(self.webpackChunkflow_web_extension=self.webpackChunkflow_web_extension||[]).push([[520],{1e4:(e,t,s)=>{s.d(t,{A:()=>ee});var i=function(){return(i=Object.assign||function(e){for(var t,s=1,i=arguments.length;s<i;s++)for(var n in t=arguments[s])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function n(e,t){var s="function"==typeof Symbol&&e[Symbol.iterator];if(!s)return e;var i,n,o=s.call(e),r=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)r.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(s=o.return)&&s.call(o)}finally{if(n)throw n.error}}return r}function o(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n(arguments[t]));return e}var r,a,l,c,d,u=function(){function e(){this._hooks={},this._cache=[],this._hooksCache={}}return e.prototype.on=function(e,t){e&&t&&"function"==typeof t&&(this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t))},e.prototype.once=function(e,t){var s=this;e&&t&&"function"==typeof t&&this.on(e,(function i(n){t(n),s.off(e,i)}))},e.prototype.off=function(e,t){if(e&&this._hooks[e]&&this._hooks[e].length)if(t){var s=this._hooks[e].indexOf(t);-1!==s&&this._hooks[e].splice(s,1)}else this._hooks[e]=[]},e.prototype.emit=function(e,t,s){if(s){if(!e)return;-1!==this._cache.indexOf(s)?this._emit(e,t):(this._hooksCache.hasOwnProperty(s)||(this._hooksCache[s]={}),this._hooksCache[s].hasOwnProperty(e)||(this._hooksCache[s][e]=[]),this._hooksCache[s][e].push(t))}else this._emit(e,t)},e.prototype._emit=function(e,t){e&&this._hooks[e]&&this._hooks[e].length&&o(this._hooks[e]).forEach((function(e){try{e(t)}catch(e){}}))},e.prototype.set=function(e){e&&-1===this._cache.indexOf(e)&&this._cache.push(e)},e}(),h=function(e){return null!=e&&"[object Object]"==Object.prototype.toString.call(e)},p=(r=+Date.now()+Number((""+Math.random()).slice(2,8)),function(){return r+=1}),g=function(e){return function(e,t,s){if("string"==typeof e&&"number"==typeof s){var i,n=[];s=s<=25?s:s%25;var o=String.fromCharCode(s+97);i=e.split(o);for(var r=0;r<i.length;r++){var a=parseInt(i[r],s);a=1*a^64;var l=String.fromCharCode(a);n.push(l)}return n.join("")}}(e,0,25)},_=function(e){var t=document.createElement("a");return t.href=e,t},m=function(e){var t={};try{var s=_(e).search;if(!s)return t;(s=s.slice(1)).split("&").forEach((function(e){var s,i,n=e.split("=");n.length&&(s=n[0],i=n[1]);try{t[s]=decodeURIComponent(void 0===i?"":i)}catch(e){t[s]=i}}))}catch(e){}return t},f=function(e){for(var t=0,s=0,i=(e+="").length,n=0;n<i;n++)((t=31*t+e.charCodeAt(s++))>0x7fffffffffff||t<-0x800000000000)&&(t&=0xffffffffffff);return t<0&&(t+=0x7ffffffffffff),t},v=(function(e,t){var s;s=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var s=arguments[e];for(var i in s)t[i]=s[i]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function s(i){function n(){}function o(t,s,o){if("undefined"!=typeof document){"number"==typeof(o=e({path:"/"},n.defaults,o)).expires&&(o.expires=new Date(1*new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var r=JSON.stringify(s);/^[\{\[]/.test(r)&&(s=r)}catch(e){}s=i.write?i.write(s,t):encodeURIComponent(String(s)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var a="";for(var l in o)o[l]&&(a+="; "+l,!0!==o[l]&&(a+="="+o[l].split(";")[0]));return document.cookie=t+"="+s+a}}function r(e,s){if("undefined"!=typeof document){for(var n={},o=document.cookie?document.cookie.split("; "):[],r=0;r<o.length;r++){var a=o[r].split("="),l=a.slice(1).join("=");s||'"'!==l.charAt(0)||(l=l.slice(1,-1));try{var c=t(a[0]);if(l=(i.read||i)(l,c)||t(l),s)try{l=JSON.parse(l)}catch(e){}if(n[c]=l,e===c)break}catch(e){}}return e?n[e]:n}}return n.set=o,n.get=function(e){return r(e,!1)},n.getJSON=function(e){return r(e,!0)},n.remove=function(t,s){o(t,"",e(s,{expires:-1}))},n.defaults={},n.withConverter=s,n}((function(){}))},e.exports=s()}(a={exports:{}}),a.exports),y=function(e,t){try{return e?v.get(e,{domain:t||document.domain}):v.get()}catch(e){return""}},b=function(e,t,s,i){try{var n=i||document.domain,o=+new Date+(s||6048e5);v.set(e,t,{expires:new Date(o),path:"/",domain:n})}catch(e){}},S=function(){function e(){this.cache={}}return e.prototype.setItem=function(e,t){this.cache[e]=t},e.prototype.getItem=function(e){return this.cache[e]},e.prototype.removeItem=function(e){this.cache[e]=void 0},e.prototype.getCookie=function(e,t){return y(e,t)},e.prototype.setCookie=function(e,t,s,i){b(e,t,s,i)},e}(),k={getItem:function(e){try{var t=localStorage.getItem(e),s=t;try{t&&"string"==typeof t&&(s=JSON.parse(t))}catch(e){}return s||{}}catch(e){}return{}},setItem:function(e,t){try{var s="string"==typeof t?t:JSON.stringify(t);localStorage.setItem(e,s)}catch(e){}},removeItem:function(e){try{localStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){return y(e,t)},setCookie:function(e,t,s,i){b(e,t,s,i)},isSupportLS:function(){try{return localStorage.setItem("_ranger-test-key","hi"),localStorage.getItem("_ranger-test-key"),localStorage.removeItem("_ranger-test-key"),!0}catch(d){return!1}}()},A={getItem:function(e){try{var t=sessionStorage.getItem(e),s=t;try{t&&"string"==typeof t&&(s=JSON.parse(t))}catch(e){}return s||{}}catch(e){}return{}},setItem:function(e,t){try{var s="string"==typeof t?t:JSON.stringify(t);sessionStorage.setItem(e,s)}catch(e){}},removeItem:function(e){try{sessionStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){return y(e,t)},setCookie:function(e,t,s,i){b(e,t,s,i)},isSupportSession:function(){try{return sessionStorage.setItem("_ranger-test-key","hi"),sessionStorage.getItem("_ranger-test-key"),sessionStorage.removeItem("_ranger-test-key"),!0}catch(d){return!1}}()},w=function(){function e(e,t){this._storage=t&&"session"===t?A:!e&&k.isSupportLS?k:new S}return e.prototype.getItem=function(e){return this._storage.getItem(e)},e.prototype.setItem=function(e,t){this._storage.setItem(e,t)},e.prototype.getCookie=function(e,t){return this._storage.getCookie(e,t)},e.prototype.setCookie=function(e,t,s,i){this._storage.setCookie(e,t,s,i)},e.prototype.removeItem=function(e){this._storage.removeItem(e)},e}(),z=function(){function e(e,t,s){this.appid=e,this.domain=t,this.userAgent=window.navigator.userAgent,this.appVersion=window.navigator.appVersion,this.cookie_expire=s}return e.prototype.init=function(){var e=window.navigator.userAgent,t=window.navigator.language,s=document.referrer,i=s?_(s).hostname:"",n=m(window.location.href),o=/Mobile|htc|mini|Android|iP(ad|od|hone)/.test(this.appVersion)?"wap":"web";this.utm=function(e,t,s,i){var n=new w(!1),o=new w(!1,"session"),r=e?"_tea_utm_cache_"+e:"_tea_utm_cache",a=e?"_$utm_from_url_"+e:"_$utm_from_url",l={},c=["tr_shareuser","tr_admaster","tr_param1","tr_param2","tr_param3","tr_param4","$utm_from_url"],d={ad_id:Number(t.ad_id)||void 0,campaign_id:Number(t.campaign_id)||void 0,creative_id:Number(t.creative_id)||void 0,utm_source:t.utm_source,utm_medium:t.utm_medium,utm_campaign:t.utm_campaign,utm_term:t.utm_term,utm_content:t.utm_content,tr_shareuser:t.tr_shareuser,tr_admaster:t.tr_admaster,tr_param1:t.tr_param1,tr_param2:t.tr_param2,tr_param3:t.tr_param3,tr_param4:t.tr_param4};try{var u=!1;for(var h in d)d[h]&&(-1!==c.indexOf(h)?(l.hasOwnProperty("tracer_data")||(l.tracer_data={}),l.tracer_data[h]=d[h]):l[h]=d[h],u=!0);if(u)o.setItem(a,"1"),n.setCookie(r,JSON.stringify(l),i,s);else{var p=n.getCookie(r,s);p&&(l=JSON.parse(p))}o.getItem(a)&&(l.hasOwnProperty("tracer_data")||(l.tracer_data={}),l.tracer_data.$utm_from_url=1)}catch(e){return d}return l}(this.appid,n,this.domain,this.cookie_expire);var r=this.browser(),a=this.os();return{browser:r.browser,browser_version:r.browser_version,platform:o,os_name:a.os_name,os_version:a.os_version,userAgent:e,screen_width:window.screen&&window.screen.width,screen_height:window.screen&&window.screen.height,device_model:this.getDeviceModel(a.os_name),language:t,referrer:s,referrer_host:i,utm:this.utm,latest_data:this.last(s,i)}},e.prototype.last=function(e,t){var s="",i="",n="",o=location.hostname,r=!1;if(e&&t&&o!==t){s=e,i=t,r=!0;var a=m(e);a.keyword&&(n=a.keyword)}return{$latest_referrer:s,$latest_referrer_host:i,$latest_search_keyword:n,isLast:r}},e.prototype.browser=function(){var e,t,s="",i=""+parseFloat(this.appVersion),n=this.userAgent,o=/\sSamantha(\w+)\/(.*?)(\s|$)/i.exec(n);return o?{browser:o[1],browser_version:o[2]}:(-1!==n.indexOf("Edge")||-1!==n.indexOf("Edg")?(s="Microsoft Edge",-1!==n.indexOf("Edge")?(e=n.indexOf("Edge"),i=n.substring(e+5)):(e=n.indexOf("Edg"),i=n.substring(e+4))):-1!==(e=n.indexOf("MSIE"))?(s="Microsoft Internet Explorer",i=n.substring(e+5)):-1!==(e=n.indexOf("MetaSr"))?(s="sougoubrowser",i=n.substring(e+7,e+10)):-1!==n.indexOf("MQQBrowser")||-1!==n.indexOf("QQBrowser")?(s="qqbrowser",-1!==n.indexOf("MQQBrowser")?(e=n.indexOf("MQQBrowser"),i=n.substring(e+11,e+15)):-1!==n.indexOf("QQBrowser")&&(e=n.indexOf("QQBrowser"),i=n.substring(e+10,e+25))):-1!==n.indexOf("Chrome")?-1!==(e=n.indexOf("MicroMessenger"))?(s="weixin",i=n.substring(e+15,e+20)):-1!==(e=n.indexOf("360"))?(s="360browser",i=n.substring(n.indexOf("Chrome")+7)):-1!==n.indexOf("baidubrowser")||-1!==n.indexOf("BIDUBrowser")?(-1!==n.indexOf("baidubrowser")?(e=n.indexOf("baidubrowser"),i=n.substring(e+13,e+16)):-1!==n.indexOf("BIDUBrowser")&&(e=n.indexOf("BIDUBrowser"),i=n.substring(e+12,e+15)),s="baidubrowser"):-1!==(e=n.indexOf("xiaomi"))?-1!==n.indexOf("openlanguagexiaomi")?(s="openlanguage xiaomi",i=n.substring(e+7,e+13)):(s="xiaomi",i=n.substring(e-7,e-1)):-1!==(e=n.indexOf("TTWebView"))?(s="TTWebView",i=n.substring(e+10,e+23)):(-1!==(e=n.indexOf("Chrome"))||-1!==(e=n.indexOf("Chrome")))&&(s="Chrome",i=n.substring(e+7)):-1!==n.indexOf("Safari")?-1!==(e=n.indexOf("QQ"))?(s="qqbrowser",i=n.substring(e+10,e+16)):-1!==(e=n.indexOf("Safari"))&&(s="Safari",i=n.substring(e+7),-1!==(e=n.indexOf("Version"))&&(i=n.substring(e+8))):-1!==(e=n.indexOf("Firefox"))?(s="Firefox",i=n.substring(e+8)):-1!==(e=n.indexOf("MicroMessenger"))?(s="weixin",i=n.substring(e+15,e+20)):-1!==(e=n.indexOf("QQ"))&&(s="qqbrowser",i=n.substring(e+3,e+8)),-1!==(t=i.indexOf(";"))&&(i=i.substring(0,t)),-1!==(t=i.indexOf(" "))&&(i=i.substring(0,t)),-1!==(t=i.indexOf(")"))&&(i=i.substring(0,t)),{browser:s,browser_version:i})},e.prototype.os=function(){for(var e="",t="",s=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0|Windows NT 10.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Android",r:/Android/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"chromeOS",r:/CrOS/},{s:"Linux",r:/(Linux|X11)/},{s:"Sun OS",r:/SunOS/}],i=0;i<s.length;i++){var n=s[i];if(n.r.test(this.userAgent)){"Mac OS X"===(e=n.s)&&this.isNewIpad()&&(e="iOS");break}}var o,r,a=function(e,t){var s=e.exec(t);return s&&s[1]?s[1]:""},l=function(e,t){var s=RegExp("(?:^|[^A-Z0-9-_]|[^A-Z0-9-]_|sprd-)(?:"+e+")","i").exec(t);return s?s.slice(1)[0]:""};switch(/Windows/.test(e)&&(t=a(/Windows (.*)/,e),e="windows"),e){case"Mac OS X":t=l("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent),e="mac";break;case"Android":(r=a(/Android ([\.\_\d]+)/,o=this.userAgent))||(r=a(/Android\/([\.\_\d]+)/,o)),t=r,e="android";break;case"iOS":t=this.isNewIpad()?l("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent):(t=/OS (\d+)_(\d+)_?(\d+)?/.exec(this.appVersion))?t[1]+"."+t[2]+"."+(0|t[3]):"",e="ios";break;case"chromeOS":var c=this.userAgent.indexOf("x86_64");t=this.userAgent.substring(c+7,c+16)}return{os_name:e,os_version:t}},e.prototype.getDeviceModel=function(e){var t="";try{if("android"===e)navigator.userAgent.split(";").forEach((function(e){e.indexOf("Build/")>-1&&(t=e.slice(0,e.indexOf("Build/")))}));else if("ios"===e||"mac"===e||"windows"===e)if(this.isNewIpad())t="iPad";else{var s=navigator.userAgent.replace("Mozilla/5.0 (",""),i=s.indexOf(";");t=s.slice(0,i)}}catch(e){return t.trim()}return t.trim()},e.prototype.isNewIpad=function(){return void 0!==this.userAgent&&"MacIntel"===navigator.platform&&"number"==typeof navigator.maxTouchPoints&&navigator.maxTouchPoints>1},e}(),E={cn:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k"},T={cn:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az28z1gz1hz1gz1cz18z1nz1gz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz21z1ez18z1jz1gz49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz18z1jz1gz24z18z49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k"},R="5.1.19",M=(g("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z1cz1bz1gz22z1mz20z49z20z18z1lz1ez1cz20z21z4az1hz21"),g("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z18z19z49z1az1mz20z1cz4az1hz21"),g("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z18z19z49z1jz1mz18z1bz1cz20z4az1hz21"),g("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz1fz1cz18z22z1kz18z1nz49z1az1mz20z1c"),g("1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1bz18z22z18z4az24z1mz1jz1az1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz1bz18z22z18z49z21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz22z1cz21z22z1cz20z49z1cz24z1cz1lz22z49z1gz1lz21z1nz1cz1az22z1mz20"),function(){function e(e,t){this.collector=e,this.config=t,this.eventNameWhiteList=["__bav_page","__bav_beat","__bav_page_statistics","__bav_click","__bav_page_exposure"],this.paramsNameWhiteList=["$inactive","$inline","$target_uuid_list","$source_uuid","$is_spider","$source_id","$is_first_time","_staging_flag"],this.regStr=new RegExp("^[a-zA-Z0-9][a-z0-9A-Z_.-]{1,255}$")}return e.prototype.checkVerify=function(e){var t=this;if(!e||!e.length)return!1;var s=e[0];if(!s)return!1;var i=s.events,n=s.header;if(!i||!i.length)return!1;var o=!0;return i.forEach((function(e){if(!e)return o=!1,void(e.checkEvent="\u4e8b\u4ef6\u5f02\u5e38");t.checkEventName(e.event)||(o=!1,e.checkEvent="\u4e8b\u4ef6\u540d\u4e0d\u80fd\u4ee5 $ or __\u5f00\u5934"),t.checkEventParams(e.params)||(o=!1,e.checkParams="\u5c5e\u6027\u540d\u4e0d\u80fd\u4ee5 $ or __\u5f00\u5934")})),this.checkEventParams(n)||(o=!1),o},e.prototype.checkEventName=function(e){return!!e&&this.calculate(e,"event")},e.prototype.checkEventParams=function(e){var t=e;if("string"==typeof e&&(t=JSON.parse(t)),!Object.keys(t).length)return!0;for(var s in t)return!(!this.calculate(s,"params")||"string"==typeof t[s]&&t[s].length>1024&&(console.warn("params: "+s+" can not over 1024 byte, please check;"),1));return!0},e.prototype.calculate=function(e,t){return-1!==("event"===t?this.eventNameWhiteList:this.paramsNameWhiteList).indexOf(e)||!new RegExp("^\\$").test(e)&&!new RegExp("^__").test(e)||(console.warn(("event"===t?"event":"params")+" name: "+e+" can not start with $ or __, pleace check;"),!1)},e}());(d=l||(l={})).Init="init",d.Config="config",d.Start="start",d.Ready="ready",d.UnReady="un-ready",d.TokenComplete="token-complete",d.TokenStorage="token-storage",d.TokenFetch="token-fetch",d.TokenError="token-error",d.ConfigUuid="config-uuid",d.ConfigWebId="config-webid",d.ConfigDomain="config-domain",d.CustomWebId="custom-webid",d.TokenChange="token-change",d.TokenReset="token-reset",d.ConfigTransform="config-transform",d.EnvTransform="env-transform",d.SessionReset="session-reset",d.SessionResetTime="session-reset-time",d.SetSessionId="set-session-id",d.Event="event",d.Events="events",d.EventNow="event-now",d.CleanEvents="clean-events",d.BeconEvent="becon-event",d.SubmitBefore="submit-before",d.SubmitScuess="submit-scuess",d.SubmitAfter="submit-after",d.SubmitError="submit-error",d.SubmitVerify="submit-verify",d.Stay="stay",d.ResetStay="reset-stay",d.StayReady="stay-ready",d.SetStay="set-stay",d.RouteChange="route-change",d.RouteReady="route-ready",d.Ab="ab",d.AbVar="ab-var",d.AbAllVars="ab-all-vars",d.AbConfig="ab-config",d.AbExternalVersion="ab-external-version",d.AbVersionChangeOn="ab-version-change-on",d.AbVersionChangeOff="ab-version-change-off",d.AbOpenLayer="ab-open-layer",d.AbCloseLayer="ab-close-layer",d.AbReady="ab-ready",d.AbComplete="ab-complete",d.AbTimeout="ab-timeout",d.Profile="profile",d.ProfileSet="profile-set",d.ProfileSetOnce="profile-set-once",d.ProfileUnset="profile-unset",d.ProfileIncrement="profile-increment",d.ProfileAppend="profile-append",d.ProfileClear="profile-clear",d.Autotrack="autotrack",d.AutotrackReady="autotrack-ready",d.CepReady="cep-ready",d.TracerReady="tracer-ready",d.sessionRecord="session-record",d.SessionRecordStart="session-record-start",d.SessionRecordPause="session-record-pause",d.SessionRecordEnd="session-record-end",d.SessionRecordReport="session-record-report",d.DestoryInstance="destory-instance",d.VisualCollectReady="visual-collect-ready",d.VisualApiReady="visual-api-ready",d.VisualApiUpdate="visual-api-update",function(e){e.DEBUGGER_MESSAGE="debugger-message",e.DEBUGGER_MESSAGE_SDK="debugger-message-sdk",e.DEBUGGER_MESSAGE_FETCH="debugger-message-fetch",e.DEBUGGER_MESSAGE_FETCH_RESULT="debugger-message-fetch-result",e.DEBUGGER_MESSAGE_EVENT="debugger-message-event",e.DEVTOOL_WEB_READY="devtool-web-ready"}(c||(c={}));var C,I=l,L=void 0,x=(new Date).getTimezoneOffset(),U=parseInt(""+-x/60,10),B=60*x,O=function(){function e(e,t){this.is_first_time=!0,this.configPersist=!1,this.initConfig=t,this.collect=e;var s=new z(t.app_id,t.cookie_domain||"",t.cookie_expire||7776e6).init();this.eventCheck=new M(e,t);var i="__tea_cache_first_"+t.app_id;this.configKey="__tea_cache_config_"+t.app_id,this.sessionStorage=new w(!1,"session"),this.localStorage=new w(!1,"local"),t.configPersist&&(this.configPersist=!0,this.storage=1===t.configPersist?this.sessionStorage:this.localStorage);var n=this.localStorage.getItem(i);n&&1==n?this.is_first_time=!1:(this.is_first_time=!0,this.localStorage.setItem(i,"1")),this.envInfo={user:{user_unique_id:L,user_type:L,user_id:L,user_is_auth:L,user_is_login:L,device_id:L,web_id:L,ip_addr_id:L,user_unique_id_type:L},header:{app_id:L,app_name:L,app_install_id:L,install_id:L,app_package:L,app_channel:L,app_version:L,ab_version:L,os_name:s.os_name,os_version:s.os_version,device_model:s.device_model,ab_client:L,traffic_type:L,client_ip:L,device_brand:L,os_api:L,access:L,language:s.language,region:L,app_language:L,app_region:L,creative_id:s.utm.creative_id,ad_id:s.utm.ad_id,campaign_id:s.utm.campaign_id,log_type:L,rnd:L,platform:s.platform,sdk_version:R,sdk_lib:"js",province:L,city:L,timezone:U,tz_offset:B,tz_name:L,sim_region:L,carrier:L,resolution:s.screen_width+"x"+s.screen_height,browser:s.browser,browser_version:s.browser_version,referrer:s.referrer,referrer_host:s.referrer_host,width:s.screen_width,height:s.screen_height,screen_width:s.screen_width,screen_height:s.screen_height,utm_term:s.utm.utm_term,utm_content:s.utm.utm_content,utm_source:s.utm.utm_source,utm_medium:s.utm.utm_medium,utm_campaign:s.utm.utm_campaign,tracer_data:JSON.stringify(s.utm.tracer_data),custom:{},wechat_unionid:L,wechat_openid:L}},this.ab_version="",this.evtParams={},this.reportErrorCallback=function(){},this.isLast=!1,this.setCustom(s),this.initDomain(),this.initABData()}return e.prototype.initDomain=function(){var e=this.initConfig.channel_domain;if(e)this.domain=e;else{var t=this.initConfig.channel;this.domain=g(T[t])}},e.prototype.setDomain=function(e){this.domain=e},e.prototype.getDomain=function(){return this.domain},e.prototype.initABData=function(){var e="__tea_sdk_ab_version_"+this.initConfig.app_id,t=null;if(this.initConfig.ab_cross){var s=this.localStorage.getCookie(e,this.initConfig.ab_cookie_domain);t=s?JSON.parse(s):null}else t=this.localStorage.getItem(e);this.setAbCache(t)},e.prototype.setAbCache=function(e){this.ab_cache=e},e.prototype.getAbCache=function(){return this.ab_cache},e.prototype.setAbVersion=function(e){this.ab_version=e},e.prototype.getAbVersion=function(){return this.ab_version},e.prototype.clearAbCache=function(){this.ab_version="",this.ab_cache={}},e.prototype.getUrl=function(e){var t="";switch(e){case"event":t="/list";break;case"webid":t="/webid";break;case"tobid":t="/tobid"}var s="";return this.initConfig.caller&&(s="?sdk_version="+R+"&sdk_name=web&app_id="+this.initConfig.app_id+"&caller="+this.initConfig.caller),""+this.getDomain()+t+s},e.prototype.setCustom=function(e){if(e&&e.latest_data&&e.latest_data.isLast)for(var t in delete e.latest_data.isLast,this.isLast=!0,e.latest_data)this.envInfo.header.custom[t]=e.latest_data[t]},e.prototype.set=function(e){var t=this;Object.keys(e).forEach((function(s){void 0!==e[s]&&null!==e[s]||t.delete(s);try{t.eventCheck.calculate(s,"config")}catch(d){}if("traffic_type"===s&&t.isLast&&(t.envInfo.header.custom.$latest_traffic_source_type=e[s]),"evtParams"===s)t.evtParams=i(i({},t.evtParams||{}),e.evtParams||{});else if("_staging_flag"===s)t.evtParams=i(i({},t.evtParams||{}),{_staging_flag:e._staging_flag});else if("reportErrorCallback"===s&&"function"==typeof e[s])t.reportErrorCallback=e[s];else{var n="",o="";if(s.indexOf(".")>-1){var r=s.split(".");n=r[0],o=r[1]}n?"user"===n||"header"===n?t.envInfo[n][o]=e[s]:t.envInfo.header.custom[o]=e[s]:Object.hasOwnProperty.call(t.envInfo.user,s)?["user_type","ip_addr_id"].indexOf(s)>-1?t.envInfo.user[s]=e[s]?Number(e[s]):e[s]:["user_id","web_id","user_unique_id","user_unique_id_type"].indexOf(s)>-1?t.envInfo.user[s]=e[s]?String(e[s]):e[s]:["user_is_auth","user_is_login"].indexOf(s)>-1?t.envInfo.user[s]=Boolean(e[s]):"device_id"===s&&(t.envInfo.user[s]=e[s]):Object.hasOwnProperty.call(t.envInfo.header,s)?t.envInfo.header[s]=e[s]:t.envInfo.header.custom[s]=e[s]}}))},e.prototype.get=function(e){try{return e?"evtParams"===e?this.evtParams:"reportErrorCallback"===e?this[e]:Object.hasOwnProperty.call(this.envInfo.user,e)?this.envInfo.user[e]:Object.hasOwnProperty.call(this.envInfo.header,e)?this.envInfo.header[e]:JSON.parse(JSON.stringify(this.envInfo[e])):JSON.parse(JSON.stringify(this.envInfo))}catch(e){console.log("get config stringify error "),this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.setStore=function(e){try{if(!this.configPersist)return;var t=this.storage.getItem(this.configKey)||{};if(t&&Object.keys(e).length){var s=Object.assign(e,t);this.storage.setItem(this.configKey,s)}}catch(e){console.log("setStore error"),this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.getStore=function(){try{if(!this.configPersist)return null;var e=this.storage.getItem(this.configKey)||{};return e&&Object.keys(e).length?e:null}catch(e){return this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message}),null}},e.prototype.delete=function(e){try{if(!this.configPersist)return;var t=this.storage.getItem(this.configKey)||{};t&&Object.hasOwnProperty.call(t,e)&&(delete t[e],this.storage.setItem(this.configKey,t))}catch(e){this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message}),console.log("delete error")}},e}(),q=function(){function e(e,t){this.isLog=t||!1,this.name=e||""}return e.prototype.info=function(e){this.isLog&&console.log("%c %s","color: yellow; background-color: black;","[AppLog WEB SDK] [instance: "+this.name+"] "+e)},e.prototype.warn=function(e){this.isLog&&console.warn("[AppLog WEB SDK] [instance: "+this.name+"] "+e)},e.prototype.error=function(e){this.isLog&&console.error("[AppLog WEB SDK] [instance: "+this.name+"] "+e)},e.prototype.throw=function(e){throw this.error(this.name),new Error(e)},e}(),P=function(){function e(){this.spiderBot=["Baiduspider","googlebot","360Spider","haosouspider","YoudaoBot","Sogou News Spider","Yisouspider","Googlebot","Headless","Applebot","Bingbot","PetalBot"]}return e.prototype.checkSpider=function(e){if(!e.enable_spider)return!1;var t=window.navigator.userAgent;if(!t)return!0;var s=!1;return this.spiderBot.forEach((function(e){-1!==t.indexOf(e)&&(s=!0)})),s},e}(),G=function(){function e(e,t){this.collect=e,this.native=t}var t=e.prototype;return t.bridgeInject=function(){try{return!!this.native&&(AppLogBridge?(console.log("AppLogBridge is injected"),!0):(console.log("AppLogBridge is not inject"),!1))}catch(e){return console.log("AppLogBridge is not inject"),!1}},t.bridgeReady=function(){var e=this;return new Promise((function(t,s){try{e.bridgeInject()?AppLogBridge.hasStarted((function(e){console.log("AppLogBridge is started? : "+e),e?t(!0):s(!1)})):s(!1)}catch(e){console.log("AppLogBridge, error:"+JSON.stringify(e.stack)),s(!1)}}))},t.setNativeAppId=function(e){try{AppLogBridge.setNativeAppId(JSON.stringify(e)),console.log("change bridge appid, event report with appid: "+e)}catch(e){console.error("setNativeAppId error")}},t.setConfig=function(e){var t=this;try{Object.keys(e).forEach((function(s){"user_unique_id"===s?t.setUserUniqueId(e[s]):e[s]?t.addHeaderInfo(s,e[s]):t.removeHeaderInfo(s)}))}catch(e){console.error("setConfig error")}},t.setUserUniqueId=function(e){try{AppLogBridge.setUserUniqueId(e)}catch(e){console.error("setUserUniqueId error")}},t.addHeaderInfo=function(e,t){try{AppLogBridge.addHeaderInfo(e,t)}catch(e){console.error("addHeaderInfo error")}},t.setHeaderInfo=function(e){try{AppLogBridge.setHeaderInfo(JSON.stringify(e))}catch(e){console.error("setHeaderInfo error")}},t.removeHeaderInfo=function(e){try{AppLogBridge.removeHeaderInfo(e)}catch(e){console.error("removeHeaderInfo error")}},t.reportPv=function(e){this.onEventV3("predefine_pageview",e)},t.onEventV3=function(e,t){try{AppLogBridge.onEventV3(e,t),this.collect.emit(DebuggerMesssge.DEBUGGER_MESSAGE,{type:DebuggerMesssge.DEBUGGER_MESSAGE_EVENT,info:"bridge\u57cb\u70b9\u4e0a\u62a5",time:Date.now(),data:[{events:[{event:e,params:t}]}],code:200,status:"success"})}catch(e){console.error("onEventV3 error")}},t.profileSet=function(e){try{AppLogBridge.profileSet(e)}catch(e){console.error("profileSet error")}},t.profileSetOnce=function(e){try{AppLogBridge.profileSetOnce(e)}catch(e){console.error("profileSetOnce error")}},t.profileIncrement=function(e){try{AppLogBridge.profileIncrement(e)}catch(e){console.error("profileIncrement error")}},t.profileUnset=function(e){try{AppLogBridge.profileUnset(e)}catch(e){console.error("profileUnset error")}},t.profileAppend=function(e){try{AppLogBridge.profileAppend(e)}catch(e){console.error("profileAppend error")}},e}(),D=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},N=function(){function e(){}return e.prototype.apply=function(e,t){var s=this;this.collect=e,this.storage=new w(!1,"session"),this.sessionKey="__tea_session_id_"+t.app_id,this.expireTime=t.expireTime||18e5,this.disableSession=t.disable_session,this.disableSessionTimeCheck=t.disable_session_check,this.disableSession||(this.setSessionId(),this.collect.on(I.SessionReset,(function(e){s.resetSessionId(e)})),this.collect.on(I.SessionResetTime,(function(){s.updateSessionIdTime()})))},e.prototype.updateSessionIdTime=function(){var e=this.storage.getItem(this.sessionKey);if(e&&e.sessionId){var t=e.timestamp;Date.now()-t>this.expireTime?e={sessionId:D(),timestamp:Date.now()}:e.timestamp=Date.now(),this.storage.setItem(this.sessionKey,e),this.resetExpTime()}},e.prototype.setSessionId=function(){var e=this,t=this.storage.getItem(this.sessionKey);t&&t.sessionId?t.timestamp=Date.now():t={sessionId:D(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,t),this.disableSessionTimeCheck||(this.sessionExp=setInterval((function(){e.checkEXp()}),this.expireTime))},e.prototype.getSessionId=function(){var e=this.storage.getItem(this.sessionKey);return this.disableSession?"":e&&e.sessionId?e.sessionId:""},e.prototype.resetExpTime=function(){var e=this;this.sessionExp&&(clearInterval(this.sessionExp),this.sessionExp=setInterval((function(){e.checkEXp()}),this.expireTime))},e.prototype.resetSessionId=function(e){var t={sessionId:e||D(),timestamp:Date.now()};this.storage.setItem(this.sessionKey,t)},e.prototype.checkEXp=function(){var e=this.storage.getItem(this.sessionKey);e&&e.sessionId&&Date.now()-e.timestamp+30>=this.expireTime&&(e={sessionId:D(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,e))},e}(),j=function(){function e(){this.eventLimit=50,this.enable_ttwebid=!1,this.eventCache=[],this.beconEventCache=[]}return e.prototype.apply=function(e,t){var s=this;this.collect=e,this.config=t,this.configManager=e.configManager,this.eventCheck=new M(e,t),this.cacheStorgae=new w(!0),this.localStorage=new w(!1),this.maxReport=t.max_report||10,this.reportTime=t.reportTime||t.report_time||30,this.timeout=t.timeout||1e5,this.enable_ttwebid=t.enable_ttwebid,this.reportUrl=t.report_url||this.configManager.getUrl("event"),this.eventKey="__tea_cache_events_"+this.configManager.get("app_id"),this.beconKey="__tea_cache_events_becon_"+this.configManager.get("app_id"),this.abKey="__tea_sdk_ab_version_"+this.configManager.get("app_id"),this.refer_key="__tea_cache_refer_"+this.configManager.get("app_id"),this.pageId=D(),this.collect.on(I.Ready,(function(){s.reportAll(!1)})),this.collect.on(I.ConfigDomain,(function(){s.reportUrl=s.configManager.getUrl("event")})),this.collect.on(I.Event,(function(e){s.event(e)})),this.collect.on(I.BeconEvent,(function(e){s.beconEvent(e)})),this.collect.on(I.CleanEvents,(function(){s.reportAll(!1)}));var i=this.linster();this.collect.on(I.DestoryInstance,(function(){i&&i()}))},e.prototype.linster=function(){var e=this,t=function(){e.reportAll(!0)};try{window.addEventListener("unload",t,!1)}catch(e){}!function(e){navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?window.addEventListener("pagehide",e,!1):window.addEventListener("beforeunload",e,!1)}(t);var s=function(){"hidden"===document.visibilityState&&e.reportAll(!0)};return document.addEventListener("visibilitychange",s,!1),function(){window.removeEventListener("unload",t),window.removeEventListener("pagehide",t,!1),window.removeEventListener("beforeunload",t,!1),document.removeEventListener("visibilitychange",s,!1)}},e.prototype.reportAll=function(e){this.report(e),this.reportBecon()},e.prototype.event=function(e){var t=this;try{if(this.collect.destroy)return;if(this.collect.sdkStop)return;var s=o(e,this.cacheStorgae.getItem(this.eventKey)||[]);if(this.cacheStorgae.setItem(this.eventKey,s),this.reportTimeout&&clearTimeout(this.reportTimeout),s.length>=this.maxReport)this.report(!1);else{var i=this.reportTime;this.reportTimeout=setTimeout((function(){t.report(!1),t.reportTimeout=null}),i)}}catch(e){this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.beconEvent=function(e){if(!this.collect.destroy&&!this.collect.sdkStop){var t=o(e,this.cacheStorgae.getItem(this.beconKey)||[]);this.cacheStorgae.setItem(this.beconKey,t),this.collect.tokenManager.getReady()&&this.collect.sdkReady&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(t)),!0))}},e.prototype.reportBecon=function(){if(!this.collect.destroy&&!this.collect.sdkStop&&this.collect.tokenManager.getReady()&&this.collect.sdkReady){var e=this.cacheStorgae.getItem(this.beconKey)||[];e&&e.length&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(e)),!0))}},e.prototype.report=function(e){if(!this.collect.destroy&&!this.collect.sdkStop&&this.collect.tokenManager.getReady()&&this.collect.sdkReady){var t=this.cacheStorgae.getItem(this.eventKey)||[];t.length&&(this.cacheStorgae.removeItem(this.eventKey),this.sliceEvent(t,e))}},e.prototype.sliceEvent=function(e,t){if(e.length>this.eventLimit)for(var s=0;s<e.length;s+=this.eventLimit){var i;i=e.slice(s,s+this.eventLimit);var n=this.split(this.merge(i));this.send(n,t)}else n=this.split(this.merge(e)),this.send(n,t)},e.prototype.handleRefer=function(){var e="";try{if(this.config.spa||this.config.autotrack){var t=this.localStorage.getItem(this.refer_key)||{};e=t.routeChange?t.refer_key:this.configManager.get("referrer")}else e=this.configManager.get("referrer")}catch(t){e=document.referrer}return e},e.prototype.merge=function(e,t){var s=this,n=this.configManager.get(),o=n.header,r=n.user;this.config.enable_pageid&&(o.custom.page_id=this.pageId),o.referrer=this.handleRefer(),o.custom=JSON.stringify(o.custom);var a=this.configManager.get("evtParams"),l=this.configManager.get("user_unique_id_type"),u=e.map((function(e){try{Object.keys(a).length&&!t&&(e.params=i(i({},a),e.params)),l&&(e.params.$user_unique_id_type=l);var n=s.configManager.getAbCache(),o=r[s.config.ab_user_mode]||r.user_unique_id;return n&&n.uuid&&n.uuid===o&&s.configManager.getAbVersion()&&(e.ab_sdk_version=s.configManager.getAbVersion()),e.session_id=s.collect.sessionManager.getSessionId(),e.params=JSON.stringify(e.params),e}catch(d){return s.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:d.message}),e}})),h=JSON.parse(JSON.stringify({events:u,user:r,header:o}));h.local_time=Math.floor(Date.now()/1e3),h.user_unique_type=this.config.enable_ttwebid?this.config.user_unique_type:void 0,h.verbose=1;var p=[];return p.push(h),p},e.prototype.split=function(e){return e.map((function(e){var t=[];return t.push(e),t}))},e.prototype.send=function(e,t){var s=this;e.length&&(this.config.disable_track_event||e.forEach((function(e){try{var i=JSON.parse(JSON.stringify(e));s.config.filter&&((i=s.config.filter(i))||console.warn("filter must return data !!")),s.collect.eventFilter&&i&&((i=s.collect.eventFilter(i))||console.warn("filterEvent api must return data !!"));var n=i||e,o=JSON.parse(JSON.stringify(n));if(s.eventCheck.checkVerify(o),!n.length)return;var r=!0;if(n.forEach((function(e){e.events.length||(r=!1)})),!r)return;s.collect.emit(I.SubmitBefore,n),s.collect.requestManager.useRequest({url:s.reportUrl,data:n,success:function(e,t){e&&0!==e.e?(s.collect.emit(I.SubmitError,{type:"f_data",eventData:t,errorCode:e.e,response:e}),s.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_EVENT,info:"\u57cb\u70b9\u4e0a\u62a5\u5931\u8d25",time:Date.now(),data:o,code:e.e,failType:"\u6570\u636e\u5f02\u5e38\u5931\u8d25",status:"fail"})):(s.collect.emit(I.SubmitScuess,{eventData:t,res:e}),s.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_EVENT,info:"\u57cb\u70b9\u4e0a\u62a5\u6210\u529f",time:Date.now(),data:o,code:200,status:"success"}))},fail:function(e,t){s.configManager.get("reportErrorCallback")(e,t),s.collect.emit(I.SubmitError,{type:"f_net",eventData:e,errorCode:t}),s.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_EVENT,info:"\u57cb\u70b9\u4e0a\u62a5\u7f51\u7edc\u5f02\u5e38",time:Date.now(),data:o,code:t,failType:"\u7f51\u7edc\u5f02\u5e38\u5931\u8d25",status:"fail"})},timeout:s.timeout,useBeacon:t,withCredentials:s.enable_ttwebid}),s.collect.emit(I.SubmitAfter,n)}catch(e){console.warn("something error, "+JSON.stringify(e.stack)),s.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}})))},e}(),F=function(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(10):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e)}().replace(/-/g,"").slice(0,19)},V=function(){function e(){this.cacheToken={},this.enableCookie=!1,this.enable_ttwebid=!1,this.enableCustomWebid=!1}return e.prototype.apply=function(e,t){var s=this;this.collect=e,this.config=t,this.configManager=this.collect.configManager,this.storage=new w(!1),this.tokenKey="__tea_cache_tokens_"+t.app_id,this.enable_ttwebid=t.enable_ttwebid,this.enableCustomWebid=t.enable_custom_webid,this.collect.on(I.ConfigUuid,(function(e){s.setUuid(e)})),this.collect.on(I.ConfigWebId,(function(e){s.setWebId(e)})),this.enableCookie=t.cross_subdomain,this.expiresTime=t.cookie_expire||6048e5,this.cookieDomain=t.cookie_domain||"",this.checkStorage()},e.prototype.checkStorage=function(){var e=this;if(this.enableCookie){var t=this.storage.getCookie(this.tokenKey,this.cookieDomain);this.cacheToken=t&&"string"==typeof t?JSON.parse(t):{}}else this.cacheToken=this.storage.getItem(this.tokenKey)||{};this.tokenType=this.cacheToken&&this.cacheToken._type_?this.cacheToken._type_:"default","custom"!==this.tokenType||this.enableCustomWebid?this.enableCustomWebid?this.collect.on(I.CustomWebId,(function(){e.tokenReady=!0,e.collect.emit(I.TokenComplete)})):this.checkEnv()||(this.enable_ttwebid?this.completeTtWid(this.cacheToken):this.check()):this.remoteWebid()},e.prototype.check=function(){this.cacheToken&&this.cacheToken.web_id?this.complete(this.cacheToken):this.config.disable_webid?this.complete({web_id:F(),user_unique_id:this.configManager.get("user_unique_id")||F()}):this.remoteWebid()},e.prototype.checkEnv=function(){var e=window.navigator.userAgent;if(-1!==e.indexOf("miniProgram")||-1!==e.indexOf("MiniProgram")){var t=m(window.location.href);return!(!t||!t.Web_ID||(this.complete({web_id:""+t.Web_ID,user_unique_id:this.configManager.get("user_unique_id")||""+t.Web_ID}),0))}return!1},e.prototype.remoteWebid=function(){var e=this,t=this.configManager.getUrl("webid"),s={app_key:this.config.app_key,app_id:this.config.app_id,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer,user_unique_id:""};this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u53d1\u8d77WEBID\u8bf7\u6c42",logType:"fetch",level:"info",time:Date.now(),data:s}),this.collect.requestManager.useRequest({url:t,data:s,success:function(t){var s;if(t&&0===t.e)s=t.web_id,e.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"WEBID\u8bf7\u6c42\u6210\u529f",logType:"fetch",level:"info",time:Date.now(),data:t});else{var i=F();s=i,e.collect.configManager.set({localWebId:i}),e.collect.emit(I.TokenError),e.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"WEBID\u8bf7\u6c42\u8fd4\u56de\u503c\u5f02\u5e38",logType:"fetch",level:"warn",time:Date.now(),data:t}),e.collect.logger.warn("appid: "+e.config.app_id+" get webid error, use local webid~")}e.complete({web_id:e.configManager.get("web_id")||s,user_unique_id:e.configManager.get("user_unique_id")||s})},fail:function(){var t=F();e.complete({web_id:e.configManager.get("web_id")||t,user_unique_id:e.configManager.get("user_unique_id")||t}),e.collect.configManager.set({localWebId:t}),e.collect.emit(I.TokenError),e.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"WEBID\u8bf7\u6c42\u7f51\u7edc\u5f02\u5e38",logType:"fetch",level:"error",time:Date.now(),data:null}),e.collect.logger.warn("appid: "+e.config.app_id+", get webid error, use local webid~")},timeout:3e5})},e.prototype.complete=function(e){var t=e.web_id,s=e.user_unique_id;e.timestamp=Date.now(),this.collect.configManager.set({web_id:t,user_unique_id:s}),this.setStorage(e),this.tokenReady=!0,this.collect.emit(I.TokenComplete)},e.prototype.completeTtWid=function(e){var t=e.user_unique_id||"",s=this.configManager.get("user_unique_id");(s||t)&&this.configManager.set({user_unique_id:s||t}),this.setStorage(e),this.tokenReady=!0,this.collect.emit(I.TokenComplete)},e.prototype.setUuid=function(e){if(e&&-1===["null","undefined","Null","None"].indexOf(e)){var t=String(e),s=this.configManager.get("user_unique_id"),i=this.cacheToken&&this.cacheToken.user_unique_id;if(t===s&&t===i)return;this.configManager.set({user_unique_id:t}),this.cacheToken||(this.cacheToken={}),this.cacheToken.user_unique_id=t,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken),this.collect.emit(I.TokenChange,"uuid"),this.collect.emit(I.SessionReset)}else this.clearUuid()},e.prototype.clearUuid=function(){this.config.enable_ttwebid||this.configManager.get("web_id")&&this.configManager.get("user_unique_id")!==this.configManager.get("web_id")&&(this.configManager.set({user_unique_id:this.configManager.get("web_id")}),this.cacheToken&&this.cacheToken.web_id&&(this.cacheToken.user_unique_id=this.cacheToken.web_id,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken)),this.collect.emit(I.TokenReset,"uuid"))},e.prototype.setWebId=function(e){if(e&&!this.config.enable_ttwebid){this.cacheToken&&this.cacheToken.web_id?this.cacheToken.web_id!==e&&(this.cacheToken.user_unique_id=this.cacheToken.web_id===this.cacheToken.user_unique_id?e:this.cacheToken.user_unique_id,this.cacheToken.web_id=e):(this.cacheToken={},this.cacheToken.web_id=e,this.cacheToken.user_unique_id=e),this.cacheToken.timestamp=Date.now();var t=this.configManager.get("web_id"),s=this.configManager.get("user_unique_id");s&&s!==t||(this.configManager.set({user_unique_id:e}),this.collect.emit(I.TokenChange,"uuid")),t!==e&&(this.configManager.set({web_id:e}),this.collect.emit(I.TokenChange,"webid")),this.setStorage(this.cacheToken)}},e.prototype.setStorage=function(e){e._type_=this.enableCustomWebid?"custom":"default",delete e["diss".split("").reverse().join("")],this.enableCookie||this.enable_ttwebid?(this.storage.setCookie(this.tokenKey,e,this.expiresTime,this.cookieDomain),this.enable_ttwebid&&(delete e.web_id,this.storage.setItem(this.tokenKey,e))):this.storage.setItem(this.tokenKey,e),this.cacheToken=e},e.prototype.getReady=function(){return this.tokenReady},e.prototype.getTobId=function(){var e=this;return new Promise((function(t){e.collect.requestManager.useRequest({url:e.configManager.getUrl("tobid"),data:{app_id:e.config.app_id,user_unique_id:e.configManager.get("user_unique_id"),web_id:e.configManager.get("web_id"),user_unique_id_type:e.configManager.get("user_unique_id_type")},success:function(e){e&&0===e.e?t(e.tobid):t("")},fail:function(){t("")},time:3e4,withCredentials:e.enable_ttwebid})}))},e}(),H=function(){function e(e,t){this.collector=e,this.config=t,this.requestType=t.request_type||"xhr",this.supportBeacon=!(!window.navigator||!window.navigator.sendBeacon),this.errorCode={NO_URL:4001,IMG_ON:4e3,IMG_CATCH:4002,BEACON_FALSE:4003,XHR_ON:500,RESPONSE:5001,TIMEOUT:5005},this.customHeader=t.custom_request_header||{}}return e.prototype.useFetch=function(e){var t=e.url,s=e.data,i=e.method,n=e.success,o=e.fail,r={"Content-Type":"application/json; charset=utf-8"};if(Object.keys(this.customHeader).length)for(var a in this.customHeader)r[a]=this.customHeader[a];window.fetch?fetch(t,{method:i||"POST",headers:r,body:JSON.stringify(s)}).then((function(e){return e.json()})).then((function(e){n&&n(e)})).catch((function(e){o&&o(s,e)})):(this.requestType="xhr",console.log("your brwoser not support fetch, use xhr"),this.useRequest({url:t,data:s,method:i,success:n,fail:o}))},e.prototype.useBeacon=function(e){var t=e.url,s=e.data,i=e.success,n=e.fail;window.navigator.sendBeacon(t,JSON.stringify(s))?i&&i():n&&n(s,this.errorCode.BEACON_FALSE)},e.prototype.useRequest=function(e){var t=this,s=e.url,i=e.data,n=e.method,o=e.success,r=e.fail,a=e.timeout,l=e.useBeacon,c=e.withCredentials,d=e.app_key,u=e.forceXhr;if(l&&this.supportBeacon)this.useBeacon({url:s,data:i,method:n,success:o,fail:r});else if("fetch"!==this.requestType||u)try{var h=new XMLHttpRequest,p=n||"POST";if(h.open(p,""+s,!0),h.setRequestHeader("Content-Type","application/json; charset=utf-8"),d&&h.setRequestHeader("X-MCS-AppKey",""+d),Object.keys(this.customHeader).length)for(var g in this.customHeader)h.setRequestHeader(g,this.customHeader[g]);c&&(h.withCredentials=!0),a&&(h.timeout=a,h.ontimeout=function(){r&&r(i,t.errorCode.TIMEOUT)}),h.onload=function(){if(o){var e=null;if(h.responseText){try{e=JSON.parse(h.responseText)}catch(t){e={}}o(e,i)}}},h.onerror=function(){h.abort(),r&&r(i,t.errorCode.XHR_ON)},h.send(JSON.stringify(i))}catch(e){}else this.useFetch({url:s,data:i,method:n,success:o,fail:r})},e}(),K=function(){function e(e,t){if(this.devToolReady=!1,this.devToolOrigin="*",this.sendAlready=!1,this.eventVerifyReady=!1,t.enable_debug){var s=e.adapters.storage;this.collect=e,this.config=t,this.app_id=t.app_id,this.cacheStorgae=new s(!1,"session"),this.eventVerifyInfo=[],this.sdk_type=R.includes("tob")?"tob":"inner",this.filterEvent=["__bav_page","__bav_beat","__bav_page_statistics","__bav_click","__bav_page_exposure","bav2b_page","bav2b_beat","bav2b_page_statistics","bav2b_click","bav2b_page_exposure","_be_active","predefine_pageview","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append","predefine_page_alive","predefine_page_close","abtest_exposure"],this.load()}}return e.prototype.loadScript=function(e){try{var t=document.createElement("script");t.src=e,t.onerror=function(){console.log("load DevTool render fail")},t.onload=function(){console.log("load DevTool render success")},document.getElementsByTagName("body")[0].appendChild(t)}catch(e){console.log("devTool load fail, "+e.message)}},e.prototype.parseUrl=function(){var e={};try{var t=window.location.href.split("?")[1].split("&");t.length&&t.forEach((function(t){var s=t.split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}))}catch(e){}return e},e.prototype.load=function(){return e=this,void 0,s=function(){var e,t,s;return function(e,t){var s,i,n,o,r={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(s)throw new TypeError("Generator is already executing.");for(;r;)try{if(s=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,i=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(n=(n=r.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){r=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){r.label=o[1];break}if(6===o[0]&&r.label<n[1]){r.label=n[1],n=o;break}if(n&&r.label<n[2]){r.label=n[2],r.ops.push(o);break}n[2]&&r.ops.pop(),r.trys.pop();continue}o=t.call(e,r)}catch(e){o=[6,e],i=0}finally{s=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}(this,(function(i){switch(i.label){case 0:if(i.trys.push([0,2,,3]),(e=this.parseUrl()).open_devtool_web&&e.app_id){if(parseInt(e.app_id)!==this.app_id)return[2]}else if(!this.getStorage())return[2];return this.loadBaseInfo(),this.loadHook(),this.setStorage(),this.addLintener(),this.loadDebuggerModule(),this.loadDevTool(),[4,this.fetchEventInfo()];case 1:return t=i.sent(),this.sendData("devtool:web:verify",t.verifyStatus),this.eventVerifyInfo=t.data,[3,3];case 2:return s=i.sent(),console.log("debug fail, "+s.message),[3,3];case 3:return[2]}}))},new((t=void 0)||(t=Promise))((function(i,n){function o(e){try{a(s.next(e))}catch(e){n(e)}}function r(e){try{a(s.throw(e))}catch(e){n(e)}}function a(e){e.done?i(e.value):new t((function(t){t(e.value)})).then(o,r)}a((s=s.apply(e,[])).next())}));var e,t,s},e.prototype.getStorage=function(){var e=this.cacheStorgae.getItem("__applog_devtool_web");return e&&parseInt(e)===this.app_id},e.prototype.setStorage=function(){this.cacheStorgae.setItem("__applog_devtool_web",this.app_id)},e.prototype.loadDevTool=function(){this.loadScript(g("1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz1bz1cz24z22z1mz1mz1jz4b")+"debug-web.0.0.2.js")},e.prototype.loadBaseInfo=function(){var e=this;this.info=[{title:"\u57fa\u672c\u4fe1\u606f",type:1,infoName:{app_id:this.config.app_id,channel:this.config.channel,\u4e0a\u62a5\u57df\u540d:this.collect.configManager.getDomain(),SDK\u7248\u672c:R,SDK\u5f15\u5165\u65b9\u5f0f:"npm"}},{title:"\u7528\u6237\u4fe1\u606f",type:2,infoName:{uuid:this.collect.configManager.get("user").user_unique_id||"",web_id:this.collect.configManager.get("user").web_id||"",ssid:"\u70b9\u51fb\u83b7\u53d6SSID"}},{title:"\u516c\u5171\u53c2\u6570\u4fe1\u606f",type:2,infoName:{\u6d4f\u89c8\u5668:this.collect.configManager.get("browser"),\u6d4f\u89c8\u5668\u7248\u672c:this.collect.configManager.get("browser_version"),\u5e73\u53f0:this.collect.configManager.get("platform"),\u8bbe\u5907\u578b\u53f7:this.collect.configManager.get("device_model"),\u64cd\u4f5c\u7cfb\u7edf:this.collect.configManager.get("os_name"),\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c:this.collect.configManager.get("os_version"),\u5c4f\u5e55\u5206\u8fa8\u7387:this.collect.configManager.get("resolution"),\u6765\u6e90:this.collect.configManager.get("referrer"),\u81ea\u5b9a\u4e49\u4fe1\u606f:""}},{title:"\u914d\u7f6e\u4fe1\u606f",type:3,infoName:{\u5168\u57cb\u70b9:!!this.config.autotrack,\u505c\u7559\u65f6\u957f:!!this.config.enable_stay_duration}},{title:"A/B\u914d\u7f6e\u4fe1\u606f",type:4,infoName:{"A/B\u5b9e\u9a8c":!!this.config.enable_ab_test}},{title:"\u5ba2\u6237\u7aef\u4fe1\u606f",type:3,infoName:{\u6253\u901a\u5f00\u5173:!!this.config.Native}}],this.log=[],this.event=[],this.collect.on(I.Ready,(function(){e.info[1].infoName.uuid=e.collect.configManager.get("user").user_unique_id,e.info[1].infoName.web_id=e.collect.configManager.get("user").web_id,e.info[2].infoName["\u81ea\u5b9a\u4e49\u4fe1\u606f"]=JSON.stringify(e.collect.configManager.get("custom")),e.config.enable_ab_test&&(e.info[4].infoName["\u5df2\u66dd\u5149VID"]=e.collect.configManager.getAbVersion(),e.info[4].infoName["A/B\u57df\u540d"]=e.config.ab_channel_domain||g(E[e.config.channel]),e.info[4].infoName["\u5168\u90e8\u914d\u7f6e"]=e.collect.configManager.getAbData()),e.config.Native&&(e.info[5].infoName["\u662f\u5426\u6253\u901a"]=!!e.collect.bridgeReport)}))},e.prototype.loadHook=function(){var e=this;this.collect.stop(),this.collect.on(c.DEBUGGER_MESSAGE,(function(t){switch(t.type){case c.DEBUGGER_MESSAGE_SDK:var s={time:t.time,type:t.logType||"sdk",level:t.level,name:t.info,show:!0,levelShow:!0,needDesc:!!t.data};return t.data&&(s.desc={content:JSON.stringify(t.data)}),e.updateLog(s),t.secType&&"AB"===t.secType?(e.info[4].infoName["\u5df2\u66dd\u5149VID"]=e.collect.configManager.getAbVersion(),e.info[4].infoName["\u5168\u90e8\u914d\u7f6e"]=e.collect.configManager.getAbData()):"USER"===t.secType&&(e.info[1].infoName.uuid=e.collect.configManager.get("user").user_unique_id,e.info[1].infoName.web_id=e.collect.configManager.get("user").web_id),void e.updateInfo();case c.DEBUGGER_MESSAGE_EVENT:if(t.data&&t.data.length){var i=t.data[0],n=i.events,o=i.header;if(o.custom=JSON.parse(o.custom),!n.length)return;n.forEach((function(s){s.checkShow=!0,s.searchShow=!0,s.type=-1!==e.filterEvent.indexOf(s.event)?"sdk":"cus",s.type=e.collect.bridgeReport?"bridge":s.type,s.params=JSON.parse(s.params),"fail"===t.status&&(s.info={message:"code: "+t.code+"\uff0c msg: "+t.failType},s.failType=t.failType);var i=!1,n=!1,o=[];e.eventVerifyInfo&&e.eventVerifyInfo.length&&(e.eventVerifyInfo.forEach((function(e){e.eventStatus=!1})),e.eventVerifyInfo.forEach((function(t){s.event===t.name&&(n=!0,i=!0,s.verifyStatus=t.status,Object.keys(s.params).forEach((function(i){if("event_index"!==i){var r={};r.paramsKey=i,r.paramsKeyValue=s.params[""+i],r.paramsStatus=!1,r.paramsStatusInfo="\u5c5e\u6027\u672a\u5f55\u5165",t.params.forEach((function(t){i===t.name&&(t.checked=!0,typeof s.params[""+i]!==e.formatParamsType(t.value_type)?r.paramsStatusInfo="\u5c5e\u6027\u7c7b\u578b\u9519\u8bef\uff0c\u5e94\u4e3a"+e.formatParamsType(t.value_type):(r.paramsStatus=!0,r.paramsStatusInfo=""))})),o.push(r),r.paramsStatusInfo&&(n=!1)}})),t.params.forEach((function(e){e.checked||(n=!1,o.push({paramsKey:e.name,paramsStatus:!1,paramsStatusInfo:"\u7f3a\u5c11\u5c5e\u6027"+e.name}))})))}))),s.reportStatus="success"===t.status,s.paramsInfo=o,s.eventStatus=n&&"success"===t.status,s.eventRecord=i})),e.updateEvent(i)}return}}))},e.prototype.formatParamsType=function(e){switch(e){case 0:return"string";case 1:case 2:return"number";case 3:return"boolean"}},e.prototype.fetchEventInfo=function(){var e=this;try{return new Promise((function(t){var s=g("1fz22z22z1nz21z4mz4bz4bz18z1nz1nz1jz1mz1ez1fz1mz1kz1cz4az19z27z22z1cz1bz18z1lz1az1cz4az1lz1cz22z4bz18z1nz1nz1jz1mz1ez1bz1cz24z22z1mz1mz1jz21z4bz1mz1nz1cz1lz18z1nz1gz4bz24z4dz4bz18z1nz1nz16z1jz1mz1ez16z1kz1cz22z18")+"?app_id="+e.app_id+"&t="+e.sdk_type+"&nc=false";e.collect.requestManager.useRequest({url:s,method:"GET",success:function(s){e.eventVerifyReady=!0,e.collect.reStart(),t({data:s.data,verifyStatus:!0})},fail:function(){e.eventVerifyReady=!0,e.collect.reStart(),t({data:[],verifyStatus:!1})},timeout:3e3})}))}catch(e){return{data:[],verifyStatus:!1}}},e.prototype.addLintener=function(){var e=this;window.addEventListener("message",(function(t){if(t.origin===location.origin){if(t&&t.data&&"devtool:web:ready"===t.data.type){if(e.devToolOrigin=t.origin,e.devToolReady=!0,e.sendAlready)return;e.sendData("devtool:web:init",{info:e.info,log:e.log,event:e.event,appid:e.app_id}),e.sendAlready=!0}t&&t.data&&"devtool:web:ssid"===t.data.type&&e.collect.getToken((function(t){e.info[1].infoName.ssid=t.tobid,e.updateInfo()})),t&&t.data&&t.data.type}}))},e.prototype.sendData=function(e,t){try{var s={type:e,payload:t};(window.opener||window.parent).postMessage(s,this.devToolOrigin)}catch(e){}},e.prototype.updateInfo=function(){this.devToolReady&&this.sendData("devtool:web:info",this.info)},e.prototype.updateLog=function(e){this.devToolReady?this.sendData("devtool:web:log",e):this.log.push(e)},e.prototype.updateEvent=function(e){this.devToolReady||this.eventVerifyReady?this.sendData("devtool:web:event",e):this.event.push(e)},e.prototype.loadDebuggerModule=function(){var e="#debugger-applog-web {\n      position: fixed;\n      width: 50px;\n      height: 50px;\n      background-image: url("+g("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz1bz1cz24z22z1mz1mz1jz4bz18z1nz1nz1jz1mz1ez4az1nz1lz1e")+");\n      bottom: 5%;\n      right: 10%;\n      cursor: pointer;\n      z-index:100;\n      background-size: 50px;\n    }",t=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.appendChild(document.createTextNode(e)),t.appendChild(s);var i=document.createElement("div");i.innerHTML='<div id="debugger-applog-web" class="debugger-applog-web"></div>';var n=document.createElement("div");n.innerHTML='<div id="debugger-container" class="debugger-container"></div>',document.getElementsByTagName("body")[0].appendChild(i),document.getElementsByTagName("body")[0].appendChild(n),document.getElementById("debugger-applog-web").addEventListener("click",(function(){(window.opener||window.parent).postMessage({type:"devtool:web:open-draw"},location.origin)}))},e}(),W={autotrack:{src:{cn:"",sg:"",va:""},object:"LogAutoTrack"},ab:{src:{cn:"",sg:"",va:""},object:"LogAb"},stay:{src:{cn:"",sg:"",va:""},object:"LogStay"},route:{src:{cn:"",sg:"",va:""},object:"LogRoute"},cep:{src:{cn:"",sg:"",va:""},object:"LogCep"},tracer:{src:{cn:"",sg:"",va:""},object:"LogTracer"},retry:{src:{cn:"",sg:"",va:""},object:"LogRetry"},visual:{src:{cn:"",sg:"",va:""},object:"LogVisual"}},J=["ab","autotrack","Stay","store","et","profile","cep","heartbeat","monitor","route","tracer"],$=function(){function e(e){this.disableAutoPageView=!1,this.bridgeReport=!1,this.staging=!1,this.pluginInstances=[],this.sended=!1,this.started=!1,this.destroy=!1,this.sdkReady=!1,this.adapters={},this.loadType="base",this.sdkStop=!1,this.name=e,this.hook=new u,this.remotePlugin=new Map,this.Types=I,this.adapters.storage=w,this.loadType="full"}return e.usePlugin=function(t,s,i){if(s){for(var n=!1,o=0,r=e.plugins.length;o<r;o++)if(e.plugins[o].name===s){e.plugins[o].plugin=t,e.plugins[o].options=i||{},n=!0;break}n||e.plugins.push({name:s,plugin:t,options:i})}else e.plugins.push({plugin:t})},e.prototype.usePlugin=function(e,t,s){e&&("full"===this.loadType&&J.includes(e)?console.info("your sdk version has "+e+" plugin already ~"):t?"string"==typeof t?this.remotePlugin.get(e)||this.remotePlugin.set(e,{src:t,call:s}):this.remotePlugin.get(e)||this.remotePlugin.set(e,{instance:t}):this.remotePlugin.get(e)||this.remotePlugin.set(e,"sdk"))},e.prototype.init=function(t){var s,i=this;this.logger=new q(this.name,t.log),this.inited?this.logger.warn("[instance: "+this.name+"], every instance's api: init,  can be call only one time!"):t&&h(t)?t.app_id&&"number"==typeof(s=t.app_id)&&!isNaN(s)?!t.app_key||function(e){return"string"==typeof e}(t.app_key)?(t.channel_domain||-1!==["cn","sg","va"].indexOf(t.channel)||(this.logger.warn("channel must be `cn`, `sg`,`va` !"),t.channel="cn"),this.spider=new P,this.spider.checkSpider(t)?this.logger.warn("your env may be a spider, can not report!"):(this.appBridge=new G(this,t.enable_native),this.requestManager=new H(this,t),this.bridgeReport=this.appBridge.bridgeInject(),this.configManager=new O(this,t),this.debugger=new K(this,t),this.initConfig=t,this.emit(I.Init),this.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cINIT",data:t,level:"info",time:Date.now()}),this.destroy=!1,t.disable_auto_pv&&(this.disableAutoPageView=!0),this.bridgeReport||(this.configManager.set({app_id:t.app_id}),this.eventManager=new j,this.tokenManager=new V,this.sessionManager=new N,Promise.all([new Promise((function(e){i.once(I.TokenComplete,(function(){e(!0)}))})),new Promise((function(e){i.once(I.Start,(function(){e(!0)}))}))]).then((function(){try{e.plugins.reduce((function(e,t){var s=t.plugin,n=t.options,o=Object.assign(i.initConfig,n),r=new s;return r.apply(i,o),e.push(r),e}),i.pluginInstances)}catch(t){console.warn("load plugin error, "+t.message),i.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:t.message})}i.sdkReady=!0,i.emit(I.Ready),i.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u521d\u59cb\u5316\u5b8c\u6210",time:Date.now(),level:"info",data:i.configManager.get("user")}),i.logger.info("appid: "+t.app_id+", userInfo:"+JSON.stringify(i.configManager.get("user"))),i.logger.info("appid: "+t.app_id+", sdk is ready, version type is "+i.loadType+", version is "+R+", you can report now !!!"),t.disable_auto_pv&&(i.disableAutoPageView=!0);try{"full"===i.loadType&&(t.enable_ab_test||t.autotrack)&&(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(t){i.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:t.message})}i.pageView(),i.on(I.TokenChange,(function(e){"webid"===e&&i.pageView(),i.logger.info("appid: "+t.app_id+" token change, new userInfo:"+JSON.stringify(i.configManager.get("user"))),i.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u8bbe\u7f6e\u4e86\u7528\u6237\u4fe1\u606f",time:Date.now(),secType:"USER",level:"info",data:i.configManager.get("user")})})),i.on(I.TokenReset,(function(){i.logger.info("appid: "+t.app_id+" token reset, new userInfo:"+JSON.stringify(i.configManager.get("user"))),i.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u91cd\u7f6e\u4e86\u7528\u6237\u4fe1\u606f",time:Date.now(),secType:"USER",level:"info",data:i.configManager.get("user")})})),i.on(I.RouteChange,(function(e){e.init||t.disable_route_report||i.pageView()}))})),this.tokenManager.apply(this,t),this.eventManager.apply(this,t),this.sessionManager.apply(this,t)),this.inited=!0)):this.logger.warn("app_key param is error, must be string, please check!"):this.logger.warn("app_id param is error, must be number, please check!"):this.logger.warn("init params error,please check!")},e.prototype.config=function(e){if(this.inited)if(e&&h(e))if(this.bridgeReport)this.appBridge.setConfig(e);else{e._staging_flag&&1===e._staging_flag&&(this.staging=!0),e.disable_auto_pv&&(this.disableAutoPageView=!0,delete e.disable_auto_pv);var t=i({},e),s=this.initConfig.configPersist||this.initConfig.config_persist||!1;if(this.initConfig&&s){var n=this.configManager.getStore();n&&(t=Object.assign(n,e)),this.configManager.setStore(e)}t.web_id,t.user_unique_id;var o=function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&(s[i[n]]=e[i[n]])}return s}(t,["web_id","user_unique_id"]);this.configManager.set(o),t.hasOwnProperty("web_id")&&this.emit(I.ConfigWebId,t.web_id),t.hasOwnProperty("user_unique_id")&&this.emit(I.ConfigUuid,t.user_unique_id),this.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cCONFIG",level:"info",time:Date.now(),data:t})}else console.warn("config params is error, please check");else console.warn("config must be use after function init")},e.prototype.setUserUniqueID=function(e){this.config({user_unique_id:e})},e.prototype.setHeaderInfo=function(e,t){var s={};s[e]=t,this.config(s)},e.prototype.removeHeaderInfo=function(e){var t={};t[e]=void 0,this.config(t)},e.prototype.setDomain=function(e){this.configManager&&this.configManager.setDomain(e),this.emit(I.ConfigDomain)},e.prototype.getConfig=function(e){return this.configManager.get(e)},e.prototype.send=function(){this.start()},e.prototype.start=function(){this.inited&&!this.sended&&(this.sended=!0,this.started=!0,this.emit(I.Start),this.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cSTART",level:"info",time:Date.now()}),this.bridgeReport&&(this.pageView(),this.emit(I.Ready)))},e.prototype.event=function(e,t){var s=this;try{var i=[];if(Array.isArray(e))e.forEach((function(e){var t=s.processEvent(e[0],e[1]||{});t&&i.push(t)}));else{var n=this.processEvent(e,t);if(!n)return;i.push(n)}this.bridgeReport?i.forEach((function(e){var t=e.event,i=e.params;s.appBridge.onEventV3(t,JSON.stringify(i))})):i.length&&(this.emit(I.Event,i),this.emit(I.SessionResetTime))}catch(e){this.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.beconEvent=function(e,t){if(Array.isArray(e))console.warn("beconEvent not support batch report, please check");else{var s=[],i=this.processEvent(e,t||{});i&&(s.push(i),s.length&&(this.emit(I.BeconEvent,s),this.emit(I.SessionResetTime)))}},e.prototype.beaconEvent=function(e,t){this.beconEvent(e,t)},e.prototype.processEvent=function(e,t){void 0===t&&(t={});try{if(!e)return console.warn("eventName is null\uff0c please check"),null;var s=e;/^event\./.test(e)&&(s=e.slice(6));var i=t;"object"!=typeof i&&(i={}),i.profile?delete i.profile:i.event_index=p();var n=void 0;return i.local_ms?(n=i.local_ms,delete i.local_ms):n=+new Date,{event:s,params:i,local_time_ms:n,is_bav:this.initConfig&&this.initConfig.autotrack?1:0}}catch(s){return this.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:s.message}),{event:e,params:t}}},e.prototype.filterEvent=function(e){this.eventFilter=e},e.prototype.on=function(e,t){this.hook.on(e,t)},e.prototype.once=function(e,t){this.hook.once(e,t)},e.prototype.off=function(e,t){this.hook.off(e,t)},e.prototype.emit=function(e,t,s){this.hook.emit(e,t,s)},e.prototype.set=function(e){this.hook.set(e)},e.prototype.stop=function(){this.sdkStop=!0},e.prototype.reStart=function(){this.sdkStop=!1},e.prototype.pageView=function(){this.disableAutoPageView||this.predefinePageView()},e.prototype.predefinePageView=function(e){if(void 0===e&&(e={}),this.inited){var t={time:Date.now(),$is_first_time:""+(this.configManager&&this.configManager.is_first_time||!1)},s=i(i({},t),e);this.event("predefine_pageview",s)}else console.warn("predefinePageView must be use after function init")},e.prototype.clearEventCache=function(){this.emit(I.CleanEvents)},e.prototype.setWebIDviaUnionID=function(e){if(e){var t=f(e);this.config({web_id:""+t,wechat_unionid:e}),this.emit(I.CustomWebId)}},e.prototype.setWebId=function(e){this.config({web_id:""+e})},e.prototype.setWebIDviaOpenID=function(e){if(e){var t=f(e);this.config({web_id:""+t,wechat_openid:e}),this.emit(I.CustomWebId)}},e.prototype.setNativeAppId=function(e){this.bridgeReport&&this.appBridge.setNativeAppId(e)},e.prototype.getSessionId=function(){return D()},e.prototype.setSessionId=function(e){this.emit(I.SessionReset,e)},e.prototype.resetStayDuration=function(e,t,s){this.emit(I.ResetStay,{url_path:e,title:t,url:s},I.Stay)},e.prototype.resetStayParams=function(e,t,s){void 0===e&&(e=""),void 0===t&&(t=""),void 0===s&&(s=""),this.emit(I.SetStay,{url_path:e,title:t,url:s},I.Stay)},e.prototype.getToken=function(e,t){var s=this;if(this.inited){var n=!1,o=function(t){if(!n){n=!0;var o=s.configManager.get().user;return t&&(o.tobid=t,o["diss".split("").reverse().join("")]=t),e(i({},o))}},r=function(){s.tokenManager.getTobId().then((function(e){o(e)}))};this.sdkReady?r():(t&&setTimeout((function(){o()}),t),this.on(I.Ready,(function(){r()})))}else console.warn("getToken must be use after function init")},e.prototype.profileSet=function(e){this.bridgeReport?this.appBridge.profileSet(JSON.stringify(e)):this.emit(I.ProfileSet,e,I.Profile),this.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cprofileSet",level:"info",time:Date.now(),data:e})},e.prototype.profileSetOnce=function(e){this.bridgeReport?this.appBridge.profileSetOnce(JSON.stringify(e)):this.emit(I.ProfileSetOnce,e,I.Profile),this.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cprofileSetOnce",level:"info",time:Date.now(),data:e})},e.prototype.profileIncrement=function(e){this.bridgeReport?this.appBridge.profileIncrement(JSON.stringify(e)):this.emit(I.ProfileIncrement,e,I.Profile),this.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cprofileIncrement",level:"info",time:Date.now(),data:e})},e.prototype.profileUnset=function(e){this.bridgeReport?this.appBridge.profileUnset(e):this.emit(I.ProfileUnset,e,I.Profile),this.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cprofileUnset",level:"info",time:Date.now(),data:e})},e.prototype.profileAppend=function(e){this.bridgeReport?this.appBridge.profileAppend(JSON.stringify(e)):this.emit(I.ProfileAppend,e,I.Profile),this.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cprofileAppend",level:"info",time:Date.now(),data:e})},e.prototype.setExternalAbVersion=function(e){this.emit(I.AbExternalVersion,"string"==typeof e&&e?(""+e).trim():null,I.Ab)},e.prototype.getVar=function(e,t,s){this.emit(I.AbVar,{name:e,defaultValue:t,callback:s},I.Ab)},e.prototype.getABconfig=function(e,t){this.emit(I.AbConfig,{params:e,callback:t},I.Ab)},e.prototype.getAbSdkVersion=function(){return this.configManager.getAbVersion()},e.prototype.onAbSdkVersionChange=function(e){var t=this;return this.emit(I.AbVersionChangeOn,e,I.Ab),function(){t.emit(I.AbVersionChangeOff,e,I.Ab)}},e.prototype.offAbSdkVersionChange=function(e){this.emit(I.AbVersionChangeOff,e,I.Ab)},e.prototype.openOverlayer=function(){this.emit(I.AbOpenLayer,"",I.Ab)},e.prototype.closeOverlayer=function(){this.emit(I.AbCloseLayer,"",I.Ab)},e.prototype.getAllVars=function(e){this.emit(I.AbAllVars,e,I.Ab)},e.prototype.destoryInstace=function(){this.destroy||(this.destroy=!0,this.off(I.TokenComplete),this.emit(I.DestoryInstance))},e.prototype.destroyInstance=function(){this.destroy||(this.destroy=!0,this.off(I.TokenComplete),this.emit(I.DestoryInstance))},e.plugins=[],e}(),Q="__rangers_ab_style__";!function(e){e[e.Var=0]="Var",e[e.All=1]="All"}(C||(C={}));var X=function(){function e(){this.fetchStatus="no",this.refreshFetchStatus="complete",this.versions=[],this.extVersions=[],this.mulilinkVersions=[],this.enable_multilink=!1,this.enable_ab_visual=!1,this.editMode=!1,this.callbacks=[],this.data=null,this.changeListener=new Map,this.readyStatus=!1,this.exposureCache=[]}return e.prototype.apply=function(e,t){var s=this;if(t.enable_ab_test){this.collect=e,this.config=t;var i=t.enable_multilink,n=t.ab_channel_domain,o=t.enable_ab_visual,r=t.ab_cross,a=t.ab_cookie_domain,l=t.ab_timeout,c=n||g(E[t.channel||"cn"]),d=e.adapters.storage,u=this.collect.Types;this.types=u,this.cacheStorgae=new d(!1),this.timeout=l||3e3,this.enable_multilink=i,this.enable_ab_visual=o,this.abKey="__tea_sdk_ab_version_"+t.app_id,this.ab_cross=r,this.ab_cookie_domain=a||"",this.fetchUrl=c+"/service/2/abtest_config/",this.reportUrl=""+e.configManager.getUrl("event"),this.exposureLimit=t.exposure_limit||20,this.ab_batch_time=t.ab_batch_time||500,this.ab_user_mode=t.ab_user_mode||"user_unique_id",this.collect.on(u.TokenChange,(function(e){"uuid"===e&&s.readyStatus&&(s.clearCache(),s.fetchAB())})),this.collect.on(u.TokenReset,(function(e){"uuid"===e&&s.readyStatus&&(s.clearCache(),s.fetchAB())})),this.collect.on(u.AbVar,(function(e){var t=e.name,i=e.defaultValue,n=e.callback;s.getVar(t,i,n)})),this.collect.on(u.AbAllVars,(function(e){s.getAllVars(e)})),this.collect.on(u.AbConfig,(function(e){var t=e.params,i=e.callback;s.getABconfig(t,i)})),this.collect.on(u.AbExternalVersion,(function(e){s.setExternalAbVersion(e)})),this.collect.on(u.AbOpenLayer,(function(){s.openOverlayer()})),this.collect.on(u.AbCloseLayer,(function(){s.closeOverlayer()})),this.collect.on(u.AbVersionChangeOn,(function(e){s.changeListener.set(e,e)})),this.collect.on(u.AbVersionChangeOff,(function(e){s.changeListener.get(e)&&s.changeListener.delete(e)})),this.loadMode(),(this.enable_ab_visual||this.enable_multilink)&&this.openOverlayer(this.config.multilink_timeout_ms||500),this.checkLocal(),this.ready("ab"),this.readyStatus||(this.fetchAB(),this.readyStatus=!0),this.collect.emit(u.AbReady)}},e.prototype.ready=function(e){var t=this;if(this.collect.set(e),this.collect.hook._hooksCache.hasOwnProperty(e)){var s=this.collect.hook._hooksCache[e];if(!Object.keys(s).length)return;var i=function(e){s[e].length&&s[e].forEach((function(s){t.collect.hook.emit(e,s)}))};for(var n in s)i(n)}},e.prototype.loadMode=function(){var e=function(){try{return JSON.parse(atob(window.name))||void 0}catch(e){return}}(),t="";if(e){var s=e.scenario,i=e.href;s?(this.editMode=!0,t=s):!i||-1===i.indexOf("datatester")&&-1===i.indexOf("visual-editor")||(this.editMode=!0,t="visual-editor")}this.enable_ab_visual&&"visual-editor"===t&&this.collect.destoryInstace()},e.prototype.checkLocal=function(){var e=this.getABCache(),t=e.ab_version,s=e.ab_ext_version,i=e.ab_version_multilink,n=e.data,o=this.checkFromUrl();o?this.mulilinkVersions.push(o):this.mulilinkVersions=i||[],this.extVersions=s||[],this.versions=t||[],this.data=n;var r=this.versions.concat(this.extVersions);this.enable_multilink&&(r=r.concat(this.mulilinkVersions)),this.configVersions(r.join(","))},e.prototype.checkFromUrl=function(){var e=m(window.location.href);return e&&e.vid?e.vid:""},e.prototype.updateVersions=function(){var e=this.extVersions.length?this.versions.concat(this.extVersions):this.versions;this.enable_multilink&&(e=e.concat(this.mulilinkVersions)),this.configVersions(e.join(",")),this.updateABCache(),this.changeListener.size>0&&this.changeListener.forEach((function(t){"function"==typeof t&&t(e)}))},e.prototype.configVersions=function(e){this.collect.configManager.setAbVersion(e)},e.prototype.getVar=function(e,t,s){if(!e)throw new Error("variable must not be empty");if(void 0===t)throw new Error("variable no default value");if("function"!=typeof s)throw new Error("callback must be a function");var i={name:e,defaultValue:t,callback:s,type:C.Var};"complete"===this.fetchStatus&&"complete"===this.refreshFetchStatus?this.getRealVar(i,e):this.callbacks.push(i)},e.prototype.getRealVar=function(e,t){var s=e.name,i=e.defaultValue,n=e.callback,o=this.data;if(o){if(h(o[s])){var r=o[s].vid;return"$ab_url"===t?this.mulilinkVersions.includes(r)||this.mulilinkVersions.push(r):this.versions.includes(r)||this.versions.push(r),this.updateVersions(),this.fechEvent(r,t,i),n(o[s].val),void this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK \u66dd\u5149\u4e86\u5b9e\u9a8c"+s,level:"info",time:Date.now(),data:o[s]})}this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK \u8c03\u7528getVar",level:"info",time:Date.now(),data:i}),n(i)}else n(i)},e.prototype.getAllVars=function(e){if("function"!=typeof e)throw new Error("callback must be a function");var t={callback:e,type:C.All};"complete"===this.fetchStatus&&"complete"===this.refreshFetchStatus?this.getRealAllVars(t):this.callbacks.push(t)},e.prototype.getRealAllVars=function(e){(0,e.callback)(this.data?JSON.parse(JSON.stringify(this.data)):{}),this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK \u8c03\u7528getAllVars",level:"info",time:Date.now(),data:this.data})},e.prototype.fechEvent=function(e,t,s){try{if(this.config.disable_track_event)return;if(!e)return;var i=this.collect.configManager.get(),n=i.header,o=i.user,r=this.getABCache(),a=o[this.ab_user_mode]||o.user_unique_id;if(r&&r.uuid&&r.uuid!==a)return;var l={event:"abtest_exposure",ab_sdk_version:""+e,params:JSON.stringify({app_id:this.config.appId,ab_url:"$ab_url"===t?s:window.location.href}),local_time_ms:Date.now()};n.custom=JSON.stringify(n.custom);var d={events:[l],user:o,header:n};this.reportExposure(d,t)}catch(e){this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.reportExposure=function(e,t){var s=this;this.exposureCache.push(e),this.reportTimeout&&clearTimeout(this.reportTimeout),this.exposureCache.length>=this.exposureLimit?this.report(t):this.reportTimeout=setTimeout((function(){s.report(t),clearTimeout(s.reportTimeout)}),this.ab_batch_time)},e.prototype.report=function(e){var t=this;this.collect.requestManager.useRequest({url:this.reportUrl,data:this.exposureCache,timeout:2e4,useBeacon:"$ab_url"===e}),this.exposureCache.forEach((function(e){t.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_EVENT,info:"\u57cb\u70b9\u4e0a\u62a5\u6210\u529f",time:Date.now(),data:[e],code:200,status:"success"})})),this.exposureCache=[]},e.prototype.setExternalAbVersion=function(e){this.extVersions=[e],this.updateVersions()},e.prototype.getABconfig=function(e,t){var s=Object.keys(e);s&&s.length&&this.collect.configManager.set(e),this.fetchAB(t)},e.prototype.get=function(e){if(this.ab_cross){var t=this.cacheStorgae.getCookie(e,this.ab_cookie_domain);return t?JSON.parse(t):{}}return this.cacheStorgae.getItem(e)},e.prototype.set=function(e,t){this.ab_cross?this.cacheStorgae.setCookie(e,t,2592e6,this.ab_cookie_domain):this.cacheStorgae.setItem(e,t),this.collect.configManager.setAbCache(t)},e.prototype.getABCache=function(e){var t={ab_version:[],ab_ext_version:[],ab_version_multilink:[],data:null,timestamp:+new Date,uuid:""};return t=this.get(this.abKey)||t,e?t[e]:t},e.prototype.updateABCache=function(){var e=this.getABCache();e.ab_version_multilink=this.mulilinkVersions,e.ab_ext_version=this.extVersions,e.ab_version=this.versions,e.timestamp=Date.now(),this.set(this.abKey,e)},e.prototype.setAbCache=function(e){var t=this.getABCache();t.data=this.data,t.uuid=e,t.timestamp=Date.now(),this.set(this.abKey,t)},e.prototype.clearCache=function(){this.refreshFetchStatus="ing",this.data={},this.extVersions=[],this.mulilinkVersions=[],this.versions=[],this.collect.configManager.clearAbCache()},e.prototype.openOverlayer=function(e){var t=this;if(function(){if(!document.getElementById(Q)){var e="body { opacity: 0 !important; }",t=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.id=Q,s.type="text/css",s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e)),t.appendChild(s)}}(),e)var s=setTimeout((function(){t.closeOverlayer(),clearTimeout(s)}),e)},e.prototype.closeOverlayer=function(){var e;(e=document.getElementById(Q))&&e.parentElement.removeChild(e)},e.prototype.fetchComplete=function(e,t){var s=this;try{if(e&&"[object Object]"==Object.prototype.toString.call(e)){this.data=e,this.setAbCache(t);var i=[];Object.keys(e).forEach((function(t){var s=e[t].vid;s&&i.push(s)})),this.versions=this.versions.filter((function(e){return i.includes(e)}));var n=e.$ab_url,o=e.$ab_modification;if(o&&o.val&&this.enable_ab_visual){if(this.collect.destroy)return}else if(n&&this.enable_multilink){this.mulilinkVersions=this.mulilinkVersions.filter((function(e){return i.includes(e)}));var r=n.val,a=n.vid;r&&a&&this.getVar("$ab_url",r,(function(){s.editMode||(r!==window.location.href?setTimeout((function(){if(!s.collect.destroy){var e=""+r;e=-1===e.indexOf("http")?"https://"+e:e,_(e).host!==location.host?e=e+"&vid="+a:window.history.replaceState("","",e),window.location.href=e}}),100):s.closeOverlayer())}))}this.updateVersions()}else this.closeOverlayer();this.callbacks.forEach((function(e){return s[e.type===C.Var?"getRealVar":"getRealAllVars"](e,"")})),this.callbacks=[]}catch(e){}},e.prototype.fetchAB=function(e){var t=this,s=this.collect.configManager.get(),n={header:i(i(i({aid:this.config.app_id},s.user||{}),s.header||{}),{ab_sdk_version:this.collect.configManager.getAbVersion(),ab_url:window.location.href})};this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u53d1\u8d77AB\u5b9e\u9a8c\u8bf7\u6c42",level:"info",logType:"fetch",time:Date.now(),data:n});var o=s.user[this.ab_user_mode]||s.user.user_unique_id;this.collect.requestManager.useRequest({url:this.fetchUrl,data:n,success:function(s){t.fetchStatus="complete",t.refreshFetchStatus="complete";var i=s.data;"success"===s.message?(t.fetchComplete(i,o),e&&e(i)):(t.fetchComplete(null,o),e&&e(null)),t.collect.emit(t.types.AbComplete,i),t.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"AB\u5b9e\u9a8c\u8bf7\u6c42\u6210\u529f",level:"info",logType:"fetch",time:Date.now(),data:i})},fail:function(){t.fetchStatus="complete",t.refreshFetchStatus="complete",t.fetchComplete(null,o),t.collect.emit(t.types.AbTimeout),e&&e(null),t.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"AB\u5b9e\u9a8c\u8bf7\u6c42\u7f51\u7edc\u5f02\u5e38",level:"error",logType:"fetch",time:Date.now()})},timeout:this.timeout})},e}(),Y="undefined"!=typeof window?(window.LogPluginObject||(window.LogPluginObject={}),window.LogPluginObject):null,Z=function(){function e(){}return e.prototype.apply=function(e,t){this._plugin={},this.config=t,this.collect=e,this.channel=t.channel||"cn",this.loadExtend()},e.prototype.loadExtend=function(){var e=this;try{this.collect.remotePlugin.forEach((function(t,s){if("sdk"===t)if(W.hasOwnProperty(s)){var i=W[s].object,n=W[s].src[e.channel]+"?query="+Date.now();e.exist(s,i,n)}else console.warn("your "+s+" is not exist\uff0cplease check plugin name");else"object"==typeof t&&(t.src?e.exist(s,t.call,t.src):e.process(s,t.instance,"INSTANCE"))}))}catch(e){this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message}),console.log("load extend error")}},e.prototype.exist=function(e,t,s){var i=this;Y[t]?(this.process(e,Y[t]),console.log("\u5df2\u6709"+e+"\u63d2\u4ef6\uff0c\u907f\u514d\u91cd\u590d\u52a0\u8f7d~")):this.loadPlugin(e,s,(function(){i.process(e,Y[t]),console.log(" %c %s %s %s","color: yellow; background-color: black;","\u2013","load plugin:"+e+" success","-")}),(function(){console.log(" %c %s %s %s","color: red; background-color: yellow;","\u2013","load plugin:"+e+" error","-")}))},e.prototype.process=function(e,t,s){try{if(s){var i=new t;i.apply&&i.apply(this.collect,this.config),console.log("excude "+e+" success")}else t&&t(this.collect,this.config)}catch(t){this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:t.message}),console.log("excude "+e+" error, message:"+t.message)}},e.prototype.loadPlugin=function(e,t,s,i){var n=this;try{var o=document.createElement("script");o.src=t,this._plugin[e]||(this._plugin[e]=[]),this._plugin[e].push(s),o.onerror=function(){i(t)},o.onload=function(){n._plugin[e].forEach((function(e){e()}))},document.getElementsByTagName("head")[0].appendChild(o)}catch(e){this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e}();$.usePlugin(Z,"extend"),$.usePlugin(X,"ab");const ee=new $("default")},23654:(e,t,s)=>{s.d(t,{A:()=>n});var i=s(50479);const n=e=>{const t=(0,i.c)(e);return{onMessage:{addListener:t.onMessage.addListener.bind(t.onMessage)},postMessage:t.postMessage.bind(t),formatMessage:e=>e}}},9584:(e,t,s)=>{s.d(t,{Y:()=>o});var i=s(82587),n=s(71905);const o=e=>(0,i.r)(e,(0,n.TK)(e))},58291:(e,t,s)=>{s.d(t,{A:()=>o});var i=s(11855),n=s(15534);const o=()=>(0,i.useContext)(n.A)},15534:(e,t,s)=>{s.d(t,{A:()=>i});const i=(0,s(11855).createContext)(null)},50479:(e,t,s)=>{s.d(t,{c:()=>o});var i=s(34350);const n=new Map,o=e=>{const t=n.get(e);if(t)return t;const s=(0,i.Gj)().connect({name:e});return n.set(e,s),s}},37526:(e,t,s)=>{s.d(t,{Qz:()=>a});var i=s(44557),n=s(10633),o=s(70548);class r{constructor(e){(0,n.A)(this,"markersInOrder",[]),(0,n.A)(this,"performanceMeasureAcc",(e=>this.performanceMeasure(e,this._startMarker))),(0,n.A)(this,"performanceMeasure",((e,t)=>{try{return performance.measure(this.name,this.getMarkName(t),this.getMarkName(e)).duration}catch(s){return-1}})),(0,n.A)(this,"eventName",""),(0,n.A)(this,"name",""),(0,n.A)(this,"_startTime",0),(0,n.A)(this,"_startMarker","mark_start"),(0,n.A)(this,"_endMarker","mark_end"),this.eventName=e,this.name=`${e}_${Math.random().toString(32).slice(2,6)}`}get markEntries(){return this.markersInOrder.forEach((e=>performance.getEntriesByName(e)))}getMarkName(e){return`${this.name}:${e}`}get measureEntries(){return performance.getEntriesByName(this.name)}clean(){this.markersInOrder.forEach((e=>performance.clearMarks(e))),performance.clearMeasures(this.name),this.markersInOrder=[]}get origin(){return performance.timeOrigin}now(){return performance.timeOrigin+performance.now()}get startTime(){return this._startTime}start(e=this._startMarker){this.clean();const t=this.mark(e);this._startTime=t.startTime,this._startMarker=e}mark(e){return this.markersInOrder.push(e),performance.mark(this.getMarkName(e))}end(e=this._endMarker,t={}){this.mark(e),this._endMarker=e,this.report(t)}get timing(){const e={startTime:this.startTime,origin:this.origin,duration:this.duration};if(this.markersInOrder.length>=1)for(let t=1;t<this.markersInOrder.length;t++){const s=this.markersInOrder[t];e[s]=this.performanceMeasureAcc(s)}return e}get duration(){return this.performanceMeasureAcc(this._endMarker)}toJSON(){return JSON.stringify(this.timing)}toMetrics(){return this.timing}toCategories(){return this.markersInOrder.reduce(((e,t)=>(0,i.A)((0,i.A)({},e),{},{[t]:t})),{})}report(e={}){const t=(0,o.Gl)();null==t||t.reportCustomPerfEvent({name:this.eventName,metrics:this.toMetrics(),categories:e})}}const a=new class{constructor(){(0,n.A)(this,"recorders",void 0),this.recorders=new Map}create(e,t=!1){this.remove(e);const s=new r(e);return t&&s.start(),this.recorders.set(e,s),s}get(e){return this.recorders.get(e)}remove(e){this.recorders.delete(e)}report(e){const t=this.get(e);t&&t.report()}};window._perfRecorder=a},98028:(e,t,s)=>{s.d(t,{C9:()=>l,bc:()=>a,fW:()=>o,wG:()=>r});var i=s(44557);const n={web_search:{count:0},web_ask:{count:0},web_translate:{count:0},web_explain:{count:0},web_grammar:{count:0},web_rewrite:{count:0},web_video_summary:{count:0},web_summary:{count:0},web_translatePage:{count:0},web_gmail:{count:0},web_podcast_summary:{count:0},sidebar_pdf_summary:{count:0},sidebar_pdf_highlight:{count:0}},o=Object.keys(n),r=()=>n,a=["web_ask","web_translate","web_translatePage"],l=Object.keys(n).reduce(((e,t)=>(0,i.A)((0,i.A)({},e),{},{[t]:a.includes(t)?10:Number.MAX_SAFE_INTEGER})),{})},64978:(e,t,s)=>{s.d(t,{X:()=>l});var i=s(44557),n=s(14065),o=s(22234),r=s(54096),a=s(76482);const l=function(){var e=(0,n.A)((function*(e){const t=Object.keys(e),s=Object.values(e),n=yield Promise.all(t.map((e=>a.A.get(e))));for(let i=0;i<t.length;i++)if(void 0!==n[i]){const a=n[i];let c=a;if(null!==(l=a)&&"object"==typeof l&&!Array.isArray(l)){const e=Object.assign({},a);c=(0,o.A)(e,s[i])}(0,r.A)(e,t[i],c)}var l;const c=t.reduce(((t,s)=>(0,i.A)((0,i.A)({},t),{},{[s]:t=>{(0,r.A)(e,s,t.newValue)}})),{});return a.A.watch(c),()=>{a.A.unwatch(c)}}));return function(t){return e.apply(this,arguments)}}()},82980:(e,t,s)=>{s.d(t,{A:()=>y});var i=s(85335),n=s(11855),o=s(29019),r=s.n(o),a=s(75420),l=s(34944),c=s(18705),d=s(89739),u=s(99301),h=s(26263),p=s(54483),g=s(26903),_=s(13959),m=s(9584);const f={area:"area-AdxVTy",info:"info-zicQ8s",link:"link-URSKaa",dropdown:"dropdown-fl_iip"};var v=s(63159);const y=e=>{const{optionPageSection:t="",position:s="bottomRight",disableKey:o=u.lf.selectAssistant,className:y,dropdownClassName:b,show:S,setShow:k,cssStyle:A,closeClick:w,renderChildren:z,spacing:E=4,onDisableOnceClick:T,disabledScene:R=[],getPopupContainer:M,children:C}=e,I=(0,n.useRef)(null),L=(0,_.A)((e=>{const t=e.composedPath();I.current&&t.includes(I.current)||null==k||k(!1)})),x=(0,a.B)(),[,U]=(0,m.Y)(d.zs[o].global),[B,O]=(0,m.Y)(d.zs[o].page),q=e=>{e.preventDefault(),e.stopPropagation(),null==k||k(!0),null==w||w()};(0,n.useEffect)((()=>{S&&(0,h.Bq)(o)}),[S]);return(0,v.jsx)("div",{className:y,ref:L,style:A,children:(0,v.jsx)(l.ms,{trigger:"custom",visible:S,spacing:E,position:s,className:f.dropdown,contentClassName:r()(b),getPopupContainer:M||(()=>L.current),render:(0,v.jsx)("div",{ref:I,onClick:e=>{e.preventDefault(),e.stopPropagation(),null==k||k(!0)},style:{overflow:"hidden"},children:(0,v.jsxs)(l.ms.Menu,{children:[d._E.filter((e=>!(null!=R&&R.includes(e.key)))).map((e=>(0,v.jsx)(l.ms.Item,{onClick:()=>(e=>{if((0,h.jk)(e.key,o),null==k||k(!1),"page"===e.key){const e=window.location.host;B.includes(e)||B.unshift(e),O([...B])}else"global"===e.key?U(!0):T()})(e),"data-testid":`disable-settings-role-${e.key}`,className:f.dropItem,children:(0,v.jsx)("span",{className:f.name,children:x(e.name)})},e.id))),(0,v.jsx)("p",{className:f.info,children:(0,v.jsxs)(i.x,{i18nKey:"flow_web_ext_setting_reopen",children:["Reopen in",(0,v.jsx)("span",{className:f.link,onClick:()=>(0,g.I)({enter_method:p.cz.disableMenu,settting_key:t}),children:"\xa0setting \xa0"})]})})]})}),children:C||(z?z({onTriggerClick:q}):(0,v.jsx)("div",{className:f.area,onClick:q,children:(0,v.jsx)(c.gz,{className:f.icon})}))})})}},51272:(e,t,s)=>{s.d(t,{K:()=>a});var i=s(22910),n=s(73721),o=s(89739),r=s(46694);const a=(0,i.n)({httpClient:n.o,getCommonParams:r.wH,baseURL:o.C1})},33084:(e,t,s)=>{s.d(t,{k:()=>r});var i=s(97724),n=s(71905),o=s(2248);const r=e=>{const t={user_context:{locale:(0,n.TK)("uiLanguage"),timezone:(0,o.O)()}};return(0,i.A)(t,e)}},36332:(e,t,s)=>{s.d(t,{_:()=>w,y:()=>z});var i=s(44557),n=s(72106),o=s(49392),r=s(21919),a=s(16604),l=s(30065),c=s(33084),d=s(18587),u=s(48544),h=s(86548),p=s(46878),g=s(89739),_=s(9462),m=s(37524),f=s(71905),v=s(99824),y=s(37526),b=s(43423),S=s(32447),k=s(61540);const A=e=>{var t;const{prompt:s="search",language:n=navigator.language,answerWithSuggest:o=!1,replyLang:r,userQueryContent:l="",browser_language:u,browser_youtube_transcript:h,browser_plugin_info:p,flag_page_translate:g,browser_mail:m="",input_skill:y="",isUserCustomSkill:b=!1,contextText:S="",translateService:k=_.c$.HUOSHAN}=e,A=null!==(t=(0,a.wz)((0,f.TK)("uiLanguage")))&&void 0!==t?t:navigator.language,w={origin:location.origin,stream:"1",answer_with_suggest:o?"1":"0",flag_browser_plugin:"1",browser_language:null!=r?r:A};if(S&&(w.samantha_context=JSON.stringify((0,c.k)({query_context:{web_content:S}}))),b)return(0,i.A)((0,i.A)({},w),{},{browser_plugin_info:JSON.stringify({frontend_source:"plugin",custom_prompt_skill_id:s,lang:null!=r?r:A})});if(s===v.EU.adjust_skill)return(0,i.A)((0,i.A)({},w),{},{browser_plugin_info:p||""});if(s===v.EU.youtube)return(0,i.A)((0,i.A)({},w),{},{browser_language:null!=u?u:A},h);let z="{}";return s===v.EU.translate?(w.browser_plugin_info=JSON.stringify({translate_service:(0,d.w)(k),frontend_source:"plugin"}),z=n):s===v.EU.ask?z=JSON.stringify({query:l}):s===v.EU.mail?z=m:s===v.EU.browser_plugin_info?z=p||"":s===v.EU.input_skill&&(z=y||""),(0,i.A)((0,i.A)({},w),{},{[s]:z,flag_page_translate:g?"1":"0"})};function w(e,t){var s,a;const{text:c="",prompt:d="search",replyId:_="",isRegenerate:w=!1,enter_chat_method:z,current_page:E="",scene:T="",sec_scene:R,trackEvent:M=!0}=e,C=(0,p.AP)(),I={id:C},L=(0,n.A)({translate_service:e.translateService},o.A),x=y.Qz.create("cici_stream_reply_perf");null==x||x.start("request_start");const U={event_type:1,message:{conversation_id:"0",section_id:"0",local_message_id:C,content_type:1,content:JSON.stringify({text:c}),reply_id:_,ext:A(e),local_conversation_id:"0",bot_id:null!==(s=null===(a=(0,f.ue)())||void 0===a?void 0:a.assistantBotId)&&void 0!==s?s:"7241547611541340167",meta_infos:[]}};var B,O;((0,b.Rm)("sendMessage",U),w)&&(null!==(B=U.message)&&void 0!==B&&B.ext&&(U.message.ext.regen="1"));M&&(null===(O=u.Ay.Tea)||void 0===O||O.event("send_message",(0,i.A)({conversation_id:(0,m.IK)().convId,enter_chat_method:z,current_page:E||(0,k.M5)(window.location.href),scene:T,sec_scene:R},L)));return S.B.fetch({req:{url:`https://${g.FI}/alice/message/stream_call_bot`,body:{payload:(0,r.lF)(JSON.stringify(U))}}},{id:C,onOpen:e=>{var s;Object.assign(I,e),null==x||x.mark("response_open"),null==t||null===(s=t.onOpen)||void 0===s||s.call(t,e,I)},onUpdate:e=>{var s,n;const{message_id:o="",reply_id:r="",content:a="{}"}=(null===(s=e.body)||void 0===s?void 0:s.message)||{};if("0"===r){var c,d;if(M)null===(d=u.Ay.Tea)||void 0===d||d.event("send_message_status",(0,i.A)({message_id:o,enter_chat_method:z,current_page:E,scene:T,sec_scene:R,success:1},L));return null==x||x.mark("response_first_message"),void(null==t||null===(c=t.onUpdate)||void 0===c||c.call(t,e,I))}let{text:h="",suggests:p=[]}=I;try{var g;const e=JSON.parse(a);e.text&&(h=`${h}${e.text}`),null!==(g=e.suggest)&&void 0!==g&&g.length&&(0===p.length&&(null==x||x.mark("response_first_suggest")),p=p.concat(e.suggest))}catch(_){l.vF.persist.info({eventName:"[SEARCH_CORE] - UPDATE",meta:(0,i.A)({},_)}),console.error("parse message content error",e,_)}Object.assign(I,(0,i.A)((0,i.A)({},e),{},{text:h,suggests:p})),null==t||null===(n=t.onUpdate)||void 0===n||n.call(t,e,I)},onDone:s=>{var i,n,o,r;M&&(null===(o=u.Ay.Tea)||void 0===o||o.event("receive_stream",{message_id:null===(r=I.body)||void 0===r||null===(r=r.message)||void 0===r?void 0:r.message_id,message_type:"text",scene:T,success:1}));const a=d===v.EU.browser_plugin_info&&"search"===(0,h.O)(e.browser_plugin_info,{}).skill_name?"search":d;null==x||x.end("response_end",{prompt:a,hasSuggest:""+(null!=I&&null!==(i=I.suggests)&&void 0!==i&&i.length?1:0)}),null==t||null===(n=t.onDone)||void 0===n||n.call(t,s,I)},onError:e=>{var s,n,o;(l.vF.persist.info({eventName:"[SEARCH_CORE] - ERROR",meta:(0,i.A)({},new Error(`search error - id: ${I.id} - msg: ${I.text}`))}),M)&&(null===(n=u.Ay.Tea)||void 0===n||n.event("send_message_status",(0,i.A)({message_id:null===(o=I.body)||void 0===o||null===(o=o.message)||void 0===o?void 0:o.message_id,enter_chat_method:z,current_page:E,scene:T,sec_scene:R,success:0},L)));null==t||null===(s=t.onError)||void 0===s||s.call(t,e,I)},onAbort:e=>{var s;l.vF.persist.info({eventName:"[SEARCH_CORE] - ABORT",meta:(0,i.A)({},I)}),null==t||null===(s=t.onAbort)||void 0===s||s.call(t,e,I)}}),C}function z(e,t){S.B.abort(e,t)}},60822:(e,t,s)=>{s.d(t,{l:()=>d});var i=s(44557),n=s(34870),o=s(45498),r=s(54483),a=s(31525),l=s(11021);const c={isShowSidebar:!1,isShowSidebarBtn:!0,isShowSearch:!0,isShowQuick:!0,isShowLinkPreview:!0,isShowVideo:!0,enterSidebarMode:r.cz.default,showTip:!0,isSidePanelMode:!1},d=(0,o.vt)()((0,n.eh)(((e,t)=>(0,i.A)((0,i.A)({},c),{},{setIsShowSidebar:(s,i)=>e((()=>t().isSidePanelMode?((0,l.c)(s?"open-side-panel":"close-side-panel"),{isShowSidebar:!1,enterSidebarMode:i}):{isShowSidebar:s,enterSidebarMode:i})),toggleShowSidebar:s=>e((e=>{if(t().isSidePanelMode)return(0,l.c)("toggle-side-panel"),{isShowSidebar:!1,enterSidebarMode:s};return{isShowSidebar:!e.isShowSidebar,enterSidebarMode:s}})),setIsShowSidebarBtn:t=>e((()=>({isShowSidebarBtn:t}))),setIsShowSearch:t=>e((()=>({isShowSearch:t}))),setIsShowQuick:t=>e((()=>({isShowQuick:t}))),setIsShowLinkPreview:t=>e((()=>({isShowLinkPreview:t}))),setIsShowVideo:t=>e((()=>({isShowVideo:t}))),setTipVisible:t=>e((()=>({showTip:t}))),setIsSidePanelMode:t=>e({isSidePanelMode:t})}))));a.m.getInstance().registerStore("useLayoutStore",d)},22007:(e,t,s)=>{s.d(t,{on:()=>u});var i=s(44557),n=s(34870),o=s(45498),r=s(31525),a=s(71905),l=s(18867),c=s(58735);const d={summaryActionVisible:![c.EP,c.JE,c.j0].some((e=>window.location.href.includes(e))),floatingCardVisible:!0,chatPageReady:!1,subPageIframeWindow:void 0,chatPageInfo:{conversation_id:""},tabInfo:{tabId:void 0,convId:void 0},collectedPage:new Set},u=(0,o.vt)()((0,n.eh)(((e,t)=>(0,i.A)((0,i.A)({},d),{},{setSummaryActionVisible:t=>e({summaryActionVisible:t}),setChatPageReady:t=>e({chatPageReady:!0,chatPageInfo:t||d.chatPageInfo}),setIframeWindowTarget:t=>e({subPageIframeWindow:t}),setFloatingCardVisible:t=>e({floatingCardVisible:t}),addCollectedPageUrl:s=>{const i=t().collectedPage||new Set;i.add(s),e({collectedPage:i})},setTabInfo:t=>{var s;return e({tabInfo:(0,i.A)((0,i.A)({},t),{},{convId:t.tabId?null===(s=(0,a.TK)("tabConversationMap"))||void 0===s||null===(s=s[t.tabId])||void 0===s?void 0:s.conversationId:void 0})})}})))),h=()=>{u.getState().setFloatingCardVisible(!0),u.getState().setSummaryActionVisible(!0)};l.A.on("router-change",h),r.m.getInstance().registerStore("useGlobalStore",u),(0,r.A)((()=>l.A.off("router-change",h)))},9639:(e,t,s)=>{s.d(t,{t_:()=>S});var i=s(14065),n=s(44557),o=s(34870),r=s(45498),a=s(66006),l=s(64903),c=s(72969),d=s(16604),u=s(25740),h=s(34350),p=s(17753);const g=function(){var e=(0,i.A)((function*(e){try{const{infos:t}=yield(0,p.jI)(e);return t.map((e=>e.lang_code))}catch(t){}}));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=(0,i.A)((function*(e=""){let t="";try{if(e.length<200){var s;t=(null===(s=yield g([e]))||void 0===s?void 0:s[0])||""}else{const s=yield(0,h.od)(e);var i;if(s.isReliable)t=s&&(0,u.S)(s)||"";else t=(null===(i=yield g([e]))||void 0===i?void 0:i[0])||""}}catch(n){return""}return(0,d.wz)(t)}));return function(){return e.apply(this,arguments)}}();var m=s(31525),f=s(95428),v=s(71905),y=s(99824);const b={barVisible:!1,barFakeHide:!1,boxVisible:!1,displayMode:"bar",inputText:"",contextText:"",range:null,currentAction:y.EU.explain,actionMessages:{},messageCursor:0,askContent:"",writeEnabled:!1,selectionBaseInfo:(0,n.A)({},c.Ws),simpleSelectionBaseInfo:(0,n.A)({},c.Ws)},S=(0,r.vt)()((0,o.eh)(((e,t)=>{return(0,n.A)((0,n.A)({},b),{},{setBarVisible:t=>e((()=>({barVisible:t,barFakeHide:!t}))),setBarFakeHide:t=>e((()=>({barFakeHide:t}))),setBoxVisible:t=>e((()=>({boxVisible:t}))),setDisplayMode:t=>e((()=>({displayMode:t}))),setInputText:t=>e((()=>({inputText:t}))),setContextText:t=>e((()=>({contextText:t}))),setRange:t=>e((()=>({range:t}))),setAskContent:t=>e((()=>({askContent:t}))),setCurrentAction:t=>e((()=>({currentAction:t}))),clearMessages:()=>e((()=>b)),setMessageCursor:t=>e((()=>({messageCursor:t}))),setWriteEnabled:t=>{e((()=>({writeEnabled:t})))},setTone:t=>{e((()=>({tone:t})))},search:s=>{var i,o;const{inputText:r,currentAction:c,lastSearchId:d="",abort:u,tone:h,askContent:p,range:g}=t();u(null!==(i=null==s||null===(o=s.abortOptions)||void 0===o?void 0:o.id)&&void 0!==i?i:d,null==s?void 0:s.abortOptions);const{enter_chat_method:_,current_page:m="",scene:b="",contextText:S="",translateService:k,answerWithSuggest:A}=s||{},w=(null==s?void 0:s.text)||r;let z=w;const E=c===y.EU.translate?(0,v.TK)("translateLanguage"):"";let T,R="";var M;(c===y.EU.ask?R=p:c===y.EU.translate&&g&&(z=(0,l.l$)(g)||z),c===y.EU.adjust_skill)?T=(0,f.g)({text:z||"",template_type:"tone",tone:null==h?void 0:h.value,scene:"highlight_search_result_tool",sec_scene:"highlight_search_result_adjust_tone"}):T=a.P.getState().sendMessage({text:z,prompt:c,language:null!==(M=null==s?void 0:s.language)&&void 0!==M?M:E,answerWithSuggest:A,enter_chat_method:_,current_page:m,scene:b,userQueryContent:R,sec_scene:null==s?void 0:s.sec_scene,isUserCustomSkill:(0,y.em)(c),contextText:S,translateService:k});e((e=>({inputText:c===y.EU.ask?w:z,actionMessages:(0,n.A)((0,n.A)({},e.actionMessages),{},{[e.currentAction]:[T]}),messageCursor:0,lastSearchId:T})))},regenerate:({replyId:s,enter_chat_method:i,current_page:o="",scene:r="",answerWithSuggest:l}={})=>{var c;const{actionMessages:d,inputText:u,currentAction:h,messageCursor:p,tone:g}=t(),_=null===(c=d[h])||void 0===c?void 0:c[p],m=a.P.getState().messages[null!=_?_:""];let b;var S;h===y.EU.adjust_skill?b=(0,f.g)({text:u||"",template_type:"tone",tone:null==g?void 0:g.value,scene:"highlight_search_result_tool",sec_scene:"highlight_search_result_adjust_tone"}):b=a.P.getState().sendMessage({text:u,prompt:h,enter_chat_method:i,current_page:o,scene:r,language:h===y.EU.translate?(0,v.TK)("translateLanguage"):navigator.language,isRegenerate:!0,replyId:s||(null==m||null===(S=m.body)||void 0===S||null===(S=S.message)||void 0===S?void 0:S.reply_id),isUserCustomSkill:(0,y.em)(h),answerWithSuggest:l});e((e=>{var t;const s=[...null!==(t=e.actionMessages[e.currentAction])&&void 0!==t?t:[],b];return{actionMessages:(0,n.A)((0,n.A)({},e.actionMessages),{},{[e.currentAction]:s}),messageCursor:s.length-1,lastSearchId:b}}))},retry:({enter_chat_method:s,current_page:i="",scene:o=""}={})=>{const{inputText:r,currentAction:l}=t(),c=a.P.getState().sendMessage({text:r,prompt:l,enter_chat_method:s,current_page:i,scene:o,language:l===y.EU.translate?(0,v.TK)("translateLanguage"):navigator.language,isUserCustomSkill:(0,y.em)(l)});e((e=>{var t;const s=null!==(t=e.actionMessages[e.currentAction])&&void 0!==t?t:[];return s.splice(e.messageCursor,1,c),{actionMessages:(0,n.A)((0,n.A)({},e.actionMessages),{},{[e.currentAction]:s}),lastSearchId:c}}))},abort:(e,t)=>{a.P.getState().abortMessage(e,t)},checkAndSetInputLang:(s=(0,i.A)((function*(){e({inputTextLangDetecting:!0});const s=yield _(t().inputText);return e({inputTextLang:s,inputTextLangDetecting:!1}),s})),function(){return s.apply(this,arguments)})});var s})));m.m.getInstance().registerStore("useSelectAssistantStore",S)},66006:(e,t,s)=>{s.d(t,{P:()=>h});var i=s(44557),n=s(34870),o=s(45498),r=s(35841),a=s(86548),l=s(43423),c=s(58735),d=s(36332);const u={messages:{},pushMessages:{}},h=(0,o.vt)()((0,n.eh)(((e,t)=>(0,i.A)((0,i.A)({},u),{},{sendMessage:s=>{const n=(0,d._)(s,{onOpen:t=>{e((e=>({messages:(0,i.A)((0,i.A)({},e.messages),{},{[n]:(0,i.A)((0,i.A)((0,i.A)({},e.messages[n]),t),{},{isOpen:!0,originParam:s})})})))},onUpdate:t=>{e((e=>{var s;const{message_id:o="",reply_id:a="",content:l="{}",content_type:c}=(null===(s=t.body)||void 0===s?void 0:s.message)||{};var d;if("0"===a)return{pushMessages:(0,i.A)((0,i.A)({},e.pushMessages),{},{[o]:null===(d=t.body)||void 0===d?void 0:d.message})};let u={};var h;e.pushMessages[o]||(u=(0,i.A)((0,i.A)({},e.pushMessages),{},{[o]:null===(h=t.body)||void 0===h?void 0:h.message}));let{text:p="",suggests:g=[],searchCardData:_={}}=e.messages[n]||{};try{const e=JSON.parse(l);var m;if(c===r.cM.PluginSearchResult)_=e;else e.text&&(p=`${p}${e.text}`),null!==(m=e.suggest)&&void 0!==m&&m.length&&(g=g.concat(e.suggest))}catch(f){console.error("parse message content error",t,f)}return(0,i.A)({messages:(0,i.A)((0,i.A)({},e.messages),{},{[n]:(0,i.A)((0,i.A)((0,i.A)({},e.messages[n]),t),{},{text:p,suggests:g,searchCardData:_})})},u)}))},onDone:()=>{e((e=>({messages:(0,i.A)((0,i.A)({},e.messages),{},{[n]:(0,i.A)((0,i.A)({},e.messages[n]),{},{isDone:!0})})})))},onError:({code:t,message:s})=>{var o;const r=`${null===(o=(0,a.O)(s,""))||void 0===o?void 0:o.code}`,d=[c.BW,c.Be].some((e=>e===r));(0,l.Rm)("stream call bot error: ",s,t),e((e=>({messages:(0,i.A)((0,i.A)({},e.messages),{},{[n]:(0,i.A)((0,i.A)({},e.messages[n]),{},{code:t,message:s,isError:!0,isUnAuthorized:d})})})))},onAbort:()=>{e((e=>({messages:(0,i.A)((0,i.A)({},e.messages),{},{[n]:(0,i.A)((0,i.A)({},e.messages[n]),{},{isAborted:!0})})})))}});return e((()=>({messages:(0,i.A)((0,i.A)({},t().messages),{},{[n]:{id:n,isOpen:!1,isDone:!1,isError:!1,isAborted:!1,isUnAuthorized:!1,text:"",suggest:[]}})}))),n},abortMessage:(s,n)=>{const o=t().messages[s];!o||null!=o&&o.isAborted||null!=o&&o.isDone||null!=o&&o.isError||((0,d.y)(s,n),e((()=>({messages:(0,i.A)((0,i.A)({},t().messages),{},{[s]:{id:s,isAborted:!0}})}))))}}))))},305:(e,t,s)=>{s.d(t,{_o:()=>o,g6:()=>i,sJ:()=>n});let i=function(e){return e.search_engine="search_engine",e.chat="chat",e.welcome="extension_welcome",e.landing="landing",e.setting="setting",e.web_otherpage="web_otherpage",e}({}),n=function(e){return e.search_engine="search_engine",e.search_related_suggested_prompt="search_related_suggested_prompt",e.highlight_search_result_tool="highlight_search_result_tool",e.highlight_search_result_tool_edit="highlight_search_result_tool_edit",e.chat_action_bar="chat_action_bar",e.suggested_prompts="suggested_prompts",e.onboarding_suggestion="onboarding_suggestion",e.resend="resend",e.edit="edit",e.side_bar_popover_summarize="side_bar_popover_summarize",e.highlight_search_result_go_chat="highlight_search_result_go_chat",e.side_bar_popover_click="side_bar_popover_click",e.webpage_sidebar_link="webpage_sidebar_link",e.video_click="video_click",e.video_go_chat="video_go_chat",e.highlight_in_siderbar_chat="highlight_in_siderbar_chat",e.mail="mail",e.podcast="podcast",e.writing_assistant="writing_assistant",e.link_preview="link_preview",e}({}),o=function(e){return e.highlight_search_result_ask="highlight_search_result_ask",e.highlight_search_result_translate="highlight_search_result_translate",e.side_bar_popover_click_summarize="side_bar_popover_click_summarize",e.side_bar_popover_click_translate="side_bar_popover_click_translate",e.webpage_sidebar_link_summarize="webpage_sidebar_link_summarize",e.video_click_summarize="video_click_summarize",e.video_go_chat="video_go_chat",e.highlight_in_sidebar_chat_explain="highlight_in_sidebar_chat_explain",e.highlight_in_sidebar_chat_translate="highlight_in_sidebar_chat_translate",e.podcast_click_summary="podcast_click_summary",e.mind_note="mind_note",e}({})},36729:(e,t,s)=>{s.d(t,{K:()=>i});let i=function(e){return e.UPPER_RIGHT="upper_right",e.SUBSCRIBED="subscribed",e.ONBOARDING="onboarding",e.IMMERSION_FULLSCREEN_BTN="fullscreen_click",e.VIDEO_DB_CLICK="video_dbclick",e.IMMERSION_FULLSCREEN_SHORT_CUT="shortcut",e.IMMERSION_BTN="immersion_click",e.WATCH_RELAY="watch_relay",e.recommendVideo="recommendvideo_list_click",e.playNext="next_button",e.recommendVideoEnding="recommendvideo_ending_click",e}({})},25740:(e,t,s)=>{s.d(t,{S:()=>n});var i=s(48485);function n(e,t=70){const{languages:s,isReliable:n}=e;if(!n)return;const o=(0,i.A)(s,(e=>e.percentage>=t));return o?o.language:void 0}},86548:(e,t,s)=>{s.d(t,{O:()=>i});const i=(e,t)=>{try{return e?JSON.parse(e):t}catch(s){return t}}},22198:(e,t,s)=>{s.d(t,{M:()=>a,u:()=>d});var i=s(77793),n=s(3400),o=s(81379);const r=["block","flow-root","grid","list-item","flex","-webkit-box","table","table-row-group","table-row"],a=e=>{const t=(0,i.A)();e.setAttribute("data-cici-select-uid",t);for(const s of e.children)a(s)};function l(e){const t=(0,n.D6)(e);return r.includes((null==t?void 0:t.display)||"inline")||"br"===e.tagName.toLowerCase()}function c(e){for(const t of e.children){if(l(t))return!0;if(t.children.length>0)return c(t)}return!1}const d=e=>{const t=[];let s=[];return function e(i){for(const n of i)(0,o.mp)(n)&&(n instanceof Text&&(/^[\n\s]*$/.test(n.textContent||"")||s.push(n)),n instanceof Element&&(l(n)&&!c(n)?(s.push(n),t.push(s),s=[]):c(n)?e(Array.from(n.childNodes)):(/^[\n\s]|[\n\s]*$/.test(n.textContent||"")&&s.length>0&&(t.push(s),s=[]),s.push(n))))}(e),s.length&&t.push(s),t}},18587:(e,t,s)=>{s.d(t,{w:()=>n});var i=s(9462);function n(e){switch(e){case i.c$.HUOSHAN:return i.th.HUOSHAN;case i.c$.GOOGLE:return i.th.GOOGLE;case i.c$.MICROSOFT:return i.th.MICROSOFT;default:return i.th.LLM}}},25981:(e,t,s)=>{s.d(t,{s:()=>i});const i=new(s(60588).A)},90152:(e,t,s)=>{s.d(t,{Y:()=>n});var i=s(71905);const n=()=>{const e=(0,i.TK)("uuid");if(e)return e;const t=(()=>{const e=Math.floor(1e8+9e8*Math.random()),t=Math.floor(1e8+9e8*Math.random());return String(e)+String(t)})();return(0,i.vE)("uuid",t),t}},31021:(e,t,s)=>{s.d(t,{n:()=>i});const i=e=>{var t;return(null==e||null===(t=e._meta)||void 0===t?void 0:t.logId)||""}},93196:(e,t,s)=>{s.d(t,{C:()=>f});var i=s(63379),n=s(2633),o=s(89380),r=s(11646),a=s(49392),l=s(53585),c=s(98248),d=s(60767),u=s(81755),h=s(79474);var p=s(83565),g=s(29581),_=s(37156),m=s(70119);const f=(e,t)=>{const s=d.BN.getState(),f=(0,r.p8b)((0,r.c89)((0,o.A)(e)));if(!f)return;const v=f[0].resolved.conversationId||"";if(f.some((({ctx:e,resolved:t})=>(0,r.Azp)({ctx:e,resolved:t},g.pU.getState()))))return;const y=(0,_.Gl)(g.pU.getState(),v)||(0,_.VN)(g.pU.getState(),v);if(y&&(0,m.gm)(y,t.chatType)){const t=(0,p._)(e),o=s.activeSkillIdMap[v];(0,n.A)(t)?f.forEach((e=>{e.resolved.localCreateExt=(0,i.A)(e.resolved.localCreateExt,(({conversationId:e})=>{var t;const s=(0,c.Y)(d.BN.getState(),l.K9.ReadPDF);if(!(null===(t=(0,u.R)(h.vf.getState(),e))||void 0===t?void 0:t.refContents))return{};const i={};return(0,a.A)(s)||(i.input_skill=JSON.stringify({skill_id:s,skill_type:l.K9.ReadPDF})),i})({conversationId:v}))})):h.vf.getState().setRefContents({refContents:t,channel:o?`skill_${o}`:"default"},v)}(0,r.vmW)(f,t)}},17033:(e,t,s)=>{s.d(t,{n:()=>i});const i={activeSkillIdMap:{},skill_drop_down_visible:void 0,skillMap:{},skills:void 0,searchGuidanceItems:[],skillReportEvents:{},userPreferences:{transTargetLang:""},systemConfig:{modelList:[],voiceList:[],canDebug:!1,unlikeFeedbackMeta:[],likeFeedbackMeta:[],feedbackPlaceholder:"",botReportMeta:[],messageReportMeta:[],uploadFileAllowedTypes:[],botLanguageList:[],uploadFileMaxSize:s(40257).eI,saveChatHistoryPopupEnable:!1,enabledSendMultiFileMessage:!1,uploadMultiEntityConf:{maxFileCount:0,maxFileSize:0}}}},24634:(e,t,s)=>{s.d(t,{B:()=>v});var i=s(67697),n=s(14065),o=s(85886),r=s(50474),a=s.n(r);const l=()=>{const e="undefined"==typeof window?{getItem:()=>Promise.resolve(null),setItem:()=>Promise.resolve(null),removeItem:()=>Promise.resolve(null)}:a().createInstance({name:"samantha-web",storeName:"store"});var t,s,i;return{getItem:(i=(0,n.A)((function*(t){return new Promise(((s,i)=>{var n;null===(n=e.getItem(t))||void 0===n||n.then((e=>{s(e)})).catch((e=>{i(e)})),setTimeout((()=>{i(new Error(`getItem ${t} timeout, timeout after 10000ms`))}),1e4)}))})),function(e){return i.apply(this,arguments)}),setItem:(s=(0,n.A)((function*(t,s){yield e.setItem(t,s)})),function(e,t){return s.apply(this,arguments)}),removeItem:(t=(0,n.A)((function*(t){yield e.removeItem(t)})),function(e){return t.apply(this,arguments)})}},c=e=>{const t=e();if(t){const{getItem:e,setItem:s,removeItem:i}=t;t.setItem=(0,o.A)(d(s,"setItem"),1e3),t.getItem=d(e,"getItem"),t.removeItem=d(i,"removeItem")}return t},d=(e,t)=>(0,n.A)((function*(...s){try{return yield e(...s)}catch(r){if(r instanceof Error){var n,o;const{usage:e=0,quota:s=0}="undefined"!=typeof window&&(yield null===(n=navigator)||void 0===n||null===(n=n.storage)||void 0===n||null===(o=n.estimate)||void 0===o?void 0:o.call(n))||{usage:0,quota:0};i.vF.persist.error({message:`[chat-input]persist storage action error: ${t} failed`,error:r,meta:{usageSpace:e/1024/1024+" MB",quotaSpace:s/1024/1024+" MB"}})}}}));var u=s(2633);const h=e=>{try{return{skills:(0,u.A)(e.skillMap)?void 0:e.skills,skillMap:e.skillMap,userPreferences:e.userPreferences}}catch(t){return i.vF.persist.error({message:"[@chat-input-store] persist state limit error",error:t instanceof Error?t:new Error(String(t))}),{}}};var p=s(44557),g=s(85371),_=s(92431),m=s(17033);const f=(e,t)=>{try{const s=(0,g.A)(e)?m.n:e;return(0,p.A)((0,p.A)({},(0,_.A)(t)),s)}catch(s){s instanceof Error&&i.vF.persist.error({message:"[@chat-input-store] persist merge error",error:s})}return t},v=e=>{var t,s;return{name:`${e.prefix}-chat-input-store`,storage:c((()=>{var t;return null!==(t=e.storage)&&void 0!==t?t:l()})),partialize:null!==(t=e.partialize)&&void 0!==t?t:h,version:1.5,merge:null!==(s=e.merge)&&void 0!==s?s:f,onRehydrateStorage:e=>{const t=i.vF.createLoggerWith({ctx:{namespace:"persist"}});return t.info({message:"hydration started",meta:{state:e}}),(e,s)=>{s?t.persist.error({message:"hydration error",error:s instanceof Error?s:new Error(String(s))}):t.info({message:"hydration finished",meta:{state:e}})}}}}},98248:(e,t,s)=>{s.d(t,{Y:()=>i});const i=(e,t)=>{const s=Object.entries(e.skillMap),[i]=s.find((([e,s])=>s.skill_type===t))||[];return i}},79474:(e,t,s)=>{s.d(t,{vf:()=>l});var i=s(34870),n=s(45498),o=s(44557),r=s(98502);const a={refContentMap:{}},l=(0,n.vt)()((0,i.eh)(((e,t)=>(0,o.A)((0,o.A)({},a),{},{setRefContents:(s,i)=>{const{refContents:n,channel:o}=s;0!==n.length?e((0,r.jM)((e=>{e.refContentMap[i]={refContents:n,channel:o}}))):t().clearRefContents(i)},clearRefContents:t=>{e((0,r.jM)((e=>{delete e.refContentMap[t]})))},moveRefContents:(t,s)=>{e((0,r.jM)((i=>{const n=i.refContentMap[t];n&&(i.refContentMap[s]=n,setTimeout((()=>{e((0,r.jM)((e=>{delete e.refContentMap[t]})))}),3e4))})))}}))))},81755:(e,t,s)=>{s.d(t,{R:()=>n});var i=s(2633);const n=(e,t)=>{const s=e.refContentMap[t];if(s&&!(0,i.A)(s.refContents))return s}},83565:(e,t,s)=>{s.d(t,{_:()=>p});var i=s(35754),n=s(89380),o=s(6839),r=s(11646),a=s(44644);const l=e=>{if("image_key"in e)return{type:"attachment",fileKey:e.image_key,fileName:"Image"};if("image"in e&&e.local_key){const t=(0,r.mf0)(r.ozw.getState(),e.local_key);if(t)return{type:"attachment",fileKey:t,fileName:(0,a.p_C)("name")(e.image)||"Image"}}},c=e=>{if("file_key"in e){const t=e.file_name||"";return{type:"attachment",fileKey:e.file_key,fileName:t||"File"}}if("file"in e&&e.local_key){const t=(0,a.p_C)("name")(e.file),s=(0,r.mf0)(r.ozw.getState(),e.local_key);if(!s)return;return{type:"attachment",fileKey:s,fileName:t||"File"}}},d=e=>{const{images:t}=e.compositeContent;if(0===t.length)return;const s=t[0];if("key"in s)return{type:"attachment",fileKey:s.key,fileName:"Image"};if("blob"in s&&s.local_key){const e=(0,r.mf0)(r.ozw.getState(),s.local_key);if(!e)return;return{type:"attachment",fileKey:e,fileName:(0,a.p_C)("name")(s.blob)||"Image"}}},u=e=>{const{files:t}=e.compositeContent;if(0===t.length)return;const s=t[0];if("key"in s){const e="file_name"in s&&s.file_name||"";return{type:"attachment",fileKey:s.key,fileName:e||"File"}}if("blob"in s&&s.local_key){const e=(0,a.p_C)("name")(s.blob),t=(0,r.mf0)(r.ozw.getState(),s.local_key);if(!t)return;return{type:"attachment",fileKey:t,fileName:e||"File"}}},h=e=>(0,r.JGj)(e)?[l(e)].filter(o.q3):(0,r.QP5)(e)?[c(e)].filter(o.q3):(0,r.frm)(e)?[d(e)].filter(o.q3):(0,r.kkt)(e)?[u(e)].filter(o.q3):(0,r.YVR)(e)?(e=>{const{links:t}=e.compositeContent;return t.map((e=>({type:"link",link:e})))})(e):(0,r.BuH)(e)?(e=>e.nestedItems.map((e=>{if(e.type===r.WRI.File)return{type:"attachment",fileName:e.fileName,fileKey:e.fileKey}})).filter(o.q3))(e):[],p=e=>{const t=(0,n.A)(e),s=(0,i.A)(t.map((e=>h(e))));return s}},23084:(e,t,s)=>{s.d(t,{r:()=>u});var i=s(44557),n=s(69232),o=s(71681),r=s(2814),a=s(61577),l=s(11646),c=s(60767),d=s(29581);const u=e=>{var t,s,u,h,p,g,_,m;const{store:f,isEnableDebug:v,http:{baseURL:y,client:b,getCommonHeaders:S,getCommonParams:k,ApiServiceConstructor:A,subApiServiceConstructors:w},localFeatureConfig:z}=e;return(0,l.Tww)((0,i.A)((0,i.A)({},f),{},{merge:null===(t=f.merge)||void 0===t?void 0:t.chatMessageStore,partialize:null===(s=f.partialize)||void 0===s?void 0:s.chatMessageStore,isEnableDebug:!!v,reduxDevToolsSnapshot:null==z?void 0:z.reduxDevToolsSnapshot})),(0,c.mS)((0,i.A)((0,i.A)({},f),{},{merge:null===(u=f.merge)||void 0===u?void 0:u.chatInputStore,partialize:null===(h=f.partialize)||void 0===h?void 0:h.chatInputStore,isEnableDebug:!!v,reduxDevToolsSnapshot:null==z?void 0:z.reduxDevToolsSnapshot})),(0,d.Eh)((0,i.A)((0,i.A)({},f),{},{merge:null===(p=f.merge)||void 0===p?void 0:p.chatFeedStore,partialize:null===(g=f.partialize)||void 0===g?void 0:g.chatFeedStore,isEnableDebug:!!v,reduxDevToolsSnapshot:null==z?void 0:z.reduxDevToolsSnapshot})),(0,a.y7)((0,i.A)((0,i.A)({},f),{},{merge:null===(_=f.merge)||void 0===_?void 0:_.chatChunkTaskStore,partialize:null===(m=f.partialize)||void 0===m?void 0:m.chatChunkTaskStore,isEnableDebug:!!v,reduxDevToolsSnapshot:null==z?void 0:z.reduxDevToolsSnapshot})),(0,o.Dr)((0,i.A)((0,i.A)({},f),{},{isEnableDebug:!!v,reduxDevToolsSnapshot:null==z?void 0:z.reduxDevToolsSnapshot})),n.j.init({httpClient:b,baseURL:y,getCommonHeaders:S,getCommonParams:k,ApiServiceConstructor:A,subApiServiceConstructors:w}),r.B.on("message.updated",(e=>{(0,l.dz7)(e)&&l.ozw.getState().setMusicAutoPlay(!0),(0,l.oSs)(e)&&((0,l.lTU)(e)||(0,l.A99)(e))&&o.WA.getState().setUgcMusicAutoPlay(!0)})),{eventEmitter:r.B}}},2814:(e,t,s)=>{s.d(t,{B:()=>i});const i=new(s(60588).b)},75328:(e,t,s)=>{s.d(t,{G:()=>d});var i=s(10633),n=s(42579),o=s.n(n),r=s(44644),a=s(67697),l=s(25865);const c=s.n(l)();class d{constructor(e){var t,s,n;(0,i.A)(this,"imageConfig",void 0),(0,i.A)(this,"fileConfig",void 0),(0,i.A)(this,"user_id",void 0),(0,i.A)(this,"client",void 0),(0,i.A)(this,"useDirectUpload",void 0),(0,i.A)(this,"callbackMap",{});const{imageConfig:o,fileConfig:r,userId:a,appId:l,useDirectUpload:d=!1}=e;this.imageConfig=o,this.fileConfig=r,this.user_id=a,this.client=new c({appId:l,userId:a,imageHost:`https://${null==o?void 0:o.upload_host}`,imageFallbackHost:`https://${null==o?void 0:o.upload_host}`,imageConfig:{serviceId:(null==o?void 0:o.service_id)||""},objectConfig:{serviceId:null==r?void 0:r.service_id},useFileExtension:!0}),this.useDirectUpload=d,null===(t=this.client)||void 0===t||t.on("complete",this.onUploadComplete.bind(this)),null===(s=this.client)||void 0===s||s.on("error",this.onUploadError.bind(this)),null===(n=this.client)||void 0===n||n.on("progress",this.onUploadProgress.bind(this))}updateImageConfig(e){var t,s;this.imageConfig=e,null===(t=this.client)||void 0===t||t.setOption({imageHost:`https://${null==e?void 0:e.upload_host}`,imageConfig:{serviceId:(null==e?void 0:e.service_id)||""}}),null===(s=this.client)||void 0===s||s.refreshSTSToken(this.stsToken)}updateFileConfig(e){this.fileConfig=e}get imageConfigExpired(){var e;const t=o()(),s=o()(null===(e=this.imageConfig)||void 0===e||null===(e=e.auth)||void 0===e?void 0:e.expired_time);return t.isAfter(s)}get fileConfigExpired(){var e;const t=o()(),s=o()(null===(e=this.fileConfig)||void 0===e||null===(e=e.auth)||void 0===e?void 0:e.expired_time);return t.isAfter(s)}get stsToken(){var e,t,s,i,n;return{CurrentTime:(null===(e=this.imageConfig)||void 0===e||null===(e=e.auth)||void 0===e?void 0:e.current_time)||"",ExpiredTime:(null===(t=this.imageConfig)||void 0===t||null===(t=t.auth)||void 0===t?void 0:t.expired_time)||"",SessionToken:(null===(s=this.imageConfig)||void 0===s||null===(s=s.auth)||void 0===s?void 0:s.session_token)||"",AccessKeyId:(null===(i=this.imageConfig)||void 0===i||null===(i=i.auth)||void 0===i?void 0:i.access_key_id)||"",SecretAccessKey:(null===(n=this.imageConfig)||void 0===n||null===(n=n.auth)||void 0===n?void 0:n.secret_access_key)||""}}get fileStsToken(){var e,t,s,i,n;return{CurrentTime:(null===(e=this.fileConfig)||void 0===e||null===(e=e.auth)||void 0===e?void 0:e.current_time)||"",ExpiredTime:(null===(t=this.fileConfig)||void 0===t||null===(t=t.auth)||void 0===t?void 0:t.expired_time)||"",SessionToken:(null===(s=this.fileConfig)||void 0===s||null===(s=s.auth)||void 0===s?void 0:s.session_token)||"",AccessKeyId:(null===(i=this.fileConfig)||void 0===i||null===(i=i.auth)||void 0===i?void 0:i.access_key_id)||"",SecretAccessKey:(null===(n=this.fileConfig)||void 0===n||null===(n=n.auth)||void 0===n?void 0:n.secret_access_key)||""}}onUploadComplete(e){var t,s;this.callbackMap[e.key]&&(null===(t=this.callbackMap[e.key])||void 0===t||null===(s=t.complete)||void 0===s||s.call(t,e),delete this.callbackMap[e.key])}onUploadError(e){var t,s;this.callbackMap[e.key]&&(null===(t=this.callbackMap[e.key])||void 0===t||null===(s=t.error)||void 0===s||s.call(t,e))}onUploadProgress(e){var t,s;null===(t=this.callbackMap[e.key])||void 0===t||null===(s=t.progress)||void 0===s||s.call(t,e)}uploadImage(e,t){if(!this.client)return;a.vF.persist.log({eventName:"imagex_upload_image_client_addImageFile",meta:{file_size:e.size,file_name_length:(0,r.p_C)("name")(e).length}});const s=this.client.addImageFile({file:e,stsToken:this.stsToken,type:"image",useDirectUpload:this.useDirectUpload});this.callbackMap[s]=t,this.client.start(s)}uploadFile(e,t){if(!this.client)return;a.vF.persist.log({eventName:"imagex_upload_image_client_addFile",meta:{file_size:e.size,file_name_length:(0,r.p_C)("name")(e).length}});const s=this.client.addFile({file:e,stsToken:this.fileStsToken,type:"object",useDirectUpload:this.useDirectUpload});this.callbackMap[s]=t,this.client.start(s)}}},22953:(e,t,s)=>{function i(){const e={service:null};return{get(t,s){var i;const n=null===(i=e.service)||void 0===i||null===(i=i.ctx)||void 0===i?void 0:i[t];if(!n&&!s)throw new Error(`target service [${t}] not found`);return n},get service(){return e.service},set service(t){e.service=t}}}s.d(t,{p:()=>i})},51242:(e,t,s)=>{s.d(t,{H:()=>i});let i=function(e){return e[e.Conversation=0]="Conversation",e[e.Bot=1]="Bot",e[e.ProfileBot=3]="ProfileBot",e[e.NewThread=4]="NewThread",e[e.UnloginMainBot=5]="UnloginMainBot",e[e.CollectionLocalConversation=6]="CollectionLocalConversation",e}({})},60483:(e,t,s)=>{s.d(t,{Z:()=>i});let i=function(e){return e.Original="original",e.UseTemplate="use_template",e.ChangeTemplate="change_template",e.Paste="paste",e.Other="other",e.NotMessage="notMessage",e}({})},40316:(e,t,s)=>{s.d(t,{a:()=>i});let i=function(e){return e.Api="Api",e.Socket="Socket",e.HttpChunk="HttpChunk",e.HttpLongPolling="HttpLongPolling",e}({})},71681:(e,t,s)=>{s.d(t,{Dr:()=>d,WA:()=>c});var i=s(44557),n=s(34870),o=s(45498),r=s(28171),a=s(56793);const l=e=>{const{prefix:t,isEnableDebug:s,reduxDevToolsSnapshot:i}=e,r=(0,n.eh)(a.k);return s&&i?(0,o.vt)()((0,n.lt)(r,{name:`${t}-chat-view-store`})):(0,o.vt)()(r)};const c=function e(...t){const{_useChatViewStore:s}=e.prototype;if(s)return s(...t);throw Error("useChatViewStore is not initialized")};function d(e){const{_useChatViewStore:t}=c.prototype||{};if(!t){const t=l((0,i.A)((0,i.A)({},e),{},{prefix:"samantha-web"}));Object.setPrototypeOf(c.prototype,t),Object.defineProperties(c,(0,i.A)({},Object.getOwnPropertyDescriptors(t))),c.prototype._useChatViewStore=t}(0,r.Il)(e)}},35485:(e,t,s)=>{s.d(t,{CB:()=>l,Qo:()=>a,cL:()=>r});var i=s(27970),n=s(29581),o=s(36540);const r=e=>(0,i.tY)(n.pU.getState(),e),a=(e,t)=>(0,i.Xc)(n.pU.getState(),e,t),l=(e="",t,s,i)=>(0,o.D)(n.pU.getState(),e,t,s,i)},9049:(e,t,s)=>{s.d(t,{e:()=>o});var i=s(27970),n=s(29581);const o=(e,t=!1)=>(0,i.Rx)(n.pU.getState(),e,t)},36540:(e,t,s)=>{s.d(t,{D:()=>l});var i=s(70119),n=s(27970),o=s(56356);const r=(e,t)=>{if(t)return t===e;const s=o.Xy.get("chatConfigService");return(null==s?void 0:s.userId)===e};let a=function(e){return e.default="default",e.defaultNew="default_new",e.otherDefault="other_default",e.selfCreated="self_created",e.othersCreated="others_created",e}({});const l=(e,t,s,o,l)=>{var c,d;const{conversation:u,botInfo:h}=(0,n.tY)(e,s);return(0,i.if)(u)||(0,i.Sx)(l)?a.default:(0,i.aj)(u)||(0,i.i1)(l)?a.defaultNew:r((null==u||null===(c=u.bot_creator_info)||void 0===c?void 0:c.creator_id)||"",t)||r((null==o||null===(d=o.creator_info)||void 0===d?void 0:d.creator_id)||"",t)?a.selfCreated:(0,i.vM)(null==u?void 0:u.bot_type)||(0,i.vM)(null==h?void 0:h.bot_type)||(0,i.vM)(null==o?void 0:o.bot_type)?a.othersCreated:(0,i.dG)(null==u?void 0:u.bot_type)||(0,i.dG)(null==h?void 0:h.bot_type)||(0,i.dG)(null==o?void 0:o.bot_type)?a.otherDefault:(0,i.AU)(null==h?void 0:h.bot_type)||(0,i.AU)(null==o?void 0:o.bot_type)?a.default:""}},63101:(e,t,s)=>{s.d(t,{Gw:()=>E,gk:()=>z});var i=s(33451),n=s(14065),o=s(44557),r=s(35754),a=s(89380),l=s(85371),c=s(23974),d=s(56642),u=s(98502),h=s(44644),p=s(67697),g=s(69232),_=s(58367),m=s(60258);let f=function(e){return e[e.Default=0]="Default",e[e.Landing=1]="Landing",e}({});const v=e=>(0,c.A)(e,"conversationId");var y=s(53065);var b=s(64817),S=s(8755),k=s(70119),A=s(56356);const w=["type"],z={conversationListStatus:{loading:!1,failed:!1,count:0,hasMore:!1,isReload:!1,initiated:!1},conversationLinks:[],mainConversationLink:void 0,botConversationIndex:0,threadListStatus:{loading:!1,failed:!1,count:0,hasMore:!1,isReload:!1,nextIndex:"",initiated:!1},threadFeedStatus:{loading:!1,failed:!1,count:0,hasMore:!1,isReload:!1,nextIndex:"",initiated:!1},guestCanChat:!0,chatNotReachLimitMap:{},guestCanCreateThread:!1,guestReachCreateThreadLimit:!0,chatCreateInFirstTime:{},samanthaBot:{samanthaBotInfo:{},isLazyCreate:!1}},E=(...e)=>{const[t,s,E]=e,T=()=>{const{conversationLinks:e,botConversationIndex:t}=s();return e.slice(t)},R=()=>{const{conversationLinks:e,botConversationIndex:t}=s();return e.slice(0,t)},M=e=>{const{conversationLinks:i,botConversationIndex:n}=s(),o=e.length;t({conversationLinks:e.concat(i.slice(n)),botConversationIndex:o})},C=e=>{t({mainConversationLink:e})},I=(e,s=!0)=>{const i=A.Xy.get("chatBotService");s&&e.forEach((e=>{if(e.bot_id&&e.bot_disable_tag){var t,s;const n={bot_id:null==e?void 0:e.bot_id,id:null==e?void 0:e.bot_id,bot_type:null==e?void 0:e.bot_type,disabled_tag:null!==(t=null==e?void 0:e.bot_disable_tag)&&void 0!==t?t:"normal",creator_info:null!==(s=null==e?void 0:e.bot_creator_info)&&void 0!==s?s:{}};(null==i?void 0:i.getBot(e.bot_id))||null==i||i.updateBot(n)}})),t((t=>({conversationMap:e.reduce(((e,t)=>(t.conversation_id&&(e[t.conversation_id]=t),e)),(0,o.A)({},t.conversationMap)),lastMessageIndexMap:e.reduce(((e,t)=>(t.conversation_id&&(e[t.conversation_id]={message_index:Number(t.message_index)||0,read_message_index:Number(t.read_message_index)||0}),e)),(0,o.A)({},t.lastMessageIndexMap))})))},L=(e,{append:t=!0,ignoreOld:s=!1})=>{const i=R(),n=e.map((e=>{var t,s,i;return{threadId:null===(t=e.thread_id)||void 0===t?void 0:t.toString(),isLocalConversation:!1,conversationId:(null===(s=e.conversation)||void 0===s?void 0:s.conversation_id)||"",conversationType:null===(i=e.conversation)||void 0===i?void 0:i.conversation_type}})).filter((e=>!(0,l.A)(e.threadId))),o=s?[]:i,r=o.filter((e=>(0,S.fF)(e.threadId)));return v(t?[...r,...o,...n]:[...r,...n,...o])},x=(e,t)=>{e.conversationLinks.splice(t,1),t<e.botConversationIndex&&(e.botConversationIndex-=1)},U=(e,{conversationId:t,originConversationKey:s,index:i,threadId:n,pinOperation:o=!1,isLocalConversation:r=!1})=>{var a,l,c,d;const u=Boolean(n)||Boolean(null===(a=e.conversationLinks.find((e=>e.conversationId===t)))||void 0===a?void 0:a.threadId)||(0,k.aj)(e.conversationMap[t])||(0,k.if)(e.conversationMap[t]),h=u?R():T(),p=h.length;let g=-1,_=!1,m=r?null===(l=e.localConversationMap[t])||void 0===l?void 0:l.conversation_type:null===(c=e.conversationMap[t])||void 0===c?void 0:c.conversation_type,f=n,v=p,b=y.Cr.Conversation;if(h.forEach(((s,i)=>{let n=!1;var o,r,a,l;s.isLocalConversation?n=null!==(o=null===(r=e.localConversationMap[s.conversationId])||void 0===r?void 0:r.pinned)&&void 0!==o&&o:n=null!==(a=null===(l=e.conversationMap[s.conversationId])||void 0===l?void 0:l.pinned)&&void 0!==a&&a;s.conversationId===t&&(g=i,_=n,m=s.conversationType,f=s.threadId,s.isLocalConversation&&(b=y.Cr.LocalConversation)),n||v!==p||(v=i)})),!i)return;if(~g){const t=u?g:g+e.botConversationIndex;e.conversationLinks.splice(t,1),v=v>g?v-1:v,u&&(e.botConversationIndex-=1)}o?(v=_?v:0,b===y.Cr.Conversation?e.conversationMap[t]&&(e.conversationMap[t].pinned=!e.conversationMap[t].pinned):e.localConversationMap[t]&&(e.localConversationMap[t].pinned=!e.localConversationMap[t].pinned)):v=_?0:v;const S=u?v:v+e.botConversationIndex;e.conversationLinks.splice(S,0,{isLocalConversation:r,conversationId:t,originConversationKey:s,conversationType:m,threadId:null===(d=f)||void 0===d?void 0:d.toString()}),u&&(e.botConversationIndex+=1)};return(0,o.A)((0,o.A)((0,o.A)((0,o.A)({},z),(0,b.Y)(...e)),((e,t)=>({prevActiveConversationId:null,currentActiveConversationId:null,setActiveConversation:s=>{const{currentActiveConversationId:i}=t();e({prevActiveConversationId:i,currentActiveConversationId:s})}}))(...e)),{},{loadConversationList:(D=(0,n.A)((function*(e){let{type:t=[y.oA.Feed,y.oA.Thread,y.oA.Bot]}=e,n=(0,i.A)(e,w);const l=(0,a.A)(t),d=(0,p.XB)({eventName:"load_conversation_list",meta:{type:l.join(","),isRefresh:n.isRefresh,isReload:n.isReload,isInit:!n.isRefresh&&0===n.index,size:n.size,index:n.index}}),u=l.map((e=>{switch(e){case y.oA.Bot:return s().loadBotConversationList(n);case y.oA.Feed:return s().loadThreadFeed(n);case y.oA.Thread:return s().loadThreadList((0,o.A)((0,o.A)({},n),{},{index:void 0}));case y.oA.Guest:return s().loadGuestThreadFeed(n);default:return Promise.resolve([])}}));try{const e=yield Promise.all(u);return d.success(),(0,c.A)((0,r.A)(e),"conversation_id")}catch(h){throw h instanceof Error&&d.error({reason:`loadConversationList failed size:${n.size} index:${n.index} type:${l.join(",")}`,error:h}),h}})),function(e){return D.apply(this,arguments)}),loadBotConversationList:(G=(0,n.A)((function*({index:e,size:i,isReload:n,isRefresh:r}){const{conversationListStatus:a}=s(),l=(0,p.XB)({eventName:"load_bot_conversation_list",meta:{isRefresh:r,isReload:n,size:i,index:e,isInit:!a.initiated}}),c=T(),d=!r&&0===e;t({conversationListStatus:(0,o.A)((0,o.A)({},a),{},{loading:!0,isReload:Boolean(n)})});try{const{data:n}=yield(0,h.tHN)((()=>g.j.apiService.conversation.ConversationList({index:e,batch_size:i,conversation_types:[_.Cr.Bot]})),3,(e=>1e3*e));l.addDurationPoint("fetch_success");const{conversation_list:a=[],has_more:u}=n||{};I(a);const p=a.map((e=>({isLocalConversation:!1,conversationId:e.conversation_id||"",conversationType:null==e?void 0:e.conversation_type}))).filter(Boolean),m=d?[]:c,f=v(r?[...p,...c]:[...m,...p]);return(e=>{const{conversationLinks:i,botConversationIndex:n}=s();t({conversationLinks:i.slice(0,n).concat(e)})})(f),t((e=>({conversationListStatus:(0,o.A)((0,o.A)({loading:!1,failed:!1,count:f.length},r?{hasMore:e.conversationListStatus.hasMore}:{hasMore:u||!1}),{},{isReload:!1,initiated:!0})}))),l.success(),a}catch(u){throw t((e=>({conversationListStatus:(0,o.A)((0,o.A)({},e.conversationListStatus),{},{failed:!0,loading:!1})}))),u instanceof Error&&l.error({reason:`loadBotConversationList failed size:${i} index:${e}`,error:u}),u}})),function(e){return G.apply(this,arguments)}),loadThreadFeed:(P=(0,n.A)((function*({isReload:e,isRefresh:i=!1}={}){const{threadFeedStatus:n}=s(),r=(0,p.XB)({eventName:"load_thread_feed",meta:{isRefresh:i,isReload:e,isInit:!n.initiated}});t({threadFeedStatus:(0,o.A)((0,o.A)({},n),{},{loading:!0,isReload:Boolean(e)})});try{const{data:e}=yield(0,h.tHN)((()=>g.j.apiService.samantha.GetFeed()),3,(e=>1e3*e));r.addDurationPoint("fetch_success");const{threads:p,main_thread:m}=e||{},{thread_list:f=[],has_more:v,next_index:y}=p||{};var a,c,d,u,_;m&&C({conversationId:null!==(a=null===(c=m.conversation)||void 0===c?void 0:c.conversation_id)&&void 0!==a?a:"",conversationType:null===(d=m.conversation)||void 0===d?void 0:d.conversation_type,threadId:null!==(u=null===(_=m.thread_id)||void 0===_?void 0:_.toString())&&void 0!==u?u:"",isLocalConversation:!1});const b=[null==m?void 0:m.conversation].concat(f.map((e=>e.conversation))).filter((e=>!(0,l.A)(e)));I(b);const S=L(f,{append:!1,ignoreOld:!n.initiated&&!s().threadListStatus.initiated});return M(S),t((e=>{var t;return{threadFeedStatus:(0,o.A)((0,o.A)({loading:!1,failed:!1,count:S.length},i?{hasMore:e.threadFeedStatus.hasMore}:{hasMore:v||!1}),{},{isReload:!1,nextIndex:null!==(t=null==y?void 0:y.toString())&&void 0!==t?t:"",initiated:!0})}})),r.success(),b}catch(m){throw t((e=>({threadFeedStatus:(0,o.A)((0,o.A)({},e.threadFeedStatus),{},{failed:!0,loading:!1})}))),m instanceof Error&&r.error({reason:"loadThreadFeed failed",error:m}),m}})),function(){return P.apply(this,arguments)}),loadGuestThreadFeed:(q=(0,n.A)((function*({isReload:e,isRefresh:i=!1}={}){const{threadFeedStatus:n}=s(),r=A.Xy.get("chatBotService"),a=(0,p.XB)({eventName:"load_guest_thread_feed",meta:{isRefresh:i,isReload:e,isInit:!n.initiated}});t({threadFeedStatus:(0,o.A)((0,o.A)({},n),{},{loading:!0,isReload:Boolean(e)})});try{const{data:e}=yield(0,h.tHN)((()=>g.j.apiService.samantha.GetTouristFeed()),3,(e=>1e3*e));a.addDurationPoint("fetch_success");const{samantha_bot:v,main_thread:y,threads:b,can_create_thread:k}=null!=e?e:{},{thread_list:A=[],has_more:w,next_index:z}=b||{};if(y){var c,d,u,_,f;C({conversationId:null!==(c=null===(d=y.conversation)||void 0===d?void 0:d.conversation_id)&&void 0!==c?c:"",conversationType:null===(u=y.conversation)||void 0===u?void 0:u.conversation_type,threadId:null!==(_=null===(f=y.thread_id)||void 0===f?void 0:f.toString())&&void 0!==_?_:"",isLocalConversation:!1})}else{const e=(0,p.XB)({eventName:"create_main_conversation",meta:{from:"header"}}),t=m.Cr.CocoWeb,i=s().mainConversationLink,n=s().addNewLocalConversation({reportEvent:e,conversation:{bot_id:null==v?void 0:v.bot_id,conversation_type:t},conversationId:null!=i&&i.isLocalConversation?null==i?void 0:i.conversationId:void 0});null!=v&&v.bot_id&&(null==r||r.setLocalConversationIdForBot({botId:v.bot_id,localConversationId:n})),C({conversationId:n,conversationType:t,threadId:(0,S.l7)(n,"FirstEnter","main"),isLocalConversation:!0})}const E=[null==y?void 0:y.conversation].concat(A.map((e=>e.conversation))).filter((e=>!(0,l.A)(e)));I(E);const T=L(A,{append:!1,ignoreOld:!n.initiated});return M(T),t((e=>{var t,s;return{threadFeedStatus:(0,o.A)((0,o.A)({loading:!1,failed:!1,count:T.length},i?{hasMore:e.threadFeedStatus.hasMore}:{hasMore:w||!1}),{},{isReload:!1,nextIndex:null!==(t=null==z?void 0:z.toString())&&void 0!==t?t:"",initiated:!0}),chatNotReachLimitMap:(0,o.A)((0,o.A)((0,o.A)({},e.chatNotReachLimitMap),null!=y&&null!==(s=y.conversation)&&void 0!==s&&s.conversation_id?{[y.conversation.conversation_id]:Boolean(y.can_chat)}:{}),A.reduce(((e,t)=>{var s;const{conversation_id:i}=null!==(s=t.conversation)&&void 0!==s?s:{};return i&&(e[i]=Boolean(t.can_chat)),e}),{})),guestReachCreateThreadLimit:Boolean(!k),samanthaBot:{samanthaBotInfo:null!=v?v:{},isLazyCreate:null==y||!y.conversation}}})),a.success(),E}catch(v){throw t((e=>({threadFeedStatus:(0,o.A)((0,o.A)({},e.threadFeedStatus),{},{failed:!0,loading:!1})}))),v instanceof Error&&a.error({reason:"loadThreadFeed failed",error:v}),v}})),function(){return q.apply(this,arguments)}),loadThreadList:(O=(0,n.A)((function*({index:e,size:i,isReload:n,isRefresh:r=!1}={}){const{threadListStatus:a}=s(),c=(0,p.XB)({eventName:"load_thread_list",meta:{isRefresh:r,isReload:n,size:i,index:e,isInit:!a.initiated}});t({threadListStatus:(0,o.A)((0,o.A)({},a),{},{loading:!0,isReload:Boolean(n)})});try{const{data:s}=yield(0,h.tHN)((()=>g.j.apiService.samantha.ThreadList({index:e&&(0,h.kf$)(e)?Number(e):void 0,batch_size:i})),3,(e=>1e3*e));c.addDurationPoint("fetch_success");const{thread_list:n=[],has_more:a,next_index:d}=s||{},u=n.map((e=>e.conversation)).filter((e=>!(0,l.A)(e)));I(u);const p=L(n,{append:!r});return M(p),t((e=>{var t;return{threadListStatus:(0,o.A)((0,o.A)({loading:!1,failed:!1,count:p.length},r?{hasMore:e.threadListStatus.hasMore}:{hasMore:a||!1}),{},{isReload:!1,nextIndex:null!==(t=null==d?void 0:d.toString())&&void 0!==t?t:"",initiated:!0})}})),c.success(),u}catch(d){throw t((e=>({threadListStatus:(0,o.A)((0,o.A)({},e.threadListStatus),{},{failed:!0,loading:!1})}))),d instanceof Error&&c.error({reason:`loadThreadList failed size:${i} index:${e}`,error:d}),d}})),function(){return O.apply(this,arguments)}),addNewLocalConversation:({reportEvent:e,conversation:s,conversationId:i}={})=>{const n=i||(()=>{var e;if("undefined"==typeof window||null===(e=window)||void 0===e||null===(e=e.crypto)||void 0===e||!e.getRandomValues)return String(Math.random()*Math.pow(10,16)).slice(0,16);try{return window.crypto.getRandomValues(new Uint8Array(16)).toString().replaceAll(",","").slice(0,16)}catch(t){return String(Math.random()*Math.pow(10,16)).slice(0,16)}})();return t((0,u.jM)((t=>{t.localConversationMap[n]=(0,o.A)({local:{createStatus:y.Et.Pending,reportEvent:e}},s)}))),n},updateLocalConversation:(e,s,i=!1)=>{t((0,u.jM)((t=>{if(i&&null!=s&&s.conversation_id)return t.localConversationMap[s.conversation_id]=(0,o.A)({},s),void delete t.localConversationMap[e];const n=t.localConversationMap[e]||{};Object.assign(n,s)})))},updateConversationIdInLinks:(e,s)=>{t((0,u.jM)((t=>{const i=t.conversationLinks.findIndex((t=>t.conversationId===e)),n=(0,o.A)((0,o.A)({},t.conversationLinks[i]),{},{conversationId:s,isLocalConversation:!1});t.conversationLinks[i]=n})))},fetchConversationAndUpdateLocalStatus:(B=(0,n.A)((function*({token:e,botId:t,conversationId:i,localConversationId:n,messageId:o,scene:r=f.Default,createFrom:a}){const l=s().localConversationMap[n];if(null==l||!l.local)return;const{local:{reportEvent:c}}=l;try{var u;let l;var h;if(s().updateLocalConversation(n,{local:{createStatus:y.Et.Creating,createFrom:a}}),e)l=null===(h=yield g.j.apiService.conversation.ConversationInfoAddBot({token:e}))||void 0===h?void 0:h.data;else if(t){var p;l=null===(p=yield g.j.apiService.conversation.ConversationInfo({bot_id:t}))||void 0===p?void 0:p.data}else if(i){var _;l=null===(_=yield g.j.apiService.conversation.CreateSubConversation({conversation_id:i,message_id:o,scene:r}))||void 0===_?void 0:_.data}const m=null===(u=l)||void 0===u||null===(u=u.conversation)||void 0===u?void 0:u.conversation_id;if(!m||!l)throw new Error("Expect newConversationId, but not found");if(s().updateConversationInfo(l),s().updateLocalConversation(n,{local:{createStatus:y.Et.Done,newConversationId:m,createFrom:a}}),s().conversationListStatus.loading){const e=E.subscribe((e=>({conversationListStatus:e.conversationListStatus})),(({conversationListStatus:t})=>{t.loading||(null==e||e(),s().insertConversationToLinks({conversationId:m,index:1}))}),{fireImmediately:!0,equalityFn:d.x})}else s().insertConversationToLinks({conversationId:m,index:1});return null==c||c.addDurationPoint("success"),null==c||c.success(),l.conversation}catch(m){throw s().updateLocalConversation(n,{local:{createStatus:y.Et.Failed}}),m instanceof Error&&(null==c||c.error({error:m,reason:"create_conversation_error"})),m}})),function(e){return B.apply(this,arguments)}),removeConversationFromLinks:({conversationId:e})=>{const i=s().conversationLinks.findIndex((t=>t.conversationId===e));~i&&t((0,u.jM)((e=>x(e,i))))},removeConversationsFromLinks:({conversationIds:e=[]})=>{t((0,u.jM)((t=>{let s=!1,{botConversationIndex:i}=t;const n=t.conversationLinks.filter(((n,o)=>{const r=e.includes(n.conversationId);return r&&(s=!0,o<t.botConversationIndex&&(i-=1)),!r}));s&&(t.conversationLinks=n,t.botConversationIndex=i)})))},insertConversationToLinks:e=>{t((0,u.jM)((t=>U(t,e))))},insertNewConversationAndRemoveOldConversationFromLinks:(e,s)=>{t((0,u.jM)((t=>{U(t,e);const i=t.conversationLinks.findIndex((e=>e.conversationId===s.conversationId));~i&&x(t,i)})))},setGuestCanChat:e=>{t({guestCanChat:e})},setNotReachLimitMap:e=>{t((t=>({chatNotReachLimitMap:(0,o.A)((0,o.A)({},t.chatNotReachLimitMap),e)})))},setGuestCanCreateThread:e=>{t({guestCanCreateThread:e})},setGuestReachCreateThreadLimit:e=>{t({guestReachCreateThreadLimit:e})},updateMainConvLink:({conversation:e={},threadId:t="",isLocalConversation:s=!1})=>{const i=(0,p.XB)({eventName:"update_main_convLink"});try{var n,o;if(!e||!t)throw new Error("getMainConversationInfo: invalid data from api");if(C({conversationId:null!==(n=null==e?void 0:e.conversation_id)&&void 0!==n?n:"",conversationType:null==e?void 0:e.conversation_type,threadId:null!==(o=null==t?void 0:t.toString())&&void 0!==o?o:"",isLocalConversation:s}),!s){const t=[e].filter((e=>!(0,l.A)(e)));I(t)}i.success()}catch(r){throw r instanceof Error&&i.error({reason:"getMainConversationInfo failed",error:r}),r}},updateChatCreateInFirstTime:({conversationId:e="",status:s=!1})=>{t((0,u.jM)((t=>{t.chatCreateInFirstTime[e]=s})))}});var B,O,q,P,G,D}},64817:(e,t,s)=>{s.d(t,{Y:()=>u,w:()=>d});var i=s(14065),n=s(44557),o=s(98502),r=s(67697),a=s(69232);function l(e,t){e.conversationMap[t]&&delete e.conversationMap[t],e.lastMessageIndexMap[t]&&delete e.lastMessageIndexMap[t]}var c=s(56356);const d={conversationMap:{},localConversationMap:{},lastSectionIdMap:{},lastMessageIndexMap:{},actionBarTemplateMap:{}},u=(e,t,s)=>{return(0,n.A)((0,n.A)({},d),{},{fetchUpdateConversationInfo:(h=(0,i.A)((function*(e){var s;const{prevActiveConversationId:i}=t(),n=(0,r.XB)({eventName:"load_conversation_info",meta:{cold_start:!i}});if(null!==(s=t().localConversationMap[e])&&void 0!==s&&s.local)n.error({reason:"local_conversation_id",error:Error("local_conversation_id")});else try{const s=yield a.j.apiService.conversation.ConversationInfo({conversation_id:e,ext:i?void 0:{cold_start:"true"}}),{data:o}=s,{conversation:r}=o||{};if(!o)throw new Error("updateConversationInfo: invalid data from api");return n.addDurationPoint("success"),n.success(),t().updateConversationInfo(o),r}catch(o){throw n.error({reason:"load_conversation_info_failed",error:o}),o}})),function(e){return h.apply(this,arguments)}),updateConversationInfo:t=>{const s=c.Xy.get("chatBotService"),{conversation:i,bot_info:a,msg_templates:l,trace_map:d}=t,{conversation_id:u}=i||{};u&&i&&a?e((0,o.jM)((e=>{e.conversationMap[u]=i;(null==a?void 0:a.id)&&(null==s||s.updateBot(a)),i.last_section_id&&(e.lastSectionIdMap[u]=i.last_section_id),l&&(e.actionBarTemplateMap[u]=l.map((e=>(0,n.A)((0,n.A)({},e),{},{req_id:null==d?void 0:d.request_id})))),e.lastMessageIndexMap[u]={message_index:Number(i.message_index)||0,read_message_index:Number(i.read_message_index)||0}}))):r.vF.persist.warning({message:"invalid conversationInfo to update",meta:{conversationInfo:t}})},updateLastSectionId:(t,s)=>{e((0,o.jM)((e=>{s&&(e.lastSectionIdMap[t]=s)})))},clearContext:(u=(0,i.A)((function*(e){var s;const i=yield a.j.apiService.conversation.CreateSection({conversation_id:e}),n=null==i||null===(s=i.data)||void 0===s?void 0:s.section_id;n&&t().updateLastSectionId(e,n)})),function(e){return u.apply(this,arguments)}),updateConversationMessageIndex({conversationId:t,messageIndex:s,readMessageIndex:i}){e((0,o.jM)((e=>{const n=e.lastMessageIndexMap[t];n&&s&&Number(n.message_index)<s&&(n.message_index=s),n&&i&&Number(n.read_message_index)<i&&(n.read_message_index=i)})))},removeConversationFromMap:({conversationId:t})=>{e((0,o.jM)((e=>{l(e,t)})))},removeConversationsFromMap:({conversationIds:t})=>{e((0,o.jM)((e=>{t.forEach((t=>{l(e,t)}))})))}});var u,h}},53065:(e,t,s)=>{s.d(t,{Cr:()=>n,Et:()=>i,oA:()=>o});let i=function(e){return e.Pending="Pending",e.Creating="Creating",e.Done="Done",e.Failed="Failed",e}({}),n=function(e){return e.LocalConversation="LocalConversation",e.Conversation="Conversation",e}({}),o=function(e){return e.Bot="bot",e.Feed="feed",e.Thread="thread",e.Guest="guest",e}({})},29581:(e,t,s)=>{s.d(t,{Eh:()=>T,pU:()=>E});var i=s(44557),n=s(34870),o=s(45498),r=s(28171),a=s(67697),l=s(14065),c=s(85886),d=s(50474),u=s.n(d);const h=()=>{const e="undefined"==typeof window?{getItem:()=>Promise.resolve(null),setItem:()=>Promise.resolve(null),removeItem:()=>Promise.resolve(null)}:u().createInstance({name:"samantha-web",storeName:"store"});var t,s,i;return{getItem:(i=(0,l.A)((function*(t){return new Promise(((s,i)=>{var n;null===(n=e.getItem(t))||void 0===n||n.then((e=>{s(e)})).catch((e=>{i(e)})),setTimeout((()=>{i(new Error(`getItem ${t} timeout, timeout after 10000ms`))}),1e4)}))})),function(e){return i.apply(this,arguments)}),setItem:(s=(0,l.A)((function*(t,s){yield e.setItem(t,s)})),function(e,t){return s.apply(this,arguments)}),removeItem:(t=(0,l.A)((function*(t){yield e.removeItem(t)})),function(e){return t.apply(this,arguments)})}},p=e=>{const t=e();if(t){const{getItem:e,setItem:s,removeItem:i}=t;t.setItem=(0,c.A)(g(s,"setItem"),1e3),t.getItem=g(e,"getItem"),t.removeItem=g(i,"removeItem")}return t},g=(e,t)=>(0,l.A)((function*(...s){try{return yield e(...s)}catch(r){if(r instanceof Error){var i,n,o;const{usage:e=0,quota:s=0}=null!==(i=yield null===(n=navigator)||void 0===n||null===(n=n.storage)||void 0===n||null===(o=n.estimate)||void 0===o?void 0:o.call(n))&&void 0!==i?i:{usage:0,quota:0};a.vF.persist.error({message:`[feed-core]persist storage action error: ${t} failed`,error:r,meta:{usageSpace:e/1024/1024+" MB",quotaSpace:s/1024/1024+" MB"}})}}}));var _=s(21511),m=s(8755),f=s(37156);const v=((e={})=>t=>{const{getExtraConversationIds:s}=e;try{var i;const e=(0,m.oR)((0,f.qk)(t)).filter((e=>!e.isLocalConversation)).slice(0,5),n=(0,m.Vs)((0,f.SE)(t)).slice(0,5),o=(0,f.mV)(t),r=null!=o&&o.isLocalConversation?void 0:o,a=e.length,l=e.concat(n),c=(0,_.A)(l.map((e=>e.conversationId)).concat(null!==(i=null==s?void 0:s())&&void 0!==i?i:[])),d={},u={};return c.forEach((e=>{d[e]=t.conversationMap[e],u[e]=t.lastMessageIndexMap[e]})),{mainConversationLink:r,conversationLinks:l,botConversationIndex:a,conversationMap:d,lastSectionIdMap:t.lastSectionIdMap,lastMessageIndexMap:u,actionBarTemplateMap:t.actionBarTemplateMap}}catch(n){return a.vF.persist.error({message:"[@feed-core-store] persist state limit error",error:n instanceof Error?n:new Error(String(n))}),{}}})();var y=s(85371),b=s(92431),S=s(64817),k=s(63101);const A=(e,t)=>{try{const s=(0,y.A)(e)?(0,i.A)((0,i.A)({},k.gk),S.w):e;return(0,i.A)((0,i.A)({},(0,b.A)(t)),s)}catch(s){s instanceof Error&&a.vF.persist.error({message:"[@samantha-feed-core], persist merge error",error:s})}return t},w=e=>{var t,s;return{name:`${e.prefix}-chat-feed-store`,storage:p((()=>{var t;return null!==(t=e.storage)&&void 0!==t?t:h()})),partialize:null!==(t=e.partialize)&&void 0!==t?t:v,version:1.5,merge:null!==(s=e.merge)&&void 0!==s?s:A,onRehydrateStorage:e=>{const t=a.vF.createLoggerWith({ctx:{namespace:"persist"}});return t.info({message:"hydration started",meta:"undefined"!=typeof window?{state:e}:{}}),(e,s)=>{s?t.persist.error({message:"hydration error",error:s instanceof Error?s:new Error(String(s))}):(t.info({message:"hydration finished",meta:"undefined"!=typeof window?{state:e}:{}}),(0,r.SR)().addDurationPoint("chat_store_hydrate_finish"))}}}};const z=e=>{const{prefix:t,storage:s,isEnableDebug:i,merge:r,partialize:a,reduxDevToolsSnapshot:l}=e,c=w({prefix:t,storage:s,merge:r,partialize:a}),d=(0,n.Zr)((0,n.eh)(k.Gw),c);return i&&l?(0,o.vt)()((0,n.lt)(d,{name:`${t}-chat-feed-store`})):(0,o.vt)()(d)};const E=function e(...t){const{_useFeedStore:s}=e.prototype;if(s)return s(...t);throw Error("useFeedStore is not initialized")};function T(e){const{_useFeedStore:t}=E.prototype||{};if(!t){const t=z((0,i.A)({},e));Object.setPrototypeOf(E.prototype,t),Object.defineProperties(E,(0,i.A)({},Object.getOwnPropertyDescriptors(t))),E.prototype._useFeedStore=t}(0,r.Il)(e)}},37156:(e,t,s)=>{s.d(t,{Gl:()=>r,SE:()=>i,VN:()=>a,mV:()=>n,qk:()=>o});const i=e=>({conversationLinks:e.conversationLinks,botConversationIndex:e.botConversationIndex,conversationListStatus:e.conversationListStatus,loadBotConversationList:e.loadBotConversationList}),n=e=>e.mainConversationLink,o=e=>({conversationLinks:e.conversationLinks,botConversationIndex:e.botConversationIndex,threadListStatus:e.threadListStatus,threadFeedStatus:e.threadFeedStatus,loadThreadList:e.loadThreadList,loadThreadFeed:e.loadThreadFeed}),r=(e,t)=>t?e.localConversationMap[t]:void 0,a=(e,t)=>t?e.conversationMap[t]:void 0},27970:(e,t,s)=>{s.d(t,{Rx:()=>n,Xc:()=>r,tY:()=>o});var i=s(56356);const n=(e,t,s=!1)=>{if(!t)return;const{conversation_type:i}=e.conversationMap[t]||{};if(i||!s)return i;const{conversation_type:n}=e.localConversationMap[t]||{};return t?n:void 0},o=(e,t)=>{if(!t)return{};const s=i.Xy.get("chatBotService"),n=e.conversationMap[t];return{conversation:n,botInfo:null!=n&&n.bot_id?null==s?void 0:s.getBot(null==n?void 0:n.bot_id):{}}},r=(e,t,s)=>{const{botInfo:n,conversation:r}=o(e,t),a=i.Xy.get("chatBotService"),l=(null==n?void 0:n.id)||(null==n?void 0:n.bot_id)||(null==r?void 0:r.bot_id);return l||!s?l:t?null==a?void 0:a.getBotIdFromLocalConversation(t):void 0}},8755:(e,t,s)=>{s.d(t,{Vs:()=>n,fF:()=>r,l7:()=>o,oR:()=>i});function i({conversationLinks:e,botConversationIndex:t}){return e.slice(0,t)}function n({conversationLinks:e,botConversationIndex:t}){return e.slice(t)}const o=(e,t,s="sub")=>`${"sub"===s?"localThread_":"localMainThread_"}${t||""}_${e}`,r=(e,t,s="sub")=>{var i;const n="sub"===s?"localThread_":"localMainThread_";var o;return t?null==e||null===(i=e.startsWith)||void 0===i?void 0:i.call(e,`${n}${t}_`):null==e||null===(o=e.startsWith)||void 0===o?void 0:o.call(e,n)}},13832:(e,t,s)=>{s.d(t,{R:()=>m});var i=s(67697),n=s(44644),o=s(64080),r=s(99964),a=s(40257),l=s(61577);const c=()=>{let e,t;return{promise:new Promise(((s,i)=>{e=s,t=i})),resolve:e,reject:t}},d=e=>!!e.local_message_id,u=e=>!!e.local_conversation_id||!!e.conversation_id,h=e=>(t,s,n)=>new Promise(((o,l)=>{const u=r.ozw.getState();if(!t.every(d))return i.vF.info("local_message_id is empty, skip to send message"),o("skip");if(!t.every(u.hasSendMessageTask))return i.vF.info("task is empty, skip to send message"),o("skip");if(t.some(u.isSendMessageExpired))return o("skip");null==e||e(t,s);const h=t.map(c);t.forEach(((e,t)=>u.updateSendMessageTaskFinishFn(e,h[t].resolve)));const p=setTimeout((()=>l(new Error("timeout"))),n||a.Sf),g=h.map((e=>e.promise));Promise.all(g).then((()=>{o("finish"),clearTimeout(p)}))})),p=h(((e,t)=>{var s;t===o.B.Message&&(null===(s=l.Pv.getSocketAdapter())||void 0===s||s.sendMessage(e))})),g=h(((e,t)=>{var s;t===o.B.Message&&(null===(s=l.Pv.getHttpAdapter())||void 0===s||s.sendMessage(e))})),_=(e,t)=>{const s=t||e,i=(t,n,o)=>e(t,n,o).catch((e=>s(t,n,o).catch((e=>i(t,n,o)))));return i},m=({messages:e,customSendWaitTimeout:t,protocolType:s})=>((e,t,s,n)=>{const o=r.ozw.getState();return e.every(d)?e.every(u)?(e.forEach((e=>o.finishSendMessageTask(e.local_message_id))),e.forEach(o.addSendMessageTask),s(e,t,n)):(i.vF.info("local_conversation_id or conversation_id is empty, skip sending message"),Promise.resolve()):(i.vF.info("local_message_id is empty, skip sending message"),Promise.resolve())})(e,o.B.Message,((e,t,i)=>{const o=(e=>e.some((e=>{var t,s;return n.Asr.length(`${(null==e?void 0:e.content)||""}${(null==e||null===(t=e.ext)||void 0===t?void 0:t.browser_explain)||""}${(null==e||null===(s=e.ext)||void 0===s?void 0:s.samantha_context)||""}`)>a.dO})))(e)||"http"===s,r="socket"===s;let l;return l=o?_(g):r?_(p):_(p,g),l(e,t,i)}),t)},79859:(e,t,s)=>{s.d(t,{P:()=>w});var i=s(44557),n=s(53719),o=s(72106),r=s(85371),a=s(92431),l=s(67697),c=s(92792),d=s(52704),u=s(40257),h=s(2814),p=s(63399),g=s(92882),_=s(53854),m=s(95544),f=s(30025),v=s(27970),y=s(29581),b=s(29084),S=s(81793),k=s(62396),A=s(61577);const w=(e,t)=>{const s=e.getState(),{conversation_id:w,message_id:z,reply_id:E=""}=t,T=(0,v.Rx)(y.pU.getState(),w),R=(0,g.M5)(t),M=(0,g.oS)(t),C=(0,g.HN)(t),I=(0,g.KU)(t),L=(0,g.RR)(t),x=(0,g.oQ)(t),U=(0,g.w5)(t),B=(0,g.Et)(t),O=S.gO.get("chatTeaService"),q=L?u.sq:E;let P=!1;if(s.updateMessageList({conversationId:w,immerUpdate:(...e)=>{const[h]=e;(0,d._V)(h,t)&&l.vF.persist.warning({message:"receive message failed",meta:{message:t}});const{draftLocalMessageMap:m,draftMessageMap:S,draftMessageLinks:I,draftRegenerateMessageMap:L}=h,G=Boolean(S[z]),D=(0,g.um)(q),N=m[D];let j=m[z];if(!G&&!j&&!N){var F,V;const s=(0,f.hT)(h);(0,c.eT)({isRegenerate:x,regenHead:null==s||null===(F=s[0])||void 0===F?void 0:F.regen_head,immerUpdateMessage:e,newLocalMessageId:z,conversationId:w,replyId:E,message:t,scene:"",sectionId:t.section_id,localMessageStatus:_.FQ.ReceivingStream,createdFrom:"message",conversationType:T}),(0,c.dk)({isRegenerate:x,immerUpdateMessage:e,newLocalMessageId:z,regenHead:null==s||null===(V=s[0])||void 0===V?void 0:V.regen_head}),j=m[z],P=!0}if(N){(0,g.Wi)(N)&&(P=!0);const s=(0,f.iv)(h,{isLocalMessage:!0,messageId:D});if(-1!==s){var H,K;const n=I.splice(s,1),o=B?{messageKey:null==n?void 0:n[0].messageKey}:{};(0,c.eT)({isRegenerate:x,regenHead:null==n||null===(H=n[0])||void 0===H?void 0:H.regen_head,immerUpdateMessage:e,newLocalMessageId:z,conversationId:w,replyId:E,message:t,scene:"",sectionId:t.section_id,localMessageStatus:_.FQ.ReceivingStream,createdFrom:"replace_temporary_message",conversationType:T}),(0,c.dk)((0,i.A)({isRegenerate:x,immerUpdateMessage:e,newLocalMessageId:z,regenHead:null==n||null===(K=n[0])||void 0===K?void 0:K.regen_head},o))}j=m[z]}if(!G&&j){const e=(0,i.A)((0,i.A)((0,i.A)({},s.getReportEvents(w,D||"")),s.getReportEvents(w,j.local_message_id||"")),s.getReportEvents(w,j.reply_id||"")),d=e.receive_message,S=(0,c.BX)(t,j);if(P){var W,J,$,Q,X,Y,Z,ee,te;if(C){const t={reason:"first-pkg-error",meta:(0,i.A)((0,i.A)({},S),{},{is_include_suggests:!1})};p.C.error(e,t)}else{var se,ie,ne;p.C.addDuration(e,"first"),null==O||O.trackEvent("receive_answer",{duration:null==d||null===(se=d.getDuration())||void 0===se?void 0:se.first,from:null===(ie=t.localInfo)||void 0===ie?void 0:ie.from,next_connection_type:t.next_connection_type,content_type:t.content_type,success:1,conversation_id:w,bot_id:(0,v.Xc)(y.pU.getState(),w),message_id:z,section_id:null==t?void 0:t.section_id,scene:null==d?void 0:d.getMeta().scene,message_type:(0,g.rJ)(t),is_cache:"1"===String(null==t||null===(ne=t.ext)||void 0===ne?void 0:ne.is_from_cache)?1:0})}null==O||O.trackEvent("message_receive_first_package",{conversation_id:w,status:C?1:0,error_code:null==S?void 0:S.has_err,duration:null==d||null===(W=d.getDuration())||void 0===W?void 0:W.first,retried:null!=t&&null!==(J=t.localInfo)&&void 0!==J&&J.retried?1:0,message_id:z,from:null===($=t.localInfo)||void 0===$?void 0:$.from,next_connection_type:t.next_connection_type,content_type:null==t?void 0:t.content_type,skill_id:null===(Q=(0,k.O)(null==t||null===(X=t.ext)||void 0===X?void 0:X.input_skill))||void 0===Q?void 0:Q.skill_id}),null==O||O.trackEvent("message_answer_start",{stream:1,from:null===(Y=t.localInfo)||void 0===Y?void 0:Y.from,next_connection_type:t.next_connection_type,retried:null!=t&&null!==(Z=t.localInfo)&&void 0!==Z&&Z.retried?1:0,content_type:t.content_type,section_id:null==t?void 0:t.section_id,reply_id:E,conversation_id:w,skill_id:null===(ee=(0,k.O)(null==t||null===(te=t.ext)||void 0===te?void 0:te.input_skill))||void 0===ee?void 0:ee.skill_id})}else if(C){const t={reason:R?"stream-error":"error",meta:(0,i.A)((0,i.A)({},S),{},{is_include_suggests:!1})};p.C.error(e,t)}if((0,A.up)(j,t))return;var oe,re,ae;if((0,c.Dj)(j,t))p.C.addDuration(e,"receive_first_chunk_packet"),null==O||O.trackEvent("receive_first_chunk_packet",{conversation_id:w,status:C?1:0,error_code:null==S?void 0:S.has_err,duration:null==d||null===(oe=d.getDuration())||void 0===oe?void 0:oe.receive_first_chunk_packet,message_id:z,retried:null==t||null===(re=t.localInfo)||void 0===re?void 0:re.retried,from:null===(ae=t.localInfo)||void 0===ae?void 0:ae.from,next_connection_type:t.next_connection_type,content_type:null==t?void 0:t.content_type});if(m[z]=(0,i.A)((0,i.A)((0,i.A)({},j),{},{local:(0,i.A)((0,i.A)({},j.local),{},{status:_.FQ.ReceivingStream,failed:!1,failedExpired:M||C?void 0:Date.now()+u.F6})},(0,o.A)(t,r.A)),{},{local_message_id:j.local_message_id}),M){var le,ce,de,ue,he,pe,ge,_e,me,fe;if(l.vF.info({namespace:null===(le=t.localInfo)||void 0===le?void 0:le.from,message:"replaceLocalMessageByRemote",meta:S}),(0,f.sK)({draft:h,localMessage:j,message:t,useRemoteMessageKey:!B,useOriginalMessageKey:!!B}),j.local.isRegenerate){const e=(0,a.A)(t);e.ext&&(e.ext.regen="1"),e.ext&&(e.ext.regen_active="1"),L.messageMap=(0,i.A)((0,i.A)({},L.messageMap),{},{[z]:e})}if((0,f.ZH)({draft:h,localMessage:j,message:t,omitReportEventProperty:["receive_message","receive_message_package"]}),q)null===(fe=A.Pv.getHttpAdapter())||void 0===fe||fe.abortMessage({replyId:q});p.C.addDuration(e,"success"),p.C.success((0,n.A)(e,["receive_message","receive_message_package"]),{meta:S});const s=e.receive_message;null==O||O.trackEvent("receive_stream",(0,i.A)({duration:null==s||null===(ce=s.getDuration())||void 0===ce?void 0:ce.success,from:null===(de=t.localInfo)||void 0===de?void 0:de.from,next_connection_type:t.next_connection_type,content_type:t.content_type,success:1,conversation_id:w,bot_id:(0,v.Xc)(y.pU.getState(),w),message_id:z,reply_id:q,section_id:null==t?void 0:t.section_id,scene:null==s?void 0:s.getMeta().scene,is_onboarding:(0,g.RR)(t)?1:0,is_soft_link:(0,g.i0)(t),message_type:(0,g.rJ)(t),is_cache:"1"===String(null==t||null===(ue=t.ext)||void 0===ue?void 0:ue.is_from_cache)?1:0},(0,b.EO)(t))),null==O||O.trackEvent("message_answer_end",{type:t.message_type,from:null===(he=t.localInfo)||void 0===he?void 0:he.from,next_connection_type:t.next_connection_type,content_type:t.content_type,success:1,stream:1,section_id:null==t?void 0:t.section_id,result:void 0,reply_id:E,message_id:z,retried:null!=t&&null!==(pe=t.localInfo)&&void 0!==pe&&pe.retried?1:0,duration:null==s||null===(ge=s.getDuration())||void 0===ge?void 0:ge.success,conversation_id:w,skill_id:null===(_e=(0,k.O)(null===(me=t.ext)||void 0===me?void 0:me.input_skill))||void 0===_e?void 0:_e.skill_id})}if(U){var ve,ye,be,Se;const{receive_total_messages:s}=e;null==O||O.trackEvent("message_total_answers_end",{type:t.message_type,content_type:t.content_type,success:1,section_id:null==t?void 0:t.section_id,reply_id:E,duration:null==s||null===(ve=s.getDuration())||void 0===ve?void 0:ve.success,conversation_id:w,skill_id:null===(ye=(0,k.O)(null===(be=t.ext)||void 0===be?void 0:be.input_skill))||void 0===ye?void 0:ye.skill_id,is_include_suggest:0,retried:null!=t&&null!==(Se=t.localInfo)&&void 0!==Se&&Se.retried?1:0}),p.C.success(e,(0,i.A)({is_include_suggest:!1},S))}}else{var ke;if(P=!G,S[z]=t,G||I.push({isLocalMessage:!1,messageId:z}),M)l.vF.persist.info({namespace:null===(ke=t.localInfo)||void 0===ke?void 0:ke.from,message:"Receive Non-local Finished Message",meta:{message_id:z,conversation_id:w,is_exist:G}})}}}),t.section_id&&P&&!I){const s=L?void 0:(0,m.tP)(e.getState(),w,{isLocalMessage:!1,messageId:q});(null==s?void 0:s.section_id)!==t.section_id&&y.pU.getState().updateLastSectionId(w,t.section_id)}const G=(0,g.Wp)(t);if(M&&G&&t.reply_id){if(!s.hasReportEvent(w,t.reply_id,"message_receive_suggests")){const e=(0,l.XB)({eventName:"message_receive_suggests",meta:{message_id:t.message_id,reply_id:t.reply_id,conversation_type:T}});e.errorIfIdle(u.so,{reason:"timeout"}),s.mergeReportEvents(w,t.reply_id,{message_receive_suggests:e})}s.updateSuggestMessage(w,(()=>({replyId:E,loading:!0,failed:!1,expired:Date.now()+u.so,suggests:[]})))}M&&(0,g.pu)(t)&&s.updateSearchResultStatus(q,!0),h.B.emit("message.updated",t),C&&h.B.emit("message.serverError",t)}},54767:(e,t,s)=>{s.d(t,{B:()=>i});const i=(e,t)=>{var s,i,n,o,r,a;return{conversation_id:e.conversation_id,message_id:e.message_id,from:null===(s=e.localInfo)||void 0===s?void 0:s.from,local_message_id:null==t?void 0:t.local_message_id,is_regenerate:null==t?void 0:t.local.isRegenerate,has_err:null==e||null===(i=e.ext)||void 0===i?void 0:i.has_err,log_id:null===(n=e.localInfo)||void 0===n?void 0:n.logId,inner_log_id:null==e||null===(o=e.ext)||void 0===o?void 0:o.log_id,trace_id:null===(r=e.localInfo)||void 0===r?void 0:r.traceId,retried:null==e||null===(a=e.localInfo)||void 0===a?void 0:a.retried,next_connection_type:null==e?void 0:e.next_connection_type,content_type:String(e.content_type)}}},89910:(e,t,s)=>{s.d(t,{QO:()=>A,Xv:()=>S,t:()=>k});var i=s(44557),n=s(62396),o=s(74848),r=s(67697),a=s(52216),l=s(35841),c=s(17458),d=s(84013),u=s(93207),h=s(27970),p=s(29581),g=s(36540),_=s(35485),m=s(60483),f=s(81793),v=s(6839),y=s(26334),b=s(36352);const S=e=>e.presetPromptType?{used_prompt:1,prompt_type:"default_prompt",default_prompt_type:e.presetPromptType}:{used_prompt:0,prompt_type:"customized_prompt"},k=e=>{try{if((0,u.Bu)(e)&&e.nestedItems.length>=0){const t=e.nestedItems,s=t.map((e=>e.fileKey)),i=t.map((e=>(0,o.ti)((0,o.GO)(e.fileName)))),r=t.map((e=>e.size||0));return{upload_id:e.preGeneratedlocalMessageId,upload_file_size:r.reduce(((e,t)=>e+t),0),is_upload_file:1,upload_file_type:1===i.length?i[0]:(0,n.e)(i),collection_id:1===s.length?s[0]:(0,n.e)(s),upload_collection_way:0===t.length?void 0:1===t.length?"single":"multi",upload_from:e.uploadFrom}}if((0,u.kk)(e)||(0,u.fr)(e)){const t=(0,u.kk)(e)?e.compositeContent.files:e.compositeContent.images,s=t.map((e=>"blob"in e?(0,b.p)("name")(e.blob):"file_name"in e?e.file_name:void 0)).filter(v.q3)[0]||"",i=t.map((e=>{if("key"in e)return e.key})).filter(v.q3)[0]||"";return{is_upload_file:1,upload_id:e.preGeneratedlocalMessageId,upload_file_size:0,upload_file_type:(0,o.ti)((0,o.GO)(s)),collection_id:i,upload_collection_way:"single",upload_from:e.uploadFrom}}return(0,u.JG)(e)?"image"in e&&e.image?{is_upload_file:1,upload_id:e.preGeneratedlocalMessageId,upload_file_size:e.image.size,upload_file_type:(0,o.ti)((0,o.GO)((0,b.p)("name")(e.image))),collection_id:e.local_key,upload_collection_way:"single",upload_from:e.uploadFrom}:"image_key"in e&&e.image_key?{is_upload_file:1,upload_id:e.preGeneratedlocalMessageId,upload_file_size:0,upload_file_type:"Image",collection_id:e.image_key,upload_collection_way:"single",upload_from:e.uploadFrom}:{is_upload_file:0}:{is_upload_file:0}}catch(t){return console.error(t),{}}},A={trackSendMessageStatusEvent:(e,t)=>{var s,n,o,r,a,c;const{conversation_id:d,bot_id:u,message_id:_,section_id:v,scene:b,sec_scene:S,use_skill:k,skill_id:A,skill_name:w,is_ogf:z,from:E,is_quote:T,quote_type:R,enter_from:M,content_source:C,content_type:I,used_prompt:L,prompt_type:x,default_prompt_type:U,is_upload_file:B,upload_file_type:O,collection_id:q,upload_collection_way:P,upload_from:G}=t.sendMessageReport.getMeta(),D=f.gO.get("chatConfigService"),N=f.gO.get("chatBotService"),j=f.gO.get("chatTeaService");if(!D)return;const{loginSource:F,enterChatMethod:V}=D,{botInfo:H}=(0,h.tY)(p.pU.getState(),d),K=(0,h.Rx)(p.pU.getState(),d),W=(0,g.D)(p.pU.getState(),"",d,H,K);null==j||j.trackEvent("send_message_status",(0,i.A)((0,i.A)((0,i.A)((0,i.A)({duration:null===(s=t.sendMessageReport.getDuration())||void 0===s?void 0:s.ack,success:t.success?1:0,result:t.success?void 0:"shark",conversation_id:d,conversation_type:K,chat_type:W,bot_id:u,message_id:_,section_id:v,scene:"seo_keyboard"===b?"keyboard":b,sec_scene:S,use_skill:k,skill_name:w,skill_id:A,used_prompt:L,prompt_type:x,default_prompt_type:U,is_upload_file:B,upload_file_type:O,collection_id:q,upload_collection_way:P,upload_from:G,is_gpt4:z,message_type:(0,y.rJ)(e),from:E,writing_genre:null===(n=t.sendMessageReport.getMeta())||void 0===n?void 0:n.writing_genre,styles:null===(o=t.sendMessageReport.getMeta())||void 0===o?void 0:o.styles,collect_id:null===(r=t.sendMessageReport.getMeta())||void 0===r?void 0:r.collect_id,collect_type:null===(a=t.sendMessageReport.getMeta())||void 0===a?void 0:a.collect_type},F?{previous_page:F}:{}),{},{enter_chat_method:V},I===l.cM.Text?{original_content_source:C||m.Z.Other}:{}),M&&"bot_discover"===M?{user_id:D.userId,req_id:u?null==N||null===(c=N.getBotIdToRequestIdMap())||void 0===c?void 0:c[u]:"",recommend_from:"bot_list_discover"}:{}),{},{is_quote:T,quote_type:R}))},logSendMessage:e=>{r.vF.info({message:"send message",meta:{localMessage:e}})},trackSendMessageStartEvent:(e,t)=>{const s=f.gO.get("chatTeaService");null==s||s.trackEvent("message_send_start",{from:c.aU.Socket,type:e.message_type,send_id:e.message_id,section_id:e.section_id,local_message_id:e.local_message_id,conversation_id:e.conversation_id,skill_id:t.skill_id})},trackSendMessageEndEvent:(e,t)=>{var s,i,n;const{skill_id:o,retried:r}=t.sendMessageReport.getMeta(),a=f.gO.get("chatTeaService");null==a||a.trackEvent("message_send_end",{success:t.success?1:0,stream:0,duration:(null===(s=t.sendMessageReport)||void 0===s||null===(s=s.getDuration())||void 0===s?void 0:s.ack)||(null===(i=t.sendMessageReport)||void 0===i||null===(i=i.getDuration())||void 0===i?void 0:i.failed),from:null==e||null===(n=e.localInfo)||void 0===n?void 0:n.from,type:e.message_type,section_id:e.section_id,local_message_id:e.local_message_id,conversation_id:e.conversation_id,retry:r,skill_id:o})},trackSendMessageEvent:(e,t)=>{const{resolved:s,ctx:o,scene:r,content_source:a,sec_scene:u,use_skill:h=!1,skill_id:p,skill_name:g,reportParams:_}=e,{enterFrom:v}=o,y=f.gO.get("chatConfigService"),b=f.gO.get("chatTeaService"),S=f.gO.get("chatBotService");var k,A,w,z;s.isRegenerate||(null==b||b.trackEvent("send_message",(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)({message_type:s.message_type,from:c.aU.Socket,conversation_id:o.conversationId,conversation_type:s.conversation_type,bot_id:s.bot_id,chat_type:s.chat_type,scene:"seo_keyboard"===r?"keyboard":r,sec_scene:"resend"===r?"resend":u,use_skill:h,skill_id:p,skill_name:g,is_gpt4:(0,d.hy)(),is_quote:(Number(null===(k=(0,n.O)(null===(A=s.localCreateExt)||void 0===A?void 0:A.reference_content))||void 0===k?void 0:k.length)||0)>0?1:0},_),s.content_type===l.cM.Text?{original_content_source:(null==a?void 0:a.source)||m.Z.Other}:{}),["keyboard_unlog","seo_keyboard"].includes(r)&&null!=y&&y.loginSource?{previous_page:y.loginSource}:{}),v&&"bot_discover"===v?{user_id:null==y?void 0:y.userId,req_id:s.bot_id?null==S||null===(w=S.getBotIdToRequestIdMap())||void 0===w?void 0:w[s.bot_id]:"",recommend_from:"bot_list_discover"}:{}),null!==(z=t.ext)&&void 0!==z&&z.collection_id?{collection_id:t.ext.collection_id}:{})))},trackOnBoardingMessageSentEvent(){const e=f.gO.get("chatTeaService");null==e||e.trackEvent("auto_onboarding_message_sent",{type:"create_chat"})},trackUploadParseStatus(e,t){const{conversationId:s}=t.resolved,r=f.gO.get("chatTeaService");if((0,u.Bu)(t)){var l;const c=t.nestedItems.length,{botInfo:d}=(0,_.cL)(s),u=(0,n.O)(null===(l=t.resolved.localCreateExt)||void 0===l?void 0:l.input_skill);t.nestedItems.forEach((n=>{var l;const h={conversation_id:s,chat_type:(0,_.CB)("",s,d),skill_name:(u.skill_type||"").toString(),skill_id:u.skill_id||"",upload_id:t.resolved.localMessageId,upload_collection_way:c>1?"multi":"single",upload_type:"Image"===(0,o.ti)(n.fileName)?"pic":"pdf",upload_file_type:(0,o.GO)(n.fileName),upload_file_size:(null===(l=e.preprocessTaskMap[n.identifier])||void 0===l||null===(l=l.file)||void 0===l?void 0:l.size)||0};n.parseState===a.hI.ParseState_Failed?null==r||r.trackEvent("upload_parse_status",(0,i.A)({status:0,error_code:"parse_failed"},h)):null==r||r.trackEvent("upload_parse_status",(0,i.A)({status:1},h))}))}}}},81801:(e,t,s)=>{s.d(t,{h:()=>n});var i=s(99964);const n=()=>(e=>{const{userOgf:t}=e;if(null!=t&&t.featureEnabled)return null!=t&&t.value?1:0})(i.ozw.getState())},69853:(e,t,s)=>{s.d(t,{B:()=>o});var i=s(56642),n=s(99964);const o=(e,t=i.x)=>{const s=(...s)=>(0,n.ozw)((t=>e(t,...s)),t);return s.raw=e,s}},43545:(e,t,s)=>{s.d(t,{U:()=>l,e:()=>c});var i=s(14065),n=s(44557),o=s(63379),r=s(98502),a=s(69232);const l={messageFeedbackMap:{}},c=e=>(0,n.A)((0,n.A)({},l),{},{updateMessageFeedback:({conversationId:t,messageId:s,detail:n,reportEvent:l,onlyLocal:c=!1})=>(0,i.A)((function*(){try{c||(yield a.j.apiService.message.MessageReport({message_id:s,action:"feedback",feedbackDetail:n})),e((0,r.jM)((({messageFeedbackMap:e})=>{e[t]||(e[t]={}),e[t][s]||(e[t][s]={}),(0,o.A)(e[t][s],n)}))),null==l||l.success()}catch(i){i instanceof Error&&(null==l||l.error({reason:"message report failed",error:i}))}}))()})},80882:(e,t,s)=>{s.d(t,{A:()=>b,e:()=>S});var i=s(44557),n=s(14065),o=s(20997),r=s(85371),a=s(2633),l=s(94654),c=s(24323),d=s.n(c),u=s(98502),h=s(74848),p=s(67697),g=s(69232),_=s(27463),m=s(44644),f=s(27970),v=s(29581),y=s(81793);const b={preprocessTaskMap:{},uploaderToken:{}},S=(e,t)=>{const s=s=>{const{ctx:i,file:o}=s,r=i?(0,p.XB)({eventName:"attachment_upload",meta:{upload_type:s.type,upload_from:i.uploadFrom}}):void 0,a=(s,i)=>function(){var o=(0,n.A)((function*(n){const o=(0,u.mq)(t()),r=o.preprocessTaskMap[s];try{if(!r)return;yield i(n,r)}finally{e((0,u.vD)(o))}}));return function(e){return o.apply(this,arguments)}}();return{complete:a(s.local_key,((e,n)=>{if(n.loading=!1,n.failed=!1,e){n.percent=e.percent,n.uploadResult=e.uploadResult,n.key=e.uploadResult.ImageUri||"",n.fileKey=e.key,r&&(r.addDurationPoint("success"),r.success({meta:{upload_file_size:e.fileSize}}));const l=y.gO.get("chatTeaService");if(!l)return;var a;if(i)l.trackEvent("upload_attachment_status",{bot_id:i.botId,current_page:"chat",message_type:"file"===s.type?"file":"pic",message_type_detail:o&&"name"in o?null===(a=(null==o?void 0:o.name).match(/\.([^.]+)$/))||void 0===a?void 0:a[1].toLowerCase():"",enter_method:i.from,uri:e.uploadResult.ImageUri||"",success:"1"}),l.trackEvent("upload_status",{status:"1",conversation_id:i.conversationId,conversation_type:(0,f.Rx)(v.pU.getState(),i.conversationId)||1,module_actionid:i.moduleActionId,current_page:"chat",chat_type:i.chatType,skill_name:i.skillType?i.skillType.toString():"",skill_id:i.skillId,upload_id:i.uploadId,duration:e.duration.toString(),upload_way:i.uploadWay,upload_collection_way:i.uploadCollectionWay,collection_id:s.fileKey,collection_name:(0,m.p_C)("name")(o),upload_type:"file"===s.type?"pdf":"pic",upload_file_type:(0,h.GO)((0,m.p_C)("name")(o)),upload_token_length:"",upload_file_size:e.fileSize,upload_from:i.uploadFrom});(0,_.N)({info:e,task:t().preprocessTaskMap[s.local_key]})}})),progress:a(s.local_key,((e,t)=>{t.loading=!0,t.failed=!1,e&&(t.percent=e.percent,t.fileKey=e.key)})),error:a(s.local_key,((e,t)=>{if(t.loading=!1,t.failed=!0,t.uploadResult=void 0,t.key="",e){t.fileKey=e.key,r&&r.error({reason:"upload attachment failed",meta:{upload_file_size:e.fileSize}});const l=y.gO.get("chatTeaService");if(!l)return;var n,a;if(i)l.trackEvent("upload_file_status",{bot_id:i.botId,current_page:"chat",message_type:s.type,enter_method:i.from,success:"0",result:null!==(n=null===(a=e.extra)||void 0===a?void 0:a.message)&&void 0!==n?n:""}),l.trackEvent("upload_status",{status:"0",error_code:"fail_to_upload",conversation_id:i.conversationId,conversation_type:(0,f.Rx)(v.pU.getState(),i.conversationId)||1,module_actionid:i.moduleActionId,current_page:"chat",chat_type:i.chatType,skill_name:i.skillType?i.skillType.toString():"",skill_id:i.skillId,upload_id:i.uploadId,duration:e.duration.toString(),upload_way:i.uploadWay,upload_collection_way:i.uploadCollectionWay,collection_id:s.fileKey,collection_name:(0,m.p_C)("name")(o),upload_type:"file"===s.type?"pdf":"pic",upload_file_type:(0,h.GO)((0,m.p_C)("name")(o)),upload_token_length:"",upload_file_size:e.fileSize,upload_from:i.uploadFrom})}}))}},c=(()=>{let t=null;const s=function(){var s=(0,n.A)((function*(){p.vF.persist.log({eventName:"attachment_upload_refreshUploadToken_GetUploadAuthToken_image",meta:{}});const{data:s}=yield g.j.apiService.resource.GetUploadAuthToken({scene:"bot_chat",data_type:"image"});let i;p.vF.persist.log({eventName:"attachment_upload_refreshUploadToken_GetUploadAuthTokenDone_image",meta:{uploader_token_image:!!s}});try{p.vF.persist.log({eventName:"attachment_upload_refreshUploadToken_GetUploadAuthToken_file",meta:{}});i=(yield g.j.apiService.resource.GetUploadAuthToken({scene:"bot_chat",data_type:"file"})).data,p.vF.persist.log({eventName:"attachment_upload_refreshUploadToken_GetUploadAuthTokenDone_file",meta:{file_uploader_token_file:!!i}})}catch(a){var n;console.error("get file upload token failed"),p.vF.persist.error({error:new Error("attachment_upload_refreshUploadToken_GetUploadAuthTokenDone_file_error"),meta:{error:(0,o.A)(a)&&"message"in a?null==a||null===(n=a.message)||void 0===n?void 0:n.toString():""}})}const r={image:s,file:i};p.vF.persist.log({eventName:"attachment_upload_refreshUploadToken_setUploaderToken",meta:{uploader_token_file:!!r.file,uploader_token_image:!!r.image}}),e((()=>({uploaderToken:r}))),t=null}));return function(){return s.apply(this,arguments)}}();return()=>{var e;return null!==(e=t)&&void 0!==e?e:t=s()}})();let S;const k=function(){var e=(0,n.A)((function*(e,s){var i,n,o,r,l,d,u,h,g,_,m;if(p.vF.persist.log({eventName:"start_attachment_upload_getUploader_start",meta:{local_key:s.local_key,upload_id:null===(i=s.ctx)||void 0===i?void 0:i.uploadId,upload_type:s.type,upload_from:null===(n=s.ctx)||void 0===n?void 0:n.uploadFrom,type:e}}),S&&!S["file"===e?"fileConfigExpired":"imageConfigExpired"])return p.vF.persist.log({eventName:"start_attachment_upload_getUploader_notExpired",meta:{local_key:s.local_key,upload_id:null===(d=s.ctx)||void 0===d?void 0:d.uploadId,upload_type:s.type,upload_from:null===(u=s.ctx)||void 0===u?void 0:u.uploadFrom,type:e}}),S;if(null===(o=S)||void 0===o||!o.client){var f,v,b,k,A,w,z,E,T,R,M;if(p.vF.persist.log({eventName:"start_attachment_upload_getUploader_noClient",meta:{local_key:s.local_key,upload_id:null===(f=s.ctx)||void 0===f?void 0:f.uploadId,upload_type:s.type,upload_from:null===(v=s.ctx)||void 0===v?void 0:v.uploadFrom,type:e}}),(0,a.A)(t().uploaderToken))p.vF.persist.log({eventName:"start_attachment_upload_getUploader_noToken",meta:{local_key:s.local_key,upload_id:null===(E=s.ctx)||void 0===E?void 0:E.uploadId,upload_type:s.type,upload_from:null===(T=s.ctx)||void 0===T?void 0:T.uploadFrom,type:e}}),yield c(),p.vF.persist.log({eventName:"start_attachment_upload_getUploader_refreshUploadTokenAfterNoTokenDone",meta:{local_key:s.local_key,upload_id:null===(R=s.ctx)||void 0===R?void 0:R.uploadId,upload_type:s.type,upload_from:null===(M=s.ctx)||void 0===M?void 0:M.uploadFrom,uploader_token_file:!!t().uploaderToken.file,uploader_token_image:!!t().uploaderToken.image,type:e}});p.vF.persist.log({eventName:"start_attachment_upload_getUploader_createUploader",meta:{local_key:s.local_key,upload_id:null===(b=s.ctx)||void 0===b?void 0:b.uploadId,upload_type:s.type,upload_from:null===(k=s.ctx)||void 0===k?void 0:k.uploadFrom,type:e}});const i=y.gO.get("chatConfigService");if(!i)return;S=yield i.createUploader({imageConfig:t().uploaderToken.image,fileConfig:t().uploaderToken.file,userId:null!==(A=i.userId)&&void 0!==A?A:"",appId:i.appId}),p.vF.persist.log({eventName:"start_attachment_upload_getUploader_createUploaderDone",meta:{local_key:s.local_key,upload_id:null===(w=s.ctx)||void 0===w?void 0:w.uploadId,upload_type:s.type,upload_from:null===(z=s.ctx)||void 0===z?void 0:z.uploadFrom,uploader:!!S,type:e}})}S["file"===e?"fileConfigExpired":"imageConfigExpired"]&&(p.vF.persist.log({eventName:"start_attachment_upload_getUploader_expired",meta:{local_key:s.local_key,upload_id:null===(h=s.ctx)||void 0===h?void 0:h.uploadId,upload_type:s.type,upload_from:null===(g=s.ctx)||void 0===g?void 0:g.uploadFrom,type:e}}),yield c(),p.vF.persist.log({eventName:"start_attachment_upload_getUploader_refreshUploadTokenAfterExpiredDone",meta:{local_key:s.local_key,upload_id:null===(_=s.ctx)||void 0===_?void 0:_.uploadId,upload_type:s.type,upload_from:null===(m=s.ctx)||void 0===m?void 0:m.uploadFrom,type:e}}),S.updateImageConfig(t().uploaderToken.image),S.updateFileConfig(t().uploaderToken.file));return p.vF.persist.log({eventName:"start_attachment_upload_getUploader_returnUploader",meta:{local_key:s.local_key,upload_id:null===(r=s.ctx)||void 0===r?void 0:r.uploadId,upload_type:s.type,upload_from:null===(l=s.ctx)||void 0===l?void 0:l.uploadFrom,uploader:!!S,type:e}}),S}));return function(t,s){return e.apply(this,arguments)}}();return(0,i.A)((0,i.A)({},b),{},{refreshUploadToken:c,preprocessFile(t,n,o,r){const a=((e,t,s,i={})=>{const{preHandle:n}=i;return{type:t,key:"",local_key:(0,l.A)(),percent:0,blobUrl:URL.createObjectURL(e),loading:!0,failed:!1,fileKey:"",file:e,ctx:s,preHandle:n}})(t,n,o,r),c=a.local_key;t.arrayBuffer().then((t=>{const s=d()(new Uint8Array(t));e((0,u.jM)((e=>{const t=e.preprocessTaskMap[c];t&&(t.md5=s)})))})).catch((e=>{console.error("[preprocessFile] md5 \u8ba1\u7b97\u5931\u8d25",e)})),e((({preprocessTaskMap:e})=>({preprocessTaskMap:(0,i.A)((0,i.A)({},e),{},{[a.local_key]:a})})));const h=s(a);return k(n,a).then((e=>{var s,i;p.vF.persist.log({eventName:"start_attachment_upload_getUploader_done_start_upload",meta:{local_key:a.local_key,upload_id:null===(s=a.ctx)||void 0===s?void 0:s.uploadId,upload_type:a.type,upload_from:null===(i=a.ctx)||void 0===i?void 0:i.uploadFrom,type:n}}),null==e||e["file"===n?"uploadFile":"uploadImage"](t,{complete:h.complete,progress:h.progress,error:h.error})}),(()=>h.error())),{local_key:a.local_key,key:a.key}},reUpload(e){const i=t().preprocessTaskMap[e];if(!i)return void p.vF.persist.warning({eventName:"reUpload_mismatch_preprocessTask",meta:{local_key:e}});const n=s(i);n.progress(),k(i.type,i).then((e=>{var t;return null==e||null===(t=e.client)||void 0===t?void 0:t.start()}),(()=>n.error()))},cancel:e=>{var t;null===(t=S)||void 0===t||null===(t=t.client)||void 0===t||t.cancel(e)},updateAttachmentParseState(t,s){(0,r.A)(s)||e((0,u.jM)((e=>{const i=e.preprocessTaskMap[t];i&&(i.parseState=s)})))},updateAttachmentReviewState(t,s){(0,r.A)(s)||e((0,u.jM)((e=>{const i=e.preprocessTaskMap[t];i&&(i.reviewState=s)})))}})}},82300:(e,t,s)=>{s.d(t,{I:()=>a,M:()=>l});var i=s(44557),n=s(98502),o=s(44644),r=s(67697);const a={suggestMessageMap:{}},l=(e,t)=>(0,i.A)((0,i.A)({},a),{},{clearSuggestMessage:t=>{e((0,n.jM)((e=>{e.suggestMessageMap[t]&&delete e.suggestMessageMap[t]})))},updateSuggestMessage:(t,s)=>{e((e=>{const n=s(e.suggestMessageMap[t]),o=(0,i.A)({},e.suggestMessageMap);return n?o[t]=n:delete o[t],{suggestMessageMap:o}}))},updateSuggestMessageWithRemote:(e,s)=>{t().updateSuggestMessage(e,(t=>{try{var i;if(null==s||!s.reply_id)return t;const e=JSON.parse((null===(i=s.ext)||void 0===i?void 0:i.sp)||"[]");return{replyId:s.reply_id,loading:!1,failed:!1,expired:void 0,suggests:(0,o.Bog)(e)?e:[]}}catch(n){return r.vF.persist.warning({message:"load remote sp fail",meta:{conversationId:e,message_id:null==s?void 0:s.message_id,reply_id:null==s?void 0:s.reply_id}}),t}}))}})},48465:(e,t,s)=>{s.d(t,{B:()=>E});var i=s(67697),n=s(14065),o=s(85886),r=s(50474),a=s.n(r),l=s(92431),c=s(892);const d=[{pathExpression:"$.state.localMessageMap..local",callback:e=>{delete e.reportEvents}},{pathExpression:"$.state.regenerateMessageMap..reportEvents",callback:e=>{var t;null===(t=Object.keys(e))||void 0===t||t.forEach((t=>{delete e[t]}))}}],u=()=>{const e="undefined"==typeof window?{getItem:()=>Promise.resolve(null),setItem:()=>Promise.resolve(null),removeItem:()=>Promise.resolve(null)}:a().createInstance({name:"samantha-web",storeName:"store"});var t,s,o;return{getItem:(o=(0,n.A)((function*(t){return new Promise(((s,i)=>{var n;null===(n=e.getItem(t))||void 0===n||n.then((e=>{s(e)})).catch((e=>{i(e)})),setTimeout((()=>{i(new Error(`getItem ${t} timeout, timeout after 10000ms`))}),1e4)}))})),function(e){return o.apply(this,arguments)}),setItem:(s=(0,n.A)((function*(t,s){const n=(e=>{try{const t=(0,l.A)(e);return d.forEach((e=>{(0,c.E)({path:e.pathExpression,json:t,callback:e.callback,preventEval:!0})})),t}catch(t){i.vF.persist.error({message:"persist state filter error",error:t instanceof Error?t:new Error(String(t))})}return e})(s);yield e.setItem(t,n)})),function(e,t){return s.apply(this,arguments)}),removeItem:(t=(0,n.A)((function*(t){yield e.removeItem(t)})),function(e){return t.apply(this,arguments)})}},h=e=>{const t=e();if(t){const{getItem:e,setItem:s,removeItem:i}=t;t.setItem=(0,o.A)(p(s,"setItem"),1e3),t.getItem=p(e,"getItem"),t.removeItem=p(i,"removeItem")}return t},p=(e,t)=>(0,n.A)((function*(...s){try{return yield e(...s)}catch(a){if(a instanceof Error&&"undefined"!=typeof navigator){var n,o,r;const{usage:e=0,quota:s=0}=null!==(n=yield null===(o=navigator)||void 0===o||null===(o=o.storage)||void 0===o||null===(r=o.estimate)||void 0===r?void 0:r.call(o))&&void 0!==n?n:{usage:0,quota:0};i.vF.persist.error({message:`[message-core]persist storage action error: ${t} failed`,error:a,meta:{usageSpace:e/1024/1024+" MB",quotaSpace:s/1024/1024+" MB"}})}}}));var g=s(44557),_=s(80066),m=s(51402),f=s(20997),v=s(85371),y=s(56422),b=s(92882),S=s(43545),k=s(30025),A=s(67376);const w=(0,g.A)((0,g.A)((0,g.A)((0,g.A)({},k.DA),S.U),A.I6),A.Aj),z=(e,t)=>{try{const s=(0,v.A)(e)?w:e,i=(0,g.A)((0,g.A)({},(0,l.A)(t)),s);return i.messageLinkMap&&(0,f.A)(i.messageLinkMap)&&Object.keys(i.messageLinkMap).forEach((e=>{const{messageMap:t,localMessageMap:s,messageLinks:n}=(0,b.tv)(i,e),o=(0,_.A)(n,n.length-50),r=Object.fromEntries((0,m.A)((0,y.A)(o,(e=>e.isLocalMessage)),(e=>[e.messageId,s[e.messageId]]))),a=Object.fromEntries((0,m.A)((0,y.A)(o,(e=>!e.isLocalMessage)),(e=>[e.messageId,t[e.messageId]])));i.messageLinkMap[e]=o,i.localMessageMap[e]=r,i.messageMap[e]=a})),i.messageLinkMap&&(0,f.A)(i.messageLinkMap)&&Object.keys(i.messageLinkMap).forEach((e=>{const{messageMap:t,localMessageMap:s,messageLinks:n}=(0,b.tv)(i,e),o=(0,b.uT)({messageLinks:n,getMessage:(0,b.A4)({messageMap:t,localMessageMap:s}),range:{start:0,end:0}});i.messageListStatusMap[e]=n.length<50&&i.messageListStatusMap[e]?i.messageListStatusMap[e]:o})),i}catch(s){s instanceof Error&&i.vF.persist.error({message:"persist merge error",error:s})}return t},E=(e,t)=>{var s,n;return{name:`${e.prefix}-chat-message-store`,storage:h((()=>{var t;return null!==(t=e.storage)&&void 0!==t?t:u()})),partialize:null!==(s=e.partialize)&&void 0!==s?s:t,version:1.5,merge:null!==(n=e.merge)&&void 0!==n?n:z,onRehydrateStorage:e=>{const t=i.vF.createLoggerWith({ctx:{namespace:"persist"}});return t.info({message:"hydration started",meta:{state:e}}),(e,s)=>{s?t.persist.error({message:"hydration error",error:s instanceof Error?s:new Error(String(s))}):t.info({message:"hydration finished",meta:{state:e}})}}}}},74792:(e,t,s)=>{s.d(t,{E:()=>n});var i=s(40257);const n=new(s(75741).G)(i.W2)},90862:(e,t,s)=>{s.d(t,{p:()=>o});var i=s(67697),n=s(74792);const o=e=>{try{const t=[...n.E.keys()],s={},i={},o={};return t.forEach((t=>{var i;t&&(o[t]=e.suggestMessageMap[t],null!==(i=e.messageLinkMap)&&void 0!==i&&i[t]&&(s[t]=e.messageLinkMap[t].slice(Math.max(e.messageLinkMap[t].length-30,0))))})),t.forEach((t=>{var n;t&&null!=s&&s[t]&&null!==(n=e.messageMap)&&void 0!==n&&n[t]&&(i[t]={},s[t].forEach((s=>{var n;null!==(n=e.messageMap)&&void 0!==n&&null!==(n=n[t])&&void 0!==n&&n[s.messageId]&&(i[t][s.messageId]=e.messageMap[t][s.messageId])})))})),{messageLinkMap:e.messageLinkMap,messageListStatusMap:e.messageListStatusMap,messageMap:e.messageMap,suggestMessageMap:e.suggestMessageMap,localMessageMap:e.localMessageMap,regenerateMessageMap:e.regenerateMessageMap,messageFeedbackMap:e.messageFeedbackMap,userInfo:e.userInfo}}catch(t){return i.vF.persist.error({message:"[@message-store] persist state limit error",error:t instanceof Error?t:new Error(String(t))}),{}}}},16083:(e,t,s)=>{function i(e,t){e.messageMap[t]&&delete e.messageMap[t],e.localMessageMap[t]&&delete e.localMessageMap[t],e.regenerateMessageMap[t]&&delete e.regenerateMessageMap[t],e.messageLinkMap[t]&&delete e.messageLinkMap[t],e.messageListStatusMap[t]&&delete e.messageListStatusMap[t]}s.d(t,{z:()=>i})},41987:(e,t,s)=>{s.d(t,{WZ:()=>o,ci:()=>l,rQ:()=>r,rU:()=>a});var i=s(20177),n=s(56422);s(776);const o=(e,t)=>(0,i.A)(e||[],(e=>t(e))),r=(e=[],t)=>o(e,(e=>{var s;return!e.isLocalMessage&&!!e.messageId&&(null===(s=null==t?void 0:t(e))||void 0===s||s)})),a=({messageLinks:e=[],replyId:t,getMessage:s})=>(0,n.A)(e,(e=>{var i;return(null===(i=s(e))||void 0===i?void 0:i.reply_id)===t})),l=({messageLinks:e=[],replyId:t,getMessage:s})=>o(e,(e=>{var i;return(null===(i=s(e))||void 0===i?void 0:i.reply_id)===t}))},78094:(e,t,s)=>{s.d(t,{b:()=>a});var i=s(1026),n=s(76461),o=s(33256),r=s(776);const a=(e,t,s)=>{const a=((e,t)=>e.filter((s=>{if(s.isLocalMessage){const i=t(s),o=null==i?void 0:i.message_id,a=null==i?void 0:i.reply_id;if(~(0,n.A)(e,((n,l)=>{if(n===s)return!1;const c=t(n),d=!n.isLocalMessage;if(d&&c&&n.messageId===o)return!0;if(d&&!o&&a&&(null==c?void 0:c.reply_id)===a&&(0,r.$4)(c)){if(!s.regen_head)return!0;if((0,r.pu)(c))return!0;if("local"in i&&i.local.prevRemoteMessageId===c.message_id&&e[l+1]&&!e[l+1].isLocalMessage)return!0}return d&&!o&&!a&&(null==c||c.local_message_id,null==i||i.local_message_id),!1})))return!1}return!0})))((0,i.A)([...e,...t],(e=>e.messageId)),s);return(0,o.Z)(a,s),a}},47181:(e,t,s)=>{s.d(t,{H:()=>c,x:()=>d});var i=s(44557),n=s(85371),o=s(44644),r=s(35841),a=s(776),l=s(41987);const c=(e,t)=>{const s=(0,i.A)((0,i.A)({},e),{},{localInfo:t,contentObj:!(0,n.A)(null==e?void 0:e.status)||(0,a.yU)(e)||(0,a.ey)(e)?(0,o.OlY)(e.content)||{}:void 0});return(0,n.A)(s.contentObj)||delete s.content,s},d=({prevMessageId:e,message:t,messageLinks:s,localMessageStatus:n,failedExpired:o,sendLoadingExpired:a,isRegenerate:c,localContent:d,enterFrom:u})=>{var h;return(0,i.A)((0,i.A)({},t),{},{message_type:r.Go.Message,create_time:Date.now(),status:r.q7.Available,localContent:d,local:{prevRemoteMessageId:e||(null===(h=(0,l.rQ)(s))||void 0===h?void 0:h.messageId)||"",status:n,failed:!1,isRetried:!1,failedExpired:o,sendLoadingExpired:a,isRegenerate:c,enterFrom:u}})}},63399:(e,t,s)=>{s.d(t,{C:()=>i});const i={addDuration(e,t){Object.values(e||{}).forEach((e=>{null==e||e.addDurationPoint(t)}))},updateMeta(e,t){Object.values(e||{}).forEach((e=>{null==e||e.updateMeta(t)}))},success(e,t){Object.values(e||{}).forEach((e=>{null==e||e.success(t)}))},error(e,t){Object.values(e||{}).forEach((e=>{null==e||e.error(t)}))}}},32168:(e,t,s)=>{s.d(t,{T:()=>i});const i=(e,t)=>{if(0===e.length||1===e.length)return e;let s=e.length,i=-1;function n(e,t){i=e,s=t}for(let o=e.length-1;o>=0;o--){if(e[o].isLocalMessage)continue;const r=t(e[o]);if(!r)break;const a=Number(r.index);if(-1!==i)if(i!==a){if(i-1!==a)break;n(a,o)}else e.splice(s,1),n(a,o);else n(a,o)}return e.slice(s)}},10120:(e,t,s)=>{function i(e){const t=Date.now();if(e%Math.pow(10,t.toString().length-1)===e){const s=1e3*e;return s<t?s:e}return e}s.d(t,{Q:()=>i})},75741:(e,t,s)=>{s.d(t,{G:()=>r});var i=s(10633);const n=Symbol("newer"),o=Symbol("older");class r{constructor(e,t){(0,i.A)(this,"size",void 0),(0,i.A)(this,"limit",void 0),(0,i.A)(this,"oldest",void 0),(0,i.A)(this,"newest",void 0),(0,i.A)(this,"_keyMap",void 0),this.size=0,this.limit=e,this.oldest=this.newest=void 0,this._keyMap=new Map,t&&(this.assign(t),e<1&&(this.limit=this.size))}_markEntryAsUsed(e){e!==this.newest&&(e[n]&&(e===this.oldest&&(this.oldest=e[n]),e[n][o]=e[o]),e[o]&&(e[o][n]=e[n]),e[n]=void 0,e[o]=this.newest,this.newest&&(this.newest[n]=e),this.newest=e)}assign(e){let t,s=this.limit||Number.MAX_VALUE;this._keyMap.clear();const i=e[Symbol.iterator]();for(let r=i.next();!r.done;r=i.next()){const e=new a(r.value[0],r.value[1]);if(this._keyMap.set(e.key,e),t?(t[n]=e,e[o]=t):this.oldest=e,t=e,0==s--)throw new Error("overflow")}this.newest=t,this.size=this._keyMap.size}get(e){const t=this._keyMap.get(e);if(t)return this._markEntryAsUsed(t),t.value}set(e,t){let s=this._keyMap.get(e);return s?(s.value=t,this._markEntryAsUsed(s),this):(this._keyMap.set(e,s=new a(e,t)),this.newest?(this.newest[n]=s,s[o]=this.newest):this.oldest=s,this.newest=s,++this.size,this.size>this.limit&&this.shift(),this)}shift(){const e=this.oldest;var t;if(e)return null!==(t=this.oldest)&&void 0!==t&&t[n]?(this.oldest=this.oldest[n],this.oldest[o]=void 0):(this.oldest=void 0,this.newest=void 0),e[n]=e[o]=void 0,this._keyMap.delete(e.key),--this.size,[e.key,e.value]}find(e){const t=this._keyMap.get(e);return t?t.value:void 0}has(e){return this._keyMap.has(e)}delete(e){const t=this._keyMap.get(e);if(t)return this._keyMap.delete(t.key),t[n]&&t[o]?(t[o][n]=t[n],t[n][o]=t[o]):t[n]?(t[n][o]=void 0,this.oldest=t[n]):t[o]?(t[o][n]=void 0,this.newest=t[o]):this.oldest=this.newest=void 0,this.size--,t.value}clear(){this.oldest=this.newest=void 0,this.size=0,this._keyMap.clear()}keys(){return new c(this.oldest)}values(){return new d(this.oldest)}entries(){return this}[Symbol.iterator](){return new l(this.oldest)}forEach(e,t){"object"!=typeof t&&(t=this);let s=this.oldest;for(;s;)e.call(t,s.value,s.key,this),s=s[n]}toJSON(){let e=new Array(this.size),t=0,s=this.oldest;for(;s;)e[t++]={key:s.key,value:s.value},s=s[n];return e}toString(){let e="",t=this.oldest;for(;t;)e+=`${String(t.key)}:${t.value}`,t=t[n],t&&(e+=" < ");return e}}class a{constructor(e,t){(0,i.A)(this,n,void 0),(0,i.A)(this,o,void 0),this.key=e,this.value=t,this[n]=void 0,this[o]=void 0}}class l{constructor(e){(0,i.A)(this,"entry",void 0),this.entry=e}[Symbol.iterator](){return this}next(){const e=this.entry;return e?(this.entry=e[n],{done:!1,value:[e.key,e.value]}):{done:!0,value:void 0}}}class c{constructor(e){(0,i.A)(this,"entry",void 0),this.entry=e}[Symbol.iterator](){return this}next(){const e=this.entry;return e?(this.entry=e[n],{done:!1,value:e.key}):{done:!0,value:void 0}}}class d{constructor(e){(0,i.A)(this,"entry",void 0),this.entry=e}[Symbol.iterator](){return this}next(){const e=this.entry;return e?(this.entry=e[n],{done:!1,value:e.value}):{done:!0,value:void 0}}}},21711:(e,t,s)=>{s.d(t,{E:()=>n});var i=s(9012);const n=e=>({onboarding_content_source:(0,i.A)(e,"ext.onboarding_content_source","")})},26385:(e,t,s)=>{s(80160),s(44644),s(4921),s(67697),s(77749),s(18460)},28180:(e,t,s)=>{s(67697),s(44644),s(66387)},18460:(e,t,s)=>{s.d(t,{O:()=>n,Q:()=>i});var i={open:"open",close:"close",error:"error",message:"message"};let n=function(e){return e[e.FetchFailed=1001]="FetchFailed",e[e.ResponseIsInvalid=1002]="ResponseIsInvalid",e[e.StreamParseFailed=1003]="StreamParseFailed",e[e.ServerError=1004]="ServerError",e[e.AbortFetch=1005]="AbortFetch",e}({})},99616:(e,t,s)=>{s.d(t,{n:()=>n});var i=s(10633);class n{constructor(e=0){(0,i.A)(this,"_attempts",0),this._maxRetryAttempts=e}add(){this._attempts++}reset(){this._attempts=0}get attempts(){return this._attempts}matchMaxRetryAttempts(){return this._attempts>=this._maxRetryAttempts}}},72077:(e,t,s)=>{s.d(t,{O:()=>S});var i=s(44557),n=s(14065),o=s(10633),r=s(3888),a=s(85886),l=s(47686),c=s(60588),d=s(44644),u=s(67697),h=s(64080),p=s(64283),g=s(99616),_=s(73085),m=s(72083),f=s(38633),v=s(40257),y=s(79223),b=s(40316);class S extends c.A{constructor(e){super(),(0,o.A)(this,"_retryCounter",void 0),(0,o.A)(this,"_abortTrigger",void 0),(0,o.A)(this,"_originFetchStream",void 0),(0,o.A)(this,"_baseURL",void 0),(0,o.A)(this,"_chunkTask",void 0),(0,o.A)(this,"_getCommonHttpParams",void 0),(0,o.A)(this,"_getCommonHttpHeaders",void 0),(0,o.A)(this,"_emitEventThrottle",void 0),(0,o.A)(this,"id",void 0),(0,o.A)(this,"status",void 0),this._config=e;const{maxRetryAttempts:t,fetchStream:s,getCommonHttpParams:i,getCommonHttpHeaders:n,baseURL:r,chunkInterval:l=500}=this._config;this._retryCounter=new g.n(t),this.id=Symbol("eventSourceWorker"),this.status=y.T.idle,this._handleEvent=this._handleEvent.bind(this),this._handleError=this._handleError.bind(this),this._handleFinish=this._handleFinish.bind(this),this._subscribeAbortTrigger=this._subscribeAbortTrigger.bind(this),this._originFetchStream=s,this._getCommonHttpParams=i,this._getCommonHttpHeaders=n,this._baseURL=r;const c=this.emit.bind(this);this._emitEventThrottle=(0,a.A)((e=>c("event",...e)),l)}_fetchStream(e){var t=this;return(0,n.A)((function*(){var s;yield null===(s=t._originFetchStream)||void 0===s?void 0:s.call(t,{req:{url:`${t._baseURL||""}/alice/message/stream_reply`,body:{seq_st:(Number(e.chunkSeq)||0)+1,reply_id:e.replyId,binary_type:t._config.binaryType}},reportMeta:{conversation_id:(null==e?void 0:e.conversationId)||"",reply_id:e.replyId,seq_st:(Number(e.chunkSeq)||0)+1,binary_type:t._config.binaryType},onMessage:t._handleEvent,onError:t._handleError,onFinish:t._handleFinish,subscribeAbortTrigger:t._subscribeAbortTrigger,getCommonHttpParams:t._getCommonHttpParams,getCommonHttpHeaders:t._getCommonHttpHeaders})}))()}_subscribeAbortTrigger(e){this._abortTrigger=e}_handleEvent(e,t){var s;null!=this&&null!==(s=this._config)&&void 0!==s&&s.consoleIncrementMessagePacket&&u.vF.info({namespace:"http-chunk",message:"Increment Chunk Received",meta:{chunk:e}}),e.event_type===h.B.Message&&this._batchUpdateMessage(e,t)}_batchUpdateMessage(e,t){if(e.message_list){const s=[];for(const i of e.message_list){const{mergedMessage:e}=this._mergeMessage(i,t);s.push(e)}const n=(0,i.A)((0,i.A)({},e),{},{message_list:s});this._emitEventThrottle([n]);n.message_list.every((e=>{var t;return"1"===(null==e||null===(t=e.ext)||void 0===t?void 0:t.is_finish)}))&&this._emitEventThrottle.flush()}if(e.message){var s;const{message:n}=e,{mergedMessage:o}=this._mergeMessage(n,t),r=(0,i.A)((0,i.A)({},e),{},{message:o});this._emitEventThrottle([r]);"1"===(null===(s=r.message)||void 0===s||null===(s=s.ext)||void 0===s?void 0:s.is_finish)&&this._emitEventThrottle.flush()}}_mergeMessage(e,t){var s;if(!this._chunkTask)return{mergedMessage:e};const{completionMessageMap:i,replyId:n}=this._chunkTask,{message_id:o}=e||{};i[v.Ln]&&delete i[v.Ln];const r=o||v.Ln,{mergedMessage:a}=(0,m.ws)(i[r]||{},e,{from:b.a.HttpChunk,logId:t,retried:!(null===(s=this._retryCounter)||void 0===s||!s.attempts)}),l=a||e;return i[r]=l,this.emit("update_task",n,l),{mergedMessage:l}}_handleError(e,t){if(e.code===f.O4.ServerError){const s=(0,d.OlY)(e.msg),{code:i}=s;switch(i){case p.t.NETWORK_TIMEOUT:case p.t.MYSQL_ERROR:case p.t.REDIS_ERROR:case p.t.SYSTEM_ERROR2:return void this._reFetchStream(s,t);default:this._batchEmitErrorMessage(s,t)}}else{if(e.code===f.O4.AbortFetch)return;this._reFetchStream({msg:e.msg,code:_.ge},t)}}_reFetchStream(e,t){var s=this;return(0,n.A)((function*(){if(s._retryCounter.matchMaxRetryAttempts())return s._batchEmitErrorMessage(e,t),void s._handleFinish();s._retryCounter.add(),s._retryCounter.attempts>1&&(yield s._wait(s._retryCounter.attempts)),s._chunkTask&&s._fetchStream(s._chunkTask)}))()}_wait(e){return new Promise((t=>{setTimeout(t,this._getIntervalValue(e))}))}_getIntervalValue(e){const{minFetchInterval:t=500,maxFetchInterval:s=5e3,fetchIntervalGrowFactor:i=2}=this._config||{},n=t*Math.pow(i,e-1);return n>s?s:n}_handleFinish(e){e&&this._batchFinishMessage(),this._reset(),this.emit("finish",this.id)}_batchEmitErrorMessage(e,t){if(!this._chunkTask)return;const{completionMessageMap:s}=this._chunkTask;for(const i of(0,r.A)(s))this.emit("event",(0,_.C_)(i,e,t))}_batchFinishMessage(){if(!this._chunkTask)return;const{completionMessageMap:e}=this._chunkTask;this._emitEventThrottle.flush();for(const t of(0,l.A)(e)){const s=(0,i.A)((0,i.A)({},e[t]),{},{localInfo:(0,i.A)((0,i.A)({},e[t].localInfo||{}),{},{finishReply:!0,from:b.a.HttpChunk})});e[t]=s,this.emit("event",{event_type:h.B.Message,message:s})}}_reset(){var e;this.emit("clean",(null===(e=this._chunkTask)||void 0===e?void 0:e.replyId)||""),this._retryCounter.reset(),this._chunkTask=void 0,this.status=y.T.idle}_init(e){this.status=y.T.running,this._chunkTask=(0,_.NY)(e),this._retryCounter.reset()}get replyId(){var e;return null===(e=this._chunkTask)||void 0===e?void 0:e.replyId}startTask(e){this._init(e),this._fetchStream(e)}abort(){var e;this._emitEventThrottle.flush(),null===(e=this._abortTrigger)||void 0===e||e.call(this,{msg:"breakdown",code:f.O4.AbortFetch}),this._reset()}}},44509:(e,t,s)=>{s.d(t,{P:()=>a,g:()=>r});var i=s(67697),n=s(64080),o=s(40316);const r=({event:e,adaptor:t})=>{try{const{event_type:s,message:i,cmd:o,message_list:r}=e;s===n.B.Message&&r&&r.forEach((e=>t.emit("message",e))),s===n.B.Message&&i&&t.emit("message",i),s===n.B.Cmd&&o&&t.emit("cmd",o)}catch(s){s instanceof Error&&i.vF.error({message:`unexpected error in event handler,${s.message}`,error:s})}},a={adapters:{},registerHttp(e){this.adapters[o.a.HttpLongPolling]=e},registerHttpChunk(e){this.adapters[o.a.HttpChunk]=e},registerSocket(e){this.adapters[o.a.Socket]=e},unregisterHttp(){this.adapters[o.a.HttpLongPolling]=void 0},unregisterHttpChunk(){this.adapters[o.a.HttpChunk]=void 0},unregisterSocket(){this.adapters[o.a.Socket]=void 0},getHttpChunkAdapter(){return this.adapters[o.a.HttpChunk]},getHttpAdapter(){return this.adapters[o.a.HttpLongPolling]},getSocketAdapter(){return this.adapters[o.a.Socket]}}},79223:(e,t,s)=>{s.d(t,{T:()=>i});s(60588);let i=function(e){return e[e.running=1]="running",e[e.idle=2]="idle",e}({})},10764:(e,t,s)=>{var i=s(10633),n=s(74251),o=s(95809);class r extends n.Q{constructor(e){super(),(0,i.A)(this,"type",0),(0,i.A)(this,"info",void 0),o.C.util.initPartial(e,this)}static fromBinary(e,t){return(new r).fromBinary(e,t)}static fromJson(e,t){return(new r).fromJson(e,t)}static fromJsonString(e,t){return(new r).fromJsonString(e,t)}static equals(e,t){return o.C.util.equals(r,e,t)}}(0,i.A)(r,"runtime",o.C),(0,i.A)(r,"typeName","msg_pb.MetaInfo"),(0,i.A)(r,"fields",o.C.util.newFieldList((()=>[{no:1,name:"type",kind:"scalar",T:5},{no:2,name:"info",kind:"scalar",T:9,opt:!0}])));class a extends n.Q{constructor(e){super(),(0,i.A)(this,"conversationId",void 0),(0,i.A)(this,"sectionId",void 0),(0,i.A)(this,"messageId",void 0),(0,i.A)(this,"localMessageId",void 0),(0,i.A)(this,"index",void 0),(0,i.A)(this,"secSender",void 0),(0,i.A)(this,"replyId",void 0),(0,i.A)(this,"status",void 0),(0,i.A)(this,"createTime",void 0),(0,i.A)(this,"messageType",void 0),(0,i.A)(this,"contentType",void 0),(0,i.A)(this,"content",void 0),(0,i.A)(this,"ttsContent",void 0),(0,i.A)(this,"ext",{}),(0,i.A)(this,"nextConnectionType",void 0),(0,i.A)(this,"chunkSeq",void 0),(0,i.A)(this,"isDelta",void 0),(0,i.A)(this,"metaInfos",[]),(0,i.A)(this,"localConversationId",void 0),(0,i.A)(this,"botId",void 0),(0,i.A)(this,"appletPayload",{}),(0,i.A)(this,"modelType",void 0),(0,i.A)(this,"updateTime",void 0),(0,i.A)(this,"threadId",void 0),o.C.util.initPartial(e,this)}static fromBinary(e,t){return(new a).fromBinary(e,t)}static fromJson(e,t){return(new a).fromJson(e,t)}static fromJsonString(e,t){return(new a).fromJsonString(e,t)}static equals(e,t){return o.C.util.equals(a,e,t)}}(0,i.A)(a,"runtime",o.C),(0,i.A)(a,"typeName","msg_pb.PushMessage"),(0,i.A)(a,"fields",o.C.util.newFieldList((()=>[{no:1,name:"conversation_id",kind:"scalar",T:9,opt:!0},{no:2,name:"section_id",kind:"scalar",T:9,opt:!0},{no:3,name:"message_id",kind:"scalar",T:9,opt:!0},{no:4,name:"local_message_id",kind:"scalar",T:9,opt:!0},{no:5,name:"index",kind:"scalar",T:3,opt:!0},{no:6,name:"sec_sender",kind:"scalar",T:9,opt:!0},{no:7,name:"reply_id",kind:"scalar",T:9,opt:!0},{no:8,name:"status",kind:"scalar",T:5,opt:!0},{no:9,name:"create_time",kind:"scalar",T:3,opt:!0},{no:10,name:"message_type",kind:"scalar",T:5,opt:!0},{no:11,name:"content_type",kind:"scalar",T:5,opt:!0},{no:12,name:"content",kind:"scalar",T:9,opt:!0},{no:13,name:"tts_content",kind:"scalar",T:9,opt:!0},{no:14,name:"ext",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:15,name:"next_connection_type",kind:"scalar",T:5,opt:!0},{no:16,name:"chunk_seq",kind:"scalar",T:3,opt:!0},{no:17,name:"is_delta",kind:"scalar",T:8,opt:!0},{no:18,name:"meta_infos",kind:"message",T:r,repeated:!0},{no:19,name:"local_conversation_id",kind:"scalar",T:9,opt:!0},{no:20,name:"bot_id",kind:"scalar",T:9,opt:!0},{no:21,name:"applet_payload",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:22,name:"model_type",kind:"scalar",T:5,opt:!0},{no:23,name:"update_time",kind:"scalar",T:3,opt:!0},{no:24,name:"thread_id",kind:"scalar",T:3,opt:!0}])));class l extends n.Q{constructor(e){super(),(0,i.A)(this,"cmdType",void 0),(0,i.A)(this,"index",void 0),(0,i.A)(this,"conversationId",void 0),(0,i.A)(this,"messageId",void 0),(0,i.A)(this,"ext",{}),(0,i.A)(this,"upCmdType",void 0),(0,i.A)(this,"localMessageId",void 0),o.C.util.initPartial(e,this)}static fromBinary(e,t){return(new l).fromBinary(e,t)}static fromJson(e,t){return(new l).fromJson(e,t)}static fromJsonString(e,t){return(new l).fromJsonString(e,t)}static equals(e,t){return o.C.util.equals(l,e,t)}}(0,i.A)(l,"runtime",o.C),(0,i.A)(l,"typeName","msg_pb.PushCmd"),(0,i.A)(l,"fields",o.C.util.newFieldList((()=>[{no:1,name:"cmd_type",kind:"scalar",T:5,opt:!0},{no:2,name:"index",kind:"scalar",T:3,opt:!0},{no:3,name:"conversation_id",kind:"scalar",T:9,opt:!0},{no:4,name:"message_id",kind:"scalar",T:9,opt:!0},{no:5,name:"ext",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:6,name:"up_cmd_type",kind:"scalar",T:5,opt:!0},{no:7,name:"local_message_id",kind:"scalar",T:9,opt:!0}])));class c extends n.Q{constructor(e){super(),(0,i.A)(this,"longitude",void 0),(0,i.A)(this,"latitude",void 0),(0,i.A)(this,"countryName",void 0),(0,i.A)(this,"provinceName",void 0),(0,i.A)(this,"cityName",void 0),(0,i.A)(this,"districtName",void 0),(0,i.A)(this,"townName",void 0),(0,i.A)(this,"countryCode",void 0),o.C.util.initPartial(e,this)}static fromBinary(e,t){return(new c).fromBinary(e,t)}static fromJson(e,t){return(new c).fromJson(e,t)}static fromJsonString(e,t){return(new c).fromJsonString(e,t)}static equals(e,t){return o.C.util.equals(c,e,t)}}(0,i.A)(c,"runtime",o.C),(0,i.A)(c,"typeName","msg_pb.GeoInfo"),(0,i.A)(c,"fields",o.C.util.newFieldList((()=>[{no:1,name:"longitude",kind:"scalar",T:9,opt:!0},{no:2,name:"latitude",kind:"scalar",T:9,opt:!0},{no:3,name:"country_name",kind:"scalar",T:9,opt:!0},{no:4,name:"province_name",kind:"scalar",T:9,opt:!0},{no:5,name:"city_name",kind:"scalar",T:9,opt:!0},{no:6,name:"district_name",kind:"scalar",T:9,opt:!0},{no:7,name:"town_name",kind:"scalar",T:9,opt:!0},{no:8,name:"country_code",kind:"scalar",T:9,opt:!0}])));class d extends n.Q{constructor(e){super(),(0,i.A)(this,"messageId",void 0),(0,i.A)(this,"localMessageId",void 0),(0,i.A)(this,"replyId",void 0),(0,i.A)(this,"questionId",void 0),(0,i.A)(this,"createTime",void 0),(0,i.A)(this,"content",void 0),(0,i.A)(this,"ext",{}),(0,i.A)(this,"messageType",void 0),o.C.util.initPartial(e,this)}static fromBinary(e,t){return(new d).fromBinary(e,t)}static fromJson(e,t){return(new d).fromJson(e,t)}static fromJsonString(e,t){return(new d).fromJsonString(e,t)}static equals(e,t){return o.C.util.equals(d,e,t)}}(0,i.A)(d,"runtime",o.C),(0,i.A)(d,"typeName","msg_pb.AppAction"),(0,i.A)(d,"fields",o.C.util.newFieldList((()=>[{no:1,name:"message_id",kind:"scalar",T:3,opt:!0},{no:2,name:"local_message_id",kind:"scalar",T:9,opt:!0},{no:3,name:"reply_id",kind:"scalar",T:3,opt:!0},{no:4,name:"question_id",kind:"scalar",T:3,opt:!0},{no:5,name:"create_time",kind:"scalar",T:3,opt:!0},{no:6,name:"content",kind:"scalar",T:9,opt:!0},{no:7,name:"ext",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:8,name:"message_type",kind:"scalar",T:5,opt:!0}])));class u extends n.Q{constructor(e){super(),(0,i.A)(this,"eventType",0),(0,i.A)(this,"message",void 0),(0,i.A)(this,"cmd",void 0),(0,i.A)(this,"geo",void 0),(0,i.A)(this,"appAction",void 0),(0,i.A)(this,"version",void 0),(0,i.A)(this,"messageList",[]),o.C.util.initPartial(e,this)}static fromBinary(e,t){return(new u).fromBinary(e,t)}static fromJson(e,t){return(new u).fromJson(e,t)}static fromJsonString(e,t){return(new u).fromJsonString(e,t)}static equals(e,t){return o.C.util.equals(u,e,t)}}(0,i.A)(u,"runtime",o.C),(0,i.A)(u,"typeName","msg_pb.PushEvent"),(0,i.A)(u,"fields",o.C.util.newFieldList((()=>[{no:1,name:"event_type",kind:"scalar",T:5},{no:2,name:"message",kind:"message",T:a,opt:!0},{no:3,name:"cmd",kind:"message",T:l,opt:!0},{no:4,name:"geo",kind:"message",T:c,opt:!0},{no:5,name:"app_action",kind:"message",T:d,opt:!0},{no:6,name:"version",kind:"scalar",T:5,opt:!0},{no:7,name:"message_list",kind:"message",T:a,repeated:!0}])))},77749:(e,t,s)=>{s(10764),s(98116),s(73492)},21328:(e,t,s)=>{s.d(t,{H:()=>a,uL:()=>u,xT:()=>d,yU:()=>c});var i=s(44557),n=s(85371),o=s(35841),r=s(62396);const a=(e,t)=>{const s=(0,i.A)((0,i.A)({},e),{},{localInfo:t,contentObj:!(0,n.A)(null==e?void 0:e.status)||c(e)||l(e)?(0,r.O)(e.content)||{}:void 0});return(0,n.A)(s.contentObj)||delete s.content,s},l=e=>(null==e?void 0:e.message_type)===o.Go.Loading,c=e=>(null==e?void 0:e.content_type)===o.cM.Suggest,d=e=>(null==e?void 0:e.status)===o.q7.Broken,u=e=>{var t,s;return!(!e||!l(e))&&("rich_media_intention"===(null===(t=e.ext)||void 0===t?void 0:t.intention)||!(null===(s=e.contentObj)||void 0===s||!s.search_references))}},73492:(e,t,s)=>{s(44644)},73085:(e,t,s)=>{s.d(t,{C_:()=>u,NY:()=>d,ge:()=>c});var i=s(44557),n=s(92431),o=s(97666),r=s(5099),a=s(64080),l=s(40316);const c=111111111;function d(e){const t=(0,n.A)(e),{completionMessageMap:s}=t;for(const[i,n]of(0,o.A)(s))s[i]=(0,r.A)(n,["local","local_message_id"]);return t}function u(e,t,s){var n;const{msg:o,code:r}=t,d=(0,i.A)((0,i.A)({},null!=e?e:{}),{},{ext:(0,i.A)((0,i.A)({},null!==(n=null==e?void 0:e.ext)&&void 0!==n?n:{}),{},{has_err:r===c?"":String(r),err_msg:r===c?"":o}),localInfo:{from:l.a.HttpChunk,logId:s,errorCode:r,errorMsg:o}});return{event_type:a.B.Message,message:d}}},98116:(e,t,s)=>{s(44644)},22910:(e,t,s)=>{s.d(t,{n:()=>k});var i=s(44557),n=s(33451),o=s(59566),r=s(7216),a=s(89118),l=s(1066),c=s(8709),d=s(60149),u=s(79699),h=s(44192),p=s(57726),g=s(34663),_=s(17732),m=s(15571),f=s(99634),v=s(83071),y=s(80020);const b=["params","headers"],S={bot:r.Ay,conversation:a.Ay,message:c.Ay,dataReport:l.A,samantha:g.Ay,notify:d.Ay,safety:p.Ay,profile:u.Ay,search:_.Ay,social:y.Ay,suggestwords:v.A,resource:h.A,setting:f.Ay,seo:m.Ay},k=e=>{const{httpClient:t,getCommonHeaders:s,getCommonParams:r,baseURL:a,ApiServiceConstructor:l=o.Ay,subApiServiceConstructors:c}=e,d={baseURL:a,request:(e,o)=>{let{params:a,headers:l}=e,c=(0,n.A)(e,b);return t((0,i.A)({params:(0,i.A)((0,i.A)({},null==r?void 0:r()),a),headers:(0,i.A)((0,i.A)((0,i.A)({},null==s?void 0:s()),l),null==o?void 0:o.overrideHeaders)},c),o)}},{apiServiceConstructorOptions:u=d,subApiServiceConstructorOptions:h={bot:u,conversation:u,message:u,dataReport:u,samantha:u,safety:u,notify:u,suggestwords:u,search:u,profile:u,social:u,resource:u,setting:u,seo:u}}=e,p=new l(u);return Object.entries((0,i.A)((0,i.A)({},S),c)).forEach((([e,t])=>{p[e]=new t(h[e])})),p.requestWithPath=e=>(t,s)=>{var n;const o="string"!=typeof d.baseURL?(null===(n=d.baseURL)||void 0===n?void 0:n.call(d,e))||e:`${d.baseURL}${e}`;if(!d.request)throw Error("implement error");return d.request((0,i.A)((0,i.A)({},t),{},{url:t.url||o}),s)},p.rawRequest=(e,t)=>{if(!d.request)throw Error("implement error");return d.request(e,t)},p}},59566:(e,t,s)=>{s.d(t,{Ay:()=>n});var i=s(10633);class n{constructor(e){(0,i.A)(this,"request",(()=>{throw new Error("AliceApiService.request is undefined")})),(0,i.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}CheckUpdate(e,t){const s=this.genBaseURL("/alice/update/check");return this.request({url:s,method:"POST"},t)}GetQuery(e,t){const s=this.genBaseURL("/alice/query"),i=e||{},n={query_text:i.query_text,source:i.source};return this.request({url:s,method:"POST",data:n},t)}LoadVideoTT(e,t){const s=this.genBaseURL("/alice/media/source/2"),i=e||{},n={query:i.query,search_id:i.search_id,item_ids:i.item_ids,offset:i.offset,limit:i.limit};return this.request({url:s,method:"POST",data:n},t)}LoadVideoDY(e,t){const s=this.genBaseURL("/alice/media/source/3"),i=e||{},n={query:i.query,search_id:i.search_id,item_ids:i.item_ids,offset:i.offset,limit:i.limit};return this.request({url:s,method:"POST",data:n},t)}DebugPromptDetail(e,t){const s=this.genBaseURL("/alice/debug/prompt_detail"),i=e||{},n={message_id:i.message_id,type_list:i.type_list};return this.request({url:s,method:"POST",data:n},t)}MCheckMusic(e,t){const s=this.genBaseURL("/alice/media/mcheck/music"),i=e||{},n={check_list:i.check_list,scene:i.scene};return this.request({url:s,method:"POST",data:n},t)}Report(e,t){const s=this.genBaseURL("/alice/report/create"),i=e||{},n={report_type:i.report_type,entity_id:i.entity_id,reason_ids:i.reason_ids,reason_detail:i.reason_detail};return this.request({url:s,method:"POST",data:n},t)}TemplateRecommendRelated(e,t){const s=this.genBaseURL("/alice/template/recommend_related"),i=e||{},n={template_type:i.template_type,template_id:i.template_id,offset:i.offset,size:i.size,enter_time:i.enter_time};return this.request({url:s,method:"POST",data:n},t)}TemplateRecommendList(e,t){const s=this.genBaseURL("/alice/template/recommend_list"),i=e||{},n={template_type:i.template_type,offset:i.offset,size:i.size,token:i.token};return this.request({url:s,method:"POST",data:n},t)}LoadMusicQS(e,t){const s=this.genBaseURL("/alice/media/source/4"),i={vid_list:(e||{}).vid_list};return this.request({url:s,method:"POST",data:i},t)}GetMsgTemplates(e,t){const s=this.genBaseURL("/alice/msg_template/get"),i=e||{},n={cursor:i.cursor,size:i.size,template_lang:i.template_lang,cold_start:i.cold_start};return this.request({url:s,method:"POST",data:n},t)}SearchCards(e,t){const s=this.genBaseURL("/alice/media/card_search"),i=e||{},n={query_params:i.query_params,query_type:i.query_type};return this.request({url:s,method:"POST",data:n},t)}}},7216:(e,t,s)=>{s.d(t,{Ay:()=>n});var i=s(10633);class n{constructor(e){(0,i.A)(this,"request",(()=>{throw new Error("AliceBotApiService.request is undefined")})),(0,i.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}GenBotIcon(e,t){const s=this.genBaseURL("/alice/bot/gen_icon"),i=e||{},n={name:i.name,description:i.description,bot_lang:i.bot_lang};return this.request({url:s,method:"POST",data:n},t)}GenBotIconByPrompt(e,t){const s=this.genBaseURL("/alice/bot/gen_icon_by_prompt"),i=e||{},n={prompt:i.prompt,num:i.num,image_req:i.image_req};return this.request({url:s,method:"POST",data:n},t)}GetBotList(e,t){const s=this.genBaseURL("/alice/bot/get_bot_list"),i=e||{},n={bot_ids:i.bot_ids,bot_list_type:i.bot_list_type,pageIndex:i.pageIndex,pageSize:i.pageSize};return this.request({url:s,method:"POST",data:n},t)}UploadFile(e,t){const s=this.genBaseURL("/alice/bot/upload_file"),i=e||{},n={file_head:i.file_head,data:i.data};return this.request({url:s,method:"POST",data:n},t)}RecommendBots(e,t){const s=this.genBaseURL("/alice/bot/recommend"),i=e||{},n={recommend_type:i.recommend_type,page_index:i.page_index,page_size:i.page_size,bot_ids:i.bot_ids,tag_id:i.tag_id,msg_list:i.msg_list,cold_start:i.cold_start};return this.request({url:s,method:"POST",data:n},t)}LanguageList(e,t){const s=this.genBaseURL("/alice/bot/language_list"),i={bot_id:(e||{}).bot_id};return this.request({url:s,method:"POST",data:i},t)}CreateBot(e,t){const s=this.genBaseURL("/alice/bot/create"),i=e||{},n={name:i.name,description_for_human:i.description_for_human,icon_uri:i.icon_uri,private_status:i.private_status,voice_type:i.voice_type,ugc_voice:i.ugc_voice,bot_lang:i.bot_lang,muted:i.muted,use_bot_enrich:i.use_bot_enrich,enable_web_search:i.enable_web_search,enable_pic_gen:i.enable_pic_gen,first_met:i.first_met,use_bot_enrich_edit:i.use_bot_enrich_edit,create_channel:i.create_channel,bg_img_uri:i.bg_img_uri,bg_img_info:i.bg_img_info,user_bot_gender_starling_key:i.user_bot_gender_starling_key,user_bot_type_starling_key:i.user_bot_type_starling_key,bio:i.bio,original_user_img_uri:i.original_user_img_uri};return this.request({url:s,method:"POST",data:n},t)}EnrichBot(e,t){const s=this.genBaseURL("/alice/bot/enrich"),i=e||{},n={name:i.name,bot_lang:i.bot_lang,need_desc:i.need_desc,need_voice_type:i.need_voice_type,user_bot_gender_starling_key:i.user_bot_gender_starling_key,user_bot_type_starling_key:i.user_bot_type_starling_key,bg_img_prompt:i.bg_img_prompt,data:i.data};return this.request({url:s,method:"POST",data:n},t)}UpdateBot(e,t){const s=this.genBaseURL("/alice/bot/update_bot"),i=e||{},n={bot_id:i.bot_id,name:i.name,description_for_human:i.description_for_human,icon_uri:i.icon_uri,model_type:i.model_type,voice_type:i.voice_type,delete:i.delete,bot_lang:i.bot_lang,muted:i.muted,private_status:i.private_status,ugc_voice:i.ugc_voice,message_push:i.message_push,enable_web_search:i.enable_web_search,enable_pic_gen:i.enable_pic_gen,first_met:i.first_met,bg_img_uri:i.bg_img_uri,bg_img_info:i.bg_img_info,dynamic_img_uri:i.dynamic_img_uri,bot_icon_mapped_app_icon:i.bot_icon_mapped_app_icon,bot_memory_switch_status:i.bot_memory_switch_status,reset_bot_memory_hint_status:i.reset_bot_memory_hint_status,bio:i.bio,original_user_img_uri:i.original_user_img_uri};return this.request({url:s,method:"POST",data:n},t)}VoiceTypeList(e,t){const s=this.genBaseURL("/alice/bot/voice_type_list"),i=e||{},n={bot_id:i.bot_id,bot_language_code:i.bot_language_code};return this.request({url:s,method:"POST",data:n},t)}BotInfo(e,t){const s=this.genBaseURL("/alice/bot/info"),i=e||{},n={token:i.token,botId:i.botId};return this.request({url:s,method:"POST",data:n},t)}GetBotSubject(e,t){const s=this.genBaseURL("/alice/bot/get_bot_subject"),i={bot_id:(e||{}).bot_id};return this.request({url:s,method:"POST",data:i},t)}UpdateCallerName(e,t){const s=this.genBaseURL("/alice/bot/update_caller_name"),i=e||{},n={bot_id:i.bot_id,caller_name:i.caller_name};return this.request({url:s,method:"POST",data:n},t)}GetBotPreset(e,t){const s=this.genBaseURL("/alice/bot/get_bot_preset"),i={bot_id:(e||{}).bot_id};return this.request({url:s,method:"POST",data:i},t)}GetFirstMet(e,t){const s=this.genBaseURL("/alice/bot/first_met"),i={bot_id:(e||{}).bot_id};return this.request({url:s,method:"POST",data:i},t)}GetBot(e,t){const s=this.genBaseURL("/alice/bot/get_bot"),i={bot_id:(e||{}).bot_id};return this.request({url:s,method:"POST",data:i},t)}GetBotListV2(e,t){const s=this.genBaseURL("/alice/bot/get_bot_list_v2"),i=e||{},n={bot_id_list:i.bot_id_list,scene:i.scene};return this.request({url:s,method:"POST",data:n},t)}ActionBarList(e,t){const s=this.genBaseURL("/alice/bot/action_bar_list"),i=e||{},n={language_code:i.language_code,bot_id:i.bot_id,conversation_id:i.conversation_id};return this.request({url:s,method:"POST",data:n},t)}ActionBarOperationReport(e,t){const s=this.genBaseURL("/alice/bot/action_bar_report"),i=e||{},n={language_code:i.language_code,bot_id:i.bot_id,conversation_id:i.conversation_id,action_bar_key:i.action_bar_key,passthrough_field:i.passthrough_field,switch_report:i.switch_report,instruction_report:i.instruction_report};return this.request({url:s,method:"POST",data:n},t)}ActionCards(e,t){const s=this.genBaseURL("/alice/bot/action_cards"),i=e||{},n={bot_id:i.bot_id,card_scene:i.card_scene};return this.request({url:s,method:"POST",data:n},t)}ReviewBotInfo(e,t){const s=this.genBaseURL("/alice/bot/review_bot_info"),i={bot_info:(e||{}).bot_info};return this.request({url:s,method:"POST",data:i},t)}GetAvatarHeadLocation(e,t){const s=this.genBaseURL("/alice/bot/avatar_head_location"),i={image_uri_list:(e||{}).image_uri_list};return this.request({url:s,method:"POST",data:i},t)}GetImgAvgHue(e,t){const s=this.genBaseURL("/alice/bot/get_img_avg_hue"),i={image_uri:(e||{}).image_uri};return this.request({url:s,method:"POST",data:i},t)}CheckBotAuth(e,t){const s=this.genBaseURL("/alice/bot/check_bot_auth"),i=e||{},n={client_key:i.client_key,scope:i.scope,state:i.state};return this.request({url:s,method:"POST",data:n},t)}PluginAuth(e,t){const s=this.genBaseURL("/alice/bot/plugin_auth"),i=e||{},n={bot_id:i.bot_id,plugin_ids:i.plugin_ids,op_type:i.op_type};return this.request({url:s,method:"POST",data:n},t)}PluginDetail(e,t){const s=this.genBaseURL("/alice/bot/plugin_detail"),i={plugin_id:(e||{}).plugin_id};return this.request({url:s,method:"POST",data:i},t)}PluginList(e,t){const s=this.genBaseURL("/alice/bot/plugin_list"),i=e||{},n={bot_id:i.bot_id,page_no:i.page_no,page_size:i.page_size};return this.request({url:s,method:"POST",data:n},t)}GetBotCreateQuota(e,t){const s=this.genBaseURL("/alice/bot/get_bot_create_quota");return this.request({url:s,method:"POST"},t)}Mock(e,t){const s=this.genBaseURL("/alice/bot/mock"),i=e||{},n={delete_current_week:i.delete_current_week,AddTime:i.AddTime,Uid:i.Uid};return this.request({url:s,method:"POST",data:n},t)}EnrichBotCheck(e,t){const s=this.genBaseURL("/alice/bot/enrich_check"),i={enrich_bot_content:(e||{}).enrich_bot_content};return this.request({url:s,method:"POST",data:i},t)}BatchDeleteBotMemory(e,t){const s=this.genBaseURL("/alice/bot/batch_delete_memory"),i=e||{},n={bot_id:i.bot_id,memory_ids:i.memory_ids};return this.request({url:s,method:"POST",data:n},t)}ListBotMemory(e,t){const s=this.genBaseURL("/alice/bot/list_memory"),i=e||{},n={bot_id:i.bot_id,offset:i.offset,limit:i.limit};return this.request({url:s,method:"POST",data:n},t)}ClearBotMemory(e,t){const s=this.genBaseURL("/alice/bot/clear_memory"),i={bot_id:(e||{}).bot_id};return this.request({url:s,method:"POST",data:i},t)}InsertBotMemory(e,t){const s=this.genBaseURL("/alice/bot/insert_memory"),i=e||{},n={bot_id:i.bot_id,memory_content:i.memory_content};return this.request({url:s,method:"POST",data:n},t)}SkillCards(e,t){const s=this.genBaseURL("/alice/bot/skill_cards");return this.request({url:s,method:"POST"},t)}}},89118:(e,t,s)=>{s.d(t,{Ay:()=>n});var i=s(10633);class n{constructor(e){(0,i.A)(this,"request",(()=>{throw new Error("AliceConversationApiService.request is undefined")})),(0,i.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}CreateSubConversation(e,t){const s=this.genBaseURL("/alice/conversation/create_sub_conversation"),i=e||{},n={conversation_id:i.conversation_id,message_id:i.message_id,scene:i.scene};return this.request({url:s,method:"POST",data:n},t)}ConversationPin(e,t){const s=this.genBaseURL("/alice/conversation/pin"),i=e||{},n={conversation_id:i.conversation_id,bot_id:i.bot_id,local_conversation_id:i.local_conversation_id,ext:i.ext};return this.request({url:s,method:"POST",data:n},t)}ConversationUpdate(e,t){const s=this.genBaseURL("/alice/conversation/update"),i=e||{},n={conversation_id:i.conversation_id,name:i.name,local_conversation_id:i.local_conversation_id,bot_id:i.bot_id,ext:i.ext};return this.request({url:s,method:"POST",data:n},t)}ConversationInfo(e,t){const s=this.genBaseURL("/alice/conversation/info"),i=e||{},n={conversation_id:i.conversation_id,bot_id:i.bot_id,local_conversation_id:i.local_conversation_id,ext:i.ext,init_messages:i.init_messages,bot_source:i.bot_source,scene:i.scene};return this.request({url:s,method:"POST",data:n},t)}ConversationUnpin(e,t){const s=this.genBaseURL("/alice/conversation/unpin"),i={conversation_id:(e||{}).conversation_id};return this.request({url:s,method:"POST",data:i},t)}CreateSection(e,t){const s=this.genBaseURL("/alice/conversation/create_section"),i=e||{},n={conversation_id:i.conversation_id,local_conversation_id:i.local_conversation_id,bot_id:i.bot_id,ext:i.ext};return this.request({url:s,method:"POST",data:n},t)}MarkConversationRead(e,t){const s=this.genBaseURL("/alice/conversation/mark_conversation_read"),i=e||{},n={conversation_id:i.conversation_id,latest_read_idx:i.latest_read_idx};return this.request({url:s,method:"POST",data:n},t)}ConversationArchive(e,t){const s=this.genBaseURL("/alice/conversation/archive"),i=e||{},n={conversation_id:i.conversation_id,bot_id:i.bot_id,local_conversation_id:i.local_conversation_id};return this.request({url:s,method:"POST",data:n},t)}ConversationInfoAddBot(e,t){const s=this.genBaseURL("/alice/conversation/add_bot"),i={token:(e||{}).token};return this.request({url:s,method:"POST",data:i},t)}ConversationClear(e,t){const s=this.genBaseURL("/alice/conversation/clear"),i=e||{},n={conversation_id:i.conversation_id,local_conversation_id:i.local_conversation_id,bot_id:i.bot_id,ext:i.ext};return this.request({url:s,method:"POST",data:n},t)}ConversationList(e,t){const s=this.genBaseURL("/alice/conversation/list"),i=e||{},n={index:i.index,batch_size:i.batch_size,conversation_types:i.conversation_types};return this.request({url:s,method:"POST",data:n},t)}ConversationReport(e,t){const s=this.genBaseURL("/alice/conversation/report"),i=e||{},n={conversation_id:i.conversation_id,conversation_type:i.conversation_type,bot_conversation_type:i.bot_conversation_type};return this.request({url:s,method:"POST",data:n},t)}}},58367:(e,t,s)=>{s.d(t,{Cr:()=>i});let i=function(e){return e[e.Coco=1]="Coco",e[e.Bot=2]="Bot",e[e.CocoSub=3]="CocoSub",e[e.CocoWeb=4]="CocoWeb",e[e.CocoWebSub=5]="CocoWebSub",e}({})},8709:(e,t,s)=>{s.d(t,{Ay:()=>n});var i=s(10633);class n{constructor(e){(0,i.A)(this,"request",(()=>{throw new Error("MessageApiService.request is undefined")})),(0,i.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}StreamCallBot(e,t){const s=this.genBaseURL("/alice/message/stream_call_bot"),i={payload:(e||{}).payload};return this.request({url:s,method:"POST",data:i},t)}LoadMusicQS(e,t){const s=this.genBaseURL("/alice/media/source/4"),i=e||{},n={vid_list:i.vid_list,source_id_list:i.source_id_list};return this.request({url:s,method:"POST",data:n},t)}MessageReplay(e,t){const s=this.genBaseURL("/alice/message/replay"),i={payload:(e||{}).payload};return this.request({url:s,method:"POST",data:i},t)}MessageList(e,t){const s=this.genBaseURL("/alice/message/list"),i=e||{},n={conversation_id:i.conversation_id,cursor:i.cursor,batch_size:i.batch_size,bot_id:i.bot_id};return this.request({url:s,method:"POST",data:n},t)}LoadVideoDY(e,t){const s=this.genBaseURL("/alice/media/source/3"),i=e||{},n={query:i.query,search_id:i.search_id,item_ids:i.item_ids,offset:i.offset,limit:i.limit};return this.request({url:s,method:"POST",data:n},t)}SearchCards(e,t){const s=this.genBaseURL("/alice/media/card_search"),i=e||{},n={query_params:i.query_params,query_type:i.query_type};return this.request({url:s,method:"POST",data:n},t)}MessageStream(e,t){const s=this.genBaseURL("/alice/message/stream_reply"),i=e||{},n={seq_st:i.seq_st,seq_ed:i.seq_ed,reply_id:i.reply_id,binary_type:i.binary_type,token:i.token};return this.request({url:s,method:"POST",data:n},t)}MessageReport(e,t){const s=this.genBaseURL("/alice/message/report"),i=e||{},n={message_id:i.message_id,reply_id:i.reply_id,action:i.action,position:i.position,feedbackDetail:i.feedbackDetail,conversation_id:i.conversation_id,feedbackSource:i.feedbackSource};return this.request({url:s,method:"POST",data:n},t)}GetMessageReply(e,t){const s=this.genBaseURL("/alice/message/get_reply"),i=e||{},n={message_id:i.message_id,conversation_id:i.conversation_id};return this.request({url:s,method:"POST",data:n},t)}LoadVideoTT(e,t){const s=this.genBaseURL("/alice/media/source/2"),i=e||{},n={query:i.query,search_id:i.search_id,item_ids:i.item_ids,offset:i.offset,limit:i.limit};return this.request({url:s,method:"POST",data:n},t)}UpdateMsgContent(e,t){const s=this.genBaseURL("/alice/message/update_content"),i=e||{},n={msg_id:i.msg_id,display_content:i.display_content,content:i.content,need_social_adapter:i.need_social_adapter};return this.request({url:s,method:"POST",data:n},t)}LatestMessageList(e,t){const s=this.genBaseURL("/alice/conversation/latest_messagelist"),i={request_list:(e||{}).request_list};return this.request({url:s,method:"POST",data:i},t)}MCheckMusic(e,t){const s=this.genBaseURL("/alice/media/mcheck/music"),i=e||{},n={check_list:i.check_list,scene:i.scene};return this.request({url:s,method:"POST",data:n},t)}GetMsgContent(e,t){const s=this.genBaseURL("/alice/message/content"),i={msg_id:(e||{}).msg_id};return this.request({url:s,method:"POST",data:i},t)}GetAnswerActionContent(e,t){const s=this.genBaseURL("/alice/message/answer_action_content"),i=e||{},n={action_key:i.action_key,msg_id:i.msg_id,bot_id:i.bot_id,conversation_id:i.conversation_id,section_id:i.section_id};return this.request({url:s,method:"POST",data:n},t)}CheckMessageSendRateLimit(e,t){const s=this.genBaseURL("/alice/message/rate_limit");return this.request({url:s,method:"POST"},t)}PutChatRecord(e,t){const s=this.genBaseURL("/alice/message/put_chat_record"),i=e||{},n={conversation_id:i.conversation_id,tool_message_id:i.tool_message_id,switch_message_id:i.switch_message_id};return this.request({url:s,method:"POST",data:n},t)}CmdList(e,t){const s=this.genBaseURL("/alice/message/cmd_list"),i=e||{},n={last_cmd_index:i.last_cmd_index,batch_size:i.batch_size};return this.request({url:s,method:"POST",data:n},t)}MessagePreHandle(e,t){const s=this.genBaseURL("/alice/message/pre_handle"),i=e||{},n={content_type:i.content_type,content:i.content};return this.request({url:s,method:"POST",data:n},t)}MessageListV2(e,t){const s=this.genBaseURL("/alice/message/list/v2"),i=e||{},n={conversation_id:i.conversation_id,start_index:i.start_index,batch_size:i.batch_size,is_reverse:i.is_reverse,end_index:i.end_index};return this.request({url:s,method:"POST",data:n},t)}MessageStreamV2(e,t){const s=this.genBaseURL("/alice/message/stream"),i=e||{},n={seq_st:i.seq_st,seq_ed:i.seq_ed,reply_id:i.reply_id,binary_type:i.binary_type,token:i.token};return this.request({url:s,method:"POST",data:n},t)}SaveBotReply(e,t){const s=this.genBaseURL("/alice/message/save_bot_reply"),i=e||{},n={user_id:i.user_id,conversation_id:i.conversation_id,bot_id:i.bot_id,question_id:i.question_id,contents:i.contents,suggests:i.suggests,source_type:i.source_type,for_historical_question:i.for_historical_question,biz_id:i.biz_id,tenant_id:i.tenant_id};return this.request({url:s,method:"POST",data:n},t)}SaveMessageShareInfo(e,t){const s=this.genBaseURL("/alice/message/share/save"),i=e||{},n={conv_id:i.conv_id,message_id_list:i.message_id_list,enable_generate_title:i.enable_generate_title,is_allow_seo:i.is_allow_seo,share_total_conversation:i.share_total_conversation};return this.request({url:s,method:"POST",data:n},t)}GetMessageShareInfo(e,t){const s=this.genBaseURL("/alice/message/share/get"),i={share_id:(e||{}).share_id};return this.request({url:s,method:"POST",data:i},t)}MessageAfterAuthorization(e,t){const s=this.genBaseURL("/alice/message/after_authorization"),i={scene:(e||{}).scene};return this.request({url:s,method:"POST",data:i},t)}MultiMessagePreHandle(e,t){const s=this.genBaseURL("/alice/message/pre_handle_v2"),i=e||{},n={uplink_entity:i.uplink_entity,conversation_id:i.conversation_id,bot_id:i.bot_id,section_id:i.section_id,local_message_id:i.local_message_id};return this.request({url:s,method:"POST",data:n},t)}MessageEntityState(e,t){const s=this.genBaseURL("/alice/message/entity_state"),i=e||{},n={state_type:i.state_type,entity_info:i.entity_info};return this.request({url:s,method:"POST",data:n},t)}GetBigMusicLyrics(e,t){const s=this.genBaseURL("/alice/media/bigmusic/lyrics"),i=e||{},n={prompt:i.prompt,instruction_options:i.instruction_options};return this.request({url:s,method:"POST",data:n},t)}UpdateBigMusicMsg(e,t){const s=this.genBaseURL("/alice/media/bigmusic/update_message"),i=e||{},n={message_id:i.message_id,title:i.title,cover_uri:i.cover_uri,task_id:i.task_id};return this.request({url:s,method:"POST",data:n},t)}GetBigMusicVideoInfo(e,t){const s=this.genBaseURL("/alice/media/bigmusic/get_video"),i=e||{},n={video_id:i.video_id,share_id:i.share_id,download_params:i.download_params};return this.request({url:s,method:"POST",data:n},t)}MultiMessagePreHandleWithoutConv(e,t){const s=this.genBaseURL("/alice/message/pre_handle_v2_without_conv"),i=e||{},n={uplink_entity:i.uplink_entity,bot_id:i.bot_id,local_message_id:i.local_message_id,pre_generate_id:i.pre_generate_id};return this.request({url:s,method:"POST",data:n},t)}SaveBigMusicShareInfo(e,t){const s=this.genBaseURL("/alice/media/bigmusic/share_save"),i=e||{},n={message_id:i.message_id,task_id:i.task_id};return this.request({url:s,method:"POST",data:n},t)}GetBigMusicLyricsWeb(e,t){const s=this.genBaseURL("/alice/media/bigmusic/lyrics_web"),i=e||{},n={prompt:i.prompt,genre:i.genre,mood:i.mood};return this.request({url:s,method:"POST",data:n},t)}MessageListDouyinPlayback(e,t){const s=this.genBaseURL("/alice/message/douyin_playback"),i=e||{},n={encryption_message_id_list:i.encryption_message_id_list,date:i.date,with_push_message:i.with_push_message};return this.request({url:s,method:"POST",data:n},t)}UpdateBigMusicMsgWeb(e,t){const s=this.genBaseURL("/alice/media/bigmusic/update_message_web"),i=e||{},n={message_id:i.message_id,title:i.title,cover_uri:i.cover_uri,task_id:i.task_id};return this.request({url:s,method:"POST",data:n},t)}GetMessageListByIndexList(e,t){const s=this.genBaseURL("/alice/message/index_list"),i=e||{},n={conversation_id:i.conversation_id,message_index_list:i.message_index_list,is_reverse:i.is_reverse};return this.request({url:s,method:"POST",data:n},t)}UploadEventLog(e,t){const s=this.genBaseURL("/alice/message/event_log"),i=e||{},n={question_id:i.question_id,timestamp:i.timestamp,section_id:i.section_id,conversation_id:i.conversation_id,event_type:i.event_type,key:i.key,value:i.value};return this.request({url:s,method:"POST",data:n},t)}LoadVideoModel(e,t){const s=this.genBaseURL("/alice/media/video_model"),i=e||{},n={query:i.query,search_id:i.search_id,item_ids:i.item_ids,offset:i.offset,limit:i.limit};return this.request({url:s,method:"POST",data:n},t)}}},33206:(e,t,s)=>{s.d(t,{ck:()=>i});let i=function(e){return e[e.EntityType_Unknown=0]="EntityType_Unknown",e[e.EntityType_File=1]="EntityType_File",e[e.EntityType_Image=2]="EntityType_Image",e}({})},60149:(e,t,s)=>{s.d(t,{Ay:()=>n});var i=s(10633);class n{constructor(e){(0,i.A)(this,"request",(()=>{throw new Error("NotifyApiService.request is undefined")})),(0,i.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}GetNoticeGroupUnreadCount(e,t){const s=this.genBaseURL("/alice/notice/get_unread_count"),i={groups:(e||{}).groups};return this.request({url:s,method:"POST",data:i},t)}GetNoticeList(e,t){const s=this.genBaseURL("/alice/notice/list"),i=e||{},n={min_cursor:i.min_cursor,max_cursor:i.max_cursor,count:i.count,need_read_time:i.need_read_time};return this.request({url:s,method:"POST",data:n},t)}MarkReadNotice(e,t){const s=this.genBaseURL("/alice/notice/mark_read"),i=e||{},n={group:i.group,last_read_time:i.last_read_time,mark_count:i.mark_count,groups:i.groups,notice_id:i.notice_id};return this.request({url:s,method:"POST",data:n},t)}GetPushContent(e,t){const s=this.genBaseURL("/alice/notice/push_content"),i=e||{},n={group_id:i.group_id,user_id:i.user_id};return this.request({url:s,method:"POST",data:n},t)}ReportOCPCEvent(e,t){const s=this.genBaseURL("/alice/notice/report_ocpc"),i=e||{},n={landing_page_url:i.landing_page_url,app_id:i.app_id,event_ts:i.event_ts,event_name:i.event_name,event_params:i.event_params};return this.request({url:s,method:"POST",data:n},t)}GetNoticeBanner(e,t){const s=this.genBaseURL("/alice/notice/banner"),i={page_type:(e||{}).page_type};return this.request({url:s,method:"POST",data:i},t)}UpdateRedDot(e,t){const s=this.genBaseURL("/alice/notice/update_red_dot"),i=e||{},n={user_id:i.user_id,all_red_dot:i.all_red_dot,red_dot:i.red_dot};return this.request({url:s,method:"POST",data:n},t)}GetAggregationList(e,t){const s=this.genBaseURL("/alice/notice/agg_list"),i=e||{},n={notice_id:i.notice_id,notice_group:i.notice_group,min_cursor:i.min_cursor,max_cursor:i.max_cursor,count:i.count,bot_id:i.bot_id};return this.request({url:s,method:"POST",data:n},t)}DeleteNotices(e,t){const s=this.genBaseURL("/alice/notice/delete"),i={notice_id_list:(e||{}).notice_id_list};return this.request({url:s,method:"POST",data:i},t)}}},79699:(e,t,s)=>{s.d(t,{Ay:()=>n});var i=s(10633);class n{constructor(e){(0,i.A)(this,"request",(()=>{throw new Error("ProfileApiService.request is undefined")})),(0,i.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}ProfileBotList(e,t){const s=this.genBaseURL("/alice/profile/bot_list"),i=e||{},n={visit_id:i.visit_id,index:i.index,limit:i.limit};return this.request({url:s,method:"POST",data:n},t)}ProfileInfo(e,t){const s=this.genBaseURL("/alice/profile/self"),i={visit_id:(e||{}).visit_id};return this.request({url:s,method:"POST",data:i},t)}CheckProfileInfoDefault(e,t){const s=this.genBaseURL("/alice/profile/info_default"),i={entity_id:(e||{}).entity_id};return this.request({url:s,method:"POST",data:i},t)}UserHitProfileRegister(e,t){const s=this.genBaseURL("/alice/profile/hit_register");return this.request({url:s,method:"POST"},t)}UpdateProfile(e,t){const s=this.genBaseURL("/alice/profile/update_profile"),i=e||{},n={entity_id:i.entity_id,nickname:i.nickname,user_name:i.user_name,avatar_url:i.avatar_url,is_register:i.is_register,user_language_code:i.user_language_code};return this.request({url:s,method:"POST",data:n},t)}CheckUserNameUnique(e,t){const s=this.genBaseURL("/alice/profile/user_name_unique"),i=e||{},n={user_name:i.user_name,entity_id:i.entity_id};return this.request({url:s,method:"POST",data:n},t)}ProfileOverview(e,t){const s=this.genBaseURL("/alice/profile/overview"),i={visit_id:(e||{}).visit_id};return this.request({url:s,method:"POST",data:i},t)}ProfileBrief(e,t){const s=this.genBaseURL("/alice/profile/self_brief");return this.request({url:s,method:"POST"},t)}ReportAwemeOpenID(e,t){const s=this.genBaseURL("/alice/profile/report_aweme_open_id"),i=e||{},n={client_key:i.client_key,open_id:i.open_id};return this.request({url:s,method:"POST",data:n},t)}OperateUserVoice(e,t){const s=this.genBaseURL("/alice/profile/update_user_voice"),i=e||{},n={uid:i.uid,voice_id:i.voice_id,operate:i.operate};return this.request({url:s,method:"POST",data:n},t)}GetUserVoice(e,t){const s=this.genBaseURL("/alice/profile/get_user_voice"),i={uid:(e||{}).uid};return this.request({url:s,method:"POST",data:i},t)}}},44192:(e,t,s)=>{s.d(t,{A:()=>n});var i=s(10633);class n{constructor(e){(0,i.A)(this,"request",(()=>{throw new Error("ResourceApiService.request is undefined")})),(0,i.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}GetFileURL(e,t){const s=this.genBaseURL("/alice/message/get_file_url"),i=e||{},n={uris:i.uris,type:i.type,format:i.format,expire_second:i.expire_second};return this.request({url:s,method:"POST",data:n},t)}UploadImage(e,t){const s=this.genBaseURL("/alice/upload/image"),i=e||{},n={file_type:i.file_type,biz_type:i.biz_type,data:i.data};return this.request({url:s,method:"POST",data:n},t)}FileUpload(e,t){const s=this.genBaseURL("/alice/upload/file"),i=e||{},n={file_type:i.file_type,biz_type:i.biz_type,data:i.data};return this.request({url:s,method:"POST",data:n},t)}GetUploadAuthToken(e,t){const s=this.genBaseURL("/alice/upload/auth_token"),i=e||{},n={scene:i.scene,data_type:i.data_type};return this.request({url:s,method:"POST",data:n},t)}RefreshFileURL(e,t){const s=this.genBaseURL("/alice/upload/refresh_file_url"),i={url:(e||{}).url};return this.request({url:s,method:"POST",data:i},t)}}},57726:(e,t,s)=>{s.d(t,{Ay:()=>n});var i=s(10633);class n{constructor(e){(0,i.A)(this,"request",(()=>{throw new Error("SafetyApiService.request is undefined")})),(0,i.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}AgeGateCheck(e,t){const s=this.genBaseURL("/alice/age_gate/check"),i={scene:(e||{}).scene};return this.request({url:s,method:"POST",data:i},t)}AgeGateReport(e,t){const s=this.genBaseURL("/alice/age_gate/report"),i=e||{},n={birthday:i.birthday,scene:i.scene,pass:i.pass};return this.request({url:s,method:"POST",data:n},t)}AgeGateDelete(e,t){const s=this.genBaseURL("/alice/age_gate/delete"),i={uid:(e||{}).uid};return this.request({url:s,method:"POST",data:i},t)}RedirectByRegion(e,t){const s=this.genBaseURL("/alice/safety/redirect_by_region"),i={key:(e||{}).key};return this.request({url:s,method:"GET",params:i},t)}GetReportReasons(e,t){const s=this.genBaseURL("/alice/safety/report/reasons"),i={report_type:(e||{}).report_type};return this.request({url:s,method:"GET",params:i},t)}ConversationReport(e,t){const s=this.genBaseURL("/alice/safety/report/create/conversation"),i=e||{},n={report_type:i.report_type,conversation_ID:i.conversation_ID,reason_ID:i.reason_ID,reason_detail:i.reason_detail,report_message:i.report_message,report_source:i.report_source,reporter_user_ID:i.reporter_user_ID};return this.request({url:s,method:"POST",data:n},t)}ConversationAppeal(e,t){const s=this.genBaseURL("/alice/safety/conversation/appeal"),i={conversation_id:(e||{}).conversation_id};return this.request({url:s,method:"POST",data:i},t)}UserReport(e,t){const s=this.genBaseURL("/alice/safety/report/create/user"),i=e||{},n={report_type:i.report_type,reporter_user_id:i.reporter_user_id,reported_user_id:i.reported_user_id,reason_id:i.reason_id,reason_detail:i.reason_detail,report_messages:i.report_messages,report_source:i.report_source};return this.request({url:s,method:"POST",data:n},t)}GetReviewReport(e,t){const s=this.genBaseURL("/alice/safety/get_review_report"),i={suppression_notify_id:(e||{}).suppression_notify_id};return this.request({url:s,method:"GET",params:i},t)}SuppressAppeal(e,t){const s=this.genBaseURL("/alice/safety/appeal"),i={suppression_notify_id:(e||{}).suppression_notify_id};return this.request({url:s,method:"POST",data:i},t)}}},34663:(e,t,s)=>{s.d(t,{Ay:()=>n});var i=s(10633);class n{constructor(e){(0,i.A)(this,"request",(()=>{throw new Error("SamanthaApiService.request is undefined")})),(0,i.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}GetFeed(e,t){const s=this.genBaseURL("/samantha/feed");return this.request({url:s,method:"GET"},t)}ThreadList(e,t){const s=this.genBaseURL("/samantha/thread/list"),i=e||{},n={index:i.index,batch_size:i.batch_size};return this.request({url:s,method:"POST",data:n},t)}ThreadDelete(e,t){const s=this.genBaseURL("/samantha/thread/delete"),i=e||{},n={thread_id:i.thread_id,conversation_id:i.conversation_id};return this.request({url:s,method:"POST",data:n},t)}ThreadUpdate(e,t){const s=this.genBaseURL("/samantha/thread/update"),i=e||{},n={thread_id:i.thread_id,conversation_id:i.conversation_id,name:i.name};return this.request({url:s,method:"POST",data:n},t)}ThreadCreate(e,t){const s=this.genBaseURL("/samantha/thread/create"),i=e||{},n={conversation_id:i.conversation_id,message_id:i.message_id,bot_id:i.bot_id};return this.request({url:s,method:"POST",data:n},t)}GetSkillGuidance(e,t){const s=this.genBaseURL("/samantha/skill/guidance"),i=e||{},n={config_key:i.config_key,option_indexes:i.option_indexes};return this.request({url:s,method:"POST",data:n},t)}GetRecommendSkills(e,t){const s=this.genBaseURL("/samantha/skill/recommend");return this.request({url:s,method:"POST"},t)}CreateOrGetMainThread(e,t){const s=this.genBaseURL("/samantha/thread/main/create_or_get");return this.request({url:s,method:"POST"},t)}GetSamanthaWebHitStatus(e,t){const s=this.genBaseURL("/samantha/user/web_hit_status/get");return this.request({url:s,method:"GET"},t)}UpdateSamanthaWebHitStatus(e,t){const s=this.genBaseURL("/samantha/user/web_hit_status/update"),i=e||{},n={status:i.status,hit_source:i.hit_source,remind_time:i.remind_time};return this.request({url:s,method:"POST",data:n},t)}DetectLang(e,t){const s=this.genBaseURL("/samantha/plugin/detect_lang"),i={raw_text:(e||{}).raw_text};return this.request({url:s,method:"POST",data:i},t)}GetThreadShareInfo(e,t){const s=this.genBaseURL("/samantha/thread/share/info"),i=e||{},n={thread_id:i.thread_id,conversation_id:i.conversation_id};return this.request({url:s,method:"POST",data:n},t)}GetThreadShareSnapshot(e,t){const s=this.genBaseURL("/samantha/thread/share/snapshot/get"),i=e||{},n={share_id:i.share_id,need_bot:i.need_bot};return this.request({url:s,method:"POST",data:n},t)}SaveThreadShareInfo(e,t){const s=this.genBaseURL("/samantha/thread/share/save"),i=e||{},n={thread_id:i.thread_id,message_index_end:i.message_index_end,is_allow_seo:i.is_allow_seo,message_index_list:i.message_index_list,save_type:i.save_type,conversation_id:i.conversation_id};return this.request({url:s,method:"POST",data:n},t)}DeleteShareThreadInfo(e,t){const s=this.genBaseURL("/samantha/thread/share/delete"),i={share_id:(e||{}).share_id};return this.request({url:s,method:"POST",data:i},t)}GetTouristFeed(e,t){const s=this.genBaseURL("/samantha/feed/tourist_get");return this.request({url:s,method:"GET"},t)}GetYouTubeShare(e,t){const s=this.genBaseURL("/samantha/plugin/get_youtube_share"),i={share_id:(e||{}).share_id};return this.request({url:s,method:"GET",params:i},t)}CreateYouTubeShare(e,t){const s=this.genBaseURL("/samantha/plugin/youtube_share"),i={content:(e||{}).content};return this.request({url:s,method:"POST",data:i},t)}GetUtmInfo(e,t){const s=this.genBaseURL("/samantha/desktop/get_utm"),i={id:(e||{}).id};return this.request({url:s,method:"GET",params:i},t)}SaveUtmInfo(e,t){const s=this.genBaseURL("/samantha/desktop/save_utm"),i={info:(e||{}).info};return this.request({url:s,method:"POST",data:i},t)}GetLatestCRXInfo(e,t){const s=this.genBaseURL("/samantha/plugin/latest_crx_info");return this.request({url:s,method:"GET"},t)}Txt2Img(e,t){const s=this.genBaseURL("/samantha/cozeplugin/txt2img"),i=e||{},n={ratio:i.ratio,prompt:i.prompt,style:i.style};return this.request({url:s,method:"POST",data:n},t)}Translate(e,t){const s=this.genBaseURL("/samantha/plugin/translate"),i=e||{},n={raw_text:i.raw_text,source_lang:i.source_lang,target_lang:i.target_lang,translate_service:i.translate_service,scene:i.scene};return this.request({url:s,method:"POST",data:n},t)}PluginDeletePromptSkill(e,t){const s=this.genBaseURL("/samantha/plugin/prompt_skill/delete"),i=e||{},n={item_id:i.item_id,user_setting:i.user_setting,frontend_source:i.frontend_source};return this.request({url:s,method:"POST",data:n},t)}PluginAddPromptSkill(e,t){const s=this.genBaseURL("/samantha/plugin/prompt_skill/add"),i=e||{},n={items:i.items,frontend_source:i.frontend_source};return this.request({url:s,method:"POST",data:n},t)}PluginListDiscoverSkills(e,t){const s=this.genBaseURL("/samantha/plugin/prompt_skill/list_discover_skills"),i=e||{},n={page_size:i.page_size,start_index:i.start_index,frontend_source:i.frontend_source};return this.request({url:s,method:"POST",data:n},t)}ListCustomPSByUser(e,t){const s=this.genBaseURL("/samantha/plugin/prompt_skill/list_by_user"),i={frontend_source:(e||{}).frontend_source};return this.request({url:s,method:"POST",data:i},t)}PluginSavePSSetting(e,t){const s=this.genBaseURL("/samantha/plugin/prompt_skill/save_setting"),i=e||{},n={user_setting:i.user_setting,frontend_source:i.frontend_source};return this.request({url:s,method:"POST",data:n},t)}PluginUpdatePromptSkill(e,t){const s=this.genBaseURL("/samantha/plugin/prompt_skill/update"),i=e||{},n={item:i.item,frontend_source:i.frontend_source};return this.request({url:s,method:"POST",data:n},t)}GetSetting(e,t){const s=this.genBaseURL("/samantha/user/setting/get"),i={ab_param:(e||{}).ab_param};return this.request({url:s,method:"POST",data:i},t)}UpdateSetting(e,t){const s=this.genBaseURL("/samantha/user/setting/update"),i={ogf_enable:(e||{}).ogf_enable};return this.request({url:s,method:"POST",data:i},t)}Revise(e,t){const s=this.genBaseURL("/samantha/plugin/revise"),i={items:(e||{}).items};return this.request({url:s,method:"POST",data:i},t)}GetPluginChangeLog(e,t){const s=this.genBaseURL("/samantha/plugin/change_log"),i=e||{},n={version:i.version,language:i.language};return this.request({url:s,method:"GET",params:n},t)}GetPDFOcr(e,t){const s=this.genBaseURL("/samantha/pdf/ocr"),i=e||{},n={file_key:i.file_key,url:i.url,start_page:i.start_page,end_page:i.end_page};return this.request({url:s,method:"POST",data:n},t)}CollectionTagList(e,t){const s=this.genBaseURL("/samantha/collection/tag/list"),i=e||{},n={next_key:i.next_key,limit:i.limit};return this.request({url:s,method:"POST",data:n},t)}CollectionList(e,t){const s=this.genBaseURL("/samantha/collection/list"),i=e||{},n={keyword:i.keyword,tags:i.tags,types:i.types,next_key:i.next_key,limit:i.limit,onboarding:i.onboarding};return this.request({url:s,method:"POST",data:n},t)}CreateCollection(e,t){const s=this.genBaseURL("/samantha/collection/create"),i={collection:(e||{}).collection};return this.request({url:s,method:"POST",data:i},t)}GetCollection(e,t){const s=this.genBaseURL(`/samantha/collection/get/${e.id}`);return this.request({url:s,method:"GET"},t)}AcademicSearch(e,t){const s=this.genBaseURL("/samantha/cozeplugin/academic_search"),i=e||{},n={query:i.query,offset:i.offset,limit:i.limit};return this.request({url:s,method:"GET",params:n},t)}ThreadCreateOrGet(e,t){const s=this.genBaseURL("/samantha/thread/create_or_get"),i={collection_id:(e||{}).collection_id};return this.request({url:s,method:"POST",data:i},t)}DeleteCollection(e,t){const s=this.genBaseURL("/samantha/collection/delete"),i={id:(e||{}).id};return this.request({url:s,method:"POST",data:i},t)}CreateCollectionShare(e,t){const s=this.genBaseURL("/samantha/collection/share/create"),i=e||{},n={collection_id:i.collection_id,enable_seo:i.enable_seo};return this.request({url:s,method:"POST",data:n},t)}GetCollectionShare(e,t){const s=this.genBaseURL(`/samantha/collection/share/${e.share_id}`);return this.request({url:s,method:"GET"},t)}StreamCallBotInToutiao(e,t){const s=this.genBaseURL("/samantha/toutiao/stream_call_bot"),i={payload:(e||{}).payload};return this.request({url:s,method:"POST",data:i},t)}StreamArticleTranslate(e,t){const s=this.genBaseURL("/samantha/plugin/stream_article_translate"),i=e||{},n={raw_text:i.raw_text,target_lang:i.target_lang,translate_service:i.translate_service,scene:i.scene};return this.request({url:s,method:"POST",data:n},t)}UpdatePagesOutline(e,t){const s=this.genBaseURL("/samantha/pages/update_outline"),i=e||{},n={id:i.id,content:i.content,meta:i.meta};return this.request({url:s,method:"POST",data:n},t)}GetPodcastTranscript(e,t){const s=this.genBaseURL("/samantha/plugin/podcast/transcript"),i=e||{},n={url:i.url,type:i.type,resource_url:i.resource_url};return this.request({url:s,method:"POST",data:n},t)}PodcastResourceShouldUpload(e,t){const s=this.genBaseURL("/samantha/plugin/podcast/should_upload"),i=e||{},n={url:i.url,type:i.type};return this.request({url:s,method:"POST",data:n},t)}GetCollectionByFingerprint(e,t){const s=this.genBaseURL(`/samantha/collection/fingerprint/get/${e.fingerprint}`);return this.request({url:s,method:"GET"},t)}SniffUrl(e,t){const s=this.genBaseURL("/samantha/pdf/sniff"),i={urls:(e||{}).urls};return this.request({url:s,method:"POST",data:i},t)}AudioASR(e,t){const s=this.genBaseURL("/samantha/audio/asr"),i=e||{},n={format:i.format,codec:i.codec,rate:i.rate,bits:i.bits,channel:i.channel,language:i.language};return this.request({url:s,method:"GET",params:n},t)}AudioTTS(e,t){const s=this.genBaseURL("/samantha/audio/tts"),i={speaker:(e||{}).speaker};return this.request({url:s,method:"GET",params:i},t)}GetThread(e,t){const s=this.genBaseURL("/samantha/thread/get"),i={collection_id:(e||{}).collection_id};return this.request({url:s,method:"GET",params:i},t)}GetCollectionOnboardingMessage(e,t){const s=this.genBaseURL("/samantha/collection/onboarding_message"),i={collection_id:(e||{}).collection_id};return this.request({url:s,method:"GET",params:i},t)}GetWordContentFromDict(e,t){const s=this.genBaseURL("/samantha/plugin/dict/word"),i=e||{},n={content:i.content,language_target:i.language_target,language_source:i.language_source,use_dict:i.use_dict};return this.request({url:s,method:"POST",data:n},t)}UpdatePages(e,t){const s=this.genBaseURL("/samantha/pages/update"),i=e||{},n={pages_id:i.pages_id,content:i.content,version:i.version,title:i.title};return this.request({url:s,method:"POST",data:n},t)}GetPages(e,t){const s=this.genBaseURL("/samantha/pages/get"),i={pages_id:(e||{}).pages_id};return this.request({url:s,method:"GET",params:i},t)}GetThreadCollectionShareMessages(e,t){const s=this.genBaseURL("/samantha/collection/thread/share"),i=e||{},n={share_id:i.share_id,need_bot:i.need_bot};return this.request({url:s,method:"GET",params:n},t)}GetThreadCollectionMessages(e,t){const s=this.genBaseURL("/samantha/collection/thread/messages"),i={collection_id:(e||{}).collection_id};return this.request({url:s,method:"GET",params:i},t)}GetLatestReadingList(e,t){const s=this.genBaseURL("/samantha/skill/latest_reading_list");return this.request({url:s,method:"POST"},t)}GetTranslationLanguageList(e,t){const s=this.genBaseURL("/samantha/plugin/translation/language_list");return this.request({url:s,method:"GET"},t)}GetSearchCardRecommend(e,t){const s=this.genBaseURL("/samantha/plugin/search/card_recommend"),i=e||{},n={expect_cards:i.expect_cards,exposed_card_ids:i.exposed_card_ids};return this.request({url:s,method:"POST",data:n},t)}UpdateCollectionMemo(e,t){const s=this.genBaseURL("/samantha/collection/memo/update"),i=e||{},n={id:i.id,upsert:i.upsert,remove:i.remove};return this.request({url:s,method:"POST",data:n},t)}SearchPagesImages(e,t){const s=this.genBaseURL("/samantha/pages/search_image"),i=e||{},n={query:i.query,offset:i.offset,limit:i.limit};return this.request({url:s,method:"POST",data:n},t)}ReviewPagesImage(e,t){const s=this.genBaseURL("/samantha/pages/review_image"),i={url_list:(e||{}).url_list};return this.request({url:s,method:"POST",data:i},t)}UploadPagesImage(e,t){const s=this.genBaseURL("/samantha/pages/upload_image"),i=e||{},n={file_type:i.file_type,data:i.data};return this.request({url:s,method:"POST",data:n},t)}}},60258:(e,t,s)=>{s.d(t,{Cr:()=>i});let i=function(e){return e[e.Coco=1]="Coco",e[e.Bot=2]="Bot",e[e.CocoSub=3]="CocoSub",e[e.CocoWeb=4]="CocoWeb",e[e.CocoWebSub=5]="CocoWebSub",e}({})},17732:(e,t,s)=>{s.d(t,{Ay:()=>n});var i=s(10633);class n{constructor(e){(0,i.A)(this,"request",(()=>{throw new Error("SearchApiService.request is undefined")})),(0,i.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}Search(e,t){const s=this.genBaseURL("/alice/comprehensive/search"),i=e||{},n={keyword:i.keyword,index_type:i.index_type,offset:i.offset,size:i.size};return this.request({url:s,method:"POST",data:n},t)}}},15571:(e,t,s)=>{s.d(t,{Ay:()=>n});var i=s(10633);class n{constructor(e){(0,i.A)(this,"request",(()=>{throw new Error("SeoApiService.request is undefined")})),(0,i.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}GetDemo(e,t){const s=this.genBaseURL("/seo_api/demo"),i={pageId:(e||{}).pageId};return this.request({url:s,method:"GET",params:i},t)}GetItem(e,t){const s=this.genBaseURL("/seo_api/item/get"),i={id:(e||{}).id};return this.request({url:s,method:"GET",params:i},t)}GetList(e,t){const s=this.genBaseURL("/seo_api/item/list"),i=e||{},n={page_size:i.page_size,page_num:i.page_num};return this.request({url:s,method:"GET",params:n},t)}GetRecommendList(e,t){const s=this.genBaseURL("/seo_api/item/recommend"),i=e||{},n={page_size:i.page_size,page_num:i.page_num,recommend_type:i.recommend_type};return this.request({url:s,method:"GET",params:n},t)}GetUgcTalkSeoInfo(e,t){const s=this.genBaseURL("/seo_api/ugc/talk"),i={share_id:(e||{}).share_id};return this.request({url:s,method:"GET",params:i},t)}}},99634:(e,t,s)=>{s.d(t,{Ay:()=>n});var i=s(10633);class n{constructor(e){(0,i.A)(this,"request",(()=>{throw new Error("SettingApiService.request is undefined")})),(0,i.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}BanAppeal(e,t){const s=this.genBaseURL("/alice/user/ban_appeal"),i={user_id:(e||{}).user_id};return this.request({url:s,method:"POST",data:i},t)}SyncUserConfig(e,t){const s=this.genBaseURL("/alice/user/config/sync"),i={configs:(e||{}).configs};return this.request({url:s,method:"POST",data:i},t)}CreateBlocklistUser(e,t){const s=this.genBaseURL("/alice/user/blocklist/create"),i={blocklist_user_id:(e||{}).blocklist_user_id};return this.request({url:s,method:"POST",data:i},t)}Launch(e,t){const s=this.genBaseURL("/alice/user/launch"),i=e||{},n={ug_landing_tag:i.ug_landing_tag,select:i.select};return this.request({url:s,method:"POST",data:n},t)}GetFeedbackList(e,t){const s=this.genBaseURL("/alice/user/feedback_list"),i=e||{},n={iid:i.iid,appkey:i.appkey,min_id:i.min_id,max_id:i.max_id,count:i.count};return this.request({url:s,method:"POST",data:n},t)}GetAccountInfo(e,t){const s=this.genBaseURL("/alice/user/get_account_info");return this.request({url:s,method:"POST"},t)}DeleteBlocklistUser(e,t){const s=this.genBaseURL("/alice/user/blocklist/delete"),i={blocklist_user_id:(e||{}).blocklist_user_id};return this.request({url:s,method:"POST",data:i},t)}InnerSSOToken(e,t){const s=this.genBaseURL("/alice/user/inner_sso_token");return this.request({url:s,method:"ANY"},t)}GetTabbarConfig(e,t){const s=this.genBaseURL("/alice/user/tabbar/config");return this.request({url:s,method:"POST"},t)}InnerSSOTokenVerify(e,t){const s=this.genBaseURL("/alice/user/inner_sso_token_verify");return this.request({url:s,method:"POST"},t)}GetUserBlocklist(e,t){const s=this.genBaseURL("/alice/user/blocklist/list"),i=e||{},n={index:i.index,limit:i.limit};return this.request({url:s,method:"POST",data:n},t)}GetWebAnonID(e,t){const s=this.genBaseURL("/alice/user/get_web_anon_id");return this.request({url:s,method:"POST"},t)}PullUserConfig(e,t){const s=this.genBaseURL("/alice/user/config/pull"),i=e||{},n={objects:i.objects,reason:i.reason};return this.request({url:s,method:"POST",data:n},t)}ActHeartbeat(e,t){const s=this.genBaseURL("/alice/user/act_heartbeat");return this.request({url:s,method:"POST"},t)}GetUserOgfQuota(e,t){const s=this.genBaseURL("/alice/user/get_user_ogf_quota");return this.request({url:s,method:"POST"},t)}Dynamic(e,t){const s=this.genBaseURL("/alice/user/dynamic"),i={key_list:(e||{}).key_list};return this.request({url:s,method:"POST",data:i},t)}AuthSuccessReport(e,t){const s=this.genBaseURL("/alice/user/auth_success_report"),i={push_open:(e||{}).push_open};return this.request({url:s,method:"POST",data:i},t)}OpAdvanceSwitch(e,t){const s=this.genBaseURL("/alice/user/op_advance"),i={op_type:(e||{}).op_type};return this.request({url:s,method:"POST",data:i},t)}GetVoiceConfig(e,t){const s=this.genBaseURL("/alice/user/voice_config");return this.request({url:s,method:"POST"},t)}}},80020:(e,t,s)=>{s.d(t,{Ay:()=>n});var i=s(10633);class n{constructor(e){(0,i.A)(this,"request",(()=>{throw new Error("SocialApiService.request is undefined")})),(0,i.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}GetSharePage(e,t){const s=this.genBaseURL("/social/conversation/get_share_page/"),i={share_token:(e||{}).share_token};return this.request({url:s,method:"POST",data:i},t)}}},83071:(e,t,s)=>{s.d(t,{A:()=>n});var i=s(10633);class n{constructor(e){(0,i.A)(this,"request",(()=>{throw new Error("SuggestwordsApiService.request is undefined")})),(0,i.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}GetVideoSuggest(e,t){const s=this.genBaseURL("/alice/suggestwords/get_video_suggest"),i=e||{},n={item_id:i.item_id,item_id_good:i.item_id_good,video_suggest_type:i.video_suggest_type};return this.request({url:s,method:"POST",data:n},t)}GetSuggestWords(e,t){const s=this.genBaseURL("/alice/suggestwords"),i=e||{},n={query_text:i.query_text,source:i.source};return this.request({url:s,method:"POST",data:n},t)}GetTrendsTopic(e,t){const s=this.genBaseURL("/alice/suggestwords/trends_topic");return this.request({url:s,method:"POST"},t)}GetFlowSuggest(e,t){const s=this.genBaseURL("/alice/suggestwords/get_flow_suggest"),i=e||{},n={prompt_content:i.prompt_content,response_content:i.response_content,language:i.language};return this.request({url:s,method:"POST",data:n},t)}GetSuggestWordsComposite(e,t){const s=this.genBaseURL("/alice/suggestwords/composite"),i=e||{},n={query_text:i.query_text,source:i.source};return this.request({url:s,method:"POST",data:n},t)}}},64080:(e,t,s)=>{s.d(t,{B:()=>i});let i=function(e){return e[e.Message=1]="Message",e[e.Cmd=2]="Cmd",e[e.AppAction=3]="AppAction",e}({})},73721:(e,t,s)=>{s.d(t,{o:()=>l});var i=s(44557),n=s(79731),o=s(35803),r=s(52805);const a=o.A.create({timeout:1e4});a.interceptors.response.use((e=>{const{data:t={},headers:s,statusText:i,status:o,config:r}=e;return(0,n.WZ)({responseBody:t,responseHeaders:s,responseStatusText:i,responseStatusCode:o,requestConfig:{url:r.url}})}),(e=>{if((0,r.F0)(e)){const{response:i}=e;if(i){var t,s;const{data:o={},headers:r,statusText:a,status:l}=i;if((0,n.by)(e,null==e||null===(t=e.response)||void 0===t?void 0:t.status))return;(0,n.WZ)({responseBody:o,responseHeaders:r,responseStatusText:a,responseStatusCode:l,requestConfig:{url:null==e||null===(s=e.config)||void 0===s?void 0:s.url}})}}throw e}));const l=(e,t)=>a.request((0,i.A)((0,i.A)({},e),{},{params:(0,i.A)((0,i.A)({},e.params),(null==t?void 0:t.overrideParams)||{})},(null==t?void 0:t.overrideConfig)||{}))},69232:(e,t,s)=>{s.d(t,{j:()=>l});var i=s(44557),n=s(33451),o=s(10633),r=s(22910);const a=["params","headers"];class l{static init(e){if(this._apiService)return;const{httpClient:t,getCommonHeaders:s,getCommonParams:o,baseURL:l,ApiServiceConstructor:c}=e;this._apiService=(0,r.n)({ApiServiceConstructor:c,apiServiceConstructorOptions:{baseURL:l,request:(e,r)=>{let{params:l,headers:c}=e,d=(0,n.A)(e,a);return t((0,i.A)({params:(0,i.A)((0,i.A)({},null==o?void 0:o()),l),headers:(0,i.A)((0,i.A)({},null==s?void 0:s()),c)},d),r)}},httpClient:t})}static checkInit(){if(!this._apiService)throw Error("Flow Api has not initialized")}static get apiService(){return this.checkInit(),this._apiService}}(0,o.A)(l,"_apiService",void 0)},86167:(e,t,s)=>{s.d(t,{P:()=>o,g:()=>r});var i=s(10633),n=s(60588);let o=function(e){return e.UNAUTHORIZED="unauthorized",e.NOACCESS="noAccess",e.SHARK_BLOCK="sharkBlocked",e.COUNTRY_RESTRICTED="countryRestricted",e.CONVERSATION_INVALID="conversationInvalid",e.NEED_TO_WAIT="needToWait",e.USER_BANNED="userBanned",e.USER_BANNED_OTHER="userBannedOther",e.USER_BAN_RELEASE="userBanRelease",e.NETWORK_ERROR="networkError",e}({});const r=new class{constructor(){(0,i.A)(this,"eventEmitter",new n.A),(0,i.A)(this,"started",!0),(0,i.A)(this,"buffer",[])}emit(e,...t){this.started?this.eventEmitter.emit(e,...t):this.buffer.push({event:e,args:t})}on(e,t){this.eventEmitter.on(e,t)}off(e,t){this.eventEmitter.off(e,t)}start(){if(!this.started){this.started=!0;for(const{event:e,args:t}of this.buffer)this.emit(e,...t)}}stop(){this.started=!1}clear(){this.buffer=[]}}},61452:(e,t,s)=>{s.d(t,{_:()=>i});const i=e=>null==e?void 0:e["x-tt-logid"]},43140:(e,t,s)=>{s.d(t,{r:()=>m});var i=s(44557),n=s(14065),o=s(33451),r=s(28159),a=s(41967),l=s(11855),c=s(29019),d=s.n(c),u=s(63159);const h=e=>(0,u.jsxs)("svg",(0,i.A)((0,i.A)({xmlns:"http://www.w3.org/2000/svg",width:17,height:17,fill:"none",viewBox:"0 0 17 17"},e),{},{children:[(0,u.jsx)("g",{clipPath:"url(#white-loading_svg__a)",children:(0,u.jsx)("path",{stroke:"url(#white-loading_svg__b)",strokeLinecap:"round",strokeWidth:1.778,d:"M15.61 8.5A7.111 7.111 0 0 0 2.097 5.405"})}),(0,u.jsxs)("defs",{children:[(0,u.jsxs)("linearGradient",{id:"white-loading_svg__b",x1:2.096,x2:15.611,y1:8.5,y2:8.5,gradientUnits:"userSpaceOnUse",children:[(0,u.jsx)("stop",{stopColor:"#fff",stopOpacity:0}),(0,u.jsx)("stop",{offset:.399,stopColor:"#fff",stopOpacity:.5}),(0,u.jsx)("stop",{offset:1,stopColor:"#fff"})]}),(0,u.jsx)("clipPath",{id:"white-loading_svg__a",children:(0,u.jsx)("path",{fill:"#fff",d:"M.5.5h16v16H.5z"})})]})]})),p=e=>(0,u.jsxs)("svg",(0,i.A)((0,i.A)({xmlns:"http://www.w3.org/2000/svg",width:17,height:17,fill:"none",viewBox:"0 0 17 17"},e),{},{children:[(0,u.jsx)("g",{clipPath:"url(#black-loading_svg__a)",children:(0,u.jsx)("path",{stroke:"url(#black-loading_svg__b)",strokeLinecap:"round",strokeWidth:1.778,d:"M15.61 8.5A7.111 7.111 0 0 0 2.097 5.405"})}),(0,u.jsxs)("defs",{children:[(0,u.jsxs)("linearGradient",{id:"black-loading_svg__b",x1:2.096,x2:15.611,y1:8.5,y2:8.5,gradientUnits:"userSpaceOnUse",children:[(0,u.jsx)("stop",{stopOpacity:0}),(0,u.jsx)("stop",{offset:.399,stopOpacity:.5}),(0,u.jsx)("stop",{offset:1})]}),(0,u.jsx)("clipPath",{id:"black-loading_svg__a",children:(0,u.jsx)("path",{fill:"#000",d:"M.5.5h16v16H.5z"})})]})]})),g={button:"button-YIMk8y",clickable:"clickable-LJsrmr","type-primary":"type-primary-qG4wRn",typePrimary:"type-primary-qG4wRn","type-dashed":"type-dashed-HdUCt6",typeDashed:"type-dashed-HdUCt6","type-danger":"type-danger-ffMO7U",typeDanger:"type-danger-ffMO7U",disabled:"disabled-j3ucAu","width-fit":"width-fit-V3Wkl4",widthFit:"width-fit-V3Wkl4","width-full":"width-full-DHUGO3",widthFull:"width-full-DHUGO3",loading:"loading-kzj8pB",rotate:"rotate-epwdFQ",rotation:"rotation-uKQGyL"},_=["disabled","loading","width","type","onClick","onDisableClick","onLoadingClick","icon","className","style","children"],m=e=>{let{disabled:t=!1,loading:s=!1,width:c="full",type:m="primary",onClick:f,onDisableClick:v,onLoadingClick:y,icon:b,className:S,style:k,children:A}=e,w=(0,o.A)(e,_);const[z,E]=(0,l.useState)(!1),[T,R]=(0,l.useState)(!1),M=z||s,C=T||t,I={setDisabled:R,setLoading:E},L=function(){var e=(0,n.A)((function*(){if(M)return void(null==y||y(I));if(C)return void(null==v||v(I));const e=null==f?void 0:f(I);if(e){E(!0);try{yield e}finally{E(!1)}}}));return function(){return e.apply(this,arguments)}}();return(0,u.jsxs)("div",(0,i.A)((0,i.A)({className:d()(g.button,S,g[`type-${m}`],(0,r.A)(c)?g[`width-${c}`]:void 0,{[g.disabled]:C,[g.clickable]:Boolean(f)&&(Boolean(y)||!s)&&!t}),style:(0,i.A)((0,i.A)({},k),{},{width:(0,a.A)(c)?c:void 0}),onClick:L,"data-disabled":t},w),{},{children:[M?"dashed"===m?(0,u.jsx)(p,{className:d()(g.loading,g.rotate)}):(0,u.jsx)(h,{className:d()(g.loading,g.rotate)}):b,A]}))}},44055:(e,t,s)=>{s.d(t,{Qo:()=>n});var i=s(11855);const n=()=>!1;(0,i.createContext)(null).Provider},61597:(e,t,s)=>{s.d(t,{a:()=>l});var i=s(11855),n=s(97785),o=s(44644),r=s(63159);window.ResizeObserver||(window.ResizeObserver=n.tb);const a={offsetHeight:0,offsetWidth:0,height:0,width:0},l=({children:e,onResize:t})=>{const s=(0,i.useRef)(null),l=(0,i.useRef)(null),c=(0,o.FTe)(t),d=(0,i.useRef)();return(0,i.useLayoutEffect)((()=>{const e=new n.tb((e=>{var t;const i=e.find((e=>e.target===s.current));if(!i)return;const{offsetWidth:n,offsetHeight:o}=i.target,{contentRect:{width:r,height:a},target:u}=i,h={width:r,height:a,offsetWidth:n,offsetHeight:o};null===(t=c.current)||void 0===t||t.call(c,{current:h,previous:d.current,target:u,targetStandBy:l.current}),d.current=h}));return s.current&&e.observe(s.current),()=>{var t;s.current&&(null===(t=c.current)||void 0===t||t.call(c,{current:a,previous:d.current,target:s.current,targetStandBy:l.current}));e.disconnect()}}),[]),(0,r.jsx)(r.Fragment,{children:e(s,l)})}},31218:(e,t,s)=>{s.d(t,{B:()=>R});var i=s(96770),n=s(6693),o=s(11855),r=s(29019),a=s.n(r);let l=function(e){return e.Top="top",e.Bottom="bottom",e.Inner="inner",e}({});var c=s(14065),d=s(44557),u=s(44644);const h="scroll-view-VuVgIp",p="before-ZSZMHg",g="after-nYhsA1",_="content-NfeEi5",m="scrollable-xAHiOl",f="reverse-fWD12d",v="disable-scroll-DBbH6v",y="show-scrollbar-H13q3P",b="auto-show-scrollbar-yUgdkB",S="children-wrapper-tALoJZ",k=(()=>{const e=(0,u.Z57)();if(!e)return!0;const{major:t}=e;return t>=83})(),A=({reverse:e,scrollStatusRef:t})=>{const s=(0,o.useRef)(null),i=(0,o.useRef)(!1),n=()=>{const{current:e}=s;if(!e)throw Error("Not found ScrollView ref instance");return e},r=()=>{const t=n();return e&&!k?t.scrollTop-(t.scrollHeight-t.offsetHeight):t.scrollTop},a=(t,s)=>{const i=n(),o=(t=>{const s=n(),i=t;if((0,u.F_u)()){if(e){const e=s.offsetHeight-s.scrollHeight+1;return Math.max(i,e)}{const e=s.scrollHeight-s.offsetHeight-1;return Math.min(i,e)}}return i})(e&&!k?t+(i.scrollHeight-i.offsetHeight):t);s?i.scrollTo((0,d.A)({top:o},s)):i.scrollTop=o},h=(t,s)=>{if(!i.current)return a((t=>{const s=n();return e?t-(s.scrollHeight-s.offsetHeight):t})(t),s),new Promise((e=>{requestAnimationFrame((()=>{e()}))}))},p=function(){var e=(0,c.A)((function*(){yield h(0)}));return function(){return e.apply(this,arguments)}}(),g=function(){var t=(0,c.A)((function*(t={}){const{smooth:s=!1}=t,{scrollHeight:i,offsetHeight:o}=n();yield h((t=>{const s=n();return e?s.scrollHeight-s.offsetHeight+t:t})(i-o),{behavior:s?"smooth":void 0})}));return function(){return t.apply(this,arguments)}}(),_=()=>{const{current:t}=s;if(!t)return 0;const{scrollHeight:i,offsetHeight:n}=t,o=r();return e?i-(n+-o):o},m=()=>{const{current:e}=s;return e?e.scrollHeight-_()-e.offsetHeight:0};return(0,o.useEffect)((()=>{var e,t;null===(e=s.current)||void 0===e||e.addEventListener("touchstart",(()=>{i.current=!0})),null===(t=s.current)||void 0===t||t.addEventListener("touchend",(()=>{i.current=!1}))}),[]),{ref:s,controller:{scrollTo:h,scrollToTop:p,scrollToBottom:g,getScrollTop:_,getScrollBottom:m,refreshAnchor:()=>{(null==t?void 0:t.current)===l.Top?p():(null==t?void 0:t.current)===l.Bottom&&g()},disableScroll:e=>{var t;i.current=!0,null===(t=s.current)||void 0===t||t.classList.add(e||v),a(r()-1)},enableScroll:e=>{var t;i.current=!1,null===(t=s.current)||void 0===t||t.classList.remove(e||v)},isNearBottom:e=>m()<=e}}};var w=s(14049),z=s(50490),E=s(61597),T=s(63159);const R=(0,o.forwardRef)((function({style:e,className:t,children:s,scrollableClassName:r,before:c,after:d,innerBefore:u,reverse:v=!1,reachTopThreshold:k,onReachTop:R,onLeaveTop:M,reachBottomThreshold:C,onReachBottom:I,onLeaveBottom:L,showScrollbar:x,autoShowScrollbar:U,onScroll:B,bottomAttaching:O=!1},q){const P=v?l.Bottom:l.Top,G=(0,o.useRef)(P),{ref:D,controller:N}=A({reverse:v,scrollStatusRef:G}),{getScrollTop:j,getScrollBottom:F}=N,V=(0,o.useRef)(!1),H=(0,o.useRef)(!1),{className:K,onScroll:W}=(0,w.j)();(0,o.useImperativeHandle)(q,(()=>N),[N]);const J=(0,o.useMemo)((()=>(0,n.A)((e=>{G.current=e}),100)),[]),{handleResize:$}=(({enable:e=!0,controller:t})=>({handleResize:({current:{offsetHeight:s},previous:i})=>{if(!e)return;const n=t.getScrollBottom(),{offsetHeight:o}=null!=i?i:{};o&&(n>=s-o+10||t.scrollToBottom())}}))({controller:N,enable:!v&&O});return(0,T.jsx)(z.a,{containerRef:D,controller:N,children:(0,T.jsxs)("div",{className:a()(h,t),style:e,children:[c&&(0,T.jsx)("div",{className:a()(p),children:(0,i.A)(c)?null==c?void 0:c(N):c}),(0,T.jsx)("div",{className:a()(_),children:(0,T.jsxs)("div",{ref:D,className:a()(m,x&&y,U&&b,{[f]:v},K,r),onScroll:e=>{if(!e.currentTarget)return;null==B||B(e);const{offsetHeight:t}=e.currentTarget,s=null!=k?k:t,i=null!=C?C:t;j()<s?V.current||(V.current=!0,null==R||R()):V.current&&(V.current=!1,null==M||M()),F()<i?H.current||(H.current=!0,null==I||I()):H.current&&(H.current=!1,null==L||L()),G.current=l.Inner,j()<=0&&F()<=0?J(P):j()<=0?J(l.Top):F()<=0?J(l.Bottom):J(l.Inner),W()},children:[(()=>{const e=(0,i.A)(s)?s(N):s;return v?e:(0,T.jsx)(E.a,{onResize:$,children:t=>(0,T.jsx)("div",{ref:t,className:a()(S,"children-wrapper"),children:e})})})(),u&&(0,T.jsx)("div",{className:a()(p),children:(0,i.A)(u)?null==u?void 0:u(N):u})]})}),d&&(0,T.jsx)("div",{className:a()(g),children:(0,i.A)(d)?null==d?void 0:d(N):d})]})})}))},14049:(e,t,s)=>{s.d(t,{j:()=>r});var i=s(6693),n=s(11855);const o="show-scrollbar-thumb-RYti2z",r=()=>{const[e,t]=(0,n.useState)(!1),s=(0,n.useMemo)((()=>(0,i.A)((()=>t(!1)),300,{leading:!1,trailing:!0})),[]),r=(0,n.useCallback)((()=>{e||t(!0),s()}),[e]);return{className:e?o:"",onScroll:r}}},44495:(e,t,s)=>{s.d(t,{p:()=>g});var i=s(44557),n=s(33451),o=s(11855),r=s(29019),a=s.n(r),l=s(34944),c=s(44055),d=s(62277);const u={container:"container-AilALM","hide-scrollbar":"hide-scrollbar-r3YpM5",hideScrollbar:"hide-scrollbar-r3YpM5","custom-scrollbar":"custom-scrollbar-xZDNG1",customScrollbar:"custom-scrollbar-xZDNG1",flow:"flow-xs54Ev"};var h=s(63159);const p=["theme","customScrollbar","hideScrollBar"],g=(0,o.forwardRef)((function(e,t){var s;let{theme:r="flow",customScrollbar:g=!0,hideScrollBar:_=!1}=e,m=(0,n.A)(e,p);const{defaultValue:f,value:v,onChange:y,className:b,"data-testid":S,readOnly:k}=m,A=(0,c.Qo)(),[w,z]=(0,o.useState)(""),E=(0,d.r$)(null!==(s=null!=v?v:w)&&void 0!==s?s:f,!0);return(0,h.jsx)(l.fs,(0,i.A)((0,i.A)((0,i.A)({ref:t,dir:A?E:"ltr"},m),k?{readonly:!0,disabled:void 0}:{disabled:m.disabled}),{},{className:a()(u.container,u[r],b,{[u["custom-scrollbar"]]:g,[u["hide-scrollbar"]]:_}),onChange:(e,t)=>{z(e),null==y||y(e,t)},"data-testid":S}))}));(0,l.ZH)(g,{maintainCursor:!0})},62277:(e,t,s)=>{s.d(t,{r$:()=>l});var i=s(14065),n=s(11855),o=(s(22933),s(44644));const r=["ae","aeb","ajt","apc","apd","ar","ara","arb","arc","arq","ars","ary","arz","ave","avl","bal","bcc","bej","bft","bgn","bqi","brh","cja","ckb","cld","dcc","dgl","div","drw","dv","fa","fas","fia","fub","gbz","gjk","gju","glk","grc","gwc","gwt","haz","he","heb","hnd","hno","iw","ji","kas","kby","khw","ks","kvx","kxp","kzh","lad","lah","lki","lrc","luz","mde","mfa","mki","mvy","myz","mzn","nqo","oru","ota","otk","oui","pal","pbu","per","pes","phl","phn","pnb","pra","prd","prs","ps","pus","rhg","rmt","scl","sd","sdh","shu","skr","smp","snd","sog","swb","syr","tnf","trw","ug","uig","ur","urd","wni","xco","xld","xmn","xmr","xna","xpr","xsa","ydd","yi","yid","zdj"],a=function(){var e=(0,i.A)((function*(e,t=!1){try{const n=e.trim();if(!n)return t;const{franc:a}=yield(0,o.tsJ)((()=>Promise.resolve().then(s.bind(s,6683)))),l=a(n,{minLength:20});return"und"===l?(i=n.charAt(0),new RegExp("^[^A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02b8\u0300-\u0590\u0800-\u1fff\u2c00-\ufb1c\ufdfe-\ufe6f\ufefd-\uffff]*[\u0591-\u07ff\ufb1d-\ufdfd\ufe70-\ufefc]").test(i)):r.includes(l)}catch(n){return t}var i}));return function(t){return e.apply(this,arguments)}}(),l=(e,t=!1)=>{const[s,o]=(0,n.useState)("ltr");return(0,n.useEffect)((()=>{(0,i.A)((function*(){const s=yield a(e,t);o(s?"rtl":"ltr")}))()}),[e,t]),s}},75420:(e,t,s)=>{s.d(t,{B:()=>c,C:()=>l});var i=s(33451),n=s(11855),o=s(63159);const r=["children"],a=(0,n.createContext)({t:(e,t="",s={})=>(console.warn(`Not use I18nProvider to wrapper target component when using translation of ${e}`),t)}),l=e=>{let{children:t}=e,s=(0,i.A)(e,r);return(0,o.jsx)(a.Provider,{value:s,children:t})},c=()=>{const{t:e}=(0,n.useContext)(a);return e}},49059:(e,t,s)=>{s.d(t,{$b:()=>o.$,Gx:()=>n.Gx,Jz:()=>o.J,Vy:()=>i.V,cR:()=>n.cR,gK:()=>n.gK,hD:()=>n.hD});var i=s(55235),n=(s(83015),s(23548),s(45489)),o=s(14255)},45489:(e,t,s)=>{s.d(t,{Gx:()=>o.Gx,cR:()=>n.c,gK:()=>r.g,hD:()=>i.h});var i=s(2034),n=s(76828),o=s(60139),r=s(33087)},29730:(e,t,s)=>{s.d(t,{XB:()=>c});var i=s(33451),n=s(44557),o=s(54096),r=s(6415);const a=["logger"],l=({eventName:e,logger:t=r.v,meta:s,once:i=!1})=>{const a=t,l=[];let c=0,d=!1;const u=()=>{c=Date.now(),a.persist.info({eventName:`${e}_start`,meta:(0,n.A)({},h())})},h=()=>(0,n.A)((0,n.A)({},s),d?{event_has_finished:!0}:{}),p=()=>{if(0!==l.length)return l.reduce(((e,t,s)=>{const{pointName:i}=t;return e[i]=t.time-c,(0,o.A)(e,["interval",i],0===s?e[i]:t.time-l[s-1].time),e}),{})},g=({meta:t}={})=>{i&&d||(a.persist.success({eventName:e,meta:(0,n.A)((0,n.A)({},h()),{},{success:1,duration:p()},t)}),d=!0)};let _;const m=({reason:t,error:s,meta:o})=>{i&&d||(a.persist.error({eventName:e,error:s||new Error(t),meta:(0,n.A)((0,n.A)({},h()),{},{success:0,reason:t,duration:p()},o)}),d=!0)};return u(),{name:"ReportEvent",start:u,cancel:()=>{clearTimeout(_),d=!0},success:g,successIfIdle:(e,t,s)=>{clearTimeout(_),_=setTimeout((()=>d?void 0:(g(t),null==s?void 0:s())),e)},error:m,errorIfIdle:(e,t,s)=>{clearTimeout(_),_=setTimeout((()=>d?void 0:(m(t),null==s?void 0:s())),e)},addDurationPoint:(e,t=!0,s)=>{const i=l.find((t=>t.pointName===e));i?(t&&(i.time=Date.now()),s&&(i.time=s)):l.push({pointName:e,time:s||Date.now()}),l.sort(((e,t)=>e.time-t.time))},getDuration:p,getMeta:h,updateMeta:e=>{s=(0,n.A)((0,n.A)({},s),e)},getFinishStatus:()=>d,setStartTime:e=>{c=e}}},c=e=>{let{logger:t=r.v}=e,s=(0,i.A)(e,a);return l((0,n.A)({logger:t},s))}},88010:(e,t,s)=>{s.d(t,{c:()=>h});var i=s(44557),n=s(33451),o=s(11855),r=s(29019),a=s.n(r),l=s(34944);const c={"samantha-button":"samantha-button-pNbiYm",samanthaButton:"samantha-button-pNbiYm",primary:"primary-R41N0Q",secondary:"secondary-SZcW61",tertiary:"tertiary-i0ofUw",quartary:"quartary-oxqDvJ","ai-primary":"ai-primary-tZmdm_",aiPrimary:"ai-primary-tZmdm_","rotate-anim":"rotate-anim-kwxT3E",rotateAnim:"rotate-anim-kwxT3E","ai-secondary":"ai-secondary-Ia111P",aiSecondary:"ai-secondary-Ia111P","image-primary":"image-primary-IpwCvR",imagePrimary:"image-primary-IpwCvR","image-secondary":"image-secondary-Nv7jUE",imageSecondary:"image-secondary-Nv7jUE","image-tertiary":"image-tertiary-AJDpvJ",imageTertiary:"image-tertiary-AJDpvJ","image-quartary":"image-quartary-KjjOxJ",imageQuartary:"image-quartary-KjjOxJ",large:"large-K8zSnA","icon-only":"icon-only-OVkvZT",iconOnly:"icon-only-OVkvZT",icon:"icon-yU_9dw","icon-right":"icon-right-sFOZGh",iconRight:"icon-right-sFOZGh",medium:"medium-kAPPpg",small:"small-RwsXHR",logo:"logo-jfpKg9"};var d=s(63159);const u=["type","size","logo"],h=o.forwardRef((function(e,t){const{type:s="primary",size:o="medium",logo:r=!1}=e,h=(0,n.A)(e,u),{icon:p,iconPosition:g}=h,_=p||e.loading,m=p&&r;return(0,d.jsx)(l.$n,(0,i.A)((0,i.A)({ref:t},h),{},{theme:"solid",type:"primary",size:"default",className:a()(c["samantha-button"],c[s],c[o],{[c.icon]:_,[c["icon-right"]]:_&&"right"===g,[c["icon-only"]]:_&&!e.children,[c.logo]:m},h.className),children:e.children}))}))},14165:(e,t,s)=>{s(23241)},6570:(e,t,s)=>{s(60588),s(23244),s(14165)},4921:(e,t,s)=>{s(6570),s(14165)},23244:(e,t,s)=>{},62396:(e,t,s)=>{s.d(t,{O:()=>o,e:()=>n});var i=s(49392);const n=e=>{try{return JSON.stringify(e)}catch(t){return console.error({error:t}),""}},o=(e,t)=>{try{return e?JSON.parse(e):{}}catch(s){return(0,i.A)(t)?{}:t}}},36352:(e,t,s)=>{s.d(t,{p:()=>o});var i=s(28159),n=s(9012);const o=e=>t=>{const s=(0,n.A)(t,e);return(0,i.A)(s)?s:""}},38805:(e,t,s)=>{s.d(t,{BK:()=>n});var i=s(49392);function n(e,t,s){return new Promise(((n,o)=>{setTimeout((()=>{s?o(new Error("Mock to reject.")):(0,i.A)(t)?n(void 0):n(t)}),e)}))}}}]);