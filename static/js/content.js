var e,t,n,i={17753:(e,t,n)=>{n.d(t,{C$:()=>_,J2:()=>y,M$:()=>v,Pt:()=>h,U8:()=>l,Y_:()=>p,jI:()=>d});var i=n(44557),o=n(14065),s=n(46694),a=n(89207),r=n(89739);function l(e){return c.apply(this,arguments)}function c(){return(c=(0,o.A)((function*({conversationId:e="0",messageIds:t=[],switchMessageId:n="0"}){yield(0,a.S6)({method:"POST",url:`${r.Jk}/message/put_chat_record`,data:{conversation_id:e,tool_message_id:t,switch_message_id:n}})}))).apply(this,arguments)}function d(e){return u.apply(this,arguments)}function u(){return(u=(0,o.A)((function*(e){return(0,a.S6)({method:"POST",url:`${r.kD}/plugin/detect_lang`,params:(0,s.wH)(),data:{raw_text:e}})}))).apply(this,arguments)}function h(e,t){return m.apply(this,arguments)}function m(){return(m=(0,o.A)((function*(e,t,n=0){return(0,a.S6)({method:"POST",url:`${r.kD}/plugin/translate`,params:(0,s.wH)(),data:{raw_text:e,target_lang:t,source_lang:n}})}))).apply(this,arguments)}function p(e){return g.apply(this,arguments)}function g(){return(g=(0,o.A)((function*(e){return(0,a.S6)({method:"POST",url:`${r.kD}/plugin/revise`,params:(0,s.wH)(),data:{items:e}})}))).apply(this,arguments)}function v(e){return f.apply(this,arguments)}function f(){return(f=(0,o.A)((function*(e){let t=(0,s.wH)();return e&&(t=(0,i.A)((0,i.A)({},t),{},{language:e})),(0,a.S6)({method:"POST",url:`${r.kD}/skill/recommend`,params:t})}))).apply(this,arguments)}function _(e){return x.apply(this,arguments)}function x(){return(x=(0,o.A)((function*(e){const t=(0,s.wH)();return(0,a.S6)({method:"POST",url:`${r.kD}/plugin/search/card_recommend`,params:t,data:e})}))).apply(this,arguments)}function y(e){return b.apply(this,arguments)}function b(){return(b=(0,o.A)((function*(e){const t=(0,s.wH)();return(0,a.S6)({method:"POST",url:`${r.Jk}/user_voice/recommend`,params:t,data:e})}))).apply(this,arguments)}},46694:(e,t,n)=>{n.d(t,{Ql:()=>c,wH:()=>l});var i=n(71905),o=n(58735),s=n(46878),a=n(89739);const r=()=>{const{ttWid:e,webId:t=""}=(0,i.bU)();return e?t:"0"},l=()=>{var e;const{country:t,teaWebId:n,teaUuid:l}=(0,i.bU)();return{version_code:o.br,language:(0,s.XQ)(),browser_language:navigator.language,device_platform:a.lx,aid:a.sZ,pkg_type:a.eG,device_id:r(),web_id:null!==(e=null!=n?n:l)&&void 0!==e?e:"0",is_new_user:"0",region:t,sys_region:t,"use-olympus-account":1,samantha_web:"1"}},c=()=>{const e={},{isEnableDebug:t,extEnv:n}=(0,i.MI)();return t&&n&&(e["x-tt-env"]=n,e["production"===a.nD?"x-use-ppe":"x-use-boe"]="1"),e}},2248:(e,t,n)=>{n.d(t,{CN:()=>o,Im:()=>l,O:()=>a,fv:()=>r,nr:()=>s});var i=n(58735);function o(){return"ontouchend"in document}const s=()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent),a=()=>{var e;return(null===(e=Intl)||void 0===e||null===(e=e.DateTimeFormat())||void 0===e||null===(e=e.resolvedOptions())||void 0===e?void 0:e.timeZone)||""},r=()=>{try{return Boolean(getComputedStyle(document.documentElement||document.body).getPropertyValue("--arc-palette-title"))}catch(e){return!1}};function l(){var e;return i.Hn.some((e=>location.href.includes(e)))||["feishu","lark"].includes(null===(e=window.globalConfig)||void 0===e||null===(e=e.common)||void 0===e?void 0:e.product)}},38042:(e,t,n)=>{n.d(t,{H3:()=>z,Nq:()=>q,PU:()=>D,XQ:()=>B});var i=n(44557),o=n(14065),s=n(78449),a=n(26368),r=n(16604),l=n(72931),c=n(46745),d=n(71905),u=n(88034),h=n(18867),m=n(37311),p=n(26158),g=n(64903),v=n(4601),f=n(59292),_=n(46878),x=n(89739),y=n(305),b=n(48436),w=n(61540),C=n(41650),A=n(41121),S=n(66006),I=n(9639),k=n(46043),j=n(28920),E=n(77960),T=n(45602),N=n(30457),M=n(5644),R=n(51463),L=n(99824),P=n(19552);function B(e){if((0,d.TK)("authInfo").isAuthenticated)switch(e.collectionType){case b.X.TranslateResult:case b.X.ExplainResult:case b.X.TextFragment:!function(e){const{actionMessages:t,currentAction:n,messageCursor:i,boxVisible:o}=I.t_.getState();if(o){var s,a,r;const{messages:o}=S.P.getState(),l=null!==(a=(null!==(s=t[n])&&void 0!==s?s:[])[i])&&void 0!==a?a:"",{text:c="",body:d,originParam:u}=o[l]||{};if(void 0===(null==d||null===(r=d.message)||void 0===r?void 0:r.message_id))return;n===L.EU.explain?((0,C.o2)(e.collectFrom,C.p6.ExplainResult),(0,M.kg)((()=>(0,k.Lv)(d.message.message_id,{selectionText:(null==u?void 0:u.text)||"",explainedText:(0,g.q4)(c)})),(e=>`${x.Vl}/${e.id}`)).then((t=>{var n;null===(n=e.onSuccess)||void 0===n||n.call(e,t.id),(0,C.mL)(e.collectFrom,void 0!==t.id,C.p6.ExplainResult,`${t.id}`)})).catch((()=>{(0,C.mL)(e.collectFrom,!1,C.p6.ExplainResult)})).finally((()=>{var t;null===(t=e.onFinally)||void 0===t||t.call(e)}))):((0,C.o2)(e.collectFrom,C.p6.TranslateResult),(0,M.kg)((()=>{var e;return(0,k.CE)(d.message.message_id,{selectionText:(null==u?void 0:u.text)||"",translate_lang:(null==d||null===(e=d.message)||void 0===e||null===(e=e.ext)||void 0===e?void 0:e.translate)||(0,_.XQ)(),translatedText:(0,g.q4)(c)})}),(e=>`${x.Vl}/${e.id}`)).then((t=>{var n;null===(n=e.onSuccess)||void 0===n||n.call(e,t.id),(0,C.mL)(e.collectFrom,void 0!==t.id,C.p6.TranslateResult,`${t.id}`)})).catch((()=>{(0,C.mL)(e.collectFrom,!1,C.p6.TranslateResult)})).finally((()=>{var t;null===(t=e.onFinally)||void 0===t||t.call(e)})))}else!function(e){const t=I.t_.getState().simpleSelectionBaseInfo;if(void 0===t.anchorOffset)return;const n={contextText:t.contextText,selectionText:t.text,anchorOffset:t.anchorOffset};(0,C.o2)(e.collectFrom,C.p6.textfragment),(0,M.kg)((()=>(0,k.gP)(n)),(e=>`${x.Vl}/${e.id}`)).then((t=>{var n;null===(n=e.onSuccess)||void 0===n||n.call(e,t.id),(0,C.mL)(e.collectFrom,void 0!==t.id,C.p6.textfragment,`${t.id}`)})).catch((()=>{(0,C.mL)(e.collectFrom,!1,C.p6.textfragment)})).finally((()=>{var t;null===(t=e.onFinally)||void 0===t||t.call(e)}))}(e)}(e);break;case b.X.SearchResult:!function(e){const t=e.messageId;if(void 0===t||void 0===e.localMessageId)return;(0,C.o2)(e.collectFrom,C.p6.searchresult);const n=S.P.getState().messages[e.localMessageId],{text:i=""}=n||{},o={searchText:e.userInput||"",generatedText:i};(0,M.kg)((()=>(0,k.Qx)(t,o)),(e=>`${x.Vl}/${e.id}`)).then((t=>{var n;null===(n=e.onSuccess)||void 0===n||n.call(e,t.id),(0,C.mL)(e.collectFrom,void 0!==t.id,C.p6.searchresult,`${t.id}`)})).catch((()=>{(0,C.mL)(e.collectFrom,!1,C.p6.searchresult)})).finally((()=>{var t;null===(t=e.onFinally)||void 0===t||t.call(e)}))}(e);break;case b.X.Web:F(e);break;case b.X.Pdf:U(e);break;case b.X.VideoSummary:K(e);break;case b.X.SocialWebCard:!function(e){const{getSocialWebCardContent:t}=e;if(!t)return;(0,M.kg)((0,o.A)((function*(){const e=yield t();if(!e)throw new Error("\u83b7\u53d6\u793e\u4ea4\u5361\u7247\u6536\u85cf\u4fe1\u606f\u51fa\u9519");const{text_content:n,html_content:i,cover_image_url:o="",source_url:s,content_height:a,content_width:r,body_content:l,content_img_key:c=""}=e;return yield(0,k.y6)({text_content:n,html_content:(0,m.NS)(i,a,r),cover_image_url:o,body_content:l.substr(0,500),content_img_key:c},s)})),(e=>W(e.id.toString()))).then((t=>{var n;null===(n=e.onSuccess)||void 0===n||n.call(e,t.id)})).finally((()=>{var t;null===(t=e.onFinally)||void 0===t||t.call(e)}))}(e)}else(0,N.DT)({trackMeta:{previous_page:"web",login_entrance:"web"}})}function D(e){(0,M.sM)((()=>(0,k.rV)(e))).finally((()=>{h.A.emit("onWebpageSaved",void 0)}))}const F=function(){var e=(0,o.A)((function*(e){if((0,C.o2)(e.collectFrom,C.p6.web),(e=>{if((0,s.OM)())return V(e),!0;if((0,s.ax)()){const t=new URL(location.href),{setVideoId:n,setVideoTitle:i}=A.e.getState(),o=t.searchParams.get("bvid");return n(o||""),i(document.title),E._1.updateVideoSummaryId(""),E._1.updateVideoHighlightsId(""),o?(0,T.S)({videoId:o}).then((e=>E._1.updateTranscriptData.bind(E._1)(e.subtitles))).finally((()=>V(e))):V(e),!0}return!1})(e))return;const t={text_content:"",html_content:"",title:"",dir:"",description:"",cover_image_url:""};let n;if(e.getWebContent||(n=yield(0,p.q)(document),n))(0,M.kg)((0,o.A)((function*(){let i,o;if(e.getWebContent){const n=yield e.getWebContent();if(!n)throw new Error("\u83b7\u53d6\u7f51\u7ad9\u6536\u85cf\u4fe1\u606f\u51fa\u9519");t.text_content=n.text_content,t.html_content=(0,m.NS)(n.html_content,n.content_height,n.content_width),t.title=n.title,t.dir=n.dir,t.cover_image_url=n.cover_image_url,t.description=n.description,i=n.source_url}else if(n){const{imageUrl:e,desc:i}=yield(0,N.l_)();t.text_content=n.textContent,t.html_content=n.content,t.title=n.title,t.dir=n.dir,t.cover_image_url=e,t.description=i}o=yield(0,j.K)(c.e.Web,t.text_content);const s=(0,a.zV)(yield(0,k.N0)(),"image/jpeg"),r=yield(0,f.r)(s);return t.snapshot_img_key=r,yield(0,k.aZ)(t,o,i)})),(e=>`${x.Vl}/${e.id}`)).then((t=>{var n;h.A.emit("onWebpageSaved",t.id),null===(n=e.onSuccess)||void 0===n||n.call(e,t.id),(0,C.mL)(e.collectFrom,void 0!==t.id,C.p6.web,`${t.id}`)})).catch((()=>{(0,C.mL)(e.collectFrom,!1,C.p6.web)})).finally((()=>{var t;null===(t=e.onFinally)||void 0===t||t.call(e)}));else{(0,u.Ay)(location.href)&&(0,u.ow)()&&!window.location.protocol.startsWith("file:")&&U(e)}}));return function(t){return e.apply(this,arguments)}}();function U(e){(0,C.o2)(e.collectFrom,C.p6.pdf),(0,M.kg)((0,o.A)((function*(){const e=window.location.pathname.split("/").pop();return yield(0,k.s6)({url:window.location.href,filename:e||"pdf"})})),(e=>W(e.id.toString()))).then((t=>{var n;null===(n=e.onSuccess)||void 0===n||n.call(e,t.id),h.A.emit("onWebpageSaved",t.id),(0,C.mL)(e.collectFrom,void 0!==t.id,C.p6.pdf,`${t.id}`)})).catch((()=>{(0,C.mL)(e.collectFrom,!1,C.p6.pdf)})).finally((()=>{var t;null===(t=e.onFinally)||void 0===t||t.call(e)}))}function H(e,t=!1){const{sendMessage:n}=S.P.getState(),o=(0,d.TK)("uiLanguage");let s="",a="";const{title:l}=A.e.getState(),c={title:l,url:location.href,transcript_list:e},u={text:location.href,prompt:L.EU.youtube,browser_language:(0,r.wz)(o),current_page:(0,w.M5)(location.href),scene:y.sJ.video_click,sec_scene:y._o.video_click_summarize};return s=n((0,i.A)((0,i.A)({},u),{},{browser_youtube_transcript:{browser_youtube_summary_transcript:JSON.stringify(c)}})),t||(a=n((0,i.A)((0,i.A)({},u),{},{browser_youtube_transcript:{browser_youtube_timeline_transcript:JSON.stringify(c)}}))),{videoSummaryId:s,videoHighlightsId:a}}function z(){return O.apply(this,arguments)}function O(){return(O=(0,o.A)((function*(){const e=E._1.getVideoSummaryMsgBlock(),t=E._1.getTranscriptData();let{videoSummaryId:n,videoHighlightsId:i}=e;const{videoId:o,title:s}=A.e.getState();if(!E._1.hasTranscript()||n&&i){if(!E._1.hasTranscript()){const e=yield(0,R.B9)(),t=H([{offset:0,duration:100,text:(null==e?void 0:e.textContent)||s}],!0);n=t.videoSummaryId,i=t.videoHighlightsId}}else{const e=H(E._1.getTranscriptData());n=e.videoSummaryId,i=e.videoHighlightsId,E._1.updateVideoSummaryId(n),E._1.updateVideoHighlightsId(i)}return{transcript:t,videoId:o,title:s,videoSummaryId:n,videoHighlightsId:i}}))).apply(this,arguments)}const q=function(){var e=(0,o.A)((function*(e,t,n){var i,o;const{transcript:s,videoId:a,title:r,videoSummaryId:c,videoHighlightsId:d}=e,{messages:u}=S.P.getState();let h="",m="";if(c){const{isDone:i,text:o=""}=u[c]||{},s={isDone:!0,text:""},{isDone:a,text:r=""}=d&&u[d]||s;if(h=o,m=r,!i||!a)return void setTimeout((()=>q(e,t,n)),1e3)}const p=c&&(null===(i=u[c])||void 0===i||null===(i=i.body)||void 0===i||null===(i=i.message)||void 0===i?void 0:i.message_id)||"",g=d&&(null===(o=u[d])||void 0===o||null===(o=o.body)||void 0===o||null===(o=o.message)||void 0===o?void 0:o.message_id)||"",v={summary:h,summary_msg_id:p||"",videoParams:{video_type:(0,P.Zv)(),video_url:yield(0,P.PT)(a),title:r,timeline:(0,l.Bq)(m)||[],cover_url:(0,P.mJ)(a),timeline_msg_id_str:g||"",transcript:s?JSON.stringify(s):"",highlights_message_id:d,video_duration:(0,P.qZ)()}};n({collectFrom:t,collectionType:b.X.VideoSummary,videoSummaryResult:v})}));return function(t,n,i){return e.apply(this,arguments)}}();function V(e){return $.apply(this,arguments)}function $(){return($=(0,o.A)((function*(e){(0,M.UK)();const t=yield z();q(t,e.collectFrom,K)}))).apply(this,arguments)}function K(e){if(!e.videoSummaryResult)return;const t=e.videoSummaryResult;(0,C.o2)(C.vP.video_page_summarize,C.p6.videosummary),(0,M.kg)((0,o.A)((function*(){var e,n;null!=t&&null!==(e=t.videoParams)&&void 0!==e&&null!==(e=e.cover_url)&&void 0!==e&&e.startsWith("http")&&(t.videoParams.cover_url=yield(0,v.Vv)(null==t||null===(n=t.videoParams)||void 0===n?void 0:n.cover_url));return yield(0,k.Yb)(t.summary,t.summary_msg_id,t.videoParams)})),(e=>W(e.id.toString()))).then((t=>{var n;h.A.emit("onWebpageSaved",t.id),null===(n=e.onSuccess)||void 0===n||n.call(e,t.id),(0,C.mL)(C.vP.video_page_summarize,void 0!==t.id,C.p6.videosummary,`${t.id}`)})).catch((()=>{(0,C.mL)(C.vP.video_page_summarize,!1,C.p6.videosummary)})).finally((()=>{var t;null===(t=e.onFinally)||void 0===t||t.call(e)}))}const W=e=>`${x.Vl}/${e}`},37311:(e,t,n)=>{n.d(t,{NS:()=>y,l5:()=>f,dp:()=>_,hj:()=>b,cQ:()=>m,gs:()=>h,vg:()=>x});var i=n(14065),o=n(54263);const s=new Map,a=["META","STYLE","SCRIPT","NOSCRIPT"];var r=n(43423),l=n(58735),c=n(4601),d=n(59292),u=n(53435);const h=()=>{var e;return(null===(e=document.head.querySelector("title"))||void 0===e?void 0:e.innerText)||""},m=(e,t)=>{if(!e||!t)return null;let n=e.parentElement;for(;n;){if(n.matches(t))return n;n=n.parentElement}return null},p=e=>{let t=e;return e.startsWith("webkit")&&(t=`-${t}`),t.replace(/([A-Z])/g,(function(e){return`-${e.toLowerCase()}`}))},g=(e,t,n,i,o)=>{try{var c;const{tagName:r}=e;if(a.includes(r))return;const d=e.getAttribute("class");if(null!=d&&d.includes(l.AC))return;Object.keys(e.dataset||{}).forEach((t=>{e.removeAttribute(`data-${p(t)}`)}));const u=window.getComputedStyle(t);if("none"===u.display)return void i.push(e);if(Object.entries(u).forEach((t=>{const[n,i]=t;if(!i||!isNaN(Number(n)))return;const o=(e=>{const t=s.get(e);if(t)return t;const n=document.createElement("div"),i=n.attachShadow({mode:"open"}),o=document.createElement(e);o.style.cssText="color: initial;",i.appendChild(o),"A"===e&&o.setAttribute("href","https://www.ciciai.com/browser-extension/landing"),document.body.insertBefore(n,document.body.firstElementChild);const a=new Map,r=window.getComputedStyle(o);return Object.entries(r).forEach((e=>{const[t,n]=e;n&&isNaN(Number(t))&&a.set(t,n)})),s.set(e,a),n.remove(),a})(r).get(n);o!==i&&(e.style[p(n)]=i)})),null!==(c=e.style.backgroundImage)&&void 0!==c&&c.includes("url")){const t=e.style.backgroundImage.substring(5,e.style.backgroundImage.length-2),n=o.get(t);n?n.push(e):o.set(t,[e])}if("IMG"===r){const{src:t}=e,n=o.get(t);n?n.push(e):o.set(t,[e])}else if("A"===r&&"A"===t.tagName)e.setAttribute("href",null==t?void 0:t.href),e.setAttribute("target","_blank");else{if("SVG"===r)return;if("VIDEO"===r){const t=e.getAttribute("poster");if(t){const n=o.get(t);n?n.push(e):o.set(t,[e])}}}for(let s=0;s<t.children.length&&s<e.children.length;s++)n.pushTask((()=>g(e.children[s],t.children[s],n,i,o)))}catch(d){(0,r.z3)("[collection] cloneDom error: ",d)}},v=function(){var e=(0,i.A)((function*(e,t){if(e)try{const n=yield(0,c.n_)(e);if(null!=n&&n.blob){const e=yield(0,d.r)(n.blob);t.forEach((t=>t.setAttribute(u.$_,e)))}}catch(n){return void(0,r.z3)("[collection] uploadImage error",n,e)}}));return function(t,n){return e.apply(this,arguments)}}(),f=function(){var e=(0,i.A)((function*(e,t=!0){const n=new Map,i=[],s=[];try{(0,r.Rm)("[collection] start clone dom"),yield new Promise((a=>{const r=new o.E(a);e.forEach((e=>{const o=e.cloneNode(!0);if(t){const e=document.createElement("div");e.appendChild(o),s.push(e)}else s.push(o);r.pushTask((()=>g(o,e,r,i,n)))})),r.loop()})),(0,r.Rm)("[collection] start upload img"),yield Promise.race([Promise.all([...n].map((e=>v(e[0],e[1])))),new Promise((e=>{setTimeout((()=>{e(),(0,r.Rm)("[collection] uploadImage timeout")}),6e4)}))]),(0,r.Rm)("[collection] start remove useless tag"),i.forEach((e=>e.remove())),s.forEach((e=>{e.querySelectorAll(`[class*=${l.AC}]`).forEach((e=>e.remove())),a.forEach((t=>e.querySelectorAll(t.toLocaleLowerCase()).forEach((e=>e.remove()))))}))}catch(c){(0,r.z3)("[collection] clone dom error: ",c)}return(0,r.Rm)("[collection] clone done"),s}));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=(0,i.A)((function*(e,t=!0){const n=yield f([e],t);return n.length?n[0]:e.cloneNode(!0)}));return function(t){return e.apply(this,arguments)}}(),x=e=>{null!=e&&e.style&&(e.style.height="unset",e.style.minHeight="unset",e.style.blockSize="unset",e.style.minBlockSize="unset")},y=(e,t,n)=>{const i=document.createElement("div");i.innerHTML='<iframe\n  scrolling="no"\n  frameBorder="no"\n  allowFullScreen="true"\n  sandbox="allow-popups allow-same-origin"></iframe>';const o=i.querySelector("iframe");return o?(o.style.width="100%",o.style.height=`${t}px`,o.style.width=`${n}px`,o.srcdoc=`<html>\n        <head>\n          <style>\n            * {\n              cursor: unset !important;\n            }\n            body {\n              padding: 0;\n              margin: 0;\n            }\n            a {\n              cursor: pointer !important;\n            }\n          </style>\n        </head>\n        <body>\n          ${e}\n        </body>\n      </html>`,i.innerHTML):e},b=e=>{const t=document.createElement("div");return t.style.overflow="hidden",t.style.display="flex",t.style.alignItems="center",t.style.flexWrap="nowrap",t.style.flexDirection="column",t.style.width=`${e}px`,t}},58735:(e,t,n)=>{n.d(t,{$9:()=>v,AC:()=>A,AJ:()=>y,BW:()=>k,Be:()=>I,Cp:()=>a,EP:()=>r,GW:()=>b,Hn:()=>T,JE:()=>l,M0:()=>f,OD:()=>C,Ow:()=>j,QN:()=>o,R3:()=>u,U6:()=>g,Yq:()=>m,aJ:()=>E,aS:()=>w,br:()=>s,hs:()=>p,j0:()=>d,ly:()=>h,o$:()=>i,o2:()=>c,sp:()=>S,tI:()=>x,tm:()=>_});const i="cici_host_style",o="static/css/content_list.json",s=20650,a="/browser-extension",r=`${a}/login`,l=`${a}/welcome`,c=`${a}/landing`,d=`${a}/uninstall`,u="doubao",h=`${u}-ai-csui`,m=`${u}-ai-assistant`,p=`${u}-ai-deep-search-assistant`,g=`${u}-ai-search-engine-assistant`,v=`${u}-ai-video-summary-assistant`,f=`${u}-ai-video-summary-assistant-fs-sidebar`,_=`${u}-ai-immersion-btn`,x=`${u}-ai-video-memo-btn`,y=`${u}-ai-mail-assistant`,b=`${u}-ai-revision-highlighter`,w=`${u}-ai-revision-popup-card`,C=`${u}-ai-pdf-assistant`,A=`${u}-ai-collection-assistant`,S=`${u}-ai-podcast-assistant`,I="710022013",k="710012001",j="2147483647",E="86",T=["larkoffice.com/wiki","larkoffice.com/docx","feishu.cn/wiki","feishu.cn/docx"]},69021:(e,t,n)=>{n.d(t,{Ig:()=>_,Ku:()=>x,LE:()=>k,NR:()=>m,QN:()=>C,V6:()=>A,VT:()=>h,XX:()=>f,YB:()=>g,ZP:()=>w,f9:()=>p,jg:()=>j,mn:()=>y,ow:()=>b});var i=n(14065),o=n(9012),s=n(11855),a=n(75541),r=n(43423),l=n(58735),c=n(2248),d=n(31525);function u(e){e.stopPropagation()}const h=e=>{const t=document.createElement(e);var n;t.id=l.Yq,n=t,["click","copy","cut","paste","keydown","keyup","keypress"].forEach((e=>{n.addEventListener(e,u,!1)}));const i=t.attachShadow({mode:"open"}),o=document.createElement("div");o.id="ciciai-shadow-container",o.classList.add("cici-ext-container"),o.style.zIndex=(0,c.Im)()?l.aJ:l.Ow,o.style.position="absolute";let s=0,a=0;if("relative"===window.getComputedStyle(document.body).position){const e=document.body.getBoundingClientRect(),t=document.documentElement.getBoundingClientRect(),n={top:t.top-e.top,left:t.left-e.left};s+=n.top,a+=n.left}return o.style.top=`${s}px`,o.style.left=`${a}px`,o.style.visibility="visible",i.appendChild(o),{shadowHost:t,shadowRoot:i,shadowContainer:o}};const m=function(){var e=(0,i.A)((function*(e,t){try{const n=yield fetch(chrome.runtime.getURL(t)),i=(yield n.json()).content_css,o=yield Promise.all(i.map((e=>fetch(chrome.runtime.getURL(e))))),s=yield Promise.all(o.map((e=>e.text()))),a=s.join("\n"),r=document.createElement("style");r.className=l.o$,r.textContent=a,e.prepend(r)}catch(n){console.error(`Error applying styles: ${n.message}`)}}));return function(t,n){return e.apply(this,arguments)}}();function p(e){e.querySelectorAll(`.${l.o$}`).forEach((e=>e.remove()))}const g=e=>{document.body.appendChild(e)};let v;const f=(e,t)=>{if(v)try{v.unmount()}catch(n){(0,r.Rm)("unmount fail",n)}v=(0,a.createRoot)(e),v.render(s.createElement(t)),(0,d.A)((()=>{var e;null===(e=v)||void 0===e||e.unmount(),v=void 0}))};function _(e,t){var n;const i=new ClipboardEvent("paste",{clipboardData:new DataTransfer,bubbles:!0,cancelable:!0});null===(n=i.clipboardData)||void 0===n||n.setData("text/plain",e),t.dispatchEvent(i)}function x(e){return e&&("INPUT"===e.nodeName||"TEXTAREA"===e.nodeName)}function y(e){if(!e.isContentEditable){let n=e.parentElement;for(let i=0;i<10&&n;i++){var t;if(null!==(t=n)&&void 0!==t&&t.isContentEditable){e=n;break}n=n.parentElement}}if(e.isContentEditable){let t=e;for(;null!==(n=t)&&void 0!==n&&null!==(n=n.parentElement)&&void 0!==n&&n.isContentEditable;){var n;t=t.parentElement}return t}return null}function b(e){const t=getComputedStyle(e);return!("0"===t.opacity||"none"===t.display||"hidden"===t.visibility)}function w(){return!/\.(google|baidu|bing)\.com/.test(location.hostname)}function C(e){const t=e;return("INPUT"===t.tagName&&["text","search",""].includes(t.type)||"TEXTAREA"===t.tagName)&&!(t.disabled||t.readOnly)}function A(e,t){let n=null,i=null;const s=(0,o.A)(t,"maxWait",1e3);function a(){n&&(clearInterval(n),n=null)}return new Promise((r=>{const l=()=>{const n=(0,o.A)(t,"wrapper",document).querySelector(e);n&&(a(),i&&(clearTimeout(i),i=null),r(n))};n=window.setInterval(l,100),i=window.setTimeout((()=>{a(),r(null)}),s),l()}))}const S="Cici-ai-assistant",I="doubao-ai-assistant",k=e=>[S,I].includes(e);function j(e){let t=e;for(;t;){if(t.id===S||t.id===I)return!0;t=t.parentElement}return!1}},41351:(e,t,n)=>{n.d(t,{_:()=>i});const i={windowId:-1,get isInSidePanel(){return location.href.startsWith(chrome.runtime.getURL("side_panel.html"))}}},34350:(e,t,n)=>{n.d(t,{Gj:()=>r,HF:()=>p,L2:()=>l,Nf:()=>u,Yh:()=>h,e6:()=>c,od:()=>g,p2:()=>d});var i,o,s=n(14065);const a=null===(i=globalThis.chrome)||void 0===i?void 0:i.runtime,r=()=>{if(!a)throw new Error("Extension runtime is not available");return a},l=(null===(o=globalThis.chrome)||void 0===o||o.tabs,()=>"\u8c46\u5305"),c=function(){var e=(0,s.A)((function*(){const e=yield chrome.tabs.query({active:!0,currentWindow:!0});return e.length?e[0]:null}));return function(){return e.apply(this,arguments)}}(),d=(e,t="https:",n=32)=>`https://s2.googleusercontent.com/s2/favicons?domain=${t}//${e}&sz=${n}`,u=()=>chrome.runtime.getURL("assets/icon.png"),h=e=>chrome.runtime.getURL(`options.html${null!=e?e:""}`);let m="";const p=()=>(m||(m=chrome.runtime.getManifest().version),m),g=function(){var e=(0,s.A)((function*(e){return yield chrome.i18n.detectLanguage(e)}));return function(t){return e.apply(this,arguments)}}()},13959:(e,t,n)=>{n.d(t,{A:()=>o});var i=n(11855);function o(e){const t=(0,i.useRef)(null),n=n=>{var i;const o=null===(i=n.composedPath)||void 0===i?void 0:i.call(n);o&&t.current&&!o.includes(t.current)&&e(n)};return(0,i.useEffect)((()=>(document.addEventListener("pointerdown",n),()=>{document.removeEventListener("pointerdown",n)})),[]),t}},62325:(e,t,n)=>{n.d(t,{Ay:()=>c,N:()=>a,Vk:()=>l,nW:()=>s});var i=n(14065),o=n(11855);const s=e=>/^https:\/\/mail\.google\.com\/mail\/u\/\d+\//.test(e),a=e=>{if("gmail"!==e)return[];const t=[],n=document.querySelectorAll('[class="btC"]');for(const o of n){var i;const e=o.parentElement;if(!e)continue;const n=null===(i=e.closest("tr"))||void 0===i||null===(i=i.previousElementSibling)||void 0===i||null===(i=i.querySelector('[hidefocus="true"]'))||void 0===i?void 0:i.parentElement;n&&t.push([e,n])}return t},r=e=>{const t='[class="btC"]';return!(!e.matches(t)&&!e.matches(`:has(${t})`))},l=(0,o.createContext)(null),c=e=>{if(s(e)){return{name:"gmail",watchMailWritable:e=>{const t=new MutationObserver((function(t){for(const n of t)"childList"===n.type&&n.addedNodes.length>0&&n.addedNodes.forEach(function(){var t=(0,i.A)((function*(t){yield new Promise((e=>setTimeout(e,50))),t instanceof HTMLElement&&r(t)&&e()}));return function(e){return t.apply(this,arguments)}}())}));return t.observe(document.body,{childList:!0,subtree:!0}),()=>{t.disconnect()}}}}return null}},83712:(e,t,n)=>{n.d(t,{Iq:()=>d,UL:()=>c});var i=n(44557),o=n(14065),s=n(33451),a=n(43423),r=n(34350);const l=["tabId"];function c(e,t=1e4){const{tabId:n}=e,i=(0,s.A)(e,l);return Promise.race([new Promise((e=>{try{chrome.tabs.sendMessage(n,i,(t=>{var n;chrome.runtime.lastError?("tab-activated"!==i.name&&(0,a.z3)(`[ms][bg][runtime.lastError]${i.name}`,chrome.runtime.lastError),e({success:!1,error:new Error(`[${i.name}]${null===(n=chrome.runtime.lastError)||void 0===n?void 0:n.message}`),data:t})):null!=t&&t.__hasError?e({success:!1,error:new Error(t.errorMessage)}):e({success:!0,data:t})}))}catch(t){e({success:!1,error:t})}})),new Promise((e=>{setTimeout((()=>e({success:!1,error:new Error("timeout")})),t)}))])}function d(e){return u.apply(this,arguments)}function u(){return(u=(0,o.A)((function*(e,t=1e4){const n=yield(0,r.e6)();if(!n)return Promise.resolve({success:!1,data:{}});const o="string"==typeof e?{name:e}:e;return c((0,i.A)({tabId:n.id},o),t)}))).apply(this,arguments)}},39275:(e,t,n)=>{n.d(t,{Iq:()=>o.Iq,UL:()=>o.UL,cs:()=>i.c});var i=n(11021),o=n(83712)},13748:(e,t,n)=>{n.d(t,{F:()=>r,c:()=>l});var i=n(14065),o=n(10633),s=n(91689),a=n(43423);const r=new class{constructor(){var e,t;(0,o.A)(this,"handlers",{}),(0,o.A)(this,"interceptors",[]),null===(e=chrome)||void 0===e||null===(e=e.runtime)||void 0===e||null===(e=e.onMessage)||void 0===e||null===(t=e.addListener)||void 0===t||t.call(e,this.onMessage.bind(this)),this.interceptors=[],this.handlers={}}onMessage(e,t,n){let o=!1;this.interceptors.forEach((i=>{o=o||Boolean(i.onMessage(e,t,n))}));const s=this.handlers[e.name];var r;return(0,a.Rm)(`[runtime] onMessage -> [${e.name}][${s?"yes":"no"}] `,e.body||""),!!s&&(!s.preCheck||null!==(r=s.preCheck)&&void 0!==r&&r.call(s,t)?((0,i.A)((function*(){try{const i=yield s.handle(e.body,t);n(i)}catch(i){n({__hasError:!0,errorMessage:`${i.message}[${e.name}]`})}}))(),!0):o)}supportExternal(){var e,t;null===(e=chrome)||void 0===e||null===(e=e.runtime)||void 0===e||null===(e=e.onMessageExternal)||void 0===e||null===(t=e.addListener)||void 0===t||t.call(e,this.onMessage.bind(this))}register(e){const{name:t}=e||{};t&&(this.handlers[t]&&(0,a.z3)(`[runtime] handler name[${t}] duplicated !`),(0,a.Rm)(`[runtime] register handler for event: [${t}]`),this.handlers[t]=e)}unregister(e){delete this.handlers[e]}injectInterceptor(e){this.interceptors.push(e)}destroy(){this.handlers={},this.interceptors=[];try{chrome.runtime.onMessage.removeListener(this.onMessage)}catch(e){}}},l=e=>{const t=(0,s.A)(e)?e:[e];return t.forEach((e=>{r.register(e)})),()=>{t.forEach((e=>{r.unregister(e.name)}))}}},65144:(e,t,n)=>{n.d(t,{F8:()=>f});var i=n(44557),o=n(10633),s=n(26937),a=n(58414),r=n(51484),l=n(79935),c=n(63529),d=n(72959),u=n(50427),h=n(22083),m=n(41666),p=n(13748),g=n(34350),v=n(34198);const f=new class{constructor(e){var t,n,d,f,_,x,y,b,w,C;(0,o.A)(this,"jsMonitor",void 0),(0,o.A)(this,"promiseMonitor",void 0),(0,o.A)(this,"fetchMonitor",void 0),(0,o.A)(this,"crashMonitor",void 0),(0,o.A)(this,"bid",void 0),(0,o.A)(this,"crashLog",void 0),(0,o.A)(this,"region",void 0),(0,o.A)(this,"_options",void 0),(0,o.A)(this,"client",void 0),(0,o.A)(this,"prepared",!1),(0,o.A)(this,"start",((e={})=>{if(self){const t=(0,c.m)(),n=(0,g.HF)();this.client.init((0,i.A)({env:"public",release:n,version:n,bid:this.bid,transport:{get:t.get,post:t.post}},e)),this.client.start(),this.runBgMonitors(),this.addMessageListeners(),(0,m.sN)(this),this.prepared=!0}})),(0,o.A)(this,"config",(e=>{this.client.config(e)})),(0,o.A)(this,"runBgMonitors",(()=>{var e;(this.jsMonitor&&new a.A(this.region),this.promiseMonitor&&new s.A(this.region),this.fetchMonitor)&&new r.A({region:this.region,rule:null===(e=this._options.plugins)||void 0===e?void 0:e.fetchInterceptRule});this.crashMonitor&&new l.A(this.region,this.crashLog)})),(0,o.A)(this,"addMessageListeners",(()=>{const e=this,t={name:"slardar-message",handle:t=>{const{type:n,data:i}=t||{};switch(n){case h.O4.CONTENT_EVENT:e.sendEvent(i);break;case h.O4.CONTENT_LOG:case h.O4.CONTENT_PERF_EVENT:e.sendLog(i)}}};(0,p.c)(t)})),(0,o.A)(this,"sendEvent",(e=>{var t,n;this.prepared&&(null===(t=(n=this.client).sendEvent)||void 0===t||t.call(n,e),(0,v.v)({type:"slardar",payload:e,action:"event"}))})),(0,o.A)(this,"sendLog",(e=>{var t,n;this.prepared&&(null===(t=(n=this.client).sendLog)||void 0===t||t.call(n,e),(0,v.v)({type:"slardar",payload:e,action:"log"}))})),this.jsMonitor=null===(t=null==e||null===(n=e.plugins)||void 0===n?void 0:n.jsMonitor)||void 0===t||t,this.promiseMonitor=null===(d=null==e||null===(f=e.plugins)||void 0===f?void 0:f.promiseMonitor)||void 0===d||d,this.fetchMonitor=null===(_=null==e||null===(x=e.plugins)||void 0===x?void 0:x.fetchMonitor)||void 0===_||_,this.crashMonitor=null===(y=null==e||null===(b=e.plugins)||void 0===b?void 0:b.crashMonitor)||void 0===y||y,this.bid=e.bid,this.crashLog=null!==(w=null==e||null===(C=e.log)||void 0===C?void 0:C.crashLog)&&void 0!==w&&w,this.region=(0,u.J)(),this._options=e,this.client=(0,u.K)(this.region)}configExtraInfo(e){d.A.recordExtraInfo(e)}}({bid:"flow_web_ext",plugins:{promiseMonitor:!1,crashMonitor:!1}})},88034:(e,t,n)=>{n.d(t,{Ay:()=>a,Er:()=>s,ow:()=>o});var i=n(11855);const o=()=>{const e=document.querySelector("embed");return"EMBED"===(null==e?void 0:e.nodeName)&&"application/pdf"===(null==e?void 0:e.type)},s=(0,i.createContext)(null),a=e=>(e=>/^https:\/\/arxiv\.org\/abs\/\d+\.\d+/.test(e))(e)?{name:"arxiv",prevNodeQuery:"a.download-pdf"}:o()?{name:"pdf"}:null},24768:(e,t,n)=>{n.d(t,{Ay:()=>c,Dd:()=>r,gw:()=>a,s6:()=>l});var i=n(11855);let o=window.location.href,s=window.location.href;const a=e=>/^https:\/\/www\.xiaoyuzhoufm\.com\/episode\/\w+/.test(e),r=e=>/^https:\/\/podcasts\.apple\.com\/\w+\/podcast\/.+\/id\w+\?i=\w+/.test(e),l=(0,i.createContext)(null),c=e=>a(e)||(e=>{const t=/^https:\/\/www\.xiaoyuzhoufm\.com\/podcast\/\w+/.test(e),n=/^https:\/\/www\.xiaoyuzhoufm\.com\/collection\/episode\/\w+/.test(e);return t||n})(e)?{name:"xiaoyuzhou",buttonContainerNodeQuery:".podcast-title",headerNodeQuery:"header",audioQuery:"audio",checkPodcastDetail:e=>a(e),watchRouteChange(e){const t=setInterval((function(){window.location.href!==o&&(o=window.location.href,a(window.location.href)&&e())}),1e3);return()=>{window.clearInterval(t)}}}:r(e)||(e=>/^https:\/\/podcasts\.apple\.com\/\w+\/podcast\/.+\/id\w+/.test(e))(e)?{name:"applepodcast",headerNodeQuery:"picture",audioQuery:"audio",checkPodcastDetail:e=>r(e),watchRouteChange(e){const t=setInterval((function(){window.location.href!==s&&(s=window.location.href,r(window.location.href)&&e())}),1e3);return()=>{window.clearInterval(t)}}}:null},99824:(e,t,n)=>{n.d(t,{AA:()=>m,EU:()=>i,HO:()=>o,Hh:()=>u,I8:()=>g,R1:()=>s,Tz:()=>c,WN:()=>h,Xt:()=>p,YN:()=>_,aX:()=>l,em:()=>x,fS:()=>v,tE:()=>f,y3:()=>r});var i={search:"search",read:"read",explain:"explain",translate:"translate",summarize:"summarize",grammar:"grammar",rewrite:"rewrite",ask:"browser_ask",browser_explain:"browser_explain",youtube:"youtube",mail:"browser_mail",copy:"copy",browser_plugin_info:"browser_plugin_info",input_skill:"input_skill",collect:"collect",adjust_skill:"adjust_skill"};[{cnName:"\u200b\u4e2d\u6587\u200b",enName:"Chinese\u200b",name:"\u4e2d\u6587",lang:"zh"},{cnName:"\u82f1\u6587\u200b",enName:"English\u200b",name:"English",lang:"en"},{cnName:"\u65e5\u8bed\u200b",enName:"Japanese\u200b",name:"\u65e5\u672c\u8a9e",lang:"ja"},{cnName:"\u97e9\u8bed\u200b",enName:"Korean\u200b",name:"\ud55c\uad6d\uc5b4",lang:"ko"},{cnName:"\u6cd5\u8bed\u200b",enName:"French\u200b",name:"Fran\xe7ais",lang:"fr"},{cnName:"\u5fb7\u8bed\u200b",enName:"German\u200b",name:"Deutsch",lang:"de"},{cnName:"\u897f\u73ed\u7259\u8bed\u200b",enName:"Spanish\u200b",name:"Espa\xf1ol",lang:"es"},{cnName:"\u4fc4\u8bed\u200b",enName:"Russian\u200b",name:"\u0420\u0443\u0441\u0441\u043a\u0438\u0439",lang:"ru"},{cnName:"\u610f\u5927\u5229\u8bed\u200b",enName:"Italian\u200b",name:"Italiano",lang:"it"},{cnName:"\u8461\u8404\u7259\u8bed\u200b",enName:"Portuguese\u200b",name:"Portugu\xeas",lang:"pt"},{cnName:"\u8377\u5170\u8bed\u200b",enName:"Dutch\u200b",name:"Nederlands",lang:"nl"},{cnName:"\u745e\u5178\u8bed\u200b",enName:"Swedish\u200b",name:"Svenska",lang:"sv"},{cnName:"\u4e39\u9ea6\u8bed\u200b",enName:"Danish\u200b",name:"Dansk",lang:"da"},{cnName:"\u632a\u5a01\u8bed\u200b",enName:"Norwegian\u200b",name:"Norsk",lang:"no"},{cnName:"\u6ce2\u5170\u8bed\u200b",enName:"Polish\u200b",name:"Polski",lang:"pl"},{cnName:"\u5e0c\u814a\u8bed\u200b",enName:"Greek\u200b",name:"\u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac",lang:"el"},{cnName:"\u571f\u8033\u5176\u8bed\u200b",enName:"Turkish\u200b",name:"T\xfcrk\xe7e",lang:"tr"},{cnName:"\u8d8a\u5357\u8bed\u200b",enName:"Vietlangse\u200b",name:"Ti\u1ebfng Vi\u1ec7t",lang:"vi"},{cnName:"\u6cf0\u8bed\u200b",enName:"Thai\u200b",name:"\u0e44\u0e17\u0e22",lang:"th"},{cnName:"\u5370\u5730\u8bed\u200b",enName:"Hindi\u200b",name:"\u0939\u093f\u0928\u094d\u0926\u0940\u200b",lang:"hi"}].reduce(((e,t)=>(e[t.lang]=t.name,e)),{});const o=[{id:i.ask,prompt:"",name:"flow_web_ext_action_ask",icon:"cici"},{id:i.explain,prompt:"\u89e3\u91ca\u8fd9\u6bb5\u6587\u672c: \n\u201d\u201d\u201d\n$[text]\n\u201d\u201d\u201d",name:"flow_web_ext_action_explain",icon:"explain"},{id:i.translate,prompt:"\u628a\u4e0b\u9762\u8fd9\u6bb5\u6587\u672c\u7ffb\u8bd1\u6210\u76ee\u6807\u8bed\u8a00: $[lang]\u3002\u9700\u8981\u7ffb\u8bd1\u7684\u5185\u5bb9\u662f: \n\u201d\u201d\u201d\n$[text]\n\u201d\u201d\u201d",name:"flow_web_ext_action_translate",icon:"IconTranslateOutline"},{id:i.summarize,prompt:"\u603b\u7ed3\u4ee5\u4e0b\u5185\u5bb9: \n\u201d\u201d\u201d\n$[text]\n\u201d\u201d\u201d",name:"flow_web_ext_action_summarize",icon:"summarize"},{id:i.grammar,prompt:"\u6821\u5bf9\u5e76\u7ea0\u6b63\u8fd9\u6bb5\u6587\u5b57: \n\u201d\u201d\u201d\n$[text]\n\u201d\u201d\u201d",name:"flow_web_ext_action_grammar",icon:"check"},{id:i.adjust_skill,prompt:"\u91cd\u65b0\u8868\u8ff0\u8fd9\u6bb5\u6587\u5b57, \u4f7f\u8fd9\u6bb5\u6587\u5b57\u8868\u8ff0\u7684\u66f4\u52a0\u5408\u7406: \n\u201d\u201d\u201d\n$[text]\n\u201d\u201d\u201d",name:"modify_change_tone",icon:"adjust_skill"},{id:i.copy,prompt:"",name:"message_long_press_copy",icon:"copy"},{id:i.collect,prompt:"",name:"flow_web_ext_action_bookmarks",icon:"collect",options:{brand:"\u8c46\u5305"}}],s=[i.ask,i.grammar,i.rewrite,i.adjust_skill],a=[i.grammar,i.rewrite,i.explain,i.translate,i.copy,i.adjust_skill],r=new Set([i.ask]),l=[i.explain,i.translate,i.collect],c=[i.copy],d=new Set([i.summarize]),u=(e=[])=>o.filter((t=>l.includes(t.id)&&!d.has(t.id)&&!e.includes(t.id))),h=(e=[])=>o.filter((t=>c.includes(t.id)&&!d.has(t.id)&&!e.includes(t.id))),m=[i.grammar,i.rewrite,i.collect,i.adjust_skill],p=[i.explain,i.translate,i.copy],g=(e=[])=>o.filter((t=>m.includes(t.id)&&!d.has(t.id)&&!e.includes(t.id))),v=(e=[])=>o.filter((t=>p.includes(t.id)&&!d.has(t.id)&&!e.includes(t.id))),f=e=>(e||o).filter((e=>a.includes(e.id))),_=o.reduce(((e,t)=>(e[t.id]=t,e)),{});const x=e=>!_[e]},51463:(e,t,n)=>{n.d(t,{B9:()=>h,CC:()=>d,GA:()=>u,Tp:()=>c});var i=n(89586);const o=10485760;class s extends Error{constructor(e,t){super(`readability: ${e}`,t)}}const a=new RegExp("^https?:\\/\\/www\\.zhihu\\.com\\/question\\/\\d+");function r(){a.test(location.href)&&(i.Readability.prototype.REGEXPS.negative=/-ad-|^kfecollection-viprecommendcard$|hidden|^hid$| hid$| hid |^hid |banner|combx|comment|com-|contact|foot|footer|footnote|gdpr|masthead|media|meta|outbrain|promo|related|scroll|share|shoutbox|sidebar|skyscraper|sponsor|shopping|tags|tool|widget/i)}const l={charThreshold:500,keepClasses:!1};function c(e){const t=(e=e||document).cloneNode(!0);r();const n=new i.Readability(t,l).parse();if(n&&n.content.length>o)throw new s(`Content Length exceeds the limit of ${o} characters; ${n.content.length} found`);return n}function d(e){const t=(e=e||document).cloneNode(!0);r();const n=new i.Readability(t,l).parse();return n&&(n.content=""),n}function u(){return new Promise((e=>{"complete"===document.readyState||"interactive"===document.readyState?e():document.addEventListener("DOMContentLoaded",(()=>{e()}))}))}function h(){return u().then((()=>c(document)))}},41264:(e,t,n)=>{n.d(t,{Ay:()=>a,QK:()=>o,mn:()=>s});var i=n(11855);const o=(e,t)=>new URL(t).searchParams.get(e),s=(0,i.createContext)(null),a=e=>/^http(s)?:\/\/www.baidu.com\//.test(e)?{name:"baidu",inputQuery:["input[name='wd']"],searchTag:"#searchTag",sidebarContainerQuery:"#content_right",searchParam:"wd",watchRouteChange:e=>{const t=document.getElementById("wrapper_wrapper");if(!t)return;const n=new MutationObserver((function(t){for(const n of t){if("childList"!==n.type)break;for(const t of n.addedNodes)if("container"===(null==t?void 0:t.id))return void e()}}));return n.observe(t,{childList:!0}),()=>{n.disconnect()}}}:/^https:\/\/www.google.com?(?:.\w+)?\/search\?/.test(e)?{name:"google",inputQuery:["input[name='q']","textarea[name='q']"],sidebarContainerQuery:"#rhs",searchParam:"q",customAppend(){if("lcl"===o("tbm",window.location.href))return null;let e=document.querySelector(this.sidebarContainerQuery);if(!e){const t=document.querySelector("#rcnt");t&&(e=document.createElement("div"),e.id="rhs",t.appendChild(e))}return e}}:/^https:\/\/so.toutiao.com\/search\?/.test(e)?{name:"toutiao",inputQuery:["input[type='search']"],sidebarContainerQuery:".s-side-list",searchParam:"keyword",disabled:()=>!0}:/^https:\/\/\w+.bing.com\/search\?/.test(e)?{name:"bing",inputQuery:["[name='q']"],sidebarContainerQuery:"#b_context",searchParam:"q",containerStyle:{minWidth:470,marginLeft:-20},getPageContent:()=>[]}:null},65240:(e,t,n)=>{n.d(t,{RX:()=>N,qZ:()=>M});var i=n(14065),o=n(48485),s=n(59585),a=n.n(s),r=n(44644),l=n(53585),c=n(51242),d=n(74315),u=n(37524),h=n(51463),m=n(38042),p=n(17753),g=n(305),v=n(48436),f=n(93215),_=n(54483),x=n(41650),y=n(9639),b=n(22007),w=n(60822),C=n(33084),A=n(27675),S=n(89369),I=n(71905),k=n(99824),j=n(30065),E=n(16110);const T=(0,r.jco)(),N=function(){var e=(0,i.A)((function*(e,t){var n;w.l.getState().setIsShowSidebar(!0,t?_.cz.onboarding:_.cz.selectAssistantMenu);let i="";const s=l.K9.Search;try{var a;const[e]=yield Promise.all([(0,d.Rf)((0,p.M$)(),1500,(()=>{j.vF.persist.error({eventName:"[SELECT_BAR] - SEARCH",error:new Error("get skill res timeout")})})),(0,E.Z)()]);if(i=(null===(a=(0,o.A)(e.latest_skills,(e=>(null==e?void 0:e.skill_type)===s)))||void 0===a?void 0:a.skill_id)||"",""===i)throw new Error("search skill id is empty")}catch(b){j.vF.persist.error({message:"get skill failed",error:b})}let r={textContent:""};try{r=yield(0,h.B9)()}catch(b){j.vF.persist.error({message:"get doc failed when search",error:b})}const{convId:m,convType:v,mainBotId:f}=(0,u.IK)(),x={text:e||y.t_.getState().inputText,scene:g.sJ.highlight_search_result_tool,sec_scene:g._o.highlight_search_result_ask,extraExt:{input_skill:JSON.stringify({skill_id:i,skill_type:s,variables:{}}),earlier_search_result:"1",send_from_skill_guidance_or_suggestion:(0,I.TK)("authInfo").isAuthenticated?void 0:"1",samantha_context:JSON.stringify((0,C.k)({query_context:{web_content:(null===(n=r)||void 0===n?void 0:n.textContent)||""}})),need_create_thread:v===c.H.NewThread?"1":"0"},ctx:(0,A.Pe)(v,m,f)};yield(0,A.Bc)(v,x)}));return function(t,n){return e.apply(this,arguments)}}(),M=(e,t,n=!1)=>{(0,f.Bp)({button_name:(0,k.em)(e)?"customized_button":e,click_from:t});const{setCurrentAction:i,setBarVisible:o,setBarFakeHide:s,setBoxVisible:r,inputText:l}=y.t_.getState();if(!l)return;b.on.getState().setFloatingCardVisible(!1),b.on.getState().setSummaryActionVisible(!1);const c=(0,S.BB)({action:(0,S.OB)(e),triggerLogin:e===k.EU.ask,loginParams:{}});if(o(!1),e===k.EU.ask){if(c)return;const e=y.t_.getState().inputText;return T?(s(!0),void N(e)):void N(t===_.Z5.shortcut?e:void 0)}i(e),e!==k.EU.copy?e!==k.EU.collect?n?R(e,l):r(!0):(0,m.XQ)({collectFrom:x.vP.highlight_function_bar,collectionType:v.X.TextFragment}):a()(l)},R=function(){var e=(0,i.A)((function*(e,t){if((0,S.BB)({action:(0,S.OB)(e,"web"),loginParams:{trackMeta:{login_entrance:"sidebar_float"}}}))return;y.t_.getState().clearMessages(),w.l.getState().setIsShowSidebar(!0,_.cz.other);try{yield(0,E.Z)()}catch(l){j.vF.persist.error({message:"page load failed",error:l})}const{convId:n,convType:i,mainBotId:o}=(0,u.IK)(),s={text:t,scene:g.sJ.highlight_in_siderbar_chat,ctx:(0,A.Pe)(i,n,o)},a=(0,I.TK)("uiLanguage"),r=(0,I.TK)("translateLanguage");if([k.EU.translate,k.EU.explain].includes(e)){const t={[e]:"{}",browser_language:a,flag_browser_plugin:"1"};e===k.EU.translate&&(t[e]=r||"{}"),s.extraExt=t,s.sec_scene=e===k.EU.translate?"highlight_in_siderbar_chat_translate":"highlight_in_siderbar_chat_explain"}else{const t=L(e);s.extraExt={flag_browser_plugin:"1",browser_plugin_info:JSON.stringify({frontend_source:"plugin",custom_prompt_skill_id:e,lang:r||a,custom_ref_show_variable:{title:(null==t?void 0:t.name)||"",icon:(null==t?void 0:t.icon)||""}}),need_create_thread:i===c.H.NewThread?"1":"0"}}yield(0,A.Bc)(i,s)}));return function(t,n){return e.apply(this,arguments)}}(),L=e=>{const t=(0,I.TK)("readingPopupActions"),n=(0,I.TK)("editingPopupActions");return t.actionList.find((t=>t.id===e))||t.moreActionList.find((t=>t.id===e))||n.actionList.find((t=>t.id===e))||n.moreActionList.find((t=>t.id===e))}},71905:(e,t,n)=>{n.d(t,{Fc:()=>k,LR:()=>y,MI:()=>j,TK:()=>A,bU:()=>M,gv:()=>I,lv:()=>b,n5:()=>T,pu:()=>N,tl:()=>S,ue:()=>E,vE:()=>C});var i=n(14065),o=n(22234),s=n(97724),a=n(16604),r=n(64978),l=n(98028),c=n(41536),d=n(58440),u=n(41543),h=n(27224),m=n(99824),p=n(13706),g=n(76482),v=n(9462);const f=(0,d.c)(),_={uuid:"",installReason:"",synced:!1,authInfo:{isAuthenticated:!1},autoTranslateSubtitles:!0,subtitleTranslateLang:"system",launchInfo:{},launchConfig:{},abTestValue:{},chatInfo:{},debugInfo:{isEnableDebug:!1,webEnv:"",extEnv:""},requestCommonParams:{},fg:{},videoSubtitleDisableAll:!1,videoSubtitleDisableHosts:[],videoSummaryDisableAll:!1,videoSummaryDisableHosts:[],podcastSummaryDisableAll:!1,podcastSummaryDisableHosts:[],chatFloatCardDisableAll:!1,chatFloatCardDisableHosts:[],sidebarButtonDisabledAll:!1,sidebarButtonDisabledHosts:[],searchDisabledAll:!1,searchDisabledHosts:[],disableSearchAddonsHosts:[],disableSearchAddonsGlobal:!0,sidebarButtonTop:.5,sidebarButtonPosition:"right",autoTranslatePageHosts:[],disableGlobalGrammar:!1,disableGrammarHosts:[],InputAssistantDisabledAll:!1,InputAssistantDisabledHosts:[],inputAssistantLang:"zh",quickDisabledAll:!1,quickDisabledHosts:[],actions:m.HO,translateLanguage:(0,a.wz)(f),themeMode:v.lG.AUTO,uiLanguage:f,voiceSpeaker:c.F,sidePanelEnabled:!0,hostId:"",PopupListMaxCount:4,readingPopupActions:{actionList:(0,m.Hh)(),moreActionList:(0,m.WN)()},editingPopupActions:{actionList:(0,m.I8)(),moreActionList:(0,m.fS)()},selectBarOnlyIcon:!1,onboardingActionRecord:(0,l.wG)(),isSelectbarMoreMenuClicked:!1,needOpenSideBar:!1,featureInfo:null,pageTranslateService:v.c$.HUOSHAN,selectTranslateService:v.c$.HUOSHAN,pageTranslateShowUnderline:!1,collectionConfig:(0,p.i)(),transPreferConfig:{tipShown:!1,langMap:{}},tabConversationMap:{},isHistoryChatsClicked:!1,shortcutsConfig:h.A,appSettings:u.K,overseaAccessibility:{},doubaoNoticeKey:"",linkPreviewDisabledAll:!1,linkPreviewDisabledHosts:[],searchUsageTimesInfo:{},readWebPageCtxConfig:{enabled:!1,hasWebPageContextDialogShow:!1},voiceSettingTipShown:!1};let x=()=>{};const y=()=>{var e;null===(e=x)||void 0===e||e()},b=function(){var e=(0,i.A)((function*(){x=yield(0,r.X)(_),_.synced=!0}));return function(){return e.apply(this,arguments)}}(),w=(e,t,n=!1)=>{const i=_[e];return _[e]=n?(0,s.A)(i,t):t,g.A.set(e,_[e])},C=w;function A(e){return _[e]}const S=e=>{const t=A("appSettings")[e];return(0,o.A)(t,u.K[e])},I=()=>_.shortcutsConfig;function k(){return _.authInfo}function j(){return _.debugInfo}function E(){return _.launchInfo}function T(){return _.chatInfo}function N(e,t=!1){return w("chatInfo",e,t)}function M(){return _.requestCommonParams}},37524:(e,t,n)=>{n.d(t,{$D:()=>f,IK:()=>y,hC:()=>_,u3:()=>x});var i=n(14065),o=n(85371),s=n(98502),a=n(60258),r=n(69232),l=n(51242),c=n(29581),d=n(53065),u=n(71905),h=n(43423),m=n(9584),p=n(48544),g=n(22007);const v=()=>c.pU.getState().addNewLocalConversation({conversation:{conversation_type:a.Cr.CocoWebSub},conversationId:void 0}),f=function(){var e=(0,i.A)((function*(){const{convId:e,convType:t,mainBotId:n}=y(),i=t===l.H.NewThread;let s=e;try{if(i){var a;if(s=null===(a=(yield r.j.apiService.samantha.ThreadCreate({bot_id:n})).data)||void 0===a||null===(a=a.thread_info)||void 0===a||null===(a=a.conversation)||void 0===a?void 0:a.conversation_id,(0,o.A)(s))return void(0,h.z3)("[zx] create sub conversation failed, returned conversationId not valid",s);_(s)}}catch(c){throw console.error("thread_create_failed"),c}return s}));return function(){return e.apply(this,arguments)}}(),_=e=>{const{tabId:t}=g.on.getState().tabInfo;t?(((e,t,n)=>{if(!(0,u.TK)("authInfo").isAuthenticated)return;const i=(0,u.TK)("tabConversationMap");(0,u.vE)("tabConversationMap",Object.assign({},i,{[e]:{conversationId:t,conversationType:n}}))})(t,e,l.H.Conversation),g.on.getState().setTabInfo({tabId:t})):(0,h.z3)("[zx] tabId not valid",t)};function x(){const{tabId:e}=(0,g.on)((e=>e.tabInfo)),[t]=(0,m.Y)("authInfo"),[n]=(0,m.Y)("chatInfo"),{value:i}=(0,p.Tu)(p.FM.enableNewChat,!1);var o;if(!t.isAuthenticated||!i||!e)return{tabId:e,convId:null===(o=n.mainConversation)||void 0===o?void 0:o.conversation_id,convType:l.H.Conversation};const r=(0,u.TK)("tabConversationMap"),f=r?r[e]:void 0;var _;if(r||((0,h.z3)("[zx] tabConvMap not init"),(0,u.vE)("tabConversationMap",{})),f&&""!==f.conversationId)return f.conversationType!==l.H.NewThread||null!==(_=c.pU.getState().localConversationMap[f.conversationId])&&void 0!==_&&_.local||c.pU.setState((0,s.jM)((e=>{e.localConversationMap[f.conversationId]={local:{createStatus:d.Et.Pending},conversation_type:a.Cr.CocoWebSub}}))),{tabId:e,convId:f.conversationId,convType:f.conversationType};const x=v();return(0,u.vE)("tabConversationMap",Object.assign({},r,{[e]:{conversationId:x,conversationType:l.H.NewThread}})),{tabId:e,convId:x,convType:l.H.NewThread}}function y(){var e;const t=(0,u.TK)("authInfo"),{mainConversation:n}=(0,u.TK)("chatInfo"),i=(0,p.Mz)(p.FM.enableNewChat,!1),o=null==n?void 0:n.bot_id;if(!t.isAuthenticated||!i)return{convId:null==n?void 0:n.conversation_id,convType:l.H.Conversation,mainBotId:o};const{tabId:s}=g.on.getState().tabInfo;if(!s){return{convId:null==n?void 0:n.conversation_id,convType:l.H.Conversation,mainBotId:o}}const a=(0,u.TK)("tabConversationMap"),r=void 0===a[s]?l.H.NewThread:a[s].conversationType;return{convId:null===(e=a[s])||void 0===e?void 0:e.conversationId,convType:r,mainBotId:o}}},38671:(e,t,n)=>{n.d(t,{Ay:()=>l,jB:()=>a,un:()=>r});var i=n(11855);let o=window.location.href;const s={youtube:/^https:\/\/www.youtube.com\/watch\?/,bilibili:/^https:\/\/www\.bilibili\.com\/video\/\w+/},a=e=>!!e&&s[e].test(location.href),r=(0,i.createContext)(null),l=e=>/^https:\/\/www.youtube.com\//.test(e)?{name:"youtube",sidebarContainerQuery:"#columns #secondary",searchParam:"v",customAppend:()=>{const e=document.querySelector("#fixed-columns-secondary #secondary");return e||null}}:/^https:\/\/www\.bilibili\.com\/video\/\w+/.test(e)?{name:"bilibili",sidebarContainerQuery:"#danmukuBox",searchParam:"v",pageIsReady:e=>{const t=new MutationObserver((()=>{const t=document.querySelector(".bui-dropdown-name");null!=t&&t.textContent&&e()}));return t.observe(document.body,{childList:!0}),()=>{t.disconnect()}},onUrlChange:e=>{const t=setInterval((function(){window.location.href!==o&&(e(),o=window.location.href)}),1e3);return()=>{window.clearInterval(t)}}}:null},4580:(e,t,n)=>{n.d(t,{EE:()=>C,ab:()=>w,i4:()=>f});var i=n(44557),o=n(14065),s=n(67697),a=n(11646),r=n(23084),l=n(8209),c=n(29581),d=n(24163),u=n(89739),h=n(32572),m=n(76482),p=n(30065),g=n(46694),v=n(89207);const f=`https://${u.FI}`,_=e=>t=>{try{var n;const i=null===(n=e.getState().conversationLinks[0])||void 0===n?void 0:n.conversationId,o=i?[i]:[],s={},a={};return o.forEach((e=>{var n;null!==(n=t.messageLinkMap)&&void 0!==n&&n[e]&&(s[e]=t.messageLinkMap[e].slice(Math.max(t.messageLinkMap[e].length-6,0)))})),o.forEach((e=>{var n;null!=s&&s[e]&&null!==(n=t.messageMap)&&void 0!==n&&n[e]&&(a[e]={},s[e].forEach((n=>{var i;null!==(i=t.messageMap)&&void 0!==i&&null!==(i=i[e])&&void 0!==i&&i[n.messageId]&&(a[e][n.messageId]=t.messageMap[e][n.messageId])})))})),{messageLinkMap:s,messageMap:a}}catch(i){return p.vF.persist.error({message:"ext persist state limit error",error:i instanceof Error?i:new Error(String(i))}),{}}},x=e=>{try{return{userPreferences:e.userPreferences}}catch(t){return p.vF.persist.error({message:"ext persist state limit error",error:t instanceof Error?t:new Error(String(t))}),{userPreferences:e.userPreferences}}},y=e=>{try{return{chunkTaskMap:e.chunkTaskMap}}catch(t){return p.vF.persist.error({message:"ext persist state limit error",error:t instanceof Error?t:new Error(String(t))}),{chunkTaskMap:e.chunkTaskMap}}};let b;function w(){if(b)return b;const{eventEmitter:e}=(0,r.r)({isEnableDebug:!1,store:{prefix:"flow-ext",storage:{getItem:(s=(0,o.A)((function*(e){return yield m.A.get(e)})),function(e){return s.apply(this,arguments)}),setItem:(n=(0,o.A)((function*(e,t){return yield m.A.set(e,t)})),function(e,t){return n.apply(this,arguments)}),removeItem:(t=(0,o.A)((function*(e){return yield m.A.remove(e)})),function(e){return t.apply(this,arguments)})},merge:{chatFeedStore:(e,t)=>(0,i.A)((0,i.A)({},t),e||{}),chatInputStore:(e,t)=>(0,i.A)((0,i.A)({},t),e||{}),chatMessageStore:(e,t)=>(0,i.A)((0,i.A)({},t),e||{}),chatChunkTaskStore:(e,t)=>(0,i.A)((0,i.A)({},t),e||{})},partialize:{chatInputStore:x,chatMessageStore:_(c.pU),chatChunkTaskStore:y}},http:{client:v.sY,baseURL:f,getCommonHeaders:g.Ql,getCommonParams:g.wH}});var t,n,s;return b=e,e}const C=function(){var e=(0,o.A)((function*(){const e=w();try{const t=yield A();return(0,l.P)({launchData:t,userInfoData:{}}),(0,a.IDn)({config:{},socketClient:d.Hv,reportEvent:(0,s.XB)({eventName:"ext_message_service"}),fetchStream:{baseURL:`https://${u.FI}`,client:d._v}}),(0,a.tE0)(),(0,d.Lt)(),(0,a.CCM)({onlyLoadAssistantBot:!0,isReload:!1}),e}catch(t){p.vF.persist.error({message:"init im core failed",error:t})}}));return function(){return e.apply(this,arguments)}}(),A=function(){var e=(0,o.A)((function*(){try{const{data:e}=yield h.g.setting.Launch();if(!e)throw Error("\u83b7\u53d6 launchData \u5931\u8d25");return e}catch(e){throw console.log("===Launch failed===",e),e}}));return function(){return e.apply(this,arguments)}}()},24163:(e,t,n)=>{n.d(t,{Hv:()=>S,Lt:()=>A,_v:()=>x,jo:()=>w});var i=n(44557),o=n(10633),s=n(37462),a=n(35841),r=n(61577),l=n(30457),c=n(46878),d=n(71905),u=n(37526),h=n(50479),m=n(39275),p=n(43423),g=n(32447),v=n(18867),f=n(58735);const _=new class{constructor(){(0,o.A)(this,"_recoder",void 0),(0,o.A)(this,"_recoderName",""),(0,o.A)(this,"start",((e,t="cici_im_fetch_stream_action_perf")=>{const n=u.Qz.get("cici_summary_page_action_perf");n?(this._recoderName="cici_summary_page_action_perf",this._recoder=n,this._recoder.mark(e)):(this._recoder=u.Qz.create(t,!0),this._recoderName=t,this._recoder.mark(e)),(0,p.Rm)(`[ts] ImCorePerfRecoder start ${this._recoderName}[${e}]`)})),(0,o.A)(this,"mark",((e,t="cici_im_fetch_stream_action_perf")=>{this._recoder?((0,p.Rm)(`[ts] ImCorePerfRecoder mark ${this._recoderName}[${e}]`),this._recoder.mark(e)):this.start(e,t)})),(0,o.A)(this,"end",((e,t={})=>{this._recoder&&((0,p.Rm)(`[ts] ImCorePerfRecoder end ${this._recoderName}[${e}], categories: `,t),this._recoder.end(e,t),u.Qz.remove(this._recoderName),this._recoderName="",this._recoder=void 0)}))}},x=e=>{const{req:t,reportMeta:n,onMessage:o,onError:s,onFinish:a,subscribeAbortTrigger:r,getCommonHttpParams:l}=e;(0,p.Rm)(null==n?void 0:n.conversationId);const d=(0,c.AP)();null==r||r((e=>{g.B.abort(d,e)})),_.mark("start_fetch_stream"),(0,p.Rm)("[lwx] start fetch stream...",e);const u={type:"start",id:d};v.A.emit("im-message",u),(0,m.Iq)({name:"im-message",body:u});const h={};g.B.fetch({reportMeta:n,req:(0,i.A)((0,i.A)({},{params:null==l?void 0:l()}),t)},{id:d,onUpdate:({body:e,logId:t=""})=>{var n;if("1"==`${null==e||null===(n=e.message)||void 0===n?void 0:n.chunk_seq}`){var i;(0,p.Rm)("[lwx] fetch stream first message",e);const{source:t,input_skill:n}=(null==e||null===(i=e.message)||void 0===i?void 0:i.ext)||{};if(t&&(h.source=t),n)try{const{skill_type:e}=JSON.parse(n)||{};h.inputSkillType=`${e}`}catch(a){(0,p.z3)("parse input skill type error: ",a)}_.mark("fetch_stream_first_message")}o(e,t);const s={type:"update",id:d};v.A.emit("im-message",s),(0,m.Iq)({name:"im-message",body:s})},onError:({jsonData:e,logId:t=""})=>{_.mark("fetch_stream_error"),_.end("end_fetch_stream",h),s(e,t);const n={type:"error",id:d};v.A.emit("im-message",n),(0,m.Iq)({name:"im-message",body:n})},onDone:()=>{_.end("end_fetch_stream",h),(0,p.Rm)("[lwx] fetch stream done"),a(!0);const e={type:"done",id:d};v.A.emit("im-message",e),(0,m.Iq)({name:"im-message",body:e})}})},y=(()=>{const e=(0,h.c)("im-sdk-socket");return()=>e})(),b=(e,t)=>y().postMessage({body:{type:e,payload:t}}),w=()=>{_.start("check_connection","cici_im_connection_action_perf"),b("check-connection")};let C=null;const A=()=>{y().onMessage.addListener((e=>{var t,n,i,o,s,r,c;((0,p.Rm)("[Daniel] - recv \u{1f53d}",e),null!==(t=e.body)&&void 0!==t&&t.event)&&((null===(n=e.body.event.message)||void 0===n||null===(n=n.ext)||void 0===n?void 0:n.has_err)!==f.Be||null!==(i=(0,d.Fc)())&&void 0!==i&&i.isAuthenticated||(0,l.DT)({}),"0"==`${null===(o=e.body.event.message)||void 0===o?void 0:o.chunk_seq}`?_.mark("socket_recv_first_message"):(null===(s=e.body.event.message)||void 0===s?void 0:s.message_type)===a.Go.Ack&&_.mark("socket_recv_open"),null===(r=C)||void 0===r||r({event:e.body.event,traceId:null===(c=e.body)||void 0===c?void 0:c.traceId}))}))},S={close:s.A,drop:s.A,send:e=>{(0,p.Rm)("[Daniel] - send \u{1f53c}",e),"string"==typeof e&&(_.mark("send_socket_message"),b("message",(0,i.A)({},JSON.parse(e))))},addEventListener:e=>{(0,p.Rm)("[zoei] socketClientProxy.addEventListener",e)},removeEventListener:e=>{(0,p.Rm)("[zoei] socketClientProxy.removeEventListener",e),e===r.QV.open&&_.end("socket_proxy_init_end")},init:e=>{(0,p.Rm)("[zoei] socketClientProxy.init - connectSocketIfNeeded",e),_.mark("socket_proxy_init_begin"),(e=>{b("connect-if-needed",{options:e})})(e),C=e.onMessage}}},5644:(e,t,n)=>{n.d(t,{H7:()=>C,TL:()=>I,UK:()=>A,VJ:()=>g,kg:()=>k,oU:()=>S,sM:()=>j,t0:()=>v});var i=n(11855),o=n(29019),s=n.n(o),a=n(34944),r=n(31525),l=n(24473),c=n(69021),d=n(58735),u=n(16418),h=n(63159);const m=a.EY.create();function p(){return`popup-${r.m.getInstance().getHostId()}`}function g(e){const t=p(),n=document.getElementById(t);n&&e.prepend(n)}const v=e=>{const t=p();let n=document.getElementById(t);if(n)return null==e||e(),()=>{var e;return(null===(e=document.getElementById(t))||void 0===e||null===(e=e.shadowRoot)||void 0===e?void 0:e.querySelector("body"))||document.body};n=document.createElement("div"),n.style.width="0",n.style.height="0",n.style.position="absolute",n.id=t,n.style.zIndex="200000";const i=n.attachShadow({mode:"open"}),o=document.createElement("body");return o.classList.add("cici-ext-container"),i.appendChild(o),document.body.prepend(n),m.config({getPopupContainer:()=>{var e;const n=null===(e=document.getElementById(t))||void 0===e||null===(e=e.shadowRoot)||void 0===e?void 0:e.querySelector("body");return setTimeout((()=>{const e=null==n?void 0:n.querySelector('div.semi-toast-wrapper[id^="toast"]');e&&(e.id=`_${e.id}`)})),n||document.body}}),(0,c.NR)(i,d.QN).finally((()=>null==e?void 0:e())),(0,r.A)((()=>{var e;null===(e=document.getElementById(t))||void 0===e||e.remove()})),()=>{var e;return(null===(e=document.getElementById(t))||void 0===e||null===(e=e.shadowRoot)||void 0===e?void 0:e.querySelector("body"))||document.body}},f=e=>{const t=(0,l.Uk)(),n=(0,i.useCallback)((()=>{window.open(e.infoUrl)}),[e]);return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:s()(u.A.toastContainer),"data-testid":"collect-toast-success",children:[(0,h.jsx)("div",{className:s()(u.A.text),children:t("flow_web_ext_bookmarks_saved")}),(0,h.jsx)("div",{className:s()(u.A.linkToInfo),onClick:n,children:t("flow_web_ext_bookmarks_saved_view")})]})})},_=e=>{const t=(0,l.Uk)(),n=(0,i.useCallback)((()=>{window.open(e.infoUrl)}),[e]);return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:s()(u.A.toastContainer),children:[(0,h.jsx)("div",{className:s()(u.A.text),children:t("flow_web_ext_youtube_take_notes_saved")}),(0,h.jsx)("div",{className:s()(u.A.linkToInfo),onClick:n,children:t("flow_web_ext_youtube_take_notes_saved_view")})]})})},x=({message:e})=>(0,h.jsx)(h.Fragment,{children:(0,h.jsx)("div",{className:s()(u.A.toastContainer),children:(0,h.jsx)("div",{className:s()(u.A.text),children:e})})}),y=()=>{const e=(0,l.Uk)();return(0,h.jsx)(h.Fragment,{children:(0,h.jsx)("div",{className:s()(u.A.toastContainer),children:(0,h.jsx)("div",{className:s()(u.A.text),children:e("bookmarks_remove_complete")})})})},b=()=>{const e=(0,l.Uk)();return(0,h.jsx)(h.Fragment,{children:(0,h.jsx)("div",{className:s()(u.A.toastContainer),children:(0,h.jsx)("div",{className:s()(u.A.loadingText),children:e("flow_web_ext_bookmarks_saving")})})})},w=()=>{const e=(0,l.Uk)();return(0,h.jsx)(h.Fragment,{children:(0,h.jsx)("div",{className:s()(u.A.toastContainer),children:(0,h.jsx)("div",{className:s()(u.A.errorText),children:e("flow_web_ext_bookmarks_failed")})})})};function C(e){const t={content:(0,h.jsx)(_,{infoUrl:e.infoUrl}),duration:4,showClose:!1,className:s()(u.A.toastCard),stack:!1,id:"4",zIndex:99999};m.close("1"),m.close("2"),m.close("3"),v((()=>m.success(t)))}function A(){const e={content:(0,h.jsx)(b,{}),duration:0,showClose:!1,className:s()(u.A.toastLoadingCard),stack:!1,icon:(0,h.jsx)(a.tK,{}),id:"1",zIndex:99999};m.close("1"),v((()=>m.info(e)))}function S(){const e={content:(0,h.jsx)(w,{}),duration:3,showClose:!1,className:s()(u.A.toastErrorCard),stack:!1,id:"3",zIndex:99999};m.close("1"),v((()=>m.error(e)))}function I(e){const t={content:(0,h.jsx)(x,{message:e}),duration:3,showClose:!1,className:s()(u.A.toastCard),stack:!1,id:"10",zIndex:99999};m.close("1"),v((()=>m.success(t)))}function k(e,t){return A(),e().then((e=>(function(e){const t={content:(0,h.jsx)(f,{infoUrl:e.infoUrl}),duration:3,showClose:!1,className:s()(u.A.toastCard),stack:!1,id:"2",zIndex:99999};m.close("1"),v((()=>m.success(t)))}({infoUrl:t(e)}),e))).catch((e=>(S(),e)))}function j(e){return e().then((()=>{!function(){const e={content:(0,h.jsx)(y,{}),duration:3,showClose:!1,className:s()(u.A.toastCard),stack:!1,id:"2",zIndex:99999};m.close("1"),v((()=>m.success(e)))}()}))}},30457:(e,t,n)=>{n.d(t,{DT:()=>h,GT:()=>m,l_:()=>p});var i=n(14065),o=n(44557),s=n(38855),a=n(4601),r=n(89739),l=n(77246),c=n(39275),d=(n(43423),n(58735)),u=n(2248);const h=e=>{if(!location.href.includes(`${r.FI}${d.EP}`))if((0,u.nr)()){const{trackMeta:t}=e||{};window.open(function(e){const t={from:"ext"};return e&&(t.extra=btoa(JSON.stringify(e))),(0,s.ID)(`https://${r.FI}/browser-extension/login`,t)}({trackMeta:t}),"_blank")}else(0,c.cs)({name:"open-login-window",body:(0,o.A)((0,o.A)((0,o.A)({},(0,l.c)()),e),{},{clearWindow:(0,u.fv)()})})},m=()=>{window.location.hostname.endsWith(r.Ud)&&window.postMessage({name:"click_float_btn"})},p=function(){var e=(0,i.A)((function*(){var e,t,n;let i=(null===(e=document.querySelector('meta[property="og:image"]'))||void 0===e?void 0:e.getAttribute("content"))||"";const o=(null===(t=document.querySelector('meta[property="og:description"]'))||void 0===t?void 0:t.getAttribute("content"))||(null===(n=document.querySelector('meta[name="description"]'))||void 0===n?void 0:n.getAttribute("content"))||"";try{i&&(i=yield(0,a.Vv)(i))}catch(s){console.error("image\u83b7\u53d6\u5931\u8d25!")}return{imageUrl:i,desc:o}}));return function(){return e.apply(this,arguments)}}()},18705:(e,t,n)=>{n.d(t,{$N:()=>jt,Ai:()=>sn,Cy:()=>Zt,EH:()=>nn,GP:()=>Ot,Gk:()=>tn,H9:()=>Dt,HD:()=>Ft,I:()=>pn,JW:()=>Et,K2:()=>Ht,P$:()=>Xt,Pl:()=>et,R0:()=>on,TH:()=>Lt,Tf:()=>$t,Zx:()=>Wt,dd:()=>an,eD:()=>_t,eI:()=>Tt,gz:()=>yt,hI:()=>tt,hk:()=>rn,jR:()=>Bt,jZ:()=>Ut,jw:()=>pt,kK:()=>ht,li:()=>Qt,n4:()=>Gt,o0:()=>At,oE:()=>qt,pt:()=>Kt,un:()=>en,ut:()=>ln,vo:()=>Mt,wO:()=>Yt,w_:()=>Ct,wv:()=>Xe,yK:()=>hn,yZ:()=>cn,zG:()=>Jt});var i=n(44557),o=(n(11855),n(30435)),s=n(88035),a=n(12478),r=n(34350),l=n(30434),c=n(9188),d=n(23295),u=n(99050),h=n(53460),m=n(47137),p=n(82005),g=n(14080),v=n(85674),f=n(29114),_=n(9257),x=n(97216),y=n(36165),b=n(37767),w=n(65959),C=n(51487),A=n(21568),S=n(91445),I=n(94303),k=n(35018),j=n(8647),E=n(4584),T=n(19121),N=n(66978),M=n(48606),R=n(53897),L=n(14884),P=n(95589),B=n(77621),D=n(99155),F=n(48158),U=n(94280),H=n(80816),z=n(2764),O=n(88005),q=n(2905),V=n(91774),$=n(42859),K=n(62320),W=n(93078),G=n(70601),Z=n(71141),Y=n(16507),J=n(89900),Q=n(47455),X=n(88739),ee=n(78236),te=n(78031),ne=n(10142),ie=n(70983),oe=n(95503),se=n(59501),ae=n(34998),re=n(81160),le=n(78518),ce=n(13609),de=n(14357),ue=n(77816),he=n(72005),me=n(9277),pe=n(98525),ge=n(54704),ve=n(80493),fe=n(4790),_e=n(76262),xe=n(99804),ye=n(24669),be=n(17177),we=n(45854),Ce=n(96742),Ae=n(69016),Se=n(17419),Ie=n(42209),ke=n(85586),je=n(52490),Ee=n(83234),Te=n(97968),Ne=n(62976),Me=n(66645),Re=n(18327),Le=n(73399),Pe=n(52177),Be=n(97303),De=n(91832),Fe=n(27103),Ue=n(10460),He=n(15854),ze=n(24941),Oe=n(65228),qe=n(62986),Ve=n(54676),$e=n(52441),Ke=n(96747),We=n(19154),Ge=n(73518),Ze=n(74569),Ye=n(40736),Je=n(31538),Qe=n(63159);const Xe=(0,s.a)((0,Qe.jsx)(Ae.h,{})),et=((0,s.a)((0,Qe.jsx)(Ce.h,{})),(0,s.a)((0,Qe.jsx)(Te.h,{})),(0,s.a)((0,Qe.jsx)(_e.h,{})),(0,s.a)((0,Qe.jsx)(Be.h,{})),(0,s.a)((0,Qe.jsx)(De.h,{})),(0,s.a)((0,Qe.jsx)(Pe.h,{})),(0,s.a)((0,Qe.jsx)(Fe.h,{})),(0,s.a)((0,Qe.jsx)(re.h,{}))),tt=((0,s.a)((0,Qe.jsx)(Je.h,{})),(0,s.a)((0,Qe.jsx)(qe.h,{})),(0,s.a)((0,Qe.jsx)(ne.h,{})),(0,s.a)((0,Qe.jsx)(ce.h,{}))),nt=(0,s.a)((0,Qe.jsx)(ae.h,{})),it=(0,s.a)((0,Qe.jsx)(te.h,{})),ot=(0,s.a)((0,Qe.jsx)(Q.h,{})),st=(0,s.a)((0,Qe.jsx)($.h,{})),at=(0,s.a)((0,Qe.jsx)(O.h,{})),rt=(0,s.a)((0,Qe.jsx)(D.h,{})),lt=(0,s.a)((0,Qe.jsx)(b.h,{})),ct=(0,s.a)((0,Qe.jsx)(_.h,{})),dt=(0,s.a)((0,Qe.jsx)(v.h,{})),ut=(0,s.a)((0,Qe.jsx)(g.h,{})),ht=(0,s.a)((0,Qe.jsx)(l.h,{})),mt=(0,s.a)((0,Qe.jsx)(K.h,{})),pt=((0,s.a)((0,Qe.jsx)(G.h,{})),(0,s.a)((0,Qe.jsx)(Z.h,{}))),gt=(0,s.a)((0,Qe.jsx)(f.h,{})),vt=(0,s.a)((0,Qe.jsx)(J.h,{})),ft=(0,s.a)((0,Qe.jsx)(N.h,{})),_t=((0,s.a)((0,Qe.jsx)(M.h,{})),(0,s.a)((0,Qe.jsx)(C.h,{}))),xt=((0,s.a)((0,Qe.jsx)(A.h,{})),(0,s.a)((0,Qe.jsx)(q.h,{}))),yt=(0,s.a)((0,Qe.jsx)(X.h,{})),bt=((0,s.a)((0,Qe.jsx)(z.h,{})),(0,s.a)((0,Qe.jsx)(oe.h,{}))),wt=(0,s.a)((0,Qe.jsx)(j.h,{})),Ct=(0,s.a)((0,Qe.jsx)(E.h,{})),At=(0,s.a)((0,Qe.jsx)(L.h,{})),St=(0,s.a)((0,Qe.jsx)(y.h,{})),It=(0,s.a)((0,Qe.jsx)(S.h,{})),kt=(0,s.a)((0,Qe.jsx)(I.h,{})),jt=((0,s.a)((0,Qe.jsx)(W.h,{})),(0,s.a)((0,Qe.jsx)(de.h,{})),(0,s.a)((0,Qe.jsx)(m.h,{}))),Et=(0,s.a)((0,Qe.jsx)(p.h,{})),Tt=(0,s.a)((0,Qe.jsx)(h.h,{})),Nt=(0,s.a)((0,Qe.jsx)(U.h,{})),Mt=((0,s.a)((0,Qe.jsx)(H.h,{})),(0,s.a)((0,Qe.jsx)(V.h,{}))),Rt=((0,s.a)((0,Qe.jsx)(k.h,{})),(0,s.a)((0,Qe.jsx)(c.h,{}))),Lt=(0,s.a)((0,Qe.jsx)(B.h,{})),Pt=(0,s.a)((0,Qe.jsx)(d.h,{})),Bt=((0,s.a)((0,Qe.jsx)(We.h,{})),(0,s.a)((0,Qe.jsx)(Ye.h,{})),(0,s.a)((0,Qe.jsx)(pe.h,{})),(0,s.a)((0,Qe.jsx)(Re.h,{})),(0,s.a)((0,Qe.jsx)(Le.h,{})),(0,s.a)((0,Qe.jsx)(xe.h,{}))),Dt=(0,s.a)((0,Qe.jsx)(F.h,{})),Ft=(0,s.a)((0,Qe.jsx)(be.h,{})),Ut=((0,s.a)((0,Qe.jsx)(He.h,{})),(0,s.a)((0,Qe.jsx)(ze.h,{})),(0,s.a)((0,Qe.jsx)(ye.h,{}))),Ht=(0,s.a)((0,Qe.jsx)(w.h,{})),zt=(0,s.a)((0,Qe.jsx)(P.h,{})),Ot=(0,s.a)((0,Qe.jsx)(u.h,{})),qt=(0,s.a)((0,Qe.jsx)(ie.h,{})),Vt=(0,s.a)((0,Qe.jsx)(Y.h,{})),$t=(0,s.a)((0,Qe.jsx)(ee.h,{})),Kt=(0,s.a)((0,Qe.jsx)(R.h,{})),Wt=(0,s.a)((0,Qe.jsx)(T.h,{})),Gt=(0,s.a)((0,Qe.jsx)(le.h,{})),Zt=(0,s.a)((0,Qe.jsx)(Ue.h,{})),Yt=((0,s.a)((0,Qe.jsx)(Me.h,{})),(0,s.a)((0,Qe.jsx)(he.h,{})),(0,s.a)((0,Qe.jsx)(ge.h,{}))),Jt=(0,s.a)((0,Qe.jsx)(ke.h,{})),Qt=(0,s.a)((0,Qe.jsx)(Ne.h,{})),Xt=(0,s.a)((0,Qe.jsx)(fe.h,{})),en=(0,s.a)((0,Qe.jsx)(ue.h,{})),tn=(0,s.a)((0,Qe.jsx)(Ke.h,{})),nn=((0,s.a)((0,Qe.jsx)(Ze.h,{})),(0,s.a)((0,Qe.jsx)(Ie.h,{}))),on=(0,s.a)((0,Qe.jsx)(Ve.h,{})),sn=((0,s.a)((0,Qe.jsx)(me.h,{})),(0,s.a)((0,Qe.jsx)(Oe.h,{})),(0,s.a)((0,Qe.jsx)(ve.h,{})),(0,s.a)((0,Qe.jsx)(je.h,{}))),an=(0,s.a)((0,Qe.jsx)(Ee.h,{})),rn=(0,s.a)((0,Qe.jsx)(Ge.h,{})),ln=(0,s.a)((0,Qe.jsx)($e.h,{})),cn=(0,s.a)((0,Qe.jsx)(we.h,{})),dn=(0,s.N)((0,r.Nf)()),un=((0,s.a)((0,Qe.jsx)(se.h,{})),(0,s.a)((0,Qe.jsx)(x.h,{}))),hn=(0,s.a)((0,Qe.jsx)(Se.h,{})),mn=(0,i.A)((0,i.A)({},a.M),{},{arrow:et,avatar:nt,check:it,contact:ot,drag:st,explain:at,instruct:rt,rewrite:lt,adjust_skill:o.ebl,search:ct,sider:dt,summarize:ut,translate:ht,del:mt,copy:Vt,conversation:vt,settings:gt,more:ft,regenerate:_t,expand:xt,close:yt,cancel:bt,ok:wt,messageFailed:At,right:St,IconRead:It,IconReadPage:kt,global:Nt,expandDownFilled:Mt,IconTranslateOutline:Rt,IconLangSettings:Lt,IconTranslateOutlineActive:Pt,IconLink:zt,cici:dn,searchToggleSize:Bt,searchMore:Ft,searchSource:Ut,collect:o.Wur,searchAI:un}),pn=(e,t)=>{const n=mn[e];return n?(0,Qe.jsx)(n,(0,i.A)({},t)):(e=>{try{return new URL(e),!0}catch(t){return!1}})(e)?(0,Qe.jsx)("img",(0,i.A)({src:e},t)):(0,Qe.jsx)(zt,(0,i.A)({},t))}},95428:(e,t,n)=>{n.d(t,{g:()=>d,q:()=>c});var i=n(16604),o=n(305),s=n(66006),a=n(71905),r=n(99824);const l={skill_id:"2",skill_type:2};function c(e){const t=(0,i.wz)((0,a.TK)("inputAssistantLang"));return s.P.getState().sendMessage({text:e.text,scene:o.sJ.writing_assistant,prompt:r.EU.input_skill,replyLang:t,input_skill:JSON.stringify(l)})}function d(e){const t=(0,i.wz)((0,a.TK)("inputAssistantLang")),n={skill_name:"rewrite",template_type:e.template_type};e.adjust&&(n.adjust=e.adjust),e.tone&&(n.tone=e.tone);return s.P.getState().sendMessage({text:e.text,scene:e.scene||o.sJ.writing_assistant,sec_scene:e.sec_scene,prompt:r.EU.adjust_skill,replyLang:e.lang?e.lang:t,browser_plugin_info:JSON.stringify(n)})}},41829:(e,t,n)=>{n.d(t,{V:()=>s,s:()=>o});var i=n(71905);function o(){const e=(0,i.TK)("featureInfo");null!=e&&e.version&&(e.dotVisibleVersion=e.version,(0,i.vE)("featureInfo",e))}function s(){const e=(0,i.TK)("featureInfo");null!=e&&e.version&&(e.dotVisibleVersion=e.version,e.cardVisibleVersion=e.version,(0,i.vE)("featureInfo",e))}},7323:(e,t,n)=>{n.d(t,{EX:()=>s,P9:()=>a,RB:()=>o,Z_:()=>i,cT:()=>l,pX:()=>r,pi:()=>c});const i="https://www.bilibili.com/video/BV18h411o7Go/?spm_id_from=333.337.search-card.all.click&vd_source=9ae70c4a7d1caf5f0565fa412b8b57bf8#onboarding_have_a_try",o="#onboarding_have_a_try",s="https://sameerbajaj.com/jobs/#onboarding_have_a_try",a="https://36kr.com/p/997609012833538#onboarding_have_a_try",r="https://sameerbajaj.com/jobs/",l="https://36kr.com/p/997609012833538#onboarding_have_a_try",c="#from_feed_card"},21137:(e,t,n)=>{n.d(t,{J:()=>p,f:()=>m});var i=n(10633),o=n(14065),s=n(69232),a=n(89739),r=n(54483),l=n(60822),c=n(71905),d=n(50479),u=n(30065),h=n(41351);const m=function(){var e=(0,o.A)((function*(e){var t;const{pdfUrl:n,fromSource:i}=e;let o=null===(t=(0,c.n5)().mainConversation)||void 0===t?void 0:t.conversation_id;if(!o)try{var d,m;const e=(0,c.n5)();o=null===(m=(yield s.j.apiService.samantha.ThreadCreate({bot_id:null===(d=e.mainConversation)||void 0===d?void 0:d.bot_id})).data)||void 0===m||null===(m=m.thread_info)||void 0===m||null===(m=m.conversation)||void 0===m?void 0:m.conversation_id}catch(g){u.vF.persist.error({eventName:"PDF-READ create convId fail",error:g})}if(!o)return void u.vF.persist.error({eventName:"PDF-READ convId empty",error:new Error("empty convId")});const p=`${a.C1}/pdf/${o}/${encodeURIComponent(n)}?from_source=${i}`;window.open(p),l.l.getState().isSidePanelMode&&(h._.isInSidePanel?setTimeout((()=>{l.l.getState().setIsShowSidebar(!1,r.cz.other)}),150):l.l.getState().setIsShowSidebar(!1,r.cz.other))}));return function(t){return e.apply(this,arguments)}}();const p=new class{constructor(){(0,i.A)(this,"blobChunkMap",{}),(0,i.A)(this,"port",null)}onFileChunk(e){const{id:t,chunkIndex:n=0,chunks:i=0,binaryText:o,error:s}=e||{},a=this.blobChunkMap[t];if(a){const[e,r,l]=a;if(s)return l(),void delete this.blobChunkMap[t];const c=new Uint8Array(o.length);for(let t=0;t<c.length;t++)c[t]=o.charCodeAt(t);e[n]=new Blob([c],{type:r}),n>=i&&(l(new Blob(e,{type:r})),delete this.blobChunkMap[t])}}getFileBlob(e,t,n){const i=Math.random().toString(32).slice(2);this.blobChunkMap[i]=[[],t,n],this.port||(this.port=(0,d.c)("file-reader"),this.port.onMessage.addListener(this.onFileChunk.bind(this))),this.port.postMessage({body:{url:e,id:i}})}}},19552:(e,t,n)=>{n.d(t,{Bq:()=>g,Ev:()=>w,Is:()=>_,OX:()=>p,PT:()=>A,Wd:()=>m,Zv:()=>C,bg:()=>y,ld:()=>h,mJ:()=>I,mW:()=>v,n7:()=>x,nG:()=>f,qZ:()=>k,y4:()=>b});var i=n(14065),o=n(44557),s=n(48869),a=n(85371),r=n(63623),l=n(41121),c=n(38671),d=n(45602);const u=e=>{if("string"==typeof e)try{const t=JSON.parse(e);return!("object"!=typeof t||!t)}catch(t){return!1}return!1},h=e=>{if(!u(e))return!1;return!!JSON.parse(e).some((e=>f(null==e?void 0:e.timestamp)))},m=e=>{if(!e)return"";return new URL(location.href).searchParams.get(e.searchParam)||""},p=()=>{var e;let t="",n="";if(!(0,c.jB)("bilibili"))return{videoId:t,title:n};let i=location.pathname;i=i.endsWith("/")?i.slice(0,-1):i;const o=i.split("/");t=o[o.length-1],n=(null===(e=document.querySelector(".video-title"))||void 0===e?void 0:e.innerHTML)||"";return{videoId:t,partId:new URL(location.href).searchParams.get("p")||"0",title:n}},g=e=>{var t;if(!u(e))return"";const n=JSON.parse(e);if(!n.some((e=>f(null==e?void 0:e.timestamp))))return"";return null==n||null===(t=n.filter((e=>f(null==e?void 0:e.timestamp)&&e.section)))||void 0===t?void 0:t.map((e=>{var t;if(e.bullet_points&&(null===(t=e.bullet_points)||void 0===t?void 0:t.length)>0){const t=e.bullet_points.filter((e=>f(null==e?void 0:e.timestamp)&&e.point)),n=(0,s.A)(t,"timestamp",["asc"]);return(0,o.A)((0,o.A)({},e),{},{bullet_points:n})}}))},v=e=>{let t="";const n=g(e);return n&&0!==n.length?(n.map((e=>{var n;const i=(0,r.i)(e.timestamp);t+=`\n[${i}] ${e.section}`,t+="\n",e.bullet_points&&(null===(n=e.bullet_points)||void 0===n?void 0:n.length)>0&&e.bullet_points.map(((n,i)=>{const o=(0,r.i)(n.timestamp);t+=`\t[${o}] ${n.point}`,i!==e.bullet_points.length-1&&(t+="\n")}))})),t):""},f=e=>Number(e)>=0,_=(e,t)=>{const{setHighlightExploreCount:n}=l.e.getState();new IntersectionObserver((e=>{e.forEach((e=>{if(e.target instanceof HTMLElement&&e.isIntersecting){const{highlightExploreCount:e}=l.e.getState();n(),t(e+1)}}))})).observe(e)},x=e=>{const t=e[e.length-1];return t.bullet_points&&t.bullet_points.length>0?t.bullet_points[t.bullet_points.length-1].timestamp:t.timestamp},y=()=>{const e=document.querySelector("#wxwork-share-pic");if(!e)return"";const t=e.getAttribute("src");if(!t)return"";const n=t.lastIndexOf("@");return n<=0?"":`https:${t.slice(0,n)}`},b=e=>`https://img.youtube.com/vi/${e}/maxresdefault.jpg`,w=e=>{var t;if(!e||e.length<=0)return;const n=(null===(t=e[e.length-1])||void 0===t?void 0:t.offset)/1e3>3600||!1;return"Time,Transcript\n"+e.map((e=>{if((0,a.A)(null==e?void 0:e.offset)||!f(null==e?void 0:e.offset)||!e.text)return;return`${(0,r.i)(e.offset/1e3,n)},${e.text}`})).join("\n")};function C(){return/youtube/.test(location.hostname)?"youtube":/bilibili/.test(location.hostname)?"bilibili":"youtube"}function A(e){return S.apply(this,arguments)}function S(){return(S=(0,i.A)((function*(e){const t=C();let n=window.location.href;return"bilibili"===t&&(n=yield(0,d.Z)(e)),n}))).apply(this,arguments)}function I(e){return"bilibili"===C()?y():b(e)}function k(){var e;var t;return"bilibili"===C()?(null===(t=document.querySelector(".bpx-player-ctrl-time-duration"))||void 0===t?void 0:t.innerText)||"":(null===(e=document.querySelector(".ytp-time-duration"))||void 0===e?void 0:e.innerText)||""}},77960:(e,t,n)=>{n.d(t,{I_:()=>l,X_:()=>s,_1:()=>a,gq:()=>r});var i=n(10633),o=n(11855);let s=function(e){return e.recommendVideo="recommendvideo_list_click",e.playNext="next_button",e.recommendVideoEnding="recommendvideo_ending_click",e}({});const a=new class{constructor(){(0,i.A)(this,"_isImmersionMode",!1),(0,i.A)(this,"_lastEntryFullScreenFrom",void 0),(0,i.A)(this,"_shouldSummaryVideoDefault",!1),(0,i.A)(this,"_lastRelayBtnType",s.playNext),(0,i.A)(this,"_lastRelayBtnTime",Date.now()),(0,i.A)(this,"_currentTranscript",void 0),(0,i.A)(this,"_videoSummaryMsgBlock",{}),(0,i.A)(this,"_moduleClickFrom",void 0)}isImmersionMode(){return this._isImmersionMode}setImmersionMode(e){this._isImmersionMode=e}getLastEntryFullScreenFrom(){return this._lastEntryFullScreenFrom}updateEntryFullScreenFrom(e){this._lastEntryFullScreenFrom=e}updateTranscriptData(e){this._currentTranscript=e}getTranscriptData(){return this._currentTranscript}hasTranscript(){var e;return Boolean(null===(e=this._currentTranscript)||void 0===e?void 0:e.length)}shouldSummaryVideoDefault(){return this._shouldSummaryVideoDefault}updateShouldSummaryVideoDefault(e){this._shouldSummaryVideoDefault=e}getLastClickRelayBtnType(){return this._lastRelayBtnType}recordClickRelayBtnType(e){this._lastRelayBtnType=e,this._lastRelayBtnTime=Date.now()}resetClickRelayBtnType(e){if(e)return this._lastRelayBtnType=s.playNext,void(this._lastRelayBtnTime=Date.now());Date.now()-this._lastRelayBtnTime>1e4&&(this._lastRelayBtnType=s.playNext,this._lastRelayBtnTime=Date.now())}updateVideoSummaryId(e){this._videoSummaryMsgBlock.videoSummaryId=e}updateVideoHighlightsId(e){this._videoSummaryMsgBlock.videoHighlightsId=e}getVideoSummaryMsgBlock(){return this._videoSummaryMsgBlock}updateModuleClickFrom(e){this._moduleClickFrom||(this._moduleClickFrom=e)}getModuleClickFrom(){return this._moduleClickFrom}resetVideoSummaryStatus(){this._moduleClickFrom=void 0,this.updateTranscriptData(),this.updateVideoSummaryId(),this.updateVideoHighlightsId()}};function r(){const[e,t]=(0,o.useState)(a.isImmersionMode());return[e,(0,o.useCallback)((e=>{a.setImmersionMode(e),t(e)}),[t])]}function l(){const[e,t]=(0,o.useState)(a.shouldSummaryVideoDefault());return[e,t]}},14572:(e,t,n)=>{n.d(t,{F8:()=>o,dE:()=>i});const i="request_tts_audio",o="receive_tts_audio"},31525:(e,t,n)=>{n.d(t,{A:()=>l,m:()=>r});var i,o=n(10633),s=n(71905),a=n(58735);class r{static getInstance(){return r._instance}init(){void 0===this._hostId&&(this._hostId=(0,s.TK)("hostId"),this._listenBrandInfoMessage(),this._listenStoreMessage(),this._sendHostIdMessage(),this._sendBrandInfo(),this._listenHostIdMessage())}registerRecyclable(e){this._recyclables.push(e)}registerRecyclables(e){e.forEach((e=>{e&&this._recyclables.push(e)}))}registerStore(e,t){this._stores.set(e,t)}getHostId(){return this._hostId}constructor(){(0,o.A)(this,"_recyclables",[]),(0,o.A)(this,"_stores",new Map),(0,o.A)(this,"_hostId",void 0),(0,o.A)(this,"_listenHostIdMessage",(()=>{window.addEventListener("message",this._hostIdMessageHandler)})),(0,o.A)(this,"_listenStoreMessage",(()=>{window.addEventListener("message",this._storeMessageHandler)})),(0,o.A)(this,"_listenBrandInfoMessage",(()=>{window.addEventListener("message",this._brandInfoMessageHandler)})),(0,o.A)(this,"_hostIdMessageHandler",(e=>{var t,n,i,o;void 0!==(null==e||null===(t=e.data)||void 0===t?void 0:t.brand)&&(null==e||null===(n=e.data)||void 0===n?void 0:n.brand)!==a.R3||void 0!==(null==e||null===(i=e.data)||void 0===i?void 0:i.hostId)&&(null==e||null===(o=e.data)||void 0===o?void 0:o.hostId)!==this._hostId&&(window.removeEventListener("message",this._hostIdMessageHandler),this._destory())})),(0,o.A)(this,"_brandInfoMessageHandler",(e=>{var t;null!=e&&null!==(t=e.data)&&void 0!==t&&null!==(t=t.extensionReq)&&void 0!==t&&t.requireExtensionInfo&&this._sendBrandInfo(e.origin)})),(0,o.A)(this,"_storeMessageHandler",(e=>{var t,n,i;if(void 0!==(null==e||null===(t=e.data)||void 0===t?void 0:t.brand)&&(null==e||null===(n=e.data)||void 0===n?void 0:n.brand)!==a.R3)return;if(void 0===(null==e||null===(i=e.data)||void 0===i?void 0:i.storeData))return;const o=JSON.parse(e.data.storeData);Object.keys(o).forEach((e=>{const t=this._stores.get(e);t&&t.setState(JSON.parse(o[e]))}))})),(0,o.A)(this,"_sendStoreData",(()=>{const e={};this._stores.forEach(((t,n)=>{e[n]=JSON.stringify(t.getState())}));const t=JSON.stringify(e);window.postMessage({storeData:t}),this._stores.clear()}))}_sendHostIdMessage(){window.postMessage({hostId:this._hostId,brand:a.R3})}_sendBrandInfo(e="*"){const t={brandName:a.R3,version:chrome.runtime.getManifest().version};window.postMessage({extensionRes:t},e)}_destory(){window.removeEventListener("message",this._storeMessageHandler),window.removeEventListener("message",this._brandInfoMessageHandler),this._sendStoreData(),this._recyclables.forEach((e=>{try{"function"==typeof e?e():"function"==typeof(null==e?void 0:e.destory)&&e.destory()}catch(t){console.error("\u6267\u884cdestroy\u5931\u8d25 ",t)}})),this._recyclables=[]}}function l(e){r.getInstance().registerRecyclable(e)}i=r,(0,o.A)(r,"_instance",new i)},76258:(e,t,n)=>{var i={};n.r(i),n.d(i,{BilibiliImmersionPlayer:()=>Gl,YoutubeImmersionPlayer:()=>Zl});var o={};n.r(o),n.d(o,{autoTranslatePageRequestHandler:()=>gx,chatPageReadyHandler:()=>lx,imMessage:()=>bx,locateHighlightDomHandler:()=>dx,readPageRequestHandler:()=>ux,readingWebpageContext:()=>xx,routerChangeHandler:()=>_x,translatePageRequestHandler:()=>px,translateShowOriginRequestHandler:()=>vx,updateZustandStateHandler:()=>hx});var s={};n.r(s),n.d(s,{closeSidebarHandler:()=>Oy,contentMenuClickHandler:()=>Vy,openSidebarHandler:()=>Sp,receiveTTSAudio:()=>Wy.J,tabActivatedHandler:()=>$y,toggleSidebarHandler:()=>Ky});var a=n(44557),r=n(14065),l=(n(95585),n(44644)),c=n(69232),d=n(61577),u=n(31525),h=n(37462),m=n(75541),p=n(67697),g=n(75420),v=n(9584);var f=n(11855),_=n(54483);let x=function(e){return e[e.google=_.g6.google]="google",e[e.baidu=_.g6.baidu]="baidu",e[e.bing=_.g6.bing]="bing",e}({});var y=n(10633),b=n(63379);const w=(e=!1)=>{const t=document.createElement("div"),n={display:"flex",position:"relative",alignItems:"center",justifyContent:"center",margin:"0 auto",width:"800px",boxSizing:"border-box"};let i=null;return e&&(i=document.createElement("div"),t.appendChild(i),i.style.width="800px",i.style.display="block",i.style.position="relative",i.style.margin="0 auto",i.style.width="800px",i.style.boxSizing="border-box",n.width="100%"),(0,b.A)(t.style,n),{mountNode:t,contentNode:i}},C=e=>document.body.querySelector(e);const A=new class{constructor(){(0,y.A)(this,"mountContainer",null),(0,y.A)(this,"getInputEl",(()=>C("input[name='q']")||C("textarea[name='q']")||null)),(0,y.A)(this,"triggerSearch",(()=>{var e;const t=C('form[role="search"]');null==t||null===(e=t.submit)||void 0===e||e.call(t)})),(0,y.A)(this,"getAvatarSize",(()=>24))}getMountContainer(){try{const t=document.createElement("div");(0,b.A)(t.style,{display:"inline-flex",alignItems:"center",justifyContent:"center",zIndex:9,height:"100%",paddingRight:"8px",paddingLeft:"8px"});const n=this.getInputEl();if(n){var e;const i=null===(e=n.parentElement)||void 0===e?void 0:e.nextElementSibling,o=(null==i?void 0:i.children)||[];if(o.length)for(let e=0;e<o.length;e++)if("DIV"===o[e].tagName)return i.insertBefore(t,o[e].nextElementSibling),this.mountContainer=t,this.mountContainer}}catch(t){console.error(t)}return null}getQueryContent(){var e;return(null===(e=this.getInputEl())||void 0===e?void 0:e.value)||""}reset(){var e;null===(e=this.mountContainer)||void 0===e||e.remove(),this.mountContainer=null}};const S=new class{constructor(){(0,y.A)(this,"mountContainer",null)}getMountContainer(){try{var e;const{mountNode:t}=w();t.style.margin="24px auto 50px auto",t.style.zIndex="1";const n=C('form[role="search"]');if(null!=n&&null!==(e=n.parentElement)&&void 0!==e&&e.parentElement)return n.parentElement.parentElement.insertBefore(t,n.parentElement.nextElementSibling),this.mountContainer=t,this.mountContainer}catch(t){console.error(t)}return null}reset(){var e;null===(e=this.mountContainer)||void 0===e||e.remove(),this.mountContainer=null}getThemeMode(){try{const e=getComputedStyle(document.body).backgroundColor,t=/rgb\((\d+),\s(\d+),\s(\d+)\)/g.exec(e);if(t){const e=[t[1],t[2],t[3]].map((e=>Number(e)/255)).sort();return(e[0]+e[2])/2>.5?"light":"dark"}}catch(e){}return""}},I={brand:x.google,search:A,feed:S};var k=n(85886);const j=()=>C("#sb_form");const E=new class{constructor(){(0,y.A)(this,"mountContainer",null),(0,y.A)(this,"unSubscribers",[]),(0,y.A)(this,"getAvatarSize",(()=>28))}getMountContainer(){try{const e=document.createElement("div");(0,b.A)(e.style,{display:"inline-flex",zIndex:9,height:"100%",alignItems:"center",justifyContent:"center",marginRight:"8px",position:"absolute"});const t=j();if(t)return this.mountContainer=e,t.appendChild(e),this.updateStyle(),e}catch(e){}return null}getInputEl(){return C('input[name="q"]')}getQueryContent(){var e;return null===(e=this.getInputEl())||void 0===e?void 0:e.value}reset(){var e;this.unSubscribers=[],this.unSubscribers.forEach((e=>null==e?void 0:e())),null===(e=this.mountContainer)||void 0===e||e.remove(),this.mountContainer=null}updateStyle(){const e=this.getInputEl();this.mountContainer&&e&&(this.mountContainer.style.left=e.offsetWidth-36+"px",e.style.paddingRight="40px")}onMountNode(){const e=(0,k.A)((()=>{this.updateStyle()}),100,{leading:!0,trailing:!0});window.addEventListener("resize",e),this.unSubscribers.push((()=>{window.addEventListener("resize",e)}));const t=j(),n=new MutationObserver((0,k.A)((()=>{this.mountContainer&&(t.contains(this.mountContainer)||t.appendChild(this.mountContainer),this.updateStyle())}),100,{leading:!0,trailing:!0}));n.observe(t,{childList:!0,attributes:!0}),this.unSubscribers.push((()=>n.disconnect()))}triggerSearch(){var e,t;null===(e=j())||void 0===e||null===(t=e.submit)||void 0===t||t.call(e)}};var T=n(21919),N=n(86548);const M={borderRadius:"16px",padding:"12px 20px 16px",boxShadow:"0 2px 4px 1px rgba(0, 0, 0, 0.09)",backdropFilter:"blur(2px)"},R={marginBottom:"48px",marginTop:"20px",width:"100%"},L=()=>C("form .below_sbox"),P=()=>{try{var e;const n=((null===(e=document.cookie)||void 0===e?void 0:e.split(/;\s+/))||[]).find((e=>e.includes("_HPVN=")));if(n){var t;const e=(((null===(t=n.split("_HPVN=")[1])||void 0===t?void 0:t.split("&"))||[]).find((e=>e.startsWith("CS=")))||"").split("CS=")[1]||"";return(0,N.O)((0,T.D4)(e),{})}}catch(n){}return null},B=(()=>{let e=null,t=!1;return{checkReady:()=>{var n;return t||(t=!0,(()=>{try{var t,n;if(((null===(t=document.cookie)||void 0===t?void 0:t.split(/;\s+/))||[]).some((e=>"BENVER=1"===e.split("ENSEARCH=")[1]))||"zh"!==(null===(n=document.documentElement)||void 0===n?void 0:n.getAttribute("lang")))return void(e={status:"success",wait:!1});const i=P();if(i&&void 0!==typeof(null==i?void 0:i.Tobn))return void(e={status:"success",wait:0===i.Tobn})}catch(i){}e={status:"fail"}})()),Boolean(C("#tobPrompt"))||"success"===(null===(n=e)||void 0===n?void 0:n.status)&&!e.wait}}})();const D=new class{constructor(){(0,y.A)(this,"mountContainer",null),(0,y.A)(this,"unSubscribers",[]),(0,y.A)(this,"themeMode","")}getAndSubscribeContainerStyle(e){e(M)}getMountContainer(){return new Promise((e=>{const{mountNode:t}=w();(0,b.A)(t.style,R);const n=n=>{const i=n||L();i?(i.appendChild(t),this.mountContainer=t,e(t)):e(null)},i=(e=>{const{retryCount:t=20,gap:n=500,onCheck:i,onDone:o}=e;let s=-1;const a=e=>{i()||e>=t?o():s=setTimeout((()=>a(e+1)),n)};return a(0),()=>{clearTimeout(s)}})({retryCount:10,gap:500,onCheck:()=>B.checkReady(),onDone:()=>n()});this.unSubscribers.push(i)}))}reset(){var e;null===(e=this.mountContainer)||void 0===e||e.remove(),this.mountContainer=null,this.unSubscribers.forEach((e=>null==e?void 0:e())),this.unSubscribers=[]}onMountNode(){const e=(0,k.A)((()=>{var e;this.mountContainer&&(Number(null===(e=document.scrollingElement)||void 0===e?void 0:e.scrollTop)>0?this.mountContainer.style.display="none":this.mountContainer.style.display="flex")}),200,{leading:!0,trailing:!0});document.addEventListener("scroll",e),this.unSubscribers.push((()=>{document.removeEventListener("scroll",e)}));const t=(0,k.A)((()=>{const e=C("#scroll_cont")||C(".show_all_onerowup");e&&(window.innerHeight>=700&&window.innerHeight<=1280?e.style.top="100%":e.style.top="")}),500,{leading:!0});t(),window.addEventListener("resize",t),this.unSubscribers.push((()=>window.removeEventListener("resize",t)));const n=L();if(n){const e=new MutationObserver((0,k.A)((()=>{this.mountContainer&&n.lastElementChild!==this.mountContainer&&n.appendChild(this.mountContainer)}),100,{leading:!0,trailing:!0}));e.observe(n,{childList:!0}),this.unSubscribers.push((()=>e.disconnect()))}}getThemeMode(){return this.themeMode||(this.themeMode=(()=>{var e,t;const n=P();let i=null!==(e=document.body.className)&&void 0!==e&&e.includes("b_dark")?"dark":"light";try{var o;const e=((null===(o=document.cookie)||void 0===o?void 0:o.split(/;\s+/))||[]).find((e=>e.includes("SRCHHPGUSR=")));if(e){var s;const t=((null===(s=e.split("SRCHHPGUSR=")[1])||void 0===s?void 0:s.split("&"))||[]).find((e=>e.startsWith("WEBTHEME=")))||"";switch(`${t.split("WEBTHEME=")[1]}`){case"0":i="light";break;case"1":i="dark";break;case"2":i="system"}}}catch(a){}return"light"!==i&&(n&&0===n.Iotd||null===(t=C(".hp_body"))||void 0===t||null===(t=t.className)||void 0===t||!t.includes("no_image"))&&(i="light"),i})()),this.themeMode}},F={brand:x.bing,search:E,feed:D};let U=88;const H=new class{constructor(){(0,y.A)(this,"mountContainer",null),(0,y.A)(this,"unSubscribers",[]),(0,y.A)(this,"onInputChange",(0,k.A)((()=>{this.updateContainerPosition()}),200,{leading:!0,trailing:!0})),(0,y.A)(this,"getAvatarSize",(()=>20))}getMountContainer(){try{const e=this.getInputEl(),t=document.createElement("div");if((0,b.A)(t.style,{display:"inline-flex",position:"absolute",top:"0px",right:`${U}px`,zIndex:9,height:"100%",alignItems:"center",justifyContent:"center",transform:"translateY(-1px)"}),null!=e&&e.parentElement)return e.nextElementSibling?e.parentElement.insertBefore(t,e.nextElementSibling):e.parentElement.appendChild(t),this.mountContainer=t,this.mountContainer}catch(e){console.error(e)}return null}getInputEl(){return document.querySelector("input[name=wd]")}getQueryContent(){var e;return(null===(e=this.getInputEl())||void 0===e?void 0:e.value)||""}onMountNode(){const e=this.getInputEl();e&&e.addEventListener("input",this.onInputChange);const t=C("#form .quickdelete");if(t){const e=new MutationObserver((e=>{this.updateContainerPosition()}));e.observe(t,{attributes:!0}),this.unSubscribers.push((()=>e.disconnect()))}const n=document.getElementById("wrapper_wrapper");if(n){const e=new MutationObserver((e=>{for(const t of e){if("childList"!==t.type)break;for(const e of t.addedNodes)if("container"===(null==e?void 0:e.id))return void this.reset()}}));e.observe(n,{childList:!0}),this.unSubscribers.push((()=>e.disconnect()))}const i=C("#form");if(i){const e=()=>{U=i.className.includes("has-voice")?88:56,this.updateContainerPosition()},t=new MutationObserver(e);t.observe(i,{attributes:!0}),this.unSubscribers.push((()=>t.disconnect())),e()}}updateContainerPosition(){if(this.mountContainer){const e=this.getQueryContent();this.mountContainer.style.right=`${U+(e?32:0)}px`}}triggerSearch(){var e;const t=C("input[id='su']");null===(e=t.click)||void 0===e||e.call(t)}reset(){var e,t;null===(e=this.getInputEl())||void 0===e||e.removeEventListener("input",this.onInputChange),this.unSubscribers.forEach((e=>null==e?void 0:e())),this.unSubscribers=[],null===(t=this.mountContainer)||void 0===t||t.remove(),this.mountContainer=null}},z=()=>C("#s_wrap"),O=()=>C("#s_main");const q=[new class{constructor(){(0,y.A)(this,"mount",((e,t)=>{if(C("#head_wrapper #s-hotsearch-wrapper")){const n=z();if(n){n.insertBefore(e,n.firstElementChild);const i=t||e;return i.style.marginTop="32px",i.style.marginBottom="50px",!0}}return!1}))}},new class{constructor(){(0,y.A)(this,"unSubscribers",[]),(0,y.A)(this,"innerNodeStyle",{}),(0,y.A)(this,"mount",((e,t)=>{const n=z(),i=O();if(n&&i){n.insertBefore(e,n.firstElementChild);const o=getComputedStyle(i),s=i.scrollWidth||800;return(t||e).style.width=`${s}px`,this.innerNodeStyle={marginBottom:"50px",padding:"14px 32px",borderRadius:o.borderRadius,background:o.background},!0}return!1}))}destroy(){this.unSubscribers.forEach((e=>null==e?void 0:e())),this.unSubscribers=[]}onMount(e,t){const n=O(),i=t||e;if(t&&n){const e=(0,k.A)((()=>{const e=n.scrollWidth||800;i.style.width=`${e}px`}),500);window.addEventListener("resize",e),this.unSubscribers.push((()=>{window.removeEventListener("resize",e)}))}}getInnerNodeStyle(){return this.innerNodeStyle}}];const V=new class{constructor(){(0,y.A)(this,"mountContainer",null),(0,y.A)(this,"contentContainer",document.createElement("div")),(0,y.A)(this,"mountStrategy",null),(0,y.A)(this,"getThemeMode",(()=>"light"))}getAndSubscribeContainerStyle(e){var t,n;e((null===(t=this.mountStrategy)||void 0===t||null===(n=t.getInnerNodeStyle)||void 0===n?void 0:n.call(t))||{})}getMountContainer(){try{const{mountNode:e,contentNode:t}=w(!0);for(let n=0;n<q.length;n++){const i=q[n];if(i.mount(e,t))return this.mountStrategy=i,this.mountContainer=e,this.contentContainer=t,e}}catch(e){console.error(e)}return null}reset(){var e,t,n;null===(e=this.mountContainer)||void 0===e||e.remove(),this.mountContainer=null,null===(t=this.mountStrategy)||void 0===t||null===(n=t.destroy)||void 0===n||n.call(t),this.mountStrategy=null}onMountNode(){var e,t;this.mountStrategy&&this.mountContainer&&(null===(e=this.mountStrategy)||void 0===e||null===(t=e.onMount)||void 0===t||t.call(e,this.mountContainer,this.contentContainer))}},$={brand:x.baidu,search:H,feed:V},K=e=>(0,a.A)({unmount:()=>{e.feed.reset(),e.search.reset()}},e),W=e=>{switch(e){case x.baidu:return K($);case x.bing:return K(F);case x.google:return K(I);default:return null}},G=e=>""===e.replace(/\//g,""),Z=()=>{const{hostname:e,pathname:t}=window.location;switch(!0){case((e,t)=>e.endsWith("www.baidu.com")&&G(t))(e,t):return W(x.baidu);case((e,t)=>["www.bing.com","cn.bing.com"].includes(e)&&G(t)||t.includes("chrome/newtab"))(e,t):return W(x.bing);case((e,t)=>e.includes("www.google.com")&&(G(t)||t.endsWith("webhp")))(e,t):return W(x.google);default:return null}},Y=(0,f.createContext)({engine:{}});var J=n(71905);const Q=6e3;function X(){return X=(0,r.A)((function*(e,t=Q){return new Promise((n=>{const i=new AbortController;setTimeout((()=>{i.abort()}),t),fetch(e,{mode:"no-cors",signal:i.signal}).then((()=>{n(!0)})).catch((()=>{n(!1)}))}))})),X.apply(this,arguments)}let ee=function(e){return e.Youtube="https://www.youtube.com",e}({});const te=(e,t=!1)=>{var n;const i=(0,J.TK)("overseaAccessibility")||{},o=Date.now();i[e]&&o-(null===(n=i[e])||void 0===n?void 0:n.latest_check)<6e5||function(e){return X.apply(this,arguments)}(e).then((t=>{(0,J.vE)("overseaAccessibility",{[e]:{available:t,latest_check:Date.now()}},!0)}))};var ne=n(29019),ie=n.n(ne);let oe=function(e){return e[e.Youtube=1]="Youtube",e[e.Podcast=2]="Podcast",e[e.Bilibili=3]="Bilibili",e}({}),se=function(e){return e[e.WebCard=1]="WebCard",e}({});const ae=e=>{const{card_type:t}=e;if(t===se.WebCard)return e.web_card};var re=n(91689),le=n(9012);const ce={[se.WebCard]:"web_card"};var de=n(76482),ue=n(30065),he=n(58735),me=n(17753);const pe=[{card_type:se.WebCard,content_type:oe.Youtube,expect_cnt:1},{card_type:se.WebCard,content_type:oe.Bilibili,expect_cnt:1},{card_type:se.WebCard,content_type:oe.Podcast,expect_cnt:1}],ge=[{card_type:se.WebCard,content_type:oe.Bilibili,expect_cnt:2},{card_type:se.WebCard,content_type:oe.Podcast,expect_cnt:1}],ve=(se.WebCard,oe.Youtube,e=>e?pe:ge),fe=(e,t)=>{const n=[],i=new Set;return e.forEach((({card_type:e,content_type:o,expect_cnt:s})=>{for(let a=0;a<s;a++){const s=t.find((t=>t.card_type===e&&(0,le.A)(t,ce[e]).content_type===o&&!i.has(t.card_id)));(null==s?void 0:s.card_id)&&i.add(s.card_id),n.push(s||{card_type:e,card_id:"",web_card:{content_type:o}})}})),n},_e="feedcard-latest-data",xe=function(){var e=(0,r.A)((function*(e){try{e(yield de.A.get(_e))}catch(t){}}));return function(t){return e.apply(this,arguments)}}(),ye=()=>{var e;const[t,n]=(0,f.useState)(!0),[i,o]=(0,f.useState)(!1),[s,a]=(0,f.useState)(fe(ve(!1),[])),l=(0,f.useRef)({}),c=(0,f.useRef)(!1),d=null===(e=(0,v.Y)("overseaAccessibility")[0])||void 0===e||null===(e=e[ee.Youtube])||void 0===e?void 0:e.available,u=(0,f.useMemo)((()=>ve(d)),[d]),m=(0,f.useCallback)((0,r.A)((function*(){if(t&&c.current)return;c.current=!0,n(!0);const e=Object.keys(l.current);a(fe(u,[]));try{const t=yield(0,me.C$)({expect_cards:u,exposed_card_ids:e}),n=(null==t?void 0:t.card_list)||[];if(n.length){n.forEach((e=>{l.current[e.card_id]=e}));const e=fe(u,n);a(e),i=e,de.A.set(_e,i).catch(h.A)}else if(t instanceof Error){`${(0,N.O)(t.message,{code:0}).code}`==`${he.Be}`?(o(!0),xe((e=>{(0,re.A)(e)?a(e):ue.vF.persist.error({eventName:"[feed-card] recover fail",error:t})}))):ue.vF.persist.error({eventName:"[feed-card] fetch error",error:t})}}catch(s){}finally{n(!1)}var i})),[t,u]);return(0,f.useEffect)((()=>{m()}),[]),{cards:s,loading:t,refreshCards:m,isLimited:i}};var be=n(30435),we=n(9462),Ce=n(30457),Ae=n(82980),Se=n(34350);const Ie="header-iBbDgU",ke="tips-x3jam8",je="action-lbte1y",Ee="login-action-dChWjT",Te="change-action-Utd8Su",Ne="divider-YqrKLH",Me="close-wrapper-J4iZGH",Re="close-btn-PLjZ7k";var Le=n(63159);const Pe=({onSwitch:e,onCloseOnce:t,needLogin:n=!1,onClickCloseBtn:i})=>{const o=(0,g.B)(),[s,a]=(0,f.useState)(!1);return(0,Le.jsxs)("div",{className:Ie,children:[(0,Le.jsxs)("div",{className:ke,children:[(0,Le.jsx)("img",{src:(0,Se.Nf)(),style:{width:20,height:20}}),o("flow_web_ext_newtab_title",{brandName:(0,Se.L2)()})]}),(0,Le.jsxs)("div",{className:je,children:[n?(0,Le.jsx)("div",{className:Ee,onClick:()=>{(0,Ce.DT)({})},children:o("flow_web_ext_recommend_login")}):(0,Le.jsxs)("div",{className:Te,onClick:e,children:[(0,Le.jsx)(be._H0,{}),o("flow_web_ext_newtab_change")]}),(0,Le.jsx)("span",{className:Ne}),(0,Le.jsx)(Ae.A,{className:Me,disableKey:we.lf.searchAddons,position:"bottomRight",show:s,optionPageSection:"recommend-feed",setShow:a,renderChildren:({onTriggerClick:e})=>(0,Le.jsx)("span",{className:Re,onClick:t=>{null==i||i(),e(t)},children:(0,Le.jsx)(be.abE,{})}),onDisableOnceClick:t,disabledScene:[we.iI.page]})]})]})};var Be=n(34944);const De="card-XVyaSJ",Fe="head-MQjt0p",Ue="body-VqQqC5",He=({className:e,children:t,type:n,onClick:i})=>{const o=(0,g.B)();return(0,Le.jsxs)("div",{className:ie()(De,e),"data-testid":"feed-card-item",children:[(0,Le.jsx)("div",{className:Fe,children:o("video"===n?"flow_web_ext_newtab_videos":"flow_web_ext_newtab_podcasts")}),(0,Le.jsx)("div",{className:Ue,onClick:i,children:t})]})};var ze=n(18705);const Oe="multiple-line-XLxX3K",qe="shadow-e0FdJb",Ve=({content:e,lineHeight:t,className:n,enableShadow:i=!0})=>{const o=(0,f.useRef)(null),[s,r]=(0,f.useState)(!0),[l,c]=(0,f.useState)({lineHeight:`${t}px`});return(0,f.useEffect)((()=>{var e,n;if("undefined"!=typeof ResizeObserver){const e=()=>{const e=o.current;let n=-1;e&&(e.scrollHeight>e.offsetHeight?(r(!0),n=Math.floor(e.offsetHeight/t)):r(!1)),c((e=>(0,a.A)((0,a.A)({},e),{},{lineClamp:n,WebkitLineClamp:n})))};e();const n=new ResizeObserver((0,k.A)((()=>{e()}),200));return n.observe(o.current,{box:"border-box"}),()=>n.disconnect()}r(Number(null===(e=o.current)||void 0===e?void 0:e.scrollHeight)>Number(null===(n=o.current)||void 0===n?void 0:n.offsetHeight))}),[t,i]),(0,Le.jsxs)("div",{style:l,ref:o,className:ie()(n,Oe),children:[e,i&&s?(0,Le.jsx)("span",{className:qe}):null]})},$e="image-container-F46MzX",Ke="image-rnJKOz",We="time-oB1Yv3",Ge="desc-R4w_wU",Ze="title-dFfE1y",Ye="content-tkkwmO",Je="loading-I4jb9s";var Qe=n(8050),Xe=n(7323),et=n(42486);const tt="container-kX1lVz",nt="card-item-Pkn52b",it={[se.WebCard]:({data:e,className:t,onClick:n,loading:i=!0})=>{const{title:o="",cover_url:s="",summary:a="",duration_str:r="",content_type:l}=e||{};return(0,Le.jsx)(He,{type:l===oe.Podcast?"audio":"video",className:t,onClick:n,children:i?(()=>{const e=(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsx)(Be.EA.Image,{className:$e}),(0,Le.jsx)(Be.EA.Paragraph,{className:Ge,rows:3})]});return(0,Le.jsx)(Be.EA,{className:Je,loading:!0,active:!0,placeholder:e})})():(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsx)("div",{className:$e,children:(0,Le.jsxs)("div",{className:Ke,children:[(0,Le.jsx)("img",{src:s,referrerPolicy:"no-referrer"}),(0,Le.jsx)("span",{className:We,children:r})]})}),(0,Le.jsxs)("div",{className:Ge,children:[(0,Le.jsx)("div",{className:Ze,children:o}),(0,Le.jsx)(Ve,{className:Ye,content:(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsx)(ze.yK,{style:{verticalAlign:"sub",marginRight:4}}),a.replace(/\n/g,"")]}),lineHeight:18})]})]})})}},ot=()=>{var e,t,n;const{engine:i}=(0,f.useContext)(Y),o=(0,f.useRef)(null),[s,a]=(0,f.useState)(!1),{refreshCards:r,loading:l,cards:c,isLimited:d}=ye(),u=null===(e=(0,v.Y)("authInfo")[0])||void 0===e?void 0:e.isAuthenticated;(0,f.useEffect)((()=>{var e,t;null===(e=i.feed)||void 0===e||null===(t=e.getAndSubscribeContainerStyle)||void 0===t||t.call(e,(e=>{o.current&&(0,b.A)(o.current.style,e)})),ue.vF.persist.info({eventName:"[feed-card]-mounted",meta:{engine:null==i?void 0:i.brand}})}),[]),(0,f.useEffect)((()=>{l||c.forEach((e=>{const t=ae(e);e.card_id&&t&&((0,et.s)("show_suggested_content",{title:t.title,url:t.jump_link,content_type:t.content_type===oe.Podcast?"podcast":"video",current_page:i.brand}),(0,Qe.M7)({current_page:`${i.brand}`,show_from:"search_engine_suggested_content"}))}))}),[l,c]);const h=(null==c?void 0:c.map(((e,t)=>{const n=it[e.card_type];return n?(0,Le.jsx)(n,{data:ae(e),loading:l||Boolean(!e.card_id),className:nt,onClick:()=>(e=>{const t=ae(e);t&&((0,et.s)("click_suggested_content",{title:t.title,url:t.jump_link,content_type:t.content_type===oe.Podcast?"podcast":"video",current_page:i.brand}),(0,Qe.dn)({current_page:`${i.brand}`,click_from:"search_engine_suggested_content"}),t.jump_link&&window.open(`${t.jump_link}${Xe.pi}`))})(e)},e.card_id||t):null})).filter(Boolean))||[];return s?null:(0,Le.jsxs)("div",{ref:o,className:ie()(tt,"cici-ext-container",i.brand),"theme-mode":null==i||null===(t=i.feed)||void 0===t||null===(n=t.getThemeMode)||void 0===n?void 0:n.call(t),"data-testid":"feed-card-container",children:[(0,Le.jsx)(Pe,{onSwitch:()=>{(0,et.s)("click_suggested_content_button",{current_page:i.brand,button_name:"change"}),r(),ue.vF.persist.info({eventName:"[feed-card]-refresh",meta:{engine:null==i?void 0:i.brand}})},onCloseOnce:()=>{var e;null===(e=i.unmount)||void 0===e||e.call(i),a(!0)},needLogin:!u&&d,onClickCloseBtn:()=>{ue.vF.persist.info({eventName:"[feed-card]-click-close-btn",meta:{engine:null==i?void 0:i.brand}}),(0,et.s)("click_suggested_content_button",{current_page:i.brand,button_name:"close"})}}),c.length?(0,Le.jsx)("div",{className:"flex gap-12 mt-8","data-testid":"feed-card-body",children:h}):null]})},st=()=>{var e;const t=null===(e=(0,v.Y)("authInfo")[0])||void 0===e?void 0:e.isAuthenticated;return(0,Le.jsx)(ot,{},t?"login":"unlogin")};var at=n(24473),rt=n(69021);const lt=()=>{const e=(0,at.Uk)(),t=(()=>{const[e]=(0,v.Y)("disableSearchAddonsGlobal");return!e})();return(0,Le.jsx)(p.Yd.Provider,{value:ue.vF,children:(0,Le.jsx)(g.C,{t:e,children:t&&(0,Le.jsx)(st,{})})})},ct=function(){var e=(0,r.A)((function*(e){const t=e.feed,n=u.m.getInstance().getHostId()||"",i=(e=>`new-recommend-card-${e}`)(n);if(document.body.querySelector(`#${i}`))return;t.reset();const o=yield t.getMountContainer();if(o){o.id=i,o.dataset.buttonHostId=n;const s=(o.firstElementChild||o).attachShadow({mode:"open"}),a=(0,m.createRoot)(s);(0,rt.NR)(s,he.QN).then((()=>{var n;null===(n=t.onMountNode)||void 0===n||n.call(t),a.render((0,Le.jsx)(Y.Provider,{value:{engine:e},children:(0,Le.jsx)(lt,{})}))}))}else console.error(`feed card mount target not found [${e.brand}]`),ue.vF.persist.error({eventName:"FeedCard mount card not found",error:new Error("feed card container not found"),meta:{engine:e.brand}})}));return function(t){return e.apply(this,arguments)}}(),dt=()=>{const e=Z(),t=null==e?void 0:e.feed;let n=h.A;if(e){var i;if(te(ee.Youtube),null!=t&&t.watchMountStatusChange)n=null===(i=t.watchMountStatusChange)||void 0===i?void 0:i.call(t,(()=>ct(e)));ct(e)}return()=>{null==t||t.reset(),n()}};var ut=n(77793),ht=n(53717),mt=n(48436),pt=n(41650),gt=n(43423),vt=n(21642),ft=n(37311);class _t{constructor(){(0,y.A)(this,"getInsertContainerSelectors",(()=>[])),(0,y.A)(this,"getMutationObserverDelay",(()=>0))}}class xt extends _t{constructor(...e){super(...e),(0,y.A)(this,"getCollectionType",(()=>mt.X.Web))}}class yt extends xt{constructor(...e){super(...e),(0,y.A)(this,"match",(()=>"https:"===location.protocol&&location.host.endsWith("zhihu.com"))),(0,y.A)(this,"getCollectionData",function(){var e=(0,r.A)((function*(e){const t=(0,ft.cQ)(e,e.closest(".MoreAnswers")?".List-item .ContentItem":".Card .ContentItem");if(!t)return null;const n=location.pathname.includes("/question"),i=yield(0,ft.dp)(t),o=i.querySelector(".ContentItem-actions");o&&(o.style.position="unset");const s=n?document.querySelector("h1.QuestionHeader-title"):i.querySelector(".ContentItem-title");let a=(0,ft.gs)(),r=location.href;if(s){a=(null==s?void 0:s.innerText)||"",s.remove();const e=s.querySelector("a");e&&(r=e.href)}if(n){var l;const e=null===(l=t.querySelector('.ContentItem > meta[itemprop="url"]'))||void 0===l?void 0:l.getAttribute("content");e&&(r=e)}const{desc:c,imageUrl:d}=yield(0,Ce.l_)(),{width:u,height:h}=t.getBoundingClientRect();return{text_content:i.innerText,html_content:i.innerHTML,dir:"",title:a,description:c,cover_image_url:d,source_url:r,content_height:h,content_width:u}}));return function(t){return e.apply(this,arguments)}}()),(0,y.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>{const t=(0,ft.cQ)(e,".List-item")||(0,ft.cQ)(e,".Card");return{containerElement:e,getCollectionData:()=>this.getCollectionData(e),style:{width:"24px",height:"24px","font-size":"16px","margin-left":"auto"},insertIndex:6,hoverListenerElement:t}}))})),(0,y.A)(this,"getInsertContainerSelectors",(()=>[".Card .ContentItem-actions"]))}}class bt extends xt{constructor(...e){super(...e),(0,y.A)(this,"match",(()=>{const{hostname:e,pathname:t}=location;return e.endsWith("onlinelibrary.wiley.com")&&t.includes("doi/")})),(0,y.A)(this,"getCollectionData",(0,r.A)((function*(){const e=document.querySelector("#article__content");if(!e)return null;const t=yield(0,ft.dp)(e);let n=(0,ft.gs)();const i=t.querySelector(".citation__title");i&&(n=i.innerText,i.remove());const{desc:o,imageUrl:s}=yield(0,Ce.l_)(),{width:a,height:r}=e.getBoundingClientRect();return{text_content:t.innerText,html_content:t.innerHTML,dir:"",title:n,description:o,cover_image_url:s,source_url:location.href,content_height:r,content_width:a}}))),(0,y.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>({insertIndex:0,containerElement:e,getCollectionData:this.getCollectionData,style:{width:"28px",height:"28px",display:"inline-block","z-index":"1",float:"left",margin:"-4px 24px 0 0"}})))})),(0,y.A)(this,"getInsertContainerSelectors",(()=>[".coolBar__wrapper .coolBar__second"]))}}class wt extends _t{constructor(...e){super(...e),(0,y.A)(this,"getCollectionType",(()=>mt.X.SocialWebCard))}}class Ct extends wt{constructor(...e){super(...e),(0,y.A)(this,"match",(()=>"https:"===location.protocol&&location.host.endsWith("weibo.com"))),(0,y.A)(this,"getCollectionData",function(){var e=(0,r.A)((function*(e){var t,n,i,o,s;const a=(0,ft.cQ)(e,"article.woo-panel-main");if(!a)return null;const r=document.createElement("div");let l=a.getBoundingClientRect().width;const c=a.querySelector("header");c&&(l=c.getBoundingClientRect().width);const d=(null===(t=a.querySelector('a[class*="head-info_time"]'))||void 0===t?void 0:t.href)||location.href,u=(0,ft.hj)(l);r.appendChild(u);const h=[a],m=document.querySelector("body > svg");m&&u.appendChild(m.cloneNode(!0));const p=null===(n=a.parentElement)||void 0===n?void 0:n.querySelector('div[class*="Detail_box"]');if(p){const e=p.querySelector("#composerEle");e&&h.push(e);const t=p.querySelector('div[class*="wbpro-tab"]');t&&h.push(t);const n=p.querySelectorAll('div[class*="wbpro-list"]');for(const i of n)h.push(i)}let g=0;h.forEach((e=>g+=e.getBoundingClientRect().height));const v=yield(0,ft.l5)(h,!1);if(!v.length)return null;const f=v[0];v.forEach(((e,t)=>{0===t?u.appendChild(e):f.appendChild(e)})),(0,ft.vg)(f),f.querySelectorAll(".woo-avatar-icon .woo-icon-main .woo-icon-frames").forEach((e=>e.remove()));const _=f.innerText,x=(null===(i=f.querySelector('div[class*="detail_wbtext"]'))||void 0===i?void 0:i.innerText)||_,y=(null===(o=f.querySelector(".woo-picture-main"))||void 0===o||null===(o=o.querySelector("img"))||void 0===o?void 0:o.getAttribute("data-img-tos-key"))||(null===(s=f.querySelector(".wbp-video .wbpv-poster"))||void 0===s?void 0:s.getAttribute("data-img-tos-key"))||"";return{text_content:_,html_content:r.innerHTML,body_content:x,content_img_key:y,content_height:g,content_width:l,source_url:d}}));return function(t){return e.apply(this,arguments)}}()),(0,y.A)(this,"getCollectionInsertInfo",(()=>{const e=[];this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))}));const t=e.length>1;return e.map((e=>{let n=null;const i={"margin-right":e.childElementCount?"8px":"0px"};var o;t&&(n=null===(o=(0,ft.cQ)(e,"article.woo-panel-main"))||void 0===o?void 0:o.parentElement);return{containerElement:e,getCollectionData:()=>this.getCollectionData(e),insertIndex:0,style:i,hoverListenerElement:n}}))})),(0,y.A)(this,"getInsertContainerSelectors",(()=>[".woo-panel-main header.woo-box-flex > .woo-box-flex"]))}}const At=()=>location.pathname.includes("/status/");class St extends wt{constructor(...e){var t;super(...e),t=this,(0,y.A)(this,"match",(()=>"https:"===location.protocol&&(location.host.endsWith("x.com")||location.host.endsWith("twitter.com")))),(0,y.A)(this,"getCollectionContent",(e=>{const t=(0,ft.cQ)(e,'div[data-testid="cellInnerDiv"]');return At()?null==t?void 0:t.parentElement:t})),(0,y.A)(this,"getCollectionData",function(){var e=(0,r.A)((function*(e){var n,i,o;const s=t.getCollectionContent(e);if(!s)return null;const a=document.createElement("div");let r=location.href,l=s.getBoundingClientRect().width,c=0;const d=s.querySelector("article > div");if(d){const{width:e}=d.getBoundingClientRect();l=e}const u=document.body.style.backgroundColor,h=(0,ft.hj)(l);u&&(h.style.backgroundColor=u),a.appendChild(h);const m=[];if(At())m.push(...s.querySelectorAll('div[data-testid="cellInnerDiv"]'));else{var p;m.push(s);const e=null===(p=s.querySelector('a[href*="status"]'))||void 0===p?void 0:p.href;e&&(r=e)}m.forEach((e=>c+=e.getBoundingClientRect().height));(yield(0,ft.l5)(m,!1)).forEach((e=>{e.style.position="unset",e.style.transform="none",h.appendChild(e)}));const g=h.querySelector("article");g&&(g.style.backgroundColor="unset");const v=a.innerText,f=(null===(n=s.querySelector('div[data-testid="tweetText"]'))||void 0===n?void 0:n.innerText)||v,_=null===(i=a.querySelector('div[aria-label="Image"]'))||void 0===i?void 0:i.querySelector("img"),x=null===(o=a.querySelector('button[aria-label="Play Video"]'))||void 0===o?void 0:o.querySelector("img"),y=a.querySelector("video[poster]"),b=(null==_?void 0:_.getAttribute("data-img-tos-key"))||(null==x?void 0:x.getAttribute("data-img-tos-key"))||(null==y?void 0:y.getAttribute("data-img-tos-key"))||"";return{text_content:v,html_content:a.innerHTML,body_content:f,content_height:c,content_width:l,content_img_key:b,source_url:r}}));return function(t){return e.apply(this,arguments)}}()),(0,y.A)(this,"getCollectionInsertInfo",(()=>{const e=[];this.getInsertContainerSelectors().forEach((t=>{if(At()){const n=document.querySelector(t);n&&e.push(n)}else e.push(...document.querySelectorAll(t))}));const t=e.length>1;return e.map((e=>{var n;let i=null;const o={};return t&&(o.visibility="hidden",i=this.getCollectionContent(e)),{containerElement:null===(n=e.parentElement)||void 0===n||null===(n=n.parentElement)||void 0===n||null===(n=n.parentElement)||void 0===n?void 0:n.parentElement,getCollectionData:()=>this.getCollectionData(e),insertIndex:0,style:o,hoverListenerElement:i}}))})),(0,y.A)(this,"getInsertContainerSelectors",(()=>['main section [data-testid="cellInnerDiv"] article [data-testid="caret"]']))}}class It extends xt{constructor(...e){super(...e),(0,y.A)(this,"match",(()=>{const{hostname:e,pathname:t}=location;return e.endsWith("www.tandfonline.com")&&t.includes("doi/full/")})),(0,y.A)(this,"getCollectionData",(0,r.A)((function*(){const e=document.querySelector("article.article");if(!e)return null;const t=yield(0,ft.dp)(e);let n=(0,ft.gs)();const i=document.querySelector(".NLM_article-title");i&&(n=i.innerText);const{desc:o,imageUrl:s}=yield(0,Ce.l_)(),{width:a,height:r}=e.getBoundingClientRect();return{text_content:t.innerText,html_content:t.innerHTML,dir:"",title:n,description:o,cover_image_url:s,source_url:location.href,content_height:r,content_width:a}}))),(0,y.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>({insertIndex:0,containerElement:e,getCollectionData:this.getCollectionData,style:{width:"24px",height:"30px",display:"inline-block","z-index":"1",float:"left","margin-right":"2px"}})))})),(0,y.A)(this,"getInsertContainerSelectors",(()=>[".general-bookmark-share .a2a_share_target"]))}}class kt extends xt{constructor(...e){super(...e),(0,y.A)(this,"match",(()=>"https:"===location.protocol&&location.host.endsWith("stackoverflow.com"))),(0,y.A)(this,"getCollectionData",function(){var e=(0,r.A)((function*(e){const t=(0,ft.cQ)(e,".post-layout");if(!t)return null;const n=document.createElement("div"),i=[t],o=document.querySelector("#content .inner-content .question .post-layout");o&&i.unshift(o);let s=100;i.forEach((e=>s+=e.getBoundingClientRect().height));(yield(0,ft.l5)(i)).forEach(((e,t)=>{if(1===t){const e=document.createElement("h2");e.innerText="Answer",e.style.paddingTop="20px",n.appendChild(e)}n.appendChild(e)}));const{desc:a,imageUrl:r}=yield(0,Ce.l_)(),{width:l}=t.getBoundingClientRect(),{width:c}=o.getBoundingClientRect();return{text_content:n.innerText,html_content:n.innerHTML,dir:"",title:(0,ft.gs)(),description:a,cover_image_url:r,source_url:location.href,content_height:s,content_width:Math.max(l,c)}}));return function(t){return e.apply(this,arguments)}}()),(0,y.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>({containerElement:e,getCollectionData:()=>this.getCollectionData(e),style:{width:"24px",height:"24px","font-size":"16px","margin-top":e.childElementCount?"4px":"0px",visibility:"hidden"},hoverListenerElement:(0,ft.cQ)(e,".post-layout")})))})),(0,y.A)(this,"getInsertContainerSelectors",(()=>["#content .inner-content .answer .js-voting-container"]))}}class jt extends xt{constructor(...e){super(...e),(0,y.A)(this,"match",(()=>{const{hostname:e,pathname:t}=location;return e.endsWith("link.springer.com")&&t.includes("article/")})),(0,y.A)(this,"getCollectionData",(0,r.A)((function*(){const e=document.querySelector('article[id="main"]');if(!e)return null;const t=yield(0,ft.dp)(e);let n=(0,ft.gs)();const i=t.querySelector(".c-article-title");i&&(n=i.innerText,i.remove());const{desc:o,imageUrl:s}=yield(0,Ce.l_)(),{width:a,height:r}=e.getBoundingClientRect();return{text_content:t.innerText,html_content:t.innerHTML,dir:"",title:n,description:o,cover_image_url:s,source_url:location.href,content_height:r,content_width:a}}))),(0,y.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>({containerElement:e,getCollectionData:this.getCollectionData,style:{width:"28px",height:"28px",display:"inline-block","z-index":"1","margin-left":"12px"}})))})),(0,y.A)(this,"getInsertContainerSelectors",(()=>[".c-article-header .app-article-metrics-bar"]))}}class Et extends xt{constructor(...e){super(...e),(0,y.A)(this,"match",(()=>{const{hostname:e,pathname:t}=location;return e.endsWith("www.sciencedirect.com")&&t.includes("science/article/abs/pii")})),(0,y.A)(this,"getCollectionData",(0,r.A)((function*(){const e=document.querySelector(".article-wrapper article");if(!e)return null;const t=yield(0,ft.dp)(e);let n=(0,ft.gs)();const i=t.querySelector("#screen-reader-main-title");i&&(n=i.innerText,i.remove());const{desc:o,imageUrl:s}=yield(0,Ce.l_)(),{width:a,height:r}=e.getBoundingClientRect();return{text_content:t.innerText,html_content:t.innerHTML,dir:"",title:n,description:o,cover_image_url:s,source_url:location.href,content_height:r,content_width:a}}))),(0,y.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>({containerElement:e,getCollectionData:this.getCollectionData,style:{width:"21px",height:"21px",display:"inline-block","z-index":"1","margin-left":"16px","vertical-align":"text-top"}})))})),(0,y.A)(this,"getInsertContainerSelectors",(()=>["#banner .banner-options"]))}}class Tt extends xt{constructor(...e){super(...e),(0,y.A)(this,"match",(()=>{const{hostname:e,pathname:t}=location;return e.endsWith("journals.sagepub.com")&&t.includes("doi/abs/")})),(0,y.A)(this,"getCollectionData",(0,r.A)((function*(){const e=document.querySelector('article div[data-core-wrapper="content"]');if(!e)return null;const t=yield(0,ft.dp)(e);let n=(0,ft.gs)();const i=document.querySelector("article header .core-container h1");i&&(n=i.innerText);const{desc:o,imageUrl:s}=yield(0,Ce.l_)(),{width:a,height:r}=e.getBoundingClientRect();return{text_content:t.innerText,html_content:t.innerHTML,dir:"",title:n,description:o,cover_image_url:s,source_url:location.href,content_height:r,content_width:a}}))),(0,y.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>({containerElement:e,getCollectionData:this.getCollectionData,style:{width:"30px",height:"40px",display:"inline-block","z-index":"1","margin-left":"1.75rem"}})))})),(0,y.A)(this,"getInsertContainerSelectors",(()=>["#article_collateral_menu ul"]))}}class Nt extends xt{constructor(...e){super(...e),(0,y.A)(this,"match",(()=>"https:"===location.protocol&&location.host.endsWith("reddit.com"))),(0,y.A)(this,"getCollectionData",function(){var e=(0,r.A)((function*(e){var t;const n=!location.pathname.includes("comments")?e:(0,ft.cQ)(e,"main.main"),i=yield(0,ft.dp)(n);null===(t=i.querySelector("shreddit-comments-page-ad"))||void 0===t||t.remove();const{desc:o,imageUrl:s}=yield(0,Ce.l_)(),{width:a,height:r}=n.getBoundingClientRect();return{text_content:i.innerText,html_content:i.innerHTML,dir:"",title:(0,ft.gs)(),description:o,cover_image_url:s,source_url:location.href,content_height:r,content_width:a}}));return function(t){return e.apply(this,arguments)}}()),(0,y.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>{const t=!location.pathname.includes("comments");let n,i=e;const o={width:"32px",height:"32px","font-size":"22px"};let s=null;if(t){var a;const t=null===(a=e.shadowRoot)||void 0===a||null===(a=a.querySelector('slot[name="share-button"]'))||void 0===a?void 0:a.firstElementChild;t&&(o.position="absolute",o.left=`${t.getBoundingClientRect().width+t.offsetLeft}px`,o.visibility="hidden",s=e)}else{var r;const t=null===(r=e.shadowRoot)||void 0===r?void 0:r.querySelector('slot[name="share-button"]');if(null!=t&&t.parentElement)for(let e=0;e<t.parentElement.children.length;e++)if(t.parentElement.children[e]===t){n=e+1;break}i=null==t?void 0:t.parentElement}return{containerElement:i,getCollectionData:()=>this.getCollectionData(e),style:o,insertIndex:n,hoverListenerElement:s}}))})),(0,y.A)(this,"getInsertContainerSelectors",(()=>["shreddit-post","shreddit-ad-post"])),(0,y.A)(this,"getMutationObserverDelay",(()=>60))}}class Mt extends xt{constructor(...e){super(...e),(0,y.A)(this,"match",(()=>"https:"===location.protocol&&location.host.endsWith("quora.com"))),(0,y.A)(this,"getCollectionData",function(){var e=(0,r.A)((function*(e){if(!e)return null;const t=(0,ft.cQ)(e,e.closest(".dom_annotate_multifeed_bundle_QuestionsBundle")?".dom_annotate_multifeed_bundle_QuestionsBundle > .q-box":"div.q-box.qu-borderAll.qu-borderRadius--small");if(!t)return null;const n=yield(0,ft.dp)(t);let i=(0,ft.gs)();const o=n.querySelector('div[class*="QuestionTitle"]');var s;o&&(i=o.innerText,null===(s=(0,ft.cQ)(o,"div.q-box"))||void 0===s||s.remove());const{desc:a,imageUrl:r}=yield(0,Ce.l_)(),{width:l,height:c}=t.getBoundingClientRect();return{text_content:n.innerText,html_content:n.innerHTML,dir:"",title:i,description:a,cover_image_url:r,source_url:location.href,content_height:c,content_width:l}}));return function(t){return e.apply(this,arguments)}}()),(0,y.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>{const t=e.querySelector(".qu-zIndex--action_bar .qu-py--tiny"),n=t?(0,ft.cQ)(t,t.closest(".dom_annotate_multifeed_bundle_QuestionsBundle")?".dom_annotate_multifeed_bundle_QuestionsBundle > .q-box":"div.q-box.qu-borderAll.qu-borderRadius--small"):null;return{containerElement:t?t.children[0]:null,getCollectionData:()=>this.getCollectionData(t),style:{width:"24px",height:"24px","font-size":"16px","margin-left":null!=t&&t.childElementCount?"10px":"0px",visibility:"hidden"},hoverListenerElement:n}}))})),(0,y.A)(this,"getInsertContainerSelectors",(()=>[".dom_annotate_multifeed_home > div > div",".dom_annotate_multifeed_bundle_QuestionsBundle > .q-box",'div[class*="dom_annotate_question_answer_item"]',".spacing_log_question_page_ad"]))}}class Rt extends xt{constructor(...e){super(...e),(0,y.A)(this,"match",(()=>{const{hostname:e,pathname:t}=location;return e.endsWith("www.nature.com")&&t.includes("articles/")})),(0,y.A)(this,"getCollectionData",(0,r.A)((function*(){const e=document.querySelector(".c-article-main-column");if(!e)return null;const t=yield(0,ft.dp)(e);let n=(0,ft.gs)();const i=t.querySelector(".c-article-title");i&&(n=i.innerText,i.remove());const{desc:o,imageUrl:s}=yield(0,Ce.l_)(),{width:a,height:r}=e.getBoundingClientRect();return{text_content:t.innerText,html_content:t.innerHTML,dir:"",title:n,description:o,cover_image_url:s,source_url:location.href,content_height:r,content_width:a}}))),(0,y.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>({containerElement:e,getCollectionData:this.getCollectionData,style:{width:"22px",height:"22px",display:"inline-block","font-size":"12px","z-index":"1","vertical-align":"top","margin-left":"auto"}})))})),(0,y.A)(this,"getInsertContainerSelectors",(()=>[".c-article-header .c-article-identifiers"]))}}class Lt extends xt{constructor(...e){super(...e),(0,y.A)(this,"match",(()=>"https:"===location.protocol&&location.host.endsWith("juejin.cn"))),(0,y.A)(this,"getCollectionData",(0,r.A)((function*(){const e=document.querySelector(".main-area.article-area");if(!e)return null;const t=yield(0,ft.dp)(e);let n=(0,ft.gs)();const i=t.querySelector(".article-title");i&&(n=i.innerText,i.remove());const{desc:o,imageUrl:s}=yield(0,Ce.l_)(),{width:a,height:r}=e.getBoundingClientRect();return{text_content:t.innerText,html_content:t.innerHTML,dir:"",title:n,description:o,cover_image_url:s,source_url:location.href,content_height:r,content_width:a}}))),(0,y.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>({containerElement:e,getCollectionData:this.getCollectionData,style:{width:"48px",height:"48px","font-size":"24px"}})))})),(0,y.A)(this,"getInsertContainerSelectors",(()=>[".main-container .article-suspended-panel"]))}}class Pt extends wt{constructor(...e){super(...e),(0,y.A)(this,"match",(()=>"https:"===location.protocol&&location.host.endsWith("okjike.com"))),(0,y.A)(this,"getCollectionData",function(){var e=(0,r.A)((function*(e){var t,n,i,o;const s=(0,ft.cQ)(e,"article.items-start");if(null==s||null===(t=s.parentElement)||void 0===t||!t.parentElement)return null;const a=s.parentElement.parentElement.getBoundingClientRect();let{width:r}=a;const l=window.getComputedStyle(s),c=parseFloat(l.paddingLeft),d=parseFloat(l.paddingRight);isNaN(c)||(r-=c),isNaN(d)||(r-=d);const u=document.createElement("div"),h=(0,ft.hj)(r);u.appendChild(h);const m=yield(0,ft.dp)(s.parentElement.parentElement,!1),p=m.querySelector("article.items-start"),g=document.querySelector('div[class*="NavBar"]');p&&g&&(p.style.backgroundColor=window.getComputedStyle(g).backgroundColor),h.appendChild(m);const v=m.innerText,f=(null===(n=m.querySelector('div[class*="content_"]'))||void 0===n?void 0:n.innerText)||v,_=m.querySelector('div[class*="MessagePictureGrid"]'),x=(null==_||null===(i=_.querySelector("img"))||void 0===i?void 0:i.getAttribute("data-img-tos-key"))||(null==_||null===(o=_.querySelector('div[class*="MessagePictureGrid__Cell"]'))||void 0===o?void 0:o.getAttribute("data-img-tos-key"))||"";return{text_content:v,html_content:u.innerHTML,body_content:f,content_height:a.height,content_width:r,content_img_key:x}}));return function(t){return e.apply(this,arguments)}}()),(0,y.A)(this,"getCollectionInsertInfo",(()=>{const e=[];this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))}));const t=e.length>1;return e.map((e=>{const n={width:"24px",height:"24px","font-size":"16px","margin-right":"18px"};let i=null;return t&&(n.visibility="hidden",i=(0,ft.cQ)(e,"article.items-start")),{containerElement:e.lastElementChild,getCollectionData:()=>this.getCollectionData(e),insertIndex:e.lastElementChild?e.lastElementChild.childElementCount-1:0,style:n,hoverListenerElement:i}}))})),(0,y.A)(this,"getInsertContainerSelectors",(()=>[".items-stretch"]))}}class Bt extends xt{constructor(...e){super(...e),(0,y.A)(this,"match",(()=>"https:"===location.protocol&&location.host.endsWith("jianshu.com"))),(0,y.A)(this,"getCollectionData",(0,r.A)((function*(){const e=document.querySelector('div[role="main"] > div > section');if(!e)return null;let{width:t}=e.getBoundingClientRect();const n=e.firstElementChild;n&&(t=n.getBoundingClientRect().width);const i=document.createElement("div"),o=(0,ft.hj)(t);i.appendChild(o);const s=[e],a=e.getBoundingClientRect(),r=document.querySelector('div[role="main"] > div #note-page-comment > section');r&&s.push(r);let l=0,c=(0,ft.gs)();s.forEach((e=>l+=e.getBoundingClientRect().height));(yield(0,ft.l5)(s,!1)).forEach((e=>{o.appendChild(e),e.style.paddingTop="0",e.style.paddingBottom="0",e.style.paddingBlock="unset";const t=e.querySelector('div[role="main"]>div>section>h1');t&&(c=t.innerText,t.remove())}));const{desc:d,imageUrl:u}=yield(0,Ce.l_)();return{text_content:i.innerText,html_content:i.innerHTML,dir:"",title:c,description:d,cover_image_url:u,source_url:location.href,content_height:l,content_width:a.width}}))),(0,y.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>({containerElement:e.lastElementChild,getCollectionData:this.getCollectionData,style:{width:"48px",height:"48px","font-size":"24px",margin:"auto"}})))})),(0,y.A)(this,"getInsertContainerSelectors",(()=>location.pathname.startsWith("/p/")?["#__next"]:[]))}}class Dt extends xt{constructor(...e){super(...e),(0,y.A)(this,"match",(()=>{const{hostname:e,pathname:t}=location;return e.endsWith("ieeexplore.ieee.org")&&t.includes("document/")})),(0,y.A)(this,"getCollectionData",(0,r.A)((function*(){const e=document.querySelector(".document .document-main");if(!e)return null;const t=yield(0,ft.dp)(e);let n=(0,ft.gs)();const i=t.querySelector(".document-title");i&&(n=i.innerText,i.remove());const{desc:o,imageUrl:s}=yield(0,Ce.l_)(),{width:a,height:r}=e.getBoundingClientRect();return{text_content:t.innerText,html_content:t.innerHTML,dir:"",title:n,description:o,cover_image_url:s,source_url:location.href,content_height:r,content_width:a}}))),(0,y.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>({insertIndex:0,containerElement:e,getCollectionData:this.getCollectionData,style:{width:"25px",height:"40px",display:"inline-block","z-index":"1"}})))})),(0,y.A)(this,"getInsertContainerSelectors",(()=>[".document-main-subheader .action-item-container .stats-document-lh-actions"]))}}class Ft extends xt{constructor(...e){super(...e),(0,y.A)(this,"match",(()=>"https:"===location.protocol&&location.host.endsWith("huggingface.co"))),(0,y.A)(this,"getCollectionData",function(){var e=(0,r.A)((function*(e){const t=(0,ft.cQ)(e,"body > div.flex");if(!t)return null;const n=yield(0,ft.dp)(t),{desc:i,imageUrl:o}=yield(0,Ce.l_)(),{width:s,height:a}=t.getBoundingClientRect();return{text_content:n.innerText,html_content:n.innerHTML,dir:"",title:(0,ft.gs)(),description:i,cover_image_url:o,source_url:location.href,content_height:a,content_width:s}}));return function(t){return e.apply(this,arguments)}}()),(0,y.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>({containerElement:e,getCollectionData:()=>this.getCollectionData(e),style:{width:"23px",height:"23px","font-size":"14px","margin-left":"8px"}})))})),(0,y.A)(this,"getInsertContainerSelectors",(()=>['div[data-target="DatasetHeader"] div.container > h1','div[data-target="ModelHeader"] div.container > h1']))}}class Ut extends xt{constructor(...e){super(...e),(0,y.A)(this,"match",(()=>"https:"===location.protocol&&location.host.endsWith("github.com"))),(0,y.A)(this,"getCollectionData",function(){var e=(0,r.A)((function*(e){const t=(0,ft.cQ)(e,"div[data-turbo-body]");if(!t)return null;const n=yield(0,ft.dp)(t),{desc:i,imageUrl:o}=yield(0,Ce.l_)(),{width:s,height:a}=t.getBoundingClientRect();return{text_content:n.innerText,html_content:n.innerHTML,dir:"",title:(0,ft.gs)(),description:i,cover_image_url:o,source_url:location.href,content_height:a,content_width:s}}));return function(t){return e.apply(this,arguments)}}()),(0,y.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>({containerElement:e,getCollectionData:()=>this.getCollectionData(e),insertIndex:0,style:{"margin-right":e.childElementCount?"8px":"0px",float:"left"}})))})),(0,y.A)(this,"getInsertContainerSelectors",(()=>["#repository-container-header ul.pagehead-actions"]))}}class Ht extends xt{constructor(...e){super(...e),(0,y.A)(this,"match",(()=>{const{hostname:e,pathname:t}=location;return e.endsWith("www.frontiersin.org")&&/journals\/.*\/articles/.test(t)})),(0,y.A)(this,"getCollectionData",(0,r.A)((function*(){const e=document.querySelector(".ArticleDetails__main__content");if(!e)return null;const t=yield(0,ft.dp)(e);let n=(0,ft.gs)();const i=t.querySelector(".JournalAbstract__titleWrapper h1");i&&(n=i.innerText,i.remove());const{desc:o,imageUrl:s}=yield(0,Ce.l_)(),{width:a,height:r}=e.getBoundingClientRect();return{text_content:t.innerText,html_content:t.innerHTML,dir:"",title:n,description:o,cover_image_url:s,source_url:location.href,content_height:r,content_width:a}}))),(0,y.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>({insertIndex:0,containerElement:e,getCollectionData:this.getCollectionData,style:{width:"32px",height:"32px",display:"inline-block","z-index":"1",float:"right","margin-top":"10px"}})))})),(0,y.A)(this,"getInsertContainerSelectors",(()=>[".JournalAbstract .authors"]))}}class zt extends xt{constructor(...e){super(...e),(0,y.A)(this,"match",(()=>"https:"===location.protocol&&location.host.endsWith("csdn.net"))),(0,y.A)(this,"getCollectionData",function(){var e=(0,r.A)((function*(e){const t=(0,ft.cQ)(e,"main");if(!t)return null;const n=t.querySelector(".blog-content-box");if(!n)return null;let{width:i}=n.getBoundingClientRect();const o=n.querySelector(".blog-content-box  #article_content");o&&(i=o.getBoundingClientRect().width);const s=document.createElement("div"),a=(0,ft.hj)(i);s.appendChild(a);const r=[n],l=t.querySelector("#toolBarBox > div");l&&r.push(l);let c=0,d=(0,ft.gs)();r.forEach((e=>c+=e.getBoundingClientRect().height));(yield(0,ft.l5)(r,!1)).forEach(((e,t)=>{if(a.appendChild(e),1===t)e.style.position="unset";else{const t=e.querySelector(".article-title-box");t&&(d=t.innerText,t.remove())}}));const{desc:u,imageUrl:h}=yield(0,Ce.l_)();return{text_content:s.innerText,html_content:s.innerHTML,dir:"",title:d,description:u,cover_image_url:h,source_url:location.href,content_height:c,content_width:i}}));return function(t){return e.apply(this,arguments)}}()),(0,y.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>({containerElement:e,getCollectionData:()=>this.getCollectionData(e),insertIndex:0,style:{width:"24px",height:"24px","font-size":"16px","margin-right":e.childElementCount?"8px":"0px"}})))})),(0,y.A)(this,"getInsertContainerSelectors",(()=>["#mainBox #toolBarBox .toolbox-middle ul.toolbox-list"]))}}class Ot extends xt{constructor(...e){super(...e),(0,y.A)(this,"match",(()=>{const{hostname:e,pathname:t}=location;return e.endsWith("kns.cnki.net")&&t.includes("kcms2/article/abstract")})),(0,y.A)(this,"getCollectionData",(0,r.A)((function*(){const e=document.querySelector(".container .doc");if(!e)return null;const t=yield(0,ft.dp)(e);let n=(0,ft.gs)();const i=t.querySelector(".brief .wx-tit h1");i&&(n=i.innerText,i.remove());const{desc:o,imageUrl:s}=yield(0,Ce.l_)(),{width:a,height:r}=e.getBoundingClientRect();return{text_content:t.innerText,html_content:t.innerHTML,dir:"",title:n,description:o,cover_image_url:s,source_url:location.href,content_height:r,content_width:a}}))),(0,y.A)(this,"getCollectionInsertInfo",(()=>{const e=[];return this.getInsertContainerSelectors().forEach((t=>{e.push(...document.querySelectorAll(t))})),e.map((e=>({insertIndex:0,containerElement:e,getCollectionData:this.getCollectionData,style:{width:"25px",height:"25px",display:"inline-block","font-size":"12px","z-index":"1","vertical-align":"top","margin-left":"14px"}})))})),(0,y.A)(this,"getInsertContainerSelectors",(()=>[".btn-tool .other-btns"]))}}class qt{constructor(){(0,y.A)(this,"_collectionProviderList",void 0),(0,y.A)(this,"getCollectionProvider",(()=>this._collectionProviderList.find((e=>e.match())))),this._collectionProviderList=[new Ct,new St,new yt,new Nt,new Mt,new Ut,new Ft,new kt,new zt,new Lt,new Bt,new Pt,new Ot,new Rt,new jt,new Et,new Dt,new bt,new It,new Ht,new Tt]}}var Vt=n(38042);const $t="cici-collection-button-container-style",Kt="cici-collection-button-tooltip",Wt=e=>{const t=document.createElement("style");return t.id=$t,t.innerHTML=`\n    ${e} {\n      box-sizing: border-box;\n      cursor: pointer;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      height: 28px;\n      width: 28px;\n      outline: none;\n      border-radius: 999px;\n      overflow: hidden;\n      background: transparent;\n      svg {\n        width: 100%;\n        height: 100%;\n      }\n    }\n  `,t},Gt=(e=(0,ut.A)(),t=(0,ut.A)())=>`<svg width="36" height="36" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg">\n<g clip-path="url(#${e})">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M22.5429 15.7918C22.6194 15.8603 22.7077 15.8946 22.8079 15.8946C22.9134 15.8946 23.003 15.8603 23.0769 15.7918C23.1534 15.7232 23.1995 15.6362 23.2153 15.5307C23.276 15.1246 23.3406 14.7818 23.4091 14.5023C23.4777 14.2254 23.566 13.9973 23.6742 13.818C23.7823 13.6386 23.9234 13.4962 24.0974 13.3908C24.2741 13.2853 24.4969 13.2022 24.7659 13.1416C25.0349 13.0783 25.3645 13.0242 25.7548 12.9794C25.8655 12.9688 25.9565 12.9253 26.0277 12.8489C26.0989 12.7697 26.1345 12.6761 26.1345 12.568C26.1345 12.4652 26.0989 12.3755 26.0277 12.299C25.9591 12.2226 25.8695 12.1751 25.7587 12.1566C25.3684 12.1013 25.0401 12.0419 24.7738 11.9786C24.5101 11.9153 24.2925 11.831 24.1211 11.7255C23.9497 11.62 23.81 11.4802 23.7019 11.3062C23.5937 11.1322 23.5028 10.908 23.4289 10.6338C23.3577 10.3569 23.2865 10.0154 23.2153 9.60927C23.1969 9.50115 23.1494 9.41413 23.0729 9.34821C22.9991 9.27964 22.9107 9.24536 22.8079 9.24536C22.7051 9.24536 22.6154 9.27964 22.5389 9.34821C22.4651 9.41413 22.4203 9.50115 22.4044 9.60927C22.3438 10.0154 22.2792 10.3582 22.2106 10.6377C22.1421 10.9146 22.0524 11.1427 21.9416 11.322C21.8335 11.4987 21.6924 11.6411 21.5184 11.7492C21.3444 11.8547 21.1228 11.9378 20.8539 11.9984C20.5849 12.0591 20.2539 12.1118 19.861 12.1566C19.7529 12.1698 19.6633 12.216 19.5921 12.2951C19.5209 12.3716 19.4853 12.4625 19.4853 12.568C19.4853 12.6735 19.5195 12.7645 19.5881 12.8409C19.6593 12.9174 19.749 12.9636 19.8571 12.9794C20.25 13.0374 20.5783 13.0981 20.842 13.1613C21.1083 13.2246 21.3272 13.309 21.4986 13.4145C21.67 13.52 21.8085 13.6597 21.914 13.8338C22.0221 14.0078 22.113 14.232 22.1869 14.5062C22.2607 14.7831 22.3332 15.1246 22.4044 15.5307C22.4229 15.6362 22.469 15.7232 22.5429 15.7918ZM19.8332 10.6923H15.0234C14.8107 10.6922 14.5754 10.6922 14.3709 10.7077C14.1383 10.7253 13.8253 10.7694 13.5013 10.9228C13.073 11.1256 12.7248 11.4492 12.5066 11.8472C12.3415 12.1483 12.2941 12.4392 12.2751 12.6553C12.2584 12.8453 12.2584 13.064 12.2585 13.2617L12.2584 23.7818V23.7888C12.2583 23.82 12.2579 23.9154 12.2666 24.0053L12.2671 24.0105C12.2744 24.0882 12.308 24.4449 12.5999 24.7729C12.8966 25.1062 13.3439 25.2913 13.8088 25.2732C14.2665 25.2555 14.5743 25.04 14.6413 24.9931L14.6458 24.99C14.7235 24.9359 14.7995 24.8718 14.8244 24.8508L14.83 24.8461L17.9161 22.265L21.0022 24.8461L21.0078 24.8508C21.0327 24.8718 21.1087 24.9359 21.1864 24.99L21.1909 24.9931C21.2579 25.04 21.5657 25.2555 22.0234 25.2732C22.4884 25.2913 22.9356 25.1062 23.2323 24.7729C23.5242 24.4449 23.5578 24.0882 23.5651 24.0105L23.5656 24.0053C23.5743 23.9154 23.5739 23.82 23.5738 23.7888V23.7818V16.8568C23.5738 16.8568 23.2047 17.0416 22.8553 17.0416C22.4709 17.0416 22.1731 16.8568 22.1731 16.8568L22.173 23.7818C22.173 23.8744 22.173 23.9207 22.1529 23.9432C22.1355 23.9628 22.1092 23.9737 22.0818 23.9727C22.0503 23.9715 22.0133 23.9405 21.9392 23.8786L18.8532 21.2975C18.522 21.0205 18.3563 20.882 18.1691 20.8295C18.0041 20.7832 17.8281 20.7832 17.6631 20.8295C17.4759 20.882 17.3102 21.0205 16.9791 21.2975L13.893 23.8785C13.8189 23.9405 13.7819 23.9715 13.7504 23.9727C13.723 23.9737 13.6967 23.9628 13.6793 23.9432C13.6592 23.9207 13.6592 23.8744 13.6592 23.7818V13.2957C13.6592 12.84 13.6592 12.6122 13.7547 12.4382C13.8386 12.2851 13.9725 12.1606 14.1373 12.0826C14.3245 11.994 14.5697 11.994 15.06 11.994H18.0876C18.4582 11.1251 19.0564 10.9228 19.8332 10.6923Z" fill="url(#paint0_radial_1455_299)"/>\n<mask id="${t}" style="mask-type:luminance" maskUnits="userSpaceOnUse" x="0" y="0" width="36" height="36">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M18 36C27.9411 36 36 27.9411 36 18C36 8.05887 27.9411 0 18 0C8.05887 0 0 8.05887 0 18C0 27.9411 8.05887 36 18 36ZM18 34C26.8366 34 34 26.8366 34 18C34 9.16344 26.8366 2 18 2C9.16344 2 2 9.16344 2 18C2 26.8366 9.16344 34 18 34Z" fill="white"/>\n</mask>\n<g mask="url(#${t})">\n<path d="M34 18C34 26.8366 26.8366 34 18 34V38C29.0457 38 38 29.0457 38 18H34ZM18 2C26.8366 2 34 9.16344 34 18H38C38 6.9543 29.0457 -2 18 -2V2ZM2 18C2 9.16344 9.16344 2 18 2V-2C6.9543 -2 -2 6.9543 -2 18H2ZM18 34C9.16344 34 2 26.8366 2 18H-2C-2 29.0457 6.9543 38 18 38V34ZM32 18C32 25.732 25.732 32 18 32V36C27.9411 36 36 27.9411 36 18H32ZM18 4C25.732 4 32 10.268 32 18H36C36 8.05887 27.9411 0 18 0V4ZM4 18C4 10.268 10.268 4 18 4V0C8.05887 0 0 8.05887 0 18H4ZM18 32C10.268 32 4 25.732 4 18H0C0 27.9411 8.05887 36 18 36V32Z" fill="url(#paint1_linear_1455_299)"/>\n</g>\n</g>\n<defs>\n<radialGradient id="paint0_radial_1455_299" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(15.1905 17.2599) rotate(22.3884) scale(11.8361 17.7711)">\n<stop stop-color="#0057FF"/>\n<stop offset="0.819404" stop-color="#5A91FC"/>\n</radialGradient>\n<linearGradient id="paint1_linear_1455_299" x1="38.8636" y1="30.2727" x2="1.94345e-06" y2="6.95455" gradientUnits="userSpaceOnUse">\n<stop offset="0.25" stop-color="#75A4FF"/>\n<stop offset="1" stop-color="#0057FF"/>\n</linearGradient>\n<clipPath id="${e}">\n<rect width="36" height="36" fill="white"/>\n</clipPath>\n</defs>\n</svg>\n`,Zt=()=>{var e;null===(e=document.querySelector(`#${Kt}`))||void 0===e||e.remove()},Yt=(e,t)=>{const n=document.createElement("div");n.innerHTML=Gt(),n.onmouseenter=()=>{(e=>{Zt();const t=document.createElement("span");t.id=Kt,t.innerHTML='<svg aria-hidden="true" class="semi-tooltip-icon-arrow" width="24" height="7" viewBox="0 0 24 7"\n    fill="rgb(65, 70, 76)" xmlns="http://www.w3.org/2000/svg" style="fill: rgb(65, 70, 76);">\n    <path d="M24 0V1C20 1 18.5 2 16.5 4C14.5 6 14 7 12 7C10 7 9.5 6 7.5 4C5.5 2 4 1 0 1V0H24Z"></path>\n  </svg>';const n=t.querySelector("svg");if(!n)return;n.style.cssText="position: absolute;left: 50%;bottom: -6px;transform: translateX(-50%);";const{x:i,y:o,width:s,height:a}=e.getBoundingClientRect();let r=o+window.scrollY-46;o-46<0&&(r=o+window.scrollY+a+10,n.style.cssText="position: absolute;top: -6px;left: 50%;transform: translateX(-50%) rotate(180deg)"),t.style.cssText=`z-index: 9999;display: flex;position: absolute;left: ${i+s/2+window.scrollX}px;top: ${r}px;transform: translateX(-50%);`;const l=document.createElement("span");t.insertBefore(l,t.firstChild),l.style.cssText="padding: 8px 12px;\n    background-color: rgb(65, 70, 76);\n    border-radius: 6px;\n    color: #fff;\n    white-space: nowrap;\n    font-size: 14px;\n    line-height: 20px;\n    font-weight: 400;\n    font-family: Inter, -apple-system, BlinkMacSystemFont, Segoe UI, PingFang SC, Hiragino Sans GB, Microsoft YaHei, Helvetica Neue, Helvetica, Arial, sans-serif;",l.innerText=at.F2.t(e.getAttribute("data-collection-id")?"bookmarks_list_remove_hover":"flow_web_ext_pdf_page_bookmarks").replace(/{?{brandName}}?/,"\u8c46\u5305"),document.body.appendChild(t)})(n)},n.onmouseleave=()=>{Zt()};const i=()=>{n.removeAttribute("data-collection-id"),n.removeAttribute("data-in-collection"),n.innerHTML=Gt()},o=e=>{e?(n.setAttribute("data-collection-id",e),n.removeAttribute("data-in-collection"),n.innerHTML=((e=(0,ut.A)(),t=(0,ut.A)())=>`<svg width="36" height="36" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg">\n<g clip-path="url(#${e})">\n<mask id="${t}" style="mask-type:luminance" maskUnits="userSpaceOnUse" x="0" y="0" width="36" height="36">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M18 36C27.9411 36 36 27.9411 36 18C36 8.05887 27.9411 0 18 0C8.05887 0 0 8.05887 0 18C0 27.9411 8.05887 36 18 36ZM18 34C26.8366 34 34 26.8366 34 18C34 9.16344 26.8366 2 18 2C9.16344 2 2 9.16344 2 18C2 26.8366 9.16344 34 18 34Z" fill="white"/>\n</mask>\n<g mask="url(#${t})">\n<path d="M34 18C34 26.8366 26.8366 34 18 34V38C29.0457 38 38 29.0457 38 18H34ZM18 2C26.8366 2 34 9.16344 34 18H38C38 6.9543 29.0457 -2 18 -2V2ZM2 18C2 9.16344 9.16344 2 18 2V-2C6.9543 -2 -2 6.9543 -2 18H2ZM18 34C9.16344 34 2 26.8366 2 18H-2C-2 29.0457 6.9543 38 18 38V34ZM32 18C32 25.732 25.732 32 18 32V36C27.9411 36 36 27.9411 36 18H32ZM18 4C25.732 4 32 10.268 32 18H36C36 8.05887 27.9411 0 18 0V4ZM4 18C4 10.268 10.268 4 18 4V0C8.05887 0 0 8.05887 0 18H4ZM18 32C10.268 32 4 25.732 4 18H0C0 27.9411 8.05887 36 18 36V32Z" fill="url(#paint0_linear_1455_299)"/>\n</g>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M22.9328 15.7664C21.3574 15.7664 20.0802 14.4896 20.0796 12.9144V12.9133C20.0796 11.3375 21.3571 10.0601 22.9328 10.0601C24.5086 10.0601 25.786 11.3375 25.786 12.9133C25.786 14.489 24.5086 15.7664 22.9328 15.7664ZM24.3539 11.4584C24.4447 11.5327 24.4912 11.6342 24.4912 11.7512C24.4912 11.8061 24.4785 11.8597 24.4573 11.9109L24.4563 11.9133C24.4381 11.9551 24.4173 11.995 24.3941 12.0328L24.3933 12.0341L22.9941 14.2561C22.9488 14.3227 22.8926 14.3774 22.8244 14.4153C22.7578 14.4534 22.6846 14.4717 22.6076 14.4717C22.5308 14.4717 22.4574 14.4554 22.3906 14.4199C22.3245 14.3848 22.2666 14.3316 22.2154 14.2676L21.4815 13.3587C21.449 13.3155 21.4229 13.2693 21.4041 13.2202C21.3846 13.169 21.3746 13.1156 21.3746 13.0608C21.3746 12.951 21.4128 12.8526 21.4882 12.7728C21.5658 12.6908 21.6647 12.6465 21.7779 12.6465C21.8448 12.6465 21.9094 12.6609 21.9684 12.6925C22.0282 12.7246 22.0802 12.7752 22.1261 12.8336L22.5832 13.425L23.7187 11.5763C23.7991 11.4437 23.9171 11.3552 24.0729 11.3552C24.1781 11.3552 24.2733 11.3907 24.3539 11.4584ZM19.4684 10.6968L15.025 10.6968C14.8123 10.6967 14.577 10.6967 14.3725 10.7122C14.1399 10.7298 13.827 10.7739 13.5029 10.9273C13.0746 11.1301 12.7264 11.4537 12.5082 11.8517C12.3431 12.1528 12.2957 12.4437 12.2767 12.6598C12.26 12.8498 12.26 13.0685 12.2601 13.2662L12.2601 23.7863L12.26 23.7933C12.2599 23.8245 12.2595 23.9199 12.2682 24.0098L12.2687 24.015C12.276 24.0927 12.3096 24.4494 12.6015 24.7774C12.8982 25.1107 13.3455 25.2958 13.8105 25.2777C14.2681 25.26 14.5759 25.0445 14.6429 24.9976L14.6475 24.9945C14.7251 24.9404 14.8012 24.8763 14.8261 24.8553L14.8316 24.8506L17.9177 22.2695L21.0038 24.8506L21.0094 24.8553C21.0343 24.8763 21.1103 24.9404 21.188 24.9945L21.1925 24.9976C21.2595 25.0445 21.5673 25.26 22.025 25.2777C22.49 25.2958 22.9373 25.1107 23.2339 24.7774C23.5258 24.4494 23.5594 24.0926 23.5667 24.015L23.5672 24.0098C23.5759 23.9199 23.5755 23.8245 23.5754 23.7933L23.5754 23.7863L23.5754 16.8613C23.5754 16.8613 23.2063 17.0461 22.8569 17.0461C22.4725 17.0461 22.1747 16.8613 22.1747 16.8613L22.1746 23.7863C22.1746 23.8789 22.1746 23.9252 22.1545 23.9477C22.1371 23.9673 22.1108 23.9782 22.0834 23.9772C22.0519 23.976 22.0149 23.945 21.9409 23.8831L18.8548 21.302C18.5236 21.025 18.358 20.8865 18.1707 20.834C18.0057 20.7877 17.8297 20.7877 17.6648 20.834C17.4775 20.8865 17.3119 21.025 16.9807 21.302L13.8946 23.883C13.8205 23.945 13.7835 23.976 13.752 23.9772C13.7247 23.9782 13.6983 23.9673 13.6809 23.9477C13.6608 23.9252 13.6608 23.8789 13.6608 23.7863L13.6609 13.3002C13.6609 12.8445 13.6609 12.6167 13.7563 12.4427C13.8402 12.2896 13.9741 12.1651 14.1389 12.0871C14.3261 11.9985 14.5713 11.9985 15.0616 11.9985H18.6128C18.6128 11.8933 18.6916 10.9273 19.4684 10.6968Z" fill="url(#paint1_radial_1455_299)"/>\n</g>\n<defs>\n<linearGradient id="paint0_linear_1455_299" x1="38.8636" y1="30.2727" x2="1.94345e-06" y2="6.95455" gradientUnits="userSpaceOnUse">\n<stop offset="0.25" stop-color="#75A4FF"/>\n<stop offset="1" stop-color="#0057FF"/>\n</linearGradient>\n<radialGradient id="paint1_radial_1455_299" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(15.1182 17.6695) rotate(21.8624) scale(11.4945 16.9359)">\n<stop stop-color="#0057FF"/>\n<stop offset="0.819404" stop-color="#5A91FC"/>\n</radialGradient>\n<clipPath id="${e}">\n<rect width="36" height="36" fill="white"/>\n</clipPath>\n</defs>\n</svg>\n`)()):i()};return n.onclick=s=>{s.preventDefault(),s.stopPropagation();try{const s=n.getAttribute("data-collection-id");if(s)return(0,Vt.PU)(s),void i();if(n.getAttribute("data-in-collection"))return;n.innerHTML=((e=(0,ut.A)(),t=(0,ut.A)())=>`<svg width="36" height="36" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg">\n<g clip-path="url(#${e})">\n<mask id="${t}" style="mask-type:luminance" maskUnits="userSpaceOnUse" x="0" y="0" width="36" height="36">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M18 36C27.9411 36 36 27.9411 36 18C36 8.05887 27.9411 0 18 0C8.05887 0 0 8.05887 0 18C0 27.9411 8.05887 36 18 36ZM18 34C26.8366 34 34 26.8366 34 18C34 9.16344 26.8366 2 18 2C9.16344 2 2 9.16344 2 18C2 26.8366 9.16344 34 18 34Z" fill="white"/>\n</mask>\n<g mask="url(#${t})">\n<path d="M34 18C34 26.8366 26.8366 34 18 34V38C29.0457 38 38 29.0457 38 18H34ZM18 2C26.8366 2 34 9.16344 34 18H38C38 6.9543 29.0457 -2 18 -2V2ZM2 18C2 9.16344 9.16344 2 18 2V-2C6.9543 -2 -2 6.9543 -2 18H2ZM18 34C9.16344 34 2 26.8366 2 18H-2C-2 29.0457 6.9543 38 18 38V34ZM32 18C32 25.732 25.732 32 18 32V36C27.9411 36 36 27.9411 36 18H32ZM18 4C25.732 4 32 10.268 32 18H36C36 8.05887 27.9411 0 18 0V4ZM4 18C4 10.268 10.268 4 18 4V0C8.05887 0 0 8.05887 0 18H4ZM18 32C10.268 32 4 25.732 4 18H0C0 27.9411 8.05887 36 18 36V32Z" fill="url(#paint0_linear_1455_299)"/>\n</g>\n<path d="M16.8483 24.4251C16.5046 24.4251 16.2109 24.2724 15.9674 23.9668L12.2578 19.3262C12.1671 19.2164 12.1003 19.1089 12.0573 19.0039C12.0191 18.8989 12 18.7915 12 18.6816C12 18.4334 12.0812 18.2281 12.2435 18.0658C12.4106 17.9034 12.6207 17.8223 12.8737 17.8223C13.1649 17.8223 13.4108 17.9536 13.6113 18.2161L16.8197 22.334L23.0358 12.4583C23.1456 12.2912 23.2578 12.1743 23.3724 12.1074C23.487 12.0358 23.635 12 23.8164 12C24.0647 12 24.2676 12.0788 24.4251 12.2363C24.5827 12.3891 24.6615 12.5896 24.6615 12.8379C24.6615 12.9382 24.6448 13.0408 24.6113 13.1458C24.5779 13.2461 24.5254 13.3535 24.4538 13.4681L17.722 23.9596C17.5119 24.27 17.2207 24.4251 16.8483 24.4251Z" fill="url(#paint1_linear_1455_299)"/>\n</g>\n<defs>\n<linearGradient id="paint0_linear_1455_299" x1="38.8636" y1="30.2727" x2="1.94345e-06" y2="6.95455" gradientUnits="userSpaceOnUse">\n<stop offset="0.25" stop-color="#75A4FF"/>\n<stop offset="1" stop-color="#0057FF"/>\n</linearGradient>\n<linearGradient id="paint1_linear_1455_299" x1="25.6686" y1="22.4484" x2="12.1375" y2="14.1753" gradientUnits="userSpaceOnUse">\n<stop offset="0.25" stop-color="#75A4FF"/>\n<stop offset="1" stop-color="#0057FF"/>\n</linearGradient>\n<clipPath id="${e}">\n<rect width="36" height="36" fill="white"/>\n</clipPath>\n</defs>\n</svg>\n`)(),n.setAttribute("data-in-collection","true"),t===mt.X.SocialWebCard?(0,Vt.XQ)({collectFrom:pt.vP.webimage_collect,collectionType:mt.X.SocialWebCard,getSocialWebCardContent:e,onSuccess:o}):t===mt.X.Web&&(0,Vt.XQ)({collectFrom:pt.vP.webimage_collect,collectionType:mt.X.Web,getWebContent:e,onSuccess:o})}catch(a){(0,gt.z3)(a),i()}},n},Jt=(e,t,n,i=[])=>{const{containerElement:o,getCollectionData:s,style:a,insertIndex:r,hoverListenerElement:l}=e;if(!o)return;const c=`.${t}`;if(o.querySelector(c))return;const d=Yt(s,n.getCollectionType());if(d.className=t,a&&d.setAttribute("style",Object.keys(a).map((e=>`${e}: ${a[e]}`)).join(";")),o.insertBefore(d,isNaN(Number(r))?null:o.children[r||0]),o.getRootNode()instanceof ShadowRoot){const e=Wt(c);o.insertBefore(e,o.firstElementChild),i.push((()=>{e.remove()}))}if(l){d.style.visibility="hidden";const e=()=>{d.style.visibility="visible"},t=()=>d.style.visibility="hidden";l.addEventListener("mouseenter",e),l.addEventListener("mouseleave",t),i.push((()=>{l.removeEventListener("mouseenter",e),l.removeEventListener("mouseleave",t)}))}i.push((()=>{d.remove()}))},Qt=()=>{const e=u.m.getInstance().getHostId();if(void 0===e)return;const t=(new qt).getCollectionProvider();if(!t)return;const n=t.getInsertContainerSelectors(),i=[],o=`${he.AC}-${e}`;(e=>{(0,ht.EY)(Wt(e))})(`.${o}`);const s=()=>{const e=t.getCollectionInsertInfo();e.length&&e.forEach((e=>{Jt(e,o,t,i)}))};if(s(),n.length){const e=new MutationObserver(function(){var e=(0,r.A)((function*(e){for(const i of e)if(t.getMutationObserverDelay()&&(yield new Promise((e=>setTimeout(e,t.getMutationObserverDelay())))),"childList"===i.type&&i.addedNodes.length>0)for(const e of i.addedNodes)if(e instanceof HTMLElement&&n.find((t=>e.matches(t)||e.querySelector(t))))return void s()}));return function(t){return e.apply(this,arguments)}}());e.observe(document.body,{childList:!0,subtree:!0}),i.push((()=>e.disconnect()))}return()=>{i.forEach((e=>e())),(()=>{if(!document.head)return;const e=document.head.querySelector(`#${$t}`);e&&document.head.removeChild(e)})()}},Xt=({element:e,children:t})=>((0,f.useEffect)((()=>{const t=e.parentElement;let n=0;if(!t)return;const i=new MutationObserver((i=>{for(const o of i)o.addedNodes.length>0&&n<15&&t.firstChild!==e&&requestAnimationFrame((()=>{t.prepend(e),n++}))}));return i.observe(t,{childList:!0,subtree:!1}),()=>{i.disconnect()}}),[e]),(0,Le.jsx)(Le.Fragment,{children:t}));var en=n(48544),tn=n(61540),nn=n(75787);const on=({search_engine_name:e,show_from:t,result_type:n,show_type:i})=>{(0,tn.z8)(_.Ur.showSearchAssistant,{search_engine_name:e,show_from:t,result_type:n,show_type:i})},sn=({prompt_cnt:e,message_id:t,from_search_id:n,show_from:i,search_engine_name:o,suggested_type:s=_.Ld.search})=>{const{assistantBotId:a}=(0,J.ue)();(0,tn.z8)(_.Ur.showSearchAssistantSuggest,{bot_id:a,suggested_type:s,prompt_cnt:e,message_id:t,from_search_id:n,show_from:i,search_engine_name:o})},an=({prompt_position:e,message_id:t,from_search_id:n,show_from:i,search_engine_name:o,suggested_type:s=_.Ld.search})=>{const{assistantBotId:a}=(0,J.ue)();(0,tn.z8)(_.Ur.showSearchAssistantSuggestQuestion,{bot_id:a,suggested_type:s,prompt_position:e,message_id:t,from_search_id:n,show_from:i,search_engine_name:o})},rn=({click_position:e,message_id:t,search_id:n,search_engine_name:i,suggested_type:o=_.Ld.search})=>{const{assistantBotId:s}=(0,J.ue)();(0,tn.z8)(_.Ur.clickSearchAssistantSuggest,{bot_id:s,suggested_type:o,click_position:e,message_id:t,button_name:_._h.suggest,click_from:_.Z5.searchAssistant,search_id:n,search_engine_name:i})},ln=({search_engine_name:e,button_name:t,whether_full_screen:n=0})=>{(0,tn.z8)(_.Ur.searchResultCardClick,{search_engine_name:e,button_name:t,whether_full_screen:n})};var cn=n(41121),dn=n(60822),un=n(19552),hn=n(63623),mn=n(77960);const pn="memoEmptyContainer-zJsMMw",gn="videoArea-NcjHJV",vn="videoSlot-JEU4p9",fn="videoPlayIcon-EGOZCN",_n="triangleIcon-wLxDA7",xn="videoMemoIcon-HMW5rg",yn="button-A18LNV",bn="btnIcon-A4gJp3",wn="text-lY43Cd",Cn="cursorIcon-ZaUl6J",An="cardArea-D1CFIq",Sn="textArea-kZH74L",In=({onBtnClick:e})=>{const t=(0,at.Uk)();return(0,Le.jsxs)("div",{className:pn,children:[(0,Le.jsx)("div",{className:gn,children:(0,Le.jsxs)("div",{className:vn,children:[(0,Le.jsx)("div",{className:fn,children:(0,Le.jsx)(be.kcO,{className:_n})}),(0,Le.jsx)("div",{className:xn,children:(0,Le.jsxs)("div",{className:yn,onClick:e,children:[(0,Le.jsx)(be.jI,{className:bn}),(0,Le.jsx)("div",{className:wn,children:t("flow_web_ext_youtube_take_notes")})]})}),(0,Le.jsx)("div",{className:Cn})]})}),(0,Le.jsx)("div",{className:An}),(0,Le.jsx)("div",{className:Sn,children:t("flow_web_ext_youtube_notes_tips")})]})};function kn(e,t){var n,i,o;if(!e.length)return{pre:"",current:"",next:""};const s=1e3*t,a=e.findIndex(((t,n)=>{if(t.offset<=s){if(t.offset+t.duration>=s)return!0;if(n===e.length-1)return!0;return e[n+1].offset>s}return!1}));return{pre:(null===(n=e[a-1])||void 0===n?void 0:n.text)||"",current:(null===(i=e[a])||void 0===i?void 0:i.text)||"",next:(null===(o=e[a+1])||void 0===o?void 0:o.text)||""}}const jn={timeCapsuleWrapper:"timeCapsuleWrapper-PnZ6aI",timeCapsule:"timeCapsule-Kf1PTb",active:"active-Q2nuhJ"},En=({timeLabel:e,active:t,width:n,activeTimeCapsuleStyle:i={}})=>(0,Le.jsx)("div",{className:ie()(jn.timeCapsuleWrapper),children:(0,Le.jsx)("div",{className:ie()(jn.timeCapsule,jn.normal,{[jn.active]:t}),style:(0,a.A)({width:n},t?i:{}),children:e})});const Tn=[new class{getMemoBtnHeight(){return"21px"}configMemoBtn(e){e.style.cssText="width: fit-content",e.classList.add("ytp-button")}getSiteHost(){return"youtube"}getVideoControlContainer(){return document.querySelector("div.ytp-chrome-controls div.ytp-right-controls")}},new class{getMemoBtnHeight(){}configMemoBtn(e){}getSiteHost(){return"bilibili"}getVideoControlContainer(){const e=document.querySelector("div.bpx-player-control-wrap div.bpx-player-control-bottom-right");return e&&(e.style.alignItems="center",e.style.paddingBottom="7px"),e}}];let Nn;function Mn(){if(void 0!==Nn)return Nn;const{hostname:e}=location,t=Tn.map((t=>{if(new RegExp(t.getSiteHost()).test(e))return t})).filter((e=>e));return Nn=(null==t?void 0:t[0])||null,Nn}const Rn="memoContainer-fXLFwH",Ln="memoBtn-NBfIwK",Pn="memoBtnContent-WgPZu9",Bn="btnTxt-oOIJ5w",Dn=({onClick:e,btnContentStyle:t})=>{const n=(0,at.Uk)();return(0,Le.jsx)("div",{className:Rn,children:(0,Le.jsx)("button",{className:Ln,onClick:e,children:(0,Le.jsxs)("div",{className:Pn,style:t,children:[(0,Le.jsx)(be.jI,{style:{width:"14px",height:"14px",display:"inline-block"}}),(0,Le.jsx)("span",{className:Bn,children:n("flow_web_ext_youtube_take_notes")})]})})})};var Fn=n(59292),Un=n(89739);let Hn=function(e){return e.videoToolBar="video_tool_bar",e.summary="summary",e}({}),zn=function(e){return e.delete="delete",e.edit="edit",e.save="save",e.cancel="cancel",e}({});function On(e){(0,tn.z8)(_.Ur.takeNoteShow,{show_from:e})}function qn(e){(0,tn.z8)(_.Ur.takeNotePadShow,{show_from:e,summary_message_id:mn._1.getVideoSummaryMsgBlock().videoSummaryId})}function Vn(e,t){const n=mn._1.getVideoSummaryMsgBlock();(0,tn.z8)(_.Ur.takeNotePadClick,{click_from:e,button_name:t,summary_message_id:null==n?void 0:n.videoSummaryId,highlight_message_id:null==n?void 0:n.videoHighlightsId})}function $n(e,t,n){const i=mn._1.getVideoSummaryMsgBlock();(0,tn.z8)(_.Ur.takeNoteStatus,{show_from:e,button_name:t,status:n,summary_message_id:null==i?void 0:i.videoSummaryId,highlight_message_id:null==i?void 0:i.videoHighlightsId})}var Kn=n(46043),Wn=n(4601),Gn=n(89207);function Zn(e){return Yn.apply(this,arguments)}function Yn(){return(Yn=(0,r.A)((function*(e){const t=yield(0,Gn.S6)({method:"POST",url:`${Un.kD}/collection/memo/update`,data:e});if(t instanceof Error)throw t;return t}))).apply(this,arguments)}function Jn(){return Jn=(0,r.A)((function*(e){const t=(0,a.A)((0,a.A)({},e),{},{id:(0,ut.A)(),create_time:Date.now()});return new Promise(((e,n)=>{(0,Kn.B4)().then((i=>{i?Zn({id:`${i}`,upsert:[t],remove:[]}).then((()=>e(i))).catch(n):(0,Vt.H3)().then((i=>{(0,Vt.Nq)(i,pt.vP.video_memo_save,function(){var i=(0,r.A)((function*(i){const o=i.videoSummaryResult;if(o)try{var s,r;if(null!=o&&null!==(s=o.videoParams)&&void 0!==s&&null!==(s=s.cover_url)&&void 0!==s&&s.startsWith("http"))o.videoParams.cover_url=yield(0,Wn.Vv)(null==o||null===(r=o.videoParams)||void 0===r?void 0:r.cover_url);const n=yield(0,Kn.Yb)(o.summary,o.summary_msg_id,(0,a.A)({},o.videoParams),[t]);e(`${n.id}`)}catch(l){n(l)}else n(new Error("video summary is undefined"))}));return function(e){return i.apply(this,arguments)}}())})).catch(n)})).catch(n)}))})),Jn.apply(this,arguments)}function Qn(){return Qn=(0,r.A)((function*(){const e=yield(0,Kn.B4)();if(!e)return[];const t=yield(0,Kn.VT)(e);return(null==t?void 0:t.memos)||[]})),Qn.apply(this,arguments)}function Xn(){return(Xn=(0,r.A)((function*(e){const t=yield(0,Kn.B4)();if(t)return yield Zn({id:`${t}`,upsert:[],remove:[e]})}))).apply(this,arguments)}function ei(){return(ei=(0,r.A)((function*(e){const t=yield(0,Kn.B4)();if(t)return yield Zn({id:`${t}`,upsert:[e],remove:[]})}))).apply(this,arguments)}var ti=n(5644),ni=n(18867);let ii=function(e){return e.toolbar="toolbar",e.summaryCard="summaryCard",e}({});function oi(e,t){const n=(0,f.useCallback)(function(){var n=(0,r.A)((function*(n,i,o){const s="toolbar"===e?Hn.videoToolBar:Hn.summary;try{const e=yield function(e){return Jn.apply(this,arguments)}({content:n,video_time:Math.ceil(i),snapshot_img:yield(0,Fn.r)(o)});return(0,ti.H7)({infoUrl:`${Un.Vl}/${e}`}),ni.A.emit("video-memo-updated",e),$n(s,zn.save,"success"),e&&(null==t||t(e)),!0}catch(a){ni.A.emit("video-memo-save-failed",e,{context:n,video_time:i,blob:o}),console.error("save memo error ",a),$n(s,zn.save,"fail"),(0,ti.oU)()}return!1}));return function(e,t,i){return n.apply(this,arguments)}}(),[t,e]);return n}const si="memoEditorPanel-Tfyn_5",ai="memoBody-asWN6f",ri="iconPanel-SiuHr6",li="noteIcon-v_qdat",ci="darkNoteIcon-FAou0s",di="textPanel-nRjBHy",ui="textArea-F_ZTNi",hi="darkTextArea-jBGos0",mi="memoFooter-oo34aD",pi="memoFooterLeft-zehkkf",gi="darkMemoFooterLeft-PjDYVx",vi="memoFooterRight-RTAROo",fi="btn-EZOgj4",_i="cancelBtn-bJNuxV",xi="darkCancelBtn-WKBfiP",yi="okBtn-KjJe01",bi="darkOKBtn-Ok9Nll",wi="okBtnDisable-kYSv3H",Ci="okDarkBtnDisable-lnGG3m",Ai="popover-GjV2HE",Si="simpleEditorPanel-mK1iQ1",Ii="simpleTextarea-lRya08",ki="simpleMemoBody-T_bKVC",ji="simpleTextPanel-GUFfA5",Ei="darkPanel-bPrCDJ",Ti=(0,f.forwardRef)((({recoverFrom:e,darkPanel:t,onSimpleModeChange:n,defaultText:i,onTextInput:o,timeLabel:s,onEscape:a,onCancel:r,onConfirm:l,disableOkBtn:c,enableSimpleMode:d,autoWidth:u,editPadShow:h},m)=>{const p=(0,at.Uk)(),[g,v]=(0,f.useState)(d),_=(0,f.useCallback)((e=>{v(!1),o(e.target.value),e.preventDefault(),e.stopPropagation()}),[o]),[x,y]=(0,f.useState)(!1),b=(0,f.useRef)(null),w=(0,f.useRef)(0),C=(0,f.useRef)(null),A=(0,f.useCallback)((()=>{d&&v(!0),null==a||a()}),[d,a]),S=(0,f.useCallback)((()=>{d&&v(!0),null==r||r()}),[d,r]),I=(0,f.useCallback)((()=>{y(!0),l?l().then((e=>{d&&!1!==e&&v(!0)})).finally((()=>{y(!1)})):d&&(y(!1),v(!0))}),[d,l]);(0,f.useEffect)((()=>{setTimeout((()=>{var e;return null===(e=C.current)||void 0===e?void 0:e.focus()}),500)}),[]);const k=(0,f.useCallback)((()=>{const e=document.querySelector("video");e&&(0,Wn.CU)(e).then((t=>{b.current=t,w.current=e.currentTime}))}),[]),j=d&&g,E=(0,f.useCallback)((()=>{d&&v(!1),setTimeout((()=>{var e;return null===(e=C.current)||void 0===e?void 0:e.focus()}),100)}),[d,C]);return(0,f.useEffect)((()=>{j||k(),setTimeout((()=>null==n?void 0:n(Boolean(j))),100)}),[j,n]),(0,f.useImperativeHandle)(m,(()=>({requestInput:()=>{v(!1),setTimeout((()=>{var e;return null===(e=C.current)||void 0===e?void 0:e.focus()}),200)},getVideoSnapshot:()=>({currentTime:w.current,snapshot:b.current})})),[v,C,w,b]),(0,f.useEffect)((()=>{if(!e)return;const t=(t,{context:n,video_time:i,blob:s})=>{e===t&&(b.current=s,w.current=i,o(n),setTimeout((()=>{C.current&&(C.current.value=n)}),100),v(!1))};return ni.A.on("video-memo-save-failed",t),()=>{ni.A.off("video-memo-save-failed",t)}}),[e,b,w]),(0,f.useEffect)((()=>{!j&&(null==h||h())}),[j,h]),j?(0,Le.jsx)("div",{className:ie()(si,Si),onClick:E,children:(0,Le.jsxs)("div",{className:ie()(ai,ki),children:[(0,Le.jsx)("div",{className:ri,children:(0,Le.jsx)(be.jI,{className:li})}),(0,Le.jsx)("div",{className:ie()(di,ji),children:(0,Le.jsx)("textarea",{maxLength:2e3,value:i,onClick:E,className:ie()(ui,Ii),placeholder:`${p("flow_web_ext_youtube_take_notes")}...`,onKeyUpCapture:e=>e.stopPropagation(),onKeyDownCapture:e=>{e.stopPropagation(),"Escape"===e.code&&A()},onInputCapture:_})})]})}):(0,Le.jsxs)("div",{className:ie()(si,{[Ei]:t}),style:{width:u?"100%":void 0},children:[(0,Le.jsxs)("div",{className:ie()(ai),children:[(0,Le.jsx)("div",{className:ri,children:(0,Le.jsx)(be.jI,{className:ie()(li,{[ci]:t})})}),(0,Le.jsx)("div",{className:ie()(di),children:(0,Le.jsx)("textarea",{ref:C,maxLength:2e3,value:i,onClick:E,className:ie()(ui,{[hi]:t}),placeholder:`${p("flow_web_ext_youtube_take_notes")}...`,onKeyUpCapture:e=>e.stopPropagation(),onKeyDownCapture:e=>{e.stopPropagation(),"Escape"===e.code&&A()},onInputCapture:_})})]}),(0,Le.jsxs)("div",{className:ie()(mi),children:[(0,Le.jsx)("div",{className:ie()(pi,{[gi]:t}),children:(0,Le.jsx)(En,{timeLabel:s||"00:00",active:!1})}),(0,Le.jsxs)("div",{className:vi,children:[(0,Le.jsx)(Be.$n,{className:ie()(fi,_i,{[xi]:t}),onClick:()=>S(),children:p("cancel")}),(0,Le.jsx)(Be.$n,{className:ie()(fi,yi,{[wi]:c,[Ci]:c&&t,[bi]:t}),type:"primary",theme:"solid",loading:x,disabled:c,onClick:I,children:p("flow_web_ext_youtube_take_notes_popup_save")})]})]})]})})),Ni=()=>{var e,t;const n=(0,f.useMemo)((()=>(0,ti.t0)()),[]),[i,o]=(0,f.useState)(""),[s,a]=(0,f.useState)(!1),[r,l]=(0,f.useState)(!1),c=oi(ii.toolbar,(()=>a(!1))),[d,u]=(0,f.useState)("bottom"),h=(0,f.useRef)(null),[m,p]=(0,f.useState)(""),g=(0,f.useRef)(null);(0,f.useEffect)((()=>On(Hn.videoToolBar)),[]),(0,f.useEffect)((()=>{const e=document.querySelector("video");e&&l(e.duration>=3600);const t=()=>{a(!1),document.fullscreenElement?(0,ti.VJ)(document.fullscreenElement):(0,ti.VJ)(document.body)};return document.addEventListener("fullscreenchange",t),()=>document.removeEventListener("fullscreenchange",t)}),[]),(0,f.useEffect)((()=>{if(h.current){const e=h.current.getBoundingClientRect().bottom+180>document.body.getBoundingClientRect().bottom;p((0,ut.A)()),u(e?"top":"bottom")}}),[h,s]);const v=null===(e=g.current)||void 0===e?void 0:e.getVideoSnapshot(),x=(0,f.useMemo)((()=>{var e,t;return(null===(e=g.current)||void 0===e||null===(e=e.getVideoSnapshot())||void 0===e?void 0:e.currentTime)||(null===(t=document.querySelector("video"))||void 0===t?void 0:t.currentTime)||0}),[v]),y=(0,f.useCallback)((()=>qn(Hn.videoToolBar)),[]);return(0,Le.jsx)(Be.AM,{position:d,rePosKey:m,content:(0,Le.jsx)(Ti,{ref:g,darkPanel:Boolean(document.fullscreenElement),onTextInput:o,disableOkBtn:0===i.trim().length,onCancel:()=>{Vn(Hn.videoToolBar,zn.cancel),a(!1)},onEscape:()=>a(!1),editPadShow:y,onConfirm:()=>(Vn(Hn.videoToolBar,zn.save),c(i,x,(null==v?void 0:v.snapshot)||new Blob)),timeLabel:(0,hn.i)(`${Math.ceil(x)}`,r)}),trigger:"custom",visible:s,getPopupContainer:n,className:Ai,children:(0,Le.jsx)("div",{ref:h,children:(0,Le.jsx)(Dn,{btnContentStyle:{height:null===(t=Mn())||void 0===t?void 0:t.getMemoBtnHeight()},onClick:()=>{var e;e=document.fullscreenElement?"immersive":"non_immersive",(0,tn.z8)(_.Ur.takeNoteBtnClick,{click_from:e}),a(!s)}})})})};var Mi=n(6693),Ri=n(47519);const Li="wrapper-sNH30R",Pi="text-_qO9bA",Bi="btn-kcrew5",Di="exp-AGzfpd",Fi=({text:e,wrapperClassName:t,expClassName:n,textClassName:i,btnClassName:o,expandText:s="\u5c55\u5f00\u66f4\u591a",collapseText:a="\u6536\u8d77"})=>{const[r,l]=(0,f.useState)(!1),c=(0,f.useCallback)((e=>{l(e.target.checked)}),[]),[d,u]=(0,f.useState)(!1),h=(0,f.useRef)(null),{width:m}=(0,Ri.wY)({ref:h});(0,f.useEffect)((()=>{h.current?r||u(h.current.scrollHeight>h.current.getBoundingClientRect().height):u(!1)}),[m,r]);const p=(0,f.useMemo)((()=>(0,ut.A)()),[]);return(0,Le.jsx)(Le.Fragment,{children:(0,Le.jsxs)("div",{className:ie()(Li,t),children:[(0,Le.jsx)("input",{checked:r,id:p,onChange:c,className:ie()(Di,n),type:"checkbox"}),(0,Le.jsxs)("div",{className:ie()(Pi,i),ref:h,children:[d&&(0,Le.jsx)("label",{className:ie()(Bi,o),"data-expand":"expand","data-collapse":"collapse",htmlFor:p,children:r?a:s}),e]})]})})},Ui="memoRecordContainer-mbCRZR",Hi="memoRecordCard-NYHQMK",zi="textContent-YOSRBa",Oi="coverImg-v3NBHf",qi="timeLabel-zNAoWM",Vi="memoTranscript-coXI24",$i="transcriptContent-F1a4AG",Ki="icon-PGixdJ",Wi="text-DCXcu2",Gi="contextMenuContainer-v9VjMU",Zi="menuItem-_Jay5m",Yi="trashIcon-NK_ClM",Ji="dialogPopover-f03jrW",Qi="scrollbarHide-ILYlnc",Xi="transcriptTooltip-sFYXrh",eo="article-UdQ8Iy";let to=function(e){return e.edit="edit",e.delete="delete",e}({});const no=({id:e,onItemClick:t})=>{const n=(0,at.Uk)();return(0,Le.jsxs)("div",{className:Gi,children:[(0,Le.jsxs)("div",{className:Zi,onPointerDown:()=>null==t?void 0:t(e,to.edit),children:[(0,Le.jsx)(be.ywS,{className:Ki}),(0,Le.jsx)("div",{children:n("flow_web_ext_youtube_notes_edit")})]}),(0,Le.jsxs)("div",{className:Zi,onPointerDown:()=>null==t?void 0:t(e,to.delete),children:[(0,Le.jsx)(be.KkG,{className:ie()(Ki,Yi)}),(0,Le.jsx)("div",{style:{color:"var(--s-color-accents-red, rgba(249, 77, 77, 1))"},children:n("flow_web_ext_youtube_notes_delete")})]})]})},io=({id:e,onContextMenuItemClick:t,textContent:n,imgUrl:i,timeLabel:o,transcript:s,onCoverImgClick:a})=>{const r=(0,at.Uk)(),[l,c]=(0,f.useState)({x:0,y:0}),d=(0,f.useMemo)((()=>(0,ti.t0)()),[]),u=(0,f.useCallback)((e=>{const{pageX:t,pageY:n}=e.nativeEvent;c({x:t,y:n})}),[t,e]),h=(0,f.useCallback)((e=>{if(e){var t;const e=null===(t=d().querySelector(`.${Ji}`))||void 0===t?void 0:t.parentElement;e&&(e.style.left=`${l.x}px`,e.style.top=`${l.y}px`,e.style.transform="")}}),[l]),m=(0,f.useRef)(null),p=(0,f.useRef)(null);return(0,f.useEffect)((()=>{var e;if(!m.current)return;const t=new ResizeObserver((function(){if(!p.current||!m.current)return;p.current.style.marginRight="-12px";(p.current.scrollHeight||0)<(m.current.clientHeight||0)&&(p.current.style.marginRight="")}));t.observe(m.current);const n=(0,k.A)((()=>{p.current&&p.current.classList.remove(Qi)}),1e3),i=(0,Mi.A)((()=>{p.current&&p.current.classList.add(Qi)}),1e3),o=()=>{n(),i()};return null===(e=p.current)||void 0===e||e.addEventListener("scroll",o),()=>{var e;t.disconnect(),null===(e=m.current)||void 0===e||e.removeEventListener("scroll",o)}}),[p,p]),(0,Le.jsx)(Be.AM,{content:(0,Le.jsx)(no,{id:e,onItemClick:t}),trigger:"contextMenu",className:Ji,getPopupContainer:d,onVisibleChange:h,style:{borderRadius:"16px"},children:(0,Le.jsxs)("div",{className:Ui,children:[(0,Le.jsxs)("div",{className:Hi,ref:m,onContextMenu:u,children:[(0,Le.jsx)("div",{className:zi,ref:p,children:(0,Le.jsx)(Fi,{text:n,expandText:r("flow_web_ext_youtube_notes_more"),collapseText:r("flow_web_ext_youtube_notes_collapse")})}),(0,Le.jsxs)("div",{className:Oi,onClick:a,children:[(0,Le.jsx)("img",{src:i}),(0,Le.jsx)("div",{className:qi,children:(0,Le.jsx)(En,{timeLabel:o||"00:00",active:!1})})]})]}),s&&(0,Le.jsxs)("div",{className:Vi,children:[(0,Le.jsx)(Be.cG,{}),(0,Le.jsxs)("div",{className:$i,children:[(0,Le.jsx)(be.xP8,{className:Ki}),(0,Le.jsx)(Be.m_,{className:Xi,getPopupContainer:d,content:(0,Le.jsxs)("article",{className:eo,children:[s.pre&&(0,Le.jsx)("p",{children:s.pre}),s.current&&(0,Le.jsx)("p",{children:s.current}),s.next&&(0,Le.jsx)("p",{children:s.next})]}),children:(0,Le.jsx)("div",{className:Wi,children:s.current})})]})]})]})})},oo=({editMode:e,id:t,onContextMenuItemClick:n,textContent:i,imgUrl:o,timeLabel:s,onTextInput:a,onEscape:r,onCancel:l,transcript:c,onConfirm:d,onCoverImgClick:u})=>{const[h,m]=(0,f.useState)(i),p=(0,f.useCallback)((e=>{m(e),a(e)}),[a]);return e?(0,Le.jsx)(Ti,{timeLabel:s,autoWidth:!0,defaultText:i,onTextInput:p,onEscape:r,onCancel:l,onConfirm:d,enableSimpleMode:!1,disableOkBtn:0===h.trim().length}):(0,Le.jsx)(io,{id:t,transcript:c,onContextMenuItemClick:n,textContent:i,timeLabel:s,imgUrl:o,onCoverImgClick:u})};var so=n(33451);const ao=["summary_message_id","highlights_message_id"];let ro=function(e){return e.UPPER_RIGHT="upper_right",e.SUBSCRIBED="subscribed",e.ONBOARDING="onboarding",e.IMMERSION_FULLSCREEN_BTN="fullscreen_click",e.VIDEO_DB_CLICK="video_dbclick",e.IMMERSION_FULLSCREEN_SHORT_CUT="shortcut",e.IMMERSION_BTN="immersion_click",e.WATCH_RELAY="watch_relay",e.recommendVideo="recommendvideo_list_click",e.playNext="next_button",e.recommendVideoEnding="recommendvideo_ending_click",e.PODCAST_BUTTON="podcast_button",e}({}),lo=function(e){return e.UPPER_RIGHT="upper_right",e.ONBOARDING="onboarding",e}({}),co=function(e){return e.BOTTOM_RIGHT="bottom_right",e.SHARE_MENU="share_menu",e}({}),uo=function(e){return e.PAGE="page",e.CLIP="current_clip",e}({}),ho=function(e){return e.TOOLBAR="video_toolbar",e.SHARE_PAGE="share_page",e.FULLSCREEN="fullscreen",e.SHORTCUT="shortcut",e.VIDEO_DB_CLICK="video_db_click",e}({}),mo=function(e){return e.TOOLBAR="video_toolbar",e.SHARE_PAGE="share_page",e}({}),po=function(e){return e.EXPANDED="expanded",e.COLLAPSED="collapsed",e}({}),go=function(e){return e.summary="to_summary",e.subtitle="subtitle",e.note="to_note",e.language="language",e.copy="copy",e.share="share",e.download="download",e.addFav="add_fav",e.continueToChat="continue_to_chat",e.clickHighlight="click_highlight",e.takeNote="take_note",e}({});const vo=({summary_message_id:e,highlights_message_id:t})=>{let n=4;return n=e&&t?1:e?2:t?3:4,{summary_message_id:e,highlights_message_id:t,message_result_id:`${e}${t}`,show_type:n}},fo=(e,t)=>{let{summary_message_id:n,highlights_message_id:i}=t,o=(0,so.A)(t,ao);(0,tn.z8)(e,(0,a.A)((0,a.A)({},vo({summary_message_id:n,highlights_message_id:i})),o))},_o=({click_from:e,button_name:t=_._h.summarizeVideo})=>{(0,tn.z8)(_.Ur.clickVideoAssistantSummarizeBtn,{click_from:e,button_name:t})},xo=e=>{(0,tn.z8)(_.Ur.clickVideoImmersion,{click_from:e})},yo=e=>{(0,tn.z8)(_.Ur.showVideoImmersion,{show_from:e})},bo=e=>{(0,tn.z8)(_.Ur.immersionTimeLine,{mode:e})};const wo={closeAssistant:"closeAssistant-kOkYEs",videoSummaryAssistantContainer:"videoSummaryAssistantContainer-akGg3K",area:"area-pKRbkk",header:"header-Y1_yxW",controls:"controls-TriwIR","content-visible":"content-visible-T7D5IW",contentVisible:"content-visible-T7D5IW",actionBtn:"actionBtn-h61pvg",footer:"footer-Bs22z8",buttonItem:"buttonItem-DKpkLR",commonIcon:"commonIcon-zatgvP",actionFooterBtn:"actionFooterBtn-bfZlUX",content:"content-k93CU9",highlightPlaceholder:"highlightPlaceholder-DodOvW",highlightPlaceholderTitle:"highlightPlaceholderTitle-hScHbx",highlightLoadingContainer:"highlightLoadingContainer-D9SwcL",summary:"summary-C43f3d","no-transcript":"no-transcript-i7_Gk4",noTranscript:"no-transcript-i7_Gk4",gradientButton:"gradientButton-lSN9Xt",onboarding:"onboarding-j1o5b_",gradient_move:"gradient_move-YZnxFm",gradientMove:"gradient_move-YZnxFm",button:"button-zRpVJs",chatButton:"chatButton-uWBrKd",rightOperationButtons:"rightOperationButtons-PgKvtE","highlight-title":"highlight-title-bNWBMa",highlightTitle:"highlight-title-bNWBMa",streamMessage:"streamMessage-Ly4SZU",scrollContainer:"scrollContainer-ONDBtF",fadeIn:"fadeIn-rs4Pol",optionContainer:"optionContainer-Fm0DdW","first-time-use-summarize":"first-time-use-summarize-f2OC1h",firstTimeUseSummarize:"first-time-use-summarize-f2OC1h","no-subtitles-with-guidance":"no-subtitles-with-guidance-liS6JO",noSubtitlesWithGuidance:"no-subtitles-with-guidance-liS6JO","tab-inactive":"tab-inactive-Idddik",tabInactive:"tab-inactive-Idddik","transcript-container":"transcript-container-yUdlQL",transcriptContainer:"transcript-container-yUdlQL",timeline:"timeline-pM2KOH",time:"time-oHJzL8",text:"text-gY_g3D",memoListContainer:"memoListContainer-_40qBb",memoModal:"memoModal-So3MqA",deleteConfirmPopup:"deleteConfirmPopup-zJQ5RP",title:"title-sAoKsj",opt:"opt-JZHO5b",optBtn:"optBtn-K3Jv2_",confirmBtn:"confirmBtn-Q5ipxh",cancelBtn:"cancelBtn-yy2W8G"},Co=({onCancel:e,onConfirm:t})=>{const n=(0,at.Uk)();return(0,Le.jsxs)("div",{className:wo.deleteConfirmPopup,children:[(0,Le.jsx)("div",{className:wo.title,children:n("flow_web_ext_youtube_notes_delete_popup_desc")}),(0,Le.jsxs)("div",{className:wo.opt,children:[(0,Le.jsx)(Be.$n,{theme:"solid",onClick:t,type:"tertiary",className:ie()(wo.optBtn,wo.confirmBtn),children:n("flow_web_ext_youtube_notes_delete")}),(0,Le.jsx)(Be.$n,{theme:"solid",type:"tertiary",onClick:e,className:ie()(wo.optBtn,wo.cancelBtn),children:n("flow_web_ext_youtube_notes_delete_popup_btn")})]})]})};function Ao(){return document.querySelector(`[data-video-search-host-id='${u.m.getInstance().getHostId()}']`)}const So=()=>{var e,t,n,i;const o=(0,f.useCallback)((()=>{var e;const t=Ao();return(null==t||null===(e=t.shadowRoot)||void 0===e?void 0:e.querySelector("#cici-inline-container"))||document.body}),[]),s=(0,at.Uk)(),l=(0,f.useRef)(null),[c,d]=(0,f.useState)(""),[u,h]=(0,f.useState)(!0),m=(0,f.useRef)(null),[p,g]=(0,f.useState)(""),[v,_]=(0,f.useState)(!1),[x,y]=(0,f.useState)(""),[b,w]=(0,f.useState)(""),[C,A]=(0,f.useState)(0),[S,I]=(0,f.useState)([]),[k,j]=(0,f.useState)({}),[E,T]=(0,f.useState)(!1);(0,f.useEffect)((()=>{const e=document.querySelector("video");On(Hn.summary),T(e.duration>=3600);const t=()=>{(function(){return Qn.apply(this,arguments)})().then((e=>{I(e.sort(((e,t)=>t.create_time-e.create_time))),(0,Wn.hm)(e.map((e=>e.snapshot_img))).then((e=>j(e)))}))};return ni.A.on("video-memo-updated",t),t(),()=>{ni.A.off("video-memo-updated",t)}}),[]);const N=(0,f.useCallback)(((e,t,n)=>{if(w(e),"delete"===t){var i;setTimeout((()=>_(!0)),10);const t=null===(i=Ao())||void 0===i||null===(i=i.shadowRoot)||void 0===i?void 0:i.getElementById(e);A(((null==t?void 0:t.getBoundingClientRect().height)||0)/2)}else"edit"===t&&(y(e),g(n))}),[]),M=(0,f.useCallback)((()=>{g(""),y(""),Vn(Hn.summary,zn.cancel)}),[]),R=(0,f.useCallback)(function(){var e=(0,r.A)((function*(e){const t=Hn.summary,n=zn.edit;try{Vn(t,n);const i=p;return e.content=i,yield function(e){return ei.apply(this,arguments)}((0,a.A)((0,a.A)({},e),{},{content:i})),g(""),y(""),(0,ti.TL)(s("flow_web_ext_youtube_notes_edit_success")),$n(t,n,"success"),!0}catch(i){return $n(t,n,"fail"),!1}}));return function(t){return e.apply(this,arguments)}}(),[p]),L=(0,f.useCallback)(function(){var e=(0,r.A)((function*(e){const t=Hn.summary,n=zn.delete;try{Vn(t,n),_(!1),yield function(e){return Xn.apply(this,arguments)}(e),ni.A.emit("video-memo-updated",e),_(!1),(0,ti.TL)(s("flow_web_ext_youtube_notes_deleted")),$n(t,n,"success")}catch(i){$n(t,n,"fail")}}));return function(t){return e.apply(this,arguments)}}(),[]),P=oi(ii.summaryCard,(()=>d(""))),B=(0,f.useCallback)((()=>{var e;_o({click_from:ro.UPPER_RIGHT,button_name:go.takeNote}),null===(e=m.current)||void 0===e||e.requestInput()}),[m]),D=(0,f.useCallback)((e=>{const t=document.querySelector("video");t&&(t.currentTime=e)}),[]),F=null===(e=m.current)||void 0===e?void 0:e.getVideoSnapshot(),U=(u?null===(t=document.querySelector("video"))||void 0===t?void 0:t.currentTime:(null===(n=m.current)||void 0===n||null===(n=n.getVideoSnapshot())||void 0===n?void 0:n.currentTime)||(null===(i=document.querySelector("video"))||void 0===i?void 0:i.currentTime))||0,H=(0,f.useCallback)((()=>{qn(Hn.summary)}),[]);return(0,Le.jsx)(Le.Fragment,{children:(0,Le.jsxs)("div",{className:wo.memoListContainer,ref:l,children:[(0,Le.jsx)(Ti,{ref:m,recoverFrom:ii.summaryCard,autoWidth:!0,onTextInput:d,defaultText:c,onSimpleModeChange:h,editPadShow:H,timeLabel:(0,hn.i)(`${Math.ceil(U)}`,E),enableSimpleMode:!0,onCancel:()=>{Vn(Hn.summary,zn.cancel),d("")},onEscape:()=>d(""),onConfirm:()=>(Vn(Hn.summary,zn.save),P(c,U,(null==F?void 0:F.snapshot)||new Blob)),disableOkBtn:0===c.trim().length}),0===S.length&&(0,Le.jsx)(In,{onBtnClick:B}),S.map((e=>(0,Le.jsx)(Be.AM,{getPopupContainer:o,trigger:"custom",style:{marginTop:`-${C}px`,borderRadius:"16px"},visible:v&&e.id===b,content:(0,Le.jsx)(Co,{onCancel:()=>_(!1),onConfirm:()=>L(e.id)}),children:(0,Le.jsx)("div",{id:e.id,children:(0,Le.jsx)(oo,{id:e.id,transcript:kn(mn._1.getTranscriptData()||[],e.video_time),editMode:x===e.id,onContextMenuItemClick:(t,n)=>N(t,n,e.content),textContent:x===e.id?p:e.content,timeLabel:(0,hn.i)(e.video_time,E),imgUrl:(null==k?void 0:k[e.snapshot_img])||"",onTextInput:g,onCancel:M,onEscape:M,onConfirm:()=>R(e),onCoverImgClick:()=>D(e.video_time)})},e.id)})))]})})};var Io=n(38671);const ko="container-j8RhVh",jo="button-XaY_FC",{Text:Eo}=Be.Typography,To=({className:e})=>{const t=(0,g.B)(),n=(0,f.useRef)(null);return(0,Le.jsx)("span",{ref:n,className:ie()(ko,e),children:(0,Le.jsx)(Be.$n,{theme:"solid",size:"small",className:jo,icon:(0,Le.jsx)(ze.oE,{}),onClick:()=>{const e=(0,Io.jB)("youtube");(0,Ce.DT)({trackMeta:{previous_page:e?"youtube":"bilibili",login_entrance:e?"youtube":"bilibili"}})},type:"primary",children:(0,Le.jsx)(Eo,{ellipsis:{showTooltip:{opts:{getPopupContainer:()=>n.current}}},style:{maxWidth:125},size:"small",children:t("flow_web_ext_search_login",{brand:(0,Se.L2)()})})})})};var No=n(16604),Mo=n(26263);const Ro=(0,f.createContext)(null),Lo=()=>(0,f.useContext)(Ro);var Po=n(1950);const Bo="translateIcon-btNM0_",Do="dropdownVisible-SWmfYq",Fo="select-Kuv39i",Uo="selectTitle-Hz1y6B",Ho="selectDropdown-powb6o",zo="languageLocal-NvRcHY",Oo="languageSetting-lYgbLl",qo="optionContainer-lVwcBY",Vo=e=>{var t;const{scene:n,anchorRef:i,popContainerRef:o,translateLanguage:s,toolTipClassname:a,translateIconClassname:r,onLanguageChange:l}=e,c="podcast"===(null===(t=Lo())||void 0===t?void 0:t.scene),[d,u]=(0,f.useState)(!1),h=(0,J.TK)("uiLanguage"),[m,p]=(0,f.useState)(null!=s?s:h),v=(0,Po.e)(!0),_=(0,g.B)();return(0,Le.jsx)(Be.l6,{className:Fo,dropdownClassName:ie()((c?"podcast":"video")+"-language-selector",Ho),position:"bottomRight",suffix:(0,Le.jsx)(ze.vo,{}),showArrow:!1,value:m,getPopupContainer:()=>i.current,onDropdownVisibleChange:e=>{e||u(!1)},onChange:e=>{u(!1),p(e),null==l||l(e),(0,Mo.Su)({before_language_result:m,after_language_result:e,scene:n})},triggerRender:()=>(0,Le.jsx)("div",{children:(0,Le.jsx)(Be.m_,{content:_("flow_web_ext_youtube_respond"),className:a,getPopupContainer:()=>o.current,children:(0,Le.jsx)("div",{className:ie()(Bo,r,{[Do]:d}),onClick:()=>{u(!0)},"data-testid":(c?"podcast":"video")+"-language-btn",children:(0,Le.jsx)(ze.GP,{})})})}),outerTopSlot:(0,Le.jsx)("div",{className:Uo,children:_("flow_web_ext_youtube_respond")}),children:null==v?void 0:v.map((({language_loc:e,language_code:t,language:n})=>{const i=t===m;return(0,Le.jsx)(Be.l6.Option,{showTick:!1,value:t,children:(0,Le.jsxs)("div",{className:qo,"data-lang-option":t,children:[(0,Le.jsxs)("div",{children:[(0,Le.jsx)("div",{className:ie()(zo),children:e}),t!==No.Aq&&(0,Le.jsx)("div",{className:Oo,children:n})]}),(0,Le.jsx)("div",{children:i&&(0,Le.jsx)(ze.Tf,{})})]})},n+t)}))})};var $o=n(38855),Ko=n(50006);const Wo=({available:e,contentVisible:t,popContainerRef:n,isSummaryDone:i,isHighlightsDone:o,noContent:s,hasTranscript:a,isTranscriptLoaded:r,summarizeTriggered:l,hasNoSubtitles:c,hasShowedUserGuidance:d,translateLanguage:u,renderActionBtnTabs:h,onTranslateLanguage:m,onSummarizeVideo:p,trackResultEvent:v})=>{var _;const x=(0,g.B)(),y=(0,f.useRef)((0,$o.o6)()),b=(0,f.useRef)(null),w="podcast"===(null===(_=Lo())||void 0===_?void 0:_.scene),C=(0,f.useCallback)((()=>c&&d?null:l||(a||r)&&!a?(0,Le.jsx)(Le.Fragment,{}):(0,Le.jsx)(Be.$n,{className:ie()({[wo.gradientButton]:!y.current,[wo.onboarding]:y.current}),size:"small",theme:"solid",onClick:()=>{mn._1.updateShouldSummaryVideoDefault(!0),null==p||p({clickFrom:y.current?ro.ONBOARDING:ro.UPPER_RIGHT})},"data-testid":(w?"podcast":"video")+"-assistant-summary-btn",children:x(w?"flow_web_ext_podcast_summarize":"flow_web_ext_youtube_summarize")})),[a,r,l,c,d]);return(0,Le.jsxs)("div",{className:ie()(wo.header,{[wo["content-visible"]]:t}),ref:b,children:[(0,Le.jsx)(Ko.A,{size:"large",disable:!0}),(0,Le.jsxs)("div",{className:wo.controls,children:[e&&(0,Le.jsx)(Le.Fragment,{children:(0,Le.jsxs)("div",{className:wo.actionBtn,children:[C(),i&&o&&!s&&(0,Le.jsx)(Vo,{scene:Mo.jv.youtube_page_summary,anchorRef:b,translateLanguage:u,onLanguageChange:m,popContainerRef:n,trackResultEvent:v}),null==h?void 0:h()]})}),!e&&(0,Le.jsx)(To,{})]})]})};var Go=n(9388),Zo=n(89254),Yo=n.n(Zo),Jo=n(46913),Qo=n.n(Jo),Xo=n(59585),es=n.n(Xo),ts=n(46745),ns=n(94083),is=n(64462);const os=function(){var e=(0,r.A)((function*(e){let t=null;try{const n='@font-face { font-family: Inter, -apple-system, "system-ui", "Segoe UI", "SF Pro SC", "SF Pro Display", "SF Pro Icons", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Helvetica, Arial, sans-serif; src: url(""); unicode-range: U+0; }';t=yield(0,is.mo)(e,{fontEmbedCSS:n})}catch(n){}return t}));return function(t){return e.apply(this,arguments)}}(),ss=function(){var e=(0,r.A)((function*(e){const t=yield os(e);return!!t&&(yield as(t))}));return function(t){return e.apply(this,arguments)}}(),as=e=>new Promise((t=>{e.toBlob((function(e){if(!e)return void t(!1);const n=new ClipboardItem({"image/png":e});navigator.clipboard.write([n]).then((()=>t(!0))).catch((()=>t(!1)))}),"image/png")})),rs=function(){var e=(0,r.A)((function*(e,t){const n=yield os(e);if(!n)return"";const i=n.toDataURL("image/png");i&&ls(i,t)}));return function(t,n){return e.apply(this,arguments)}}(),ls=(e,t)=>{const n=document.createElement("a");n.href=e,n.download=t,n.click()};class cs{constructor(){var e=this;(0,y.A)(this,"videoId",""),(0,y.A)(this,"videoTitle",""),(0,y.A)(this,"videoThumbnail",""),(0,y.A)(this,"shareLink","https://www.doubao.com"),(0,y.A)(this,"shareAll",!1),(0,y.A)(this,"shareContent",[]),(0,y.A)(this,"currentClipIndex",-1),(0,y.A)(this,"qrCodeUrl",""),(0,y.A)(this,"loadThumbnail",(()=>new Promise((e=>{const t=document.createElement("img");t.onload=()=>{e(!0)},t.onerror=()=>{e(!0)},t.src=this.getVideoThumbnailUrl()})))),(0,y.A)(this,"loadQRCode",(0,r.A)((function*(){const t=yield cs.url2QRCodeSVG(e.shareLink);e.qrCodeUrl=t}))),(0,y.A)(this,"init",(0,r.A)((function*(){yield Promise.all([e.loadThumbnail(),e.loadQRCode()])}))),(0,y.A)(this,"resetVideoData",(e=>{const{videoId:t,shareAll:n,shareLink:i,shareContent:o,videoTitle:s,currentClipIndex:a,videoThumbnail:r=""}=e;this.videoThumbnail=r,this.videoId=t,this.shareAll=n,this.shareLink=i,this.videoTitle=s,this.shareContent=o,this.currentClipIndex=a})),(0,y.A)(this,"getVideoThumbnailUrl",(()=>this.videoThumbnail||cs.getYoutubeCoverImageUrl(this.videoId))),(0,y.A)(this,"getQRCodeUrl",(()=>this.qrCodeUrl)),(0,y.A)(this,"copyCard",function(){var e=(0,r.A)((function*(e){yield ss(e)}));return function(t){return e.apply(this,arguments)}}()),(0,y.A)(this,"downloadCard",function(){var e=(0,r.A)((function*(e){return yield rs(e,"share_video.png"),!0}));return function(t){return e.apply(this,arguments)}}()),(0,y.A)(this,"getShareContent",(()=>this.shareContent)),(0,y.A)(this,"getCurrentClipIndex",(()=>this.currentClipIndex)),(0,y.A)(this,"getVideoTitle",(()=>this.videoTitle)),(0,y.A)(this,"getIfShareClip",(()=>!this.shareAll))}}(0,y.A)(cs,"getYoutubeCoverImageUrl",(e=>`https://img.youtube.com/vi/${e}/maxresdefault.jpg`)),(0,y.A)(cs,"url2QRCodeSVG",(e=>new Promise((t=>{const n=document.createElement("canvas");ns.toDataURL(n,e,{errorCorrectionLevel:"H",type:"image/jpeg",margin:1,color:{dark:"#FFF",light:"#844B38"}},((e,n)=>{t(e?"":n)}))})))),(0,y.A)(cs,"domNode2Canvas",function(){var e=(0,r.A)((function*(e){let t=null;try{t=yield(0,is.mo)(e)}catch(n){}return t}));return function(t){return e.apply(this,arguments)}}());const ds=new cs,us="video_clip_container-AwCP0c",hs="video_clip_item-MzbEid",ms="video_clip_time-wKZkPO",ps="active-OcuxR4",gs="time-BQXF9X",vs="video_clip_section-Gnp4gF",fs=e=>{const{content:t,currentClipIndex:n}=e;return(0,Le.jsx)("div",{className:us,children:t.map(((e,t)=>{const i=n===t,{timestamp:o,section:s}=e;return(0,Le.jsxs)("div",{className:hs,children:[(0,Le.jsx)("div",{className:ie()({[ms]:!0,[ps]:i}),children:(0,Le.jsx)("span",{className:ie()({[gs]:!0,[ps]:i}),children:(0,hn.i)(o)})}),(0,Le.jsx)("span",{className:ie()({[vs]:!0,[ps]:i}),children:s})]})}))})};var _s=n(32929);const xs="share_card_video_summary-lz7MJv",ys=e=>{const{content:t}=e;return(0,Le.jsx)("div",{className:xs,children:(0,Le.jsx)(_s.FH,{markDown:t,style:{color:"var(--s-color-text-invert-intact-secondary, rgba(255, 255, 255, 0.85))"}})})},bs="logo_with_description-oEC1b0",ws="logo-_0H7zm",Cs="description-yn1RWx",As="name-yWTHAK",Ss="slogan-qhJPuD",Is=e=>{const{iconUrl:t,brandName:n,slogan:i}=e;return(0,Le.jsxs)("div",{className:bs,children:[(0,Le.jsx)("img",{src:t,alt:"avatar",className:ws}),(0,Le.jsxs)("div",{className:Cs,children:[(0,Le.jsx)("span",{className:As,children:n}),(0,Le.jsx)("span",{className:Ss,children:i})]})]})},ks="share_card_wrapper-sgCYh0",js="share_card-pBhLRQ",Es="share_card_close_button-pe0HYM",Ts="share_card_main-wti6Cg",Ns="share_card_main_image_container-RNx0jU",Ms="share_card_main_image-vtzLbE",Rs="share_card_main_image_overlay-AbPF3P",Ls="share_card_main_content-eF8pPX",Ps="share_card_content_header-Rvc9ga",Bs="share_card_content_summary-H2das6",Ds="share_card_content_summary_title-Ji2TRv",Fs="sum_title_icon-4drIQa",Us="sum_title_text-A1_1CA",Hs="share_card_content_summary_main-py1JqY",zs="share_card_content_bottom-iD2sLS",Os="qr_code-FsvqaO",qs="share_card_action_buttons-yl0HI6",Vs="share_card_download_button-owcQ1W",$s="share_card_copy_button-vMZWSg",Ks="icon-m56oEh",Ws="text-BVHIbw",Gs=e=>{var t;const{extName:n,extIconUrl:i,onClose:o,t:s,onCopy:a=h.A,onDownload:l=h.A}=e,[c,d]=(0,f.useState)(!1),[u,m]=(0,f.useState)(!1),[p,g]=(0,f.useState)(!1),v=(0,f.useRef)(null);(0,f.useEffect)((()=>{ds.init().then((()=>d(!0)))}),[]);const _=function(){var e=(0,r.A)((function*(){p||v.current&&(a(),g(!0),yield ds.copyCard(v.current),g(!1))}));return function(){return e.apply(this,arguments)}}(),x=function(){var e=(0,r.A)((function*(){if(u)return;if(!v.current)return;l(),m(!0);(yield ds.downloadCard(v.current))?setTimeout((()=>{m(!1)}),500):m(!1)}));return function(){return e.apply(this,arguments)}}(),y=ds.getIfShareClip();return(0,Le.jsx)("div",{className:ks,onClick:o,children:c?(0,Le.jsxs)("div",{className:js,onClick:e=>e.stopPropagation(),children:[(0,Le.jsx)("div",{className:Es,onClick:o,children:(0,Le.jsx)(be.o40,{})}),(0,Le.jsxs)("div",{className:Ts,ref:v,children:[(0,Le.jsxs)("div",{className:Ns,children:[(0,Le.jsx)("img",{className:Ms,src:ds.getVideoThumbnailUrl(),alt:"thumbnail"}),(0,Le.jsx)("div",{className:Rs})]}),(0,Le.jsxs)("div",{className:Ls,children:[(0,Le.jsx)("div",{className:Ps,children:ds.getVideoTitle()}),(0,Le.jsxs)("div",{className:Bs,children:[(0,Le.jsxs)("div",{className:Ds,children:[(0,Le.jsx)(be.k4K,{className:Fs}),(0,Le.jsx)("span",{className:Us,children:s("flow_web_ext_youtube_share_summary")})]}),(0,Le.jsx)("div",{className:Hs,children:y?(0,Le.jsx)(fs,{content:ds.getShareContent(),currentClipIndex:ds.getCurrentClipIndex()}):(0,Le.jsx)(ys,{content:(null===(t=ds.getShareContent()[0])||void 0===t?void 0:t.section)||""})})]}),(0,Le.jsxs)("div",{className:zs,children:[(0,Le.jsx)(Is,{brandName:n,slogan:s("flow_web_ext_youtube_share_desc"),iconUrl:i}),(0,Le.jsx)("img",{className:Os,src:ds.getQRCodeUrl(),alt:"qrcode"})]})]})]}),(0,Le.jsxs)("div",{className:qs,children:[(0,Le.jsx)("div",{className:Vs,onClick:x,children:u?(0,Le.jsx)(Be.tK,{spinning:!0}):(0,Le.jsx)(be.sxB,{})}),(0,Le.jsxs)("div",{className:$s,onClick:_,children:[(0,Le.jsx)("div",{className:Ks,children:p?(0,Le.jsx)(Be.tK,{spinning:!0}):(0,Le.jsx)(be.fFY,{})}),(0,Le.jsx)("div",{className:Ws,children:s("flow_web_ext_youtube_share_copy")})]})]})]}):(0,Le.jsx)(Be.tK,{spinning:!0})})},Zs="share_menu_container-lxmk1w",Ys="share_item_container-hnykmx",Js="item_icon-SGwgZ2",Qs="item_text-iUrtDq",Xs="checkbox-c8t193",ea="small_text-sTqlcx",ta="bottom_divider-PbdxTn",na="button-ttHrL3",ia="upload_icon-AJdpdr",oa=e=>{const{onClickShareLink:t,onClickShareCard:n,containerRef:i,onClickMainButton:o,isYtb:s,t:a}=e,[r,l]=(0,f.useState)(!1),[c,d]=(0,f.useState)(!1);return(0,Le.jsx)(Be.ms,{trigger:"custom",visible:c,onVisibleChange:d,onClickOutSide:()=>d(!1),className:Zs,position:"topRight",getPopupContainer:()=>(null==i?void 0:i.current)||document.body,render:(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsxs)("div",{className:Ys,"data-testid":"video-assistant-shareSingleClipBtn",onClick:()=>{t(!r),d(!1)},children:[(0,Le.jsx)(be.gXP,{className:Js}),(0,Le.jsx)("div",{className:Qs,children:"\u5206\u4eab\u94fe\u63a5"})]}),s?(0,Le.jsxs)("div",{className:Ys,onClick:()=>{n(!r),d(!1)},children:[(0,Le.jsx)(be.qjL,{className:Js}),(0,Le.jsx)("div",{className:Qs,children:a("flow_web_ext_youtube_share_image")})]}):null,(0,Le.jsx)("div",{className:ta}),(0,Le.jsxs)("div",{className:Ys,onClick:()=>{l((e=>!e))},children:[(0,Le.jsx)("div",{className:Xs,children:(0,Le.jsx)(Be.Sc,{checked:r})}),(0,Le.jsx)("div",{className:ea,children:a("flow_web_ext_youtube_share_clip")})]})]}),children:(0,Le.jsx)(Be.$n,{className:na,size:"small",theme:"solid",onClick:()=>{d(!0),null==o||o()},"data-testid":"video-assistant-share-btn",icon:(0,Le.jsx)(be.d0m,{className:ia}),children:a("flow_web_ext_youtube_sharepage_share")})})};var sa=n(60588);const aa="MODAL_CONTENT_UPDATED",ra=new sa.b,la=e=>{const{modal:t}=e,n=(0,at.Uk)(),[i,o]=f.useState();return(0,f.useEffect)((()=>(ra.on(aa,o),()=>{ra.off(aa)})),[]),(0,Le.jsx)(p.Yd.Provider,{value:ue.vF,children:(0,Le.jsx)(g.C,{t:n,children:null!=i?i:t})})};const ca=e=>{const{Modal:t,props:n}=e;return(0,Le.jsx)(t,(0,a.A)({onClose:()=>{da.removeModal("",!0)}},n||{}))},da=new class{constructor(){var e;(0,y.A)(this,"modalShadowRootContainer",void 0),(0,y.A)(this,"modalShadowRoot",void 0),(0,y.A)(this,"modalCompRootContainer",void 0),(0,y.A)(this,"modalCompRoot",void 0),(0,y.A)(this,"contextWrapperRendered",!1),(0,y.A)(this,"deleteKey",""),(0,y.A)(this,"hideModal",(()=>{ra.emit(aa,null),this.modalShadowRootContainer.style.display="none"})),(0,y.A)(this,"showModal",(()=>{this.modalShadowRootContainer.style.display="flex"})),(0,y.A)(this,"renderModalContextWrapper",(()=>{var e;null===(e=this.modalCompRoot)||void 0===e||e.render((0,Le.jsx)(la,{modal:this.getModalContent()})),this.contextWrapperRendered=!0})),(0,y.A)(this,"contentRenderer",null),(0,y.A)(this,"addModal",(e=>{const t=(0,ut.A)();return this.deleteKey=t,this.showModal(),this.contentRenderer=e,this.contextWrapperRendered?ra.emit(aa,this.contentRenderer):this.renderModalContextWrapper(),t})),(0,y.A)(this,"removeModal",((e,t=!1)=>{(e===this.deleteKey||t)&&this.hideModal()})),(0,y.A)(this,"getModalContent",(()=>this.contentRenderer)),this.modalShadowRootContainer=document.createElement("div"),this.modalShadowRootContainer.style.cssText="position: fixed; top: 0; bottom: 0; left: 0; right: 0; z-index: 9999; display: flex; align-items: center; justify-content: center;",this.modalShadowRoot=this.modalShadowRootContainer.attachShadow({mode:"open"}),(0,rt.NR)(this.modalShadowRoot,he.QN),this.modalCompRootContainer=document.createElement("div"),this.modalCompRootContainer.style.cssText="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;",null===(e=this.modalShadowRoot)||void 0===e||e.appendChild(this.modalCompRootContainer),this.modalCompRoot=(0,m.createRoot)(this.modalCompRootContainer),document.body.appendChild(this.modalShadowRootContainer),this.hideModal()}};var ua=n(45602),ha=n(66006),ma=n(58291);const pa=["onCopyClick","onMouseEnter","onMouseLeave","className","isButtonWithText","containerClassName"],ga=(0,l.jco)(),va=(0,f.forwardRef)(((e,t)=>{var n;let{onCopyClick:i,onMouseEnter:o,onMouseLeave:s,className:r,isButtonWithText:l,containerClassName:c}=e,d=(0,so.A)(e,pa);const u=(0,g.B)(),h=null===(n=(0,ma.A)())||void 0===n?void 0:n.getPopupContainer,{onCopyClick:m,onMouseEnter:p,onMouseLeave:v,checked:f}=fa(i);if(!i)return null;const _=f?ze.w_:ze.jw,x=u(f?"flow_web_ext_action_popup_copy":"message_long_press_copy"),y=()=>(0,Le.jsx)(_,(0,a.A)((0,a.A)({},d),{},{ref:t,className:r,onClick:m,onMouseEnter:()=>{null==o||o(),null==p||p()},onMouseLeave:()=>{null==s||s(),null==v||v()}})),b=()=>(0,Le.jsxs)("div",{className:c,onClick:m,children:[(0,Le.jsx)(_,(0,a.A)((0,a.A)({},d),{},{ref:t,className:r})),(0,Le.jsx)("div",{children:x})]});return l?(0,Le.jsx)(b,{}):ga?(0,Le.jsx)(y,{}):(0,Le.jsx)(Be.m_,{content:x,getPopupContainer:h,children:(0,Le.jsx)(y,{})})})),fa=e=>{const[t,n]=(0,f.useState)(!1),[i,o]=(0,f.useState)(!1),s=(0,f.useRef)(-1);return(0,f.useEffect)((()=>{t&&(s.current=Number(setTimeout((()=>{n(!1)}),3e3)))}),[t]),{onCopyClick:()=>{e(),n(!0)},onMouseLeave:()=>{o(!0)},onMouseEnter:()=>{o(!1),i&&(n(!1),clearTimeout(s.current))},checked:t}},_a=({getCollectionParam:e})=>{const[t,n]=(0,f.useState)(!1),[i,o]=(0,f.useState)(!1),[s,l]=(0,f.useState)(""),c=(0,f.useMemo)((()=>i?be.eWz:t?be.u06:be.Wur),[t,i]);return{onCollectionClick:(d=(0,r.A)((function*(){if(i)return;if(t)return(0,Vt.PU)(s),void n(!1);o(!0);const r=yield e();(0,Vt.XQ)((0,a.A)((0,a.A)({},r),{},{onSuccess:e=>{n(!0),l(e)},onFinally:()=>{o(!1)}}))})),function(){return d.apply(this,arguments)}),collected:t,loading:i,CollectionIcon:c};var d};var xa=n(85335),ya=n(88010),ba=n(78285);var wa=n(26903),Ca=n(15534);var Aa=n(48512),Sa=n(49178);const Ia="button-ttHvpX",ka="setting-tip-WVIMPE",ja="setting-button-1EfuWp",Ea="close-btn-KjSlP8",Ta=({testid:e,text:t="",getPopupContainer:n,className:i,style:o={}})=>{var s;const r=(0,g.B)(),l=(0,f.useRef)(!1),[c,d]=(0,v.Y)("voiceSettingTipShown"),[u,h]=(0,f.useState)(!c),{audioStatus:m,togglePlay:p}=(e=>{const[t,n]=(0,f.useState)({playing:!1,loading:!1}),i=(0,f.useMemo)((()=>new ba.B),[]);return(0,f.useEffect)((()=>{e&&(i.onLoadStart((()=>{n((e=>(0,a.A)((0,a.A)({},e),{},{loading:!0})))})),i.onPlayStart((()=>{n((e=>(0,a.A)((0,a.A)({},e),{},{playing:!0,loading:!1})))})),i.onPlayPause((()=>{n((e=>(0,a.A)((0,a.A)({},e),{},{playing:!1,loading:!1})))})))}),[i,e]),(0,f.useEffect)((()=>()=>{i.destroy()}),[i]),{audioStatus:t,togglePlay:()=>{t.loading||t.playing?i.cancelLoadAndPause():i.loadAndPlay(e)}}})(t),x=null===(s=(0,f.useContext)(Ca.A))||void 0===s?void 0:s.getPopupContainer,y=(0,f.useMemo)((()=>{let e=m.loading||m.playing?r("flow_web_ext_action_popup_TTS_pause_hover"):r("flow_web_ext_action_popup_TTS_hover");return u&&l.current&&(e=(0,Le.jsxs)("div",{className:ka,children:[(0,Le.jsxs)(xa.x,{i18nKey:"flow_web_ext_action_voice_tip",children:["\u591a\u79cd\u58f0\u97f3\u4f9b\u4f60\u9009\u62e9",(0,Le.jsx)("span",{className:ja,onClick:()=>{h(!1),(0,wa.I)({enter_method:_.cz.other})},children:"\u53bb\u8bbe\u7f6e"})]}),(0,Le.jsx)(be.abE,{className:Ea,onClick:()=>h(!1)})]})),e}),[m,u]),b=m.loading?Sa.L:m.playing?Aa.d:ze.wv;return(0,Le.jsx)(Be.m_,{content:y,getPopupContainer:n||x,spacing:{y:10,x:0},children:(0,Le.jsx)(ya.c,{"data-testid":e,type:"tertiary",icon:(0,Le.jsx)(b,{size:null==o?void 0:o.fontSize}),size:"small",className:ie()(i,Ia),onClick:()=>{l.current=!0,(m.loading||m.playing)&&h(!1),d(!0),p()},onMouseDown:e=>{u&&(e.preventDefault(),e.stopPropagation())},style:o})})},Na=e=>(()=>{const[e]=(0,v.Y)("authInfo");return(null==e?void 0:e.isAuthenticated)||!1})()?(0,Le.jsx)(Ta,(0,a.A)({},e)):null,Ma=({visible:e})=>{const t=(0,g.B)();return e?(0,Le.jsxs)("div",{"data-testid":"video-assistant-share-successToast",style:{padding:"10px 14px 10px 10px",borderRadius:10,background:"rgba(15, 15, 15, 1)",fontSize:16,fontWeight:500,display:"flex",alignItems:"center",color:"rgba(255, 255, 255, 0.95)",boxShadow:"0px 6px 10px 0px rgba(0, 0, 0, 0.08), 0px 0px 1px 0px rgba(0, 0, 0, 0.15)"},children:[(0,Le.jsx)(ze.wO,{style:{height:24,marginRight:4}}),(0,Le.jsx)("div",{children:t("flow_web_ext_action_popup_copy")})]}):null},Ra=({onClickContinueInChat:e,popContainerRef:t,onCopy:n,videoId:i,currentPlayingClip:o,summaryResult:s,highlightResult:a,trackShareEvent:l,videoTitle:c,transcript:d,videoSummaryId:u,videoHighlightsId:h,enableDownload:m=!1})=>{var p;const v=(0,g.B)(),[_,x]=(0,f.useState)(!1),y=(0,f.useRef)(document.createElement("div")),b=(0,f.useRef)(null),[w,C]=(0,f.useState)(""),A=(0,Io.jB)("youtube")||(0,Io.jB)("bilibili"),[S,I]=(0,f.useState)(!1),k="podcast"===(null===(p=Lo())||void 0===p?void 0:p.scene);(0,f.useEffect)((()=>{y.current=document.createElement("div"),y.current.id="cici-toast-tag",y.current.style.position="fixed",y.current.style.top="100px",y.current.style.left="50%",y.current.style.transform="translateX(-50%)",y.current.style.zIndex="9999",document.body.appendChild(y.current)}),[]),(0,f.useEffect)((()=>{(0,et.s)("show_button",{button_type:"copy",current_page:(0,tn.M5)(location.href)})}),[]);const j=function(){var e=(0,r.A)((function*(){if(A)try{const e=(0,Io.jB)("bilibili");let t=window.location.href;e&&(t=yield(0,ua.Z)(i));let n="";if(!e){const e=cs.getYoutubeCoverImageUrl(i),t=yield(0,Wn.n_)(e);null!=t&&t.blob&&(n=yield new Promise(((e,n)=>{const i=new FileReader;i.onload=()=>e(null==i?void 0:i.result),i.onerror=e=>n(e),i.readAsDataURL(t.blob)})))}const o=yield(0,Gn.S6)({method:"POST",url:`${Un.C1}/samantha/plugin/youtube_share`,data:{content:JSON.stringify({video_id:i,title:c.replace(/ - YouTube$/,""),share_clip_index:-1,summary:s,highlight:a,video_type:e?"bilibili":"youtube",video_url:t,video_thumbnail:n})}});if(null!=o&&o.share_id){const t=`https://${Un.FI}/summary/${e?"bilibili":"youtube"}/${o.share_id}`;C(t)}}catch(e){(0,gt.Rm)("[Rowan] share clip failed",e)}}));return function(){return e.apply(this,arguments)}}();(0,f.useEffect)((()=>{j()}),[]);const E=e=>{const t=e?[{timestamp:0,section:s}]:a,n=`${w}?share_clip=${e?-1:o}`;ds.resetVideoData({videoId:i,shareAll:e,shareLink:n,videoTitle:c,shareContent:t,currentClipIndex:null!=o?o:-1}),da.addModal((0,Le.jsx)(ca,{Modal:Gs,props:{extName:(0,Se.L2)()||"",extIconUrl:(0,Se.Nf)(),t:v,onCopy:()=>(0,et.s)("share_card_result_click",{content_type:"video_card",button_name:"copy"}),onDownload:()=>(0,et.s)("share_card_result_click",{content_type:"video_card",button_name:"download"})}}))},T=(0,ha.P)((e=>e.messages)),{CollectionIcon:N,onCollectionClick:M,collected:R}=_a({getCollectionParam:(L=(0,r.A)((function*(){var e,t;const n=(0,Io.jB)("bilibili");let o=window.location.href;return n&&(o=yield(0,ua.Z)(i)),{collectFrom:pt.vP.video_page_summarize,collectionType:ts.e.VideoSummary,videoSummaryResult:{summary:s,summary_msg_id:(null===(e=T[u])||void 0===e||null===(e=e.body)||void 0===e||null===(e=e.message)||void 0===e?void 0:e.message_id)||"",videoParams:{video_type:n?"bilibili":"youtube",video_url:o,title:c,timeline:a||[],cover_url:n?(0,un.bg)():(0,un.y4)(i),timeline_msg_id_str:(null===(t=T[h])||void 0===t||null===(t=t.body)||void 0===t||null===(t=t.message)||void 0===t?void 0:t.message_id)||"",transcript:d?JSON.stringify(d):"",highlights_message_id:h,video_duration:(0,un.qZ)()}}}})),function(){return L.apply(this,arguments)})});var L;return(0,f.useEffect)((()=>{(0,vt.ku)()&&(0,pt.ae)(pt.vP.video_page_summarize,pt.p6.videosummary)}),[]),(0,Le.jsxs)("div",{className:wo.footer,children:[(0,Le.jsxs)("div",{className:wo.actionFooterBtn,children:[(0,Le.jsx)(Be.$n,{className:wo.chatButton,size:"small",icon:(0,Le.jsx)(ze.oE,{}),onClick:()=>{_o({click_from:ro.UPPER_RIGHT,button_name:go.continueToChat}),e()},children:v("flow_web_ext_action_translate_chat")}),(0,Le.jsxs)("div",{className:wo.rightOperationButtons,children:[(0,Le.jsx)(Na,{text:s,className:wo.buttonItem,getPopupContainer:()=>t.current,style:{fontSize:20}}),m&&(0,Le.jsx)(Be.m_,{content:v(S?"flow_web_ext_podcast_downloaded_hover":"flow_web_ext_podcast_download_hover"),getPopupContainer:()=>t.current,children:(0,Le.jsx)("div",{className:wo.buttonItem,children:(0,Le.jsx)("div",{children:S?(0,Le.jsx)(be.eWz,{className:wo.commonIcon}):(0,Le.jsx)(be.sxB,{className:wo.commonIcon,onClick:()=>{if(_o({click_from:ro.UPPER_RIGHT,button_name:go.download}),S)return;const e=new(Yo()),t=(0,un.Ev)(d);t&&e.file("timeline.csv",t),e.file("summary.txt",s),e.generateAsync({type:"blob"}).then((e=>{var t;null===(t=Qo().saveAs)||void 0===t||t.call(Qo(),e,"doubao-summary-transcript.zip"),I(!0)}))},"data-testid":"podcast-assistant-download-btn"})})})}),(0,Le.jsx)(Be.m_,{content:v("message_long_press_copy"),getPopupContainer:()=>t.current,children:(0,Le.jsx)("div",{className:wo.buttonItem,children:(0,Le.jsx)(va,{style:{fontSize:20},onCopyClick:n,"data-testid":(k?"podcast":"video")+"-assistant-copy-button"})})}),!k&&(0,vt.ku)()&&(0,Le.jsx)(Be.m_,{content:v(R?"bookmarks_list_remove_hover":"flow_web_ext_action_bookmarks"),getPopupContainer:()=>t.current,children:(0,Le.jsx)("div",{className:wo.buttonItem,children:(0,Le.jsx)("div",{children:(0,Le.jsx)(N,{className:wo.commonIcon,onClick:()=>{M(),_o({click_from:ro.UPPER_RIGHT,button_name:go.addFav})},"data-testid":(k?"podcast":"video")+"-summary-assistant-collect-button"})})})}),(0,Le.jsx)("div",{children:A&&(0,Le.jsx)("div",{ref:b,onMouseDown:e=>e.stopPropagation(),style:{position:"relative"},children:(0,Le.jsx)(oa,{onClickShareCard:E,onClickShareLink:e=>(({shareAll:e})=>{e?null==l||l(co.SHARE_MENU,uo.PAGE):null==l||l(co.SHARE_MENU,uo.CLIP),w&&(es()(`${w}?share_clip=${e?-1:o}`),x(!0),setTimeout((()=>{x(!1)}),3e3))})({shareAll:e}),onClickMainButton:()=>{null===et.s||void 0===et.s||(0,et.s)("show_button",{button_type:"share",current_page:"youtube",range:"page"}),null===et.s||void 0===et.s||(0,et.s)("show_button",{button_type:"share",current_page:"youtube",range:"current_clip"})},containerRef:b,t:v,isYtb:(0,$o.tY)()})})})]})]}),Go.createPortal((0,Le.jsx)(Ma,{visible:_}),null==y?void 0:y.current)]})};var La=n(39625),Pa=n(48474);const Ba="highlight-list-wrapper-xihFaP",Da="content-breakdown-wrapper-ZO8UZw",Fa="highlight-title-aEzmlu",Ua="breakdownContainer-hE5NKx",Ha="breakdownExpand-eXdPNP",za="breakdownTitle-c4_spY",Oa="breakdownIsPlaying-nx8qEe",qa="breakdownTag-wncJGJ",Va="activeTag-SApbRQ",$a="breakdownContentContainer-kJyNZ5",Ka="breakdownSectionContainer-oZtSm0",Wa="breakdownContent-NHj0oy",Ga="expandIconContainer-cezszg",Za="expandIconBg-lnivJk",Ya="isExpanding-s5YPFu",Ja="bulletPointContainer-bmPPeT",Qa="pointTimestamp-XpceP1",Xa="pointContent-Tui7tV",er="currentActiveBulletPoint-MnWa2i",tr="activeBreakdownContainer-CjiZNA",nr="progressBarContainer-c3vF1o",ir="progressBar-mU8Ne9",or=({timestamp:e,section:t,bulletPoints:n,trackResultEvent:i,trackHighlightEvent:o,isCurrentActiveBreakdown:s,progress:a=0,currentActiveBulletPointIndex:r,isLastTimestampOverHour:l,onChangeVideoState:c,breakdownIndex:d,calcProgress:u,highlightContainerRef:h,videoElement:m,isImmersionMode:p=!1,handleUserInteract:g,userInteracting:v,activeScroll:x,onClickHighlight:y})=>{var b;const w="podcast"===(null===(b=Lo())||void 0===b?void 0:b.scene),C=(0,f.useRef)(null),[A,S]=(0,f.useState)(!0),{highlightExploreCount:I}=(0,cn.e)(),k=t=>{o(_.Ur.showVideoAssistantHighlightsTimeline,Number(e),t,p)};(0,f.useEffect)((()=>{C.current&&(0,un.Is)(C.current,k)}),[]),(0,f.useEffect)((()=>{s&&S(!0)}),[s]);const j=(0,f.useCallback)((0,Mi.A)((()=>{const e=h.current,t=C.current;if(e&&t){var n,i,o,s,a,r,l;const c=null==e?void 0:e.getBoundingClientRect(),d=null==t?void 0:t.getBoundingClientRect(),u=(null!==(n=null==e?void 0:e.scrollTop)&&void 0!==n?n:0)+(null!==(i=null==d?void 0:d.top)&&void 0!==i?i:0)-(null!==(o=null==c?void 0:c.top)&&void 0!==o?o:0),h=(null!==(s=null==t?void 0:t.offsetTop)&&void 0!==s?s:0)-40,m=(null!==(a=null==t?void 0:t.offsetHeight)&&void 0!==a?a:0)+(null!==(r=null==t?void 0:t.offsetTop)&&void 0!==r?r:0)-(null!==(l=null==e?void 0:e.offsetHeight)&&void 0!==l?l:0)+40;if(d.top>=c.top&&d.bottom<=c.bottom)return;if(p)(null==d?void 0:d.top)<(null==c?void 0:c.top)?null==e||e.scrollTo({top:h,behavior:"smooth"}):(null==c?void 0:c.bottom)<(null==d?void 0:d.bottom)&&(null==e||e.scrollTo({top:m,behavior:"smooth"}));else{const n=t.clientHeight>400?0:40;null==e||e.scrollTo({top:u-n,behavior:"smooth"})}}}),p?600:100),[h,p]);(0,f.useEffect)((()=>{x&&s&&!v&&j()}),[v,s,x]);const E=(e,t,n)=>{n&&(c({currentActiveBulletPointIndex:e.bulletPointIdx,currentActiveBreakdownIndex:e.breakdownIdx,progress:e.progress}),n.currentTime=t,n.play(),i(_._h.highlightSelectionBar),o(_.Ur.clickVideoAssistantHighlightsTimeline,t,I,p),S(!0),j())};return(0,Le.jsxs)("div",{className:ie()(Ua,Pa.rA,{[Ha]:A,[tr]:s}),ref:C,children:[(0,Le.jsxs)("div",{style:{zIndex:1},"data-testid":`${w?"podcast":"video"}-assistant-highlight-item-${d}`,className:ie()(za,{[Oa]:s}),onClick:t=>{null==y||y(E.bind(null,{bulletPointIdx:0,breakdownIdx:d,progress:0},Number(e))),E({bulletPointIdx:0,breakdownIdx:d,progress:0},Number(e),m),t.stopPropagation()},children:[(0,Le.jsx)(Be.vw,{className:ie()(qa,{[Va]:s}),children:(0,hn.i)(e,l)}),(0,Le.jsxs)("div",{className:$a,children:[(0,Le.jsxs)("div",{className:Ka,children:[(0,Le.jsx)("div",{className:Wa,"data-testid":`${w?"podcast":"video"}-assistant-breakdown-content-${d}`,children:t}),(s||A)&&(0,Le.jsx)("div",{className:nr,children:(0,Le.jsx)("div",{style:{width:s?100*a+"%":0},className:ir})})]}),n&&(null==n?void 0:n.length)>0&&(0,Le.jsx)("div",{className:ie()(Ga,{[Ya]:A}),onClick:e=>{S(!A),g(),i(A?_._h.fold:_._h.expand),e.stopPropagation()},"data-testid":`${w?"podcast":"video"}-assistant-dropdownArrow-${d}`,children:(0,Le.jsx)("div",{className:Za,children:(0,Le.jsx)(ze.Pl,{})})})]})]}),(0,Le.jsx)("div",{children:A&&n&&(null==n?void 0:n.length)>0&&(0,Le.jsx)(Le.Fragment,{children:n.map(((e,t)=>(0,un.nG)(null==e?void 0:e.timestamp)&&e.point?(0,Le.jsxs)("div",{className:ie()(Ja,{[er]:r===t&&s}),onClick:n=>{var i;const o=u(d,null!==(i=Number(e.timestamp))&&void 0!==i?i:0);null==y||y(E.bind(null,{bulletPointIdx:t,breakdownIdx:d,progress:o},Number(e.timestamp))),E({bulletPointIdx:t,breakdownIdx:d,progress:o},Number(e.timestamp),m),n.stopPropagation()},"data-testid":`${w?"podcast":"video"}-assistant-bullet-points-${d}-${t}`,children:[(0,Le.jsx)(Be.vw,{className:Qa,children:(0,hn.i)(e.timestamp,l)}),(0,Le.jsx)("div",{className:Xa,children:e.point})]},t):(0,Le.jsx)(Le.Fragment,{})))})})]})},sr=({text:e,mediaElement:t,trackResultEvent:n,trackHighlightEvent:i,videoDuration:o=0,videoState:s,setVideoState:r,isImmersionMode:l,handleUserInteract:c,userInteracting:d,activeScroll:u,onClickHighlight:h})=>{var m;const p=(0,g.B)(),v=(0,f.useRef)(null),_="podcast"===(null===(m=Lo())||void 0===m?void 0:m.scene),x=(0,f.useMemo)((()=>t||((0,Io.jB)("youtube")?document.querySelector(".video-stream"):document.querySelector("video"))),[t]),y=(0,un.Bq)(e),b=(e,t)=>{var n,i,s,a,r;return e===y.length-1?(t-(null===(a=y[e])||void 0===a?void 0:a.timestamp))/(o-(null===(r=y[e])||void 0===r?void 0:r.timestamp)):(t-(null===(n=y[e])||void 0===n?void 0:n.timestamp))/((null===(i=y[e+1])||void 0===i?void 0:i.timestamp)-(null===(s=y[e])||void 0===s?void 0:s.timestamp))};(0,f.useEffect)((()=>{const e=(0,le.A)(v,"current"),t=()=>{c()};if(e)return e.addEventListener("scroll",t),()=>{e.removeEventListener("scroll",t)}}),[]),(0,f.useEffect)((()=>{y&&y.length>0&&x&&(x.ontimeupdate=(0,k.A)((()=>{x.currentTime<Number(y[0].timestamp)&&r((()=>({currentActiveBreakdownIndex:-1,currentActiveBulletPointIndex:-1,progress:0}))),y.map(((e,t)=>{var n;if(x.currentTime>=Number(null==e?void 0:e.timestamp)&&(x.currentTime<Number(null===(n=y[t+1])||void 0===n?void 0:n.timestamp)||t===y.length-1)){r((e=>(0,a.A)((0,a.A)({},e),{},{currentActiveBreakdownIndex:t,currentActiveBulletPointIndex:0,progress:b(t,x.currentTime)})));const n=null==e?void 0:e.bullet_points;null==n||n.map(((e,t)=>{var i;x.currentTime>=Number(null==e?void 0:e.timestamp)&&(x.currentTime<Number(null==n||null===(i=n[t+1])||void 0===i?void 0:i.timestamp)||t===(null==n?void 0:n.length)-1)&&r((e=>(0,a.A)((0,a.A)({},e),{},{currentActiveBulletPointIndex:t})))}))}}))}),300))}),[x]);const w=(0,La.wR)(y.length,{from:{opacity:0,maxHeight:0},to:{opacity:1,maxHeight:1e3},config:{duration:200}});if(y&&y.length>0){const e=(e,t)=>(0,Le.jsx)(or,{timestamp:e.timestamp,section:e.section,bulletPoints:e.bullet_points,trackResultEvent:n,trackHighlightEvent:i,isCurrentActiveBreakdown:t===s.currentActiveBreakdownIndex,currentActiveBulletPointIndex:s.currentActiveBulletPointIndex,progress:Number(s.progress),breakdownIndex:t,isLastTimestampOverHour:(0,un.n7)(y)>=3600,onChangeVideoState:({currentActiveBreakdownIndex:e,currentActiveBulletPointIndex:t,progress:n})=>r((i=>(0,a.A)((0,a.A)({},i),{},{currentActiveBreakdownIndex:null!=e?e:i.currentActiveBreakdownIndex,currentActiveBulletPointIndex:null!=t?t:i.currentActiveBulletPointIndex,progress:null!=n?n:i.progress}))),calcProgress:b,highlightContainerRef:v,videoElement:x,isImmersionMode:l,handleUserInteract:c,userInteracting:d,activeScroll:u,onClickHighlight:h},t);return(0,Le.jsxs)("div",{id:"cici-assistant-highlights",className:Ba,"data-testid":_?"podcast-assistant-highlights":l?"video-assistant-immersionHighlights":"video-assistant-highlights",children:[(0,Le.jsx)("div",{className:Fa,children:p("flow_web_ext_youtube_highlights")}),(0,Le.jsx)("div",{className:ie()(Da),ref:v,onWheelCapture:e=>e.stopPropagation(),children:l?w.map(((t,n)=>(0,Le.jsx)(La.CS.div,{style:(0,a.A)((0,a.A)({},t),{},{overflow:"hidden",marginBottom:"10px"}),children:e(y[n],n)},n))):y.map(((t,n)=>(0,un.nG)(null==t?void 0:t.timestamp)&&t.section?e(t,n):null))})]})}return(0,Le.jsx)(Le.Fragment,{})};var ar=n(16380),rr=n.n(ar),lr=n(97164),cr=n(72372),dr=n(31704),ur=n(85908),hr=n(24724);const mr=["slots","autoFixSyntax"],pr=(0,f.forwardRef)((function(e,t){let{slots:n={},autoFixSyntax:i=!0}=e,o=(0,so.A)(e,mr);return(0,Le.jsx)(_s.FH,(0,a.A)({ref:t,slots:(0,cr.A)(n,{Tex:hr.MathJaxTex,CodeBlockHighlighter:ur.PrismCodeBlockHighlighter}),autoFixSyntax:i&&(0,a.A)({katex:dr.default},(0,lr.A)(i)?{}:i)},o))})),gr=rr().bind({"cici-ext-container":"cici-ext-container-cHKkaZ",ciciExtContainer:"cici-ext-container-cHKkaZ","inactivelink-hover-animation":"inactivelink-hover-animation-cI1oFG",inactivelinkHoverAnimation:"inactivelink-hover-animation-cI1oFG","notactivelink-hover-animation":"notactivelink-hover-animation-OwGmzQ",notactivelinkHoverAnimation:"notactivelink-hover-animation-OwGmzQ","light-click-animation":"light-click-animation-uLAyJ8",lightClickAnimation:"light-click-animation-uLAyJ8","click-animation":"click-animation-TXvTAL",clickAnimation:"click-animation-TXvTAL","semi-animation-rotate":"semi-animation-rotate-GHrtgv",semiAnimationRotate:"semi-animation-rotate-GHrtgv","inactive-btn-hover-animation":"inactive-btn-hover-animation-D_DftX",inactiveBtnHoverAnimation:"inactive-btn-hover-animation-D_DftX","cici-ext-always-dark":"cici-ext-always-dark-z_3gqK",ciciExtAlwaysDark:"cici-ext-always-dark-z_3gqK","cici-ext-always-light":"cici-ext-always-light-HTNkT5",ciciExtAlwaysLight:"cici-ext-always-light-HTNkT5",ellipsis:"ellipsis-tW3jMv",wrapper:"wrapper-dd4lUG","has-more":"has-more-_fO3cj",hasMore:"has-more-_fO3cj",inner:"inner-Ve1jl9","enable-scroll":"enable-scroll-t0C3zh",enableScroll:"enable-scroll-t0C3zh","activelink-hover-animation":"activelink-hover-animation-Ufh8M6",activelinkHoverAnimation:"activelink-hover-animation-Ufh8M6"}),vr=(0,f.forwardRef)(((e,t)=>{const{className:n,styles:i,children:o,enableScroll:s=!0,containerClassName:a,showShadow:r=!0}=e,[l,c]=(0,f.useState)(!1),d=(0,f.useCallback)((0,k.A)((e=>{const{scrollHeight:t,clientHeight:n,scrollTop:i}=e;c(t-n-i>=2)}),200,{leading:!0}),[]);return(0,f.useEffect)((()=>{const e=(0,le.A)(t,"current"),n=()=>{d(e)};if(e){e.addEventListener("scroll",n);const t=new MutationObserver((()=>d(e)));return t.observe(e,{childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeFilter:["class","style"]}),()=>{e.removeEventListener("scroll",n),t.disconnect()}}}),[]),(0,Le.jsx)("div",{className:gr("wrapper",a,{"has-more":l&&r}),children:(0,Le.jsx)("div",{className:gr(n,"inner",{"enable-scroll":s}),ref:t,style:i,children:o})})})),fr=vr,_r=e=>{const{isDone:t,autoScrollToEnd:n,children:i,message:o,style:s,className:r,containerClassName:l,showShadow:c}=e,[d,u]=(0,f.useState)(!1),h=(0,f.useRef)(null);return(0,f.useEffect)((()=>{if(h.current){let e=0;const t=()=>{var n;const i=null===(n=h.current)||void 0===n?void 0:n.scrollTop;var o;i<e&&(u(!0),null===(o=h.current)||void 0===o||o.removeEventListener("scroll",t));e=i};return h.current.addEventListener("scroll",t),()=>{var e;null===(e=h.current)||void 0===e||e.removeEventListener("scroll",t)}}}),[]),(0,f.useLayoutEffect)((()=>{const e=h.current;e&&n&&!d&&e.scrollTo({top:e.scrollHeight})}),[o]),(0,f.useLayoutEffect)((()=>{const e=h.current;e&&t&&n&&!d&&setTimeout((()=>e.scrollTo({top:e.scrollHeight})),300)}),[t]),(0,Le.jsx)(fr,{className:r,containerClassName:l,styles:(0,a.A)({},s),enableScroll:!0,ref:h,showShadow:c,children:i})},xr="failureMsg-CQv3Nt",yr=e=>{const t=(0,g.B)();return(0,Le.jsxs)("div",{className:xr,children:[(0,Le.jsx)(ze.o0,{}),"fail"===e.type&&(0,Le.jsx)("span",{children:(0,Le.jsxs)(xa.x,{i18nKey:"flow_web_ext_search_fail_x",children:["Generate failed",(0,Le.jsx)("a",{href:"#",onClick:t=>{var n;t.preventDefault(),null===(n=e.onRetry)||void 0===n||n.call(e)},children:"retry"})]})}),"overload"===e.type&&(0,Le.jsxs)("span",{children:[" ",t("flow_web_ext_search_overload")]})]})};var br=n(94267);const wr={"stream-container":"stream-container-gzUKQC",streamContainer:"stream-container-gzUKQC",message:"message-AguzyJ",placeholder:"placeholder-lfssXU"},Cr=rr().bind(wr),Ar=(0,l.jco)(),Sr=({className:e,style:t,id:n,type:i,enableScroll:o=!1,autoScrollToEnd:s=!0,onRetry:r,containerClassName:l,showShadow:c=!0,textFormatter:d,loadingStyle:u="skeleton",MDBoxProps:h={},smooth:m=!0,loadingSlot:p})=>{const g=(0,ha.P)((e=>e.messages[n])),{isDone:v,isError:_,isAborted:x,text:y="",jsonData:b}=g||{},w=!(y||_||v||x),C=!_&&Boolean(y);(0,f.useEffect)((()=>{if(_||x){const e="search"===i?"search_card_show":"highlight_function_click";(0,et.s)("generation_failure",{err_code:null==b?void 0:b.code,err_tips:null==b?void 0:b.msg,scene:e})}}),[_,x]);const A=w?"loading":_||x?"failed":v?"done":"init",S=()=>(0,Le.jsxs)(Le.Fragment,{children:[C&&(0,Le.jsx)(pr,(0,a.A)((0,a.A)({markDown:d?d(g):y,showIndicator:!v,smooth:{enable:!!m&&!v},autoFitRTL:!0},h),{},{style:Ar?{fontSize:16}:{}}),n),(_||x)&&(0,Le.jsx)(yr,{type:"fail",onRetry:r})]}),I=void 0!==p?p:(e=>"dot-flashing"===e?(0,Le.jsx)(br.c,{}):(0,Le.jsx)(Be.EA,{loading:!0,active:!0,placeholder:(0,Le.jsx)("div",{className:wr.placeholder,children:(0,Le.jsx)(Be.EA.Paragraph,{rows:3})})}))(u);return(0,Le.jsx)("div",{"data-testid":`stream-message-${A}`,children:w?I:o?(0,Le.jsx)(_r,{isDone:v,autoScrollToEnd:s,className:e,containerClassName:l,style:t,showShadow:c,message:g,children:S()}):(0,Le.jsx)("div",{className:Cr(wr["stream-container"],e),style:t,children:S()})})},Ir=({available:e,hasNoSubtitles:t,hasShowedUserGuidance:n,noContent:i,contentVisible:o,videoSummaryId:s,mediaElement:a,onRetry:r,isHighlightsDone:l,transcript:c,highlightsResult:d,trackResultEvent:u,trackHighlightEvent:h,videoState:m,setVideoState:p,handleUserInteract:v,onClickHighlight:f,userInteracting:_,isNotLoginBilibili:x})=>{var y;const b=(0,g.B)(),w=()=>(0,Le.jsxs)("div",{className:wo["first-time-use-summarize"],children:[(0,Le.jsx)("div",{style:{marginRight:4},children:"\u{1f449}"}),(0,Le.jsx)("div",{children:b("flow_web_ext_youtube_welcome")})]}),C=(0,Le.jsxs)("div",{className:wo.highlightPlaceholder,children:[(0,Le.jsx)("div",{className:wo.highlightPlaceholderTitle,children:b("flow_web_ext_youtube_highlights")}),(0,Le.jsx)(Be.EA.Paragraph,{rows:3,className:wo.highlightLoadingContainer})]}),A="podcast"===(null===(y=Lo())||void 0===y?void 0:y.scene);if(x)return(0,Le.jsx)("div",{className:wo.content,children:(0,Le.jsx)("div",{className:wo.summary,style:{marginTop:"14px"},children:b("flow_web_ext_youtube_nologin",{brand:(0,Se.L2)()})})});if(t)return(0,Le.jsxs)("div",{className:wo["no-transcript"],"data-testid":"video-assistant-no-transcript-tips",children:[!n&&w(),(0,Le.jsx)("div",{className:wo["no-subtitles-with-guidance"],children:b("flow_web_ext_youtube_nosubtitles",{brand:(0,Se.L2)()})})]});if(e&&!n&&void 0!==n&&!(0,$o.o6)()&&!(0,$o.$Z)())return w();if(i)return(0,Le.jsx)("div",{className:wo.content,children:(0,Le.jsx)("div",{className:wo.summary,style:{marginTop:"14px"},children:b("flow_web_ext_youtube_error")})});return e&&o?(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsx)("div",{className:wo.content,children:(0,Le.jsx)("div",{className:wo.summary,"data-testid":(A?"podcast":"video")+"-assistant-summary-container",children:(0,Le.jsx)(Sr,{id:s,onRetry:r,type:"summary",autoScrollToEnd:!1,enableScroll:!0,className:wo.streamMessage,containerClassName:wo.scrollContainer})})}),(0,Le.jsx)(Be.EA,{placeholder:C,loading:!l,active:!0,children:(0,Le.jsx)(sr,{videoDuration:((null==c||null===(S=c[(null==c?void 0:c.length)-1])||void 0===S?void 0:S.offset)+(null==c||null===(I=c[(null==c?void 0:c.length)-1])||void 0===I?void 0:I.duration))/1e3,mediaElement:a,text:d,trackResultEvent:u,trackHighlightEvent:h,videoState:m,setVideoState:p,handleUserInteract:v,userInteracting:_,activeScroll:!0,onClickHighlight:f})})]}):null;var S,I};var kr=n(305);const jr={error:"error-Mkbzfp",errorText:"errorText-LInQ4A",retry:"retry-GTXzIm"},Er=({t:e,handleRetry:t})=>(0,Le.jsxs)("div",{className:jr.error,children:[(0,Le.jsx)(be.ZZJ,{}),(0,Le.jsxs)("div",{className:jr.errorText,children:[(0,Le.jsx)("span",{className:jr.text,children:`${e("flow_web_ext_search_mindmap_fail")} `}),(0,Le.jsx)("span",{className:jr.retry,onClick:t,children:e("retry")})]})]}),Tr="container-IHfu8h",Nr="spin-WFJs_o",Mr=({t:e})=>(0,Le.jsxs)("div",{className:Tr,children:[(0,Le.jsx)(Be.tK,{wrapperClassName:Nr}),(0,Le.jsx)("div",{children:e("flow_web_ext_search_mindmap_loading")})]}),Rr=e=>new Promise((t=>{try{const n=new Image;let i="";const o=e.querySelector("svg > g"),s=e.getBoundingClientRect();let{width:a,height:r}=s;if(o){const t=o.getAttribute("transform");o.removeAttribute("transform");const n=e.style.width,l=e.style.height,c=o.getBoundingClientRect(),d=48,u=c.width+2*d,h=c.height+2*d;o.setAttribute("transform",`translate(${s.x-c.x+d}, ${s.y-c.y+d})`),e.style.width=`${u}px`,e.style.height=`${h}px`,a=u,r=h,i=(new XMLSerializer).serializeToString(e),t?o.setAttribute("transform",t):o.removeAttribute("transform"),e.style.width=n,e.style.height=l}else i=(new XMLSerializer).serializeToString(e);n.src=`data:image/svg+xml;utf8,${encodeURIComponent(i)}`,n.onload=()=>{const e=document.createElement("canvas"),i=e.getContext("2d");if(e.width=a,e.height=r,!i)return void t("");i.fillStyle="#ffffff",i.fillRect(0,0,e.width,e.height),i.drawImage(n,0,0);const o=e.toDataURL("image/png");t(o)}}catch(n){console.error("svgToImgBase64 error",n),t("")}})),Lr=function(){var e=(0,r.A)((function*(e){try{const t=yield Rr(e),n=document.createElement("a");return n.href=t,n.download="cici_exported_image.png",n.click(),!0}catch(t){return console.error(t),!1}}));return function(t){return e.apply(this,arguments)}}(),Pr=function(){var e=(0,r.A)((function*(e){try{const t=yield Rr(e);if(!t)return!1;const n=t.replace("data:image/png;base64,",""),i=Br(n),o=new Blob([i],{type:"image/png"});return yield navigator.clipboard.write([new ClipboardItem({"image/png":o})]),!0}catch(t){return console.error("Failed to copy image to system clipboard",t),!1}}));return function(t){return e.apply(this,arguments)}}(),Br=e=>{const t=atob(e),n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n},Dr="mindmapExportShadow-Fok_aE",Fr="mindmapExportCard-J5rL7b",Ur="content-qH2HnQ",Hr="footer-vlngvm",zr="brand-rCgfrU",Or="name-gL4ccx",qr="text-SkM_UF",Vr=({refSvg:e,iconUrl:t,extName:n,t:i})=>{const o=(0,f.useRef)(null),s=(0,f.useRef)(),[a,l]=(0,f.useState)({width:0,height:0,src:""}),[c,d]=(0,f.useState)(!1);(0,f.useEffect)((()=>{setTimeout((()=>{d(!0)}),1e3)}),[]),(0,f.useEffect)((()=>{if(!c||!e.current||!o.current)return;const{svgCode:t,width:n,height:i}=(e=>{let t="";const n=e.querySelector("svg > g"),i=e.getBoundingClientRect();let{width:o,height:s}=i;if(n){const a=n.getAttribute("transform");n.removeAttribute("transform");const r=e.style.width,l=e.style.height,c=n.getBoundingClientRect(),d=48,u=c.width+2*d,h=c.height+2*d;n.setAttribute("transform",`translate(${i.x-c.x+d}, ${i.y-c.y+d})`),e.style.width=`${u}px`,e.style.height=`${h}px`,o=u,s=h,t=(new XMLSerializer).serializeToString(e),a?n.setAttribute("transform",a):n.removeAttribute("transform"),e.style.width=r,e.style.height=l}else t=(new XMLSerializer).serializeToString(e);return{svgCode:t,width:o,height:s}})(e.current);l({width:n,height:i,src:`data:image/svg+xml;utf8,${encodeURIComponent(t)}`})}),[c,o]);const u=function(){var e=(0,r.A)((function*(){if(!o.current)return;const e=yield os(o.current);e&&(s.current=e)}));return function(){return e.apply(this,arguments)}}(),h=()=>new Promise((e=>{const t=()=>{s.current&&e(!0),requestAnimationFrame(t)};t(),setTimeout((()=>e(!1)),6e4)})),m=function(){var t=(0,r.A)((function*(){yield h(),s.current?yield as(s.current):e.current&&(yield Pr(e.current))}));return function(){return t.apply(this,arguments)}}(),p=function(){var t=(0,r.A)((function*(){yield h(),s.current?((e,t="cici_exported_image.png")=>{try{const n=document.createElement("a");return n.href=e.toDataURL("image/png"),n.download=t,n.click(),!0}catch(n){return console.error(n),!1}})(s.current):e.current&&(yield Lr(e.current))}));return function(){return t.apply(this,arguments)}}();return{mindmapExportShadowComponent:(0,Le.jsx)("div",{className:Dr,children:(0,Le.jsxs)("div",{className:Fr,ref:o,children:[(0,Le.jsx)("div",{className:Ur,children:(0,Le.jsx)("img",{src:a.src,alt:"",width:a.width,height:a.height,onLoad:u})}),(0,Le.jsxs)("div",{className:Hr,children:[(0,Le.jsx)("img",{src:t,onLoad:()=>d(!0)}),(0,Le.jsxs)("div",{className:zr,children:[(0,Le.jsx)("div",{className:Or,children:n}),(0,Le.jsx)("div",{className:qr,children:i("flow_web_ext_search_share_pic_doubao")})]})]})]})}),refExportCard:o,refExportCardCanvas:s,handleCopy:m,handleDownload:p}},$r=["rgba(0, 87, 255, 1)","rgba(39, 206, 110, 1)","rgba(255, 149, 0, 1)","rgba(249, 77, 77, 1)","rgba(153, 82, 225, 1)"];var Kr,Wr=n(14544),Gr=n(26155),Zr=n(76372);class Yr{}Kr=Yr,(0,y.A)(Yr,"_instance",void 0),(0,y.A)(Yr,"getInstance",(()=>{if(!Kr._instance){Kr._instance=new Gr.Ge;const{scripts:e,styles:t}=Kr._instance.getAssets();(0,Zr.y6)(t||[]),(0,Zr.kG)(e||[])}return Kr._instance}));const Jr=({value:e,autoHeight:t,options:n={},style:i})=>{const o=(0,f.useRef)(null),s=(0,f.useRef)(),[r,l]=(0,f.useState)(""),[c,d]=(0,f.useState)(null);(0,f.useEffect)((()=>{if(!o.current)return void(s.current=void 0);if(s.current)return;let e=-1;const t=new Map,i=Wr.mP.create(o.current,(0,a.A)({duration:500,color:n=>{const{depth:i,id:o}=n.state;if(1===i)return $r[0];const s=t.get(o);if(s)return s;2===i&&++e>=$r.length&&(e=0);const a=$r[e];return t.set(o,a),a}},n));s.current=i;const r=document.createElement("style");r.innerHTML="\n    .markmap-node {\n      line {\n        display: none;\n      }\n      .markmap-foreign {\n        transform: translateY(50%);\n        transform-box: content-box;\n      }\n    }",o.current.insertBefore(r,o.current.firstElementChild)}),[o.current]),(0,f.useEffect)((()=>{const i=s.current;if(!i||r===e)return;t&&i.setOptions({duration:0});const{root:a}=Yr.getInstance().transform(e);l(e),i.setData(a);const u=i.g.node();if(t&&u){c&&clearTimeout(c);const e=setTimeout((()=>{if(!o.current)return;const e=u.getBBox();let t=e.height;const s=e.width,{width:a}=o.current.getBoundingClientRect();if(s>a){t*=a/s}o.current.style.height=`${t+10}px`,i.fit(),i.setOptions({duration:void 0!==n.duration?n.duration:500})}),0);d(e)}else i.fit()}),[s.current,e]);return{markmapComponent:(0,Le.jsx)("svg",{style:i,ref:o}),refSvg:o,refMarkmap:s,handleZoomOut:()=>{var e;null===(e=s.current)||void 0===e||e.rescale(.75)},handleZoomIn:()=>{var e;null===(e=s.current)||void 0===e||e.rescale(1.25)},handleZoomFit:()=>{var e;null===(e=s.current)||void 0===e||e.fit()}}},Qr=({handle:e})=>{const[t,n]=(0,f.useState)(!1),[i,o]=(0,f.useState)(!1),[s,a]=(0,f.useState)(!1),l=(0,f.useRef)(-1),c=(0,f.useMemo)((()=>be.sxB),[t,i]);return(0,f.useEffect)((()=>{t&&(l.current=Number(setTimeout((()=>{n(!1)}),3e3)))}),[t]),{onDownloadClick:(d=(0,r.A)((function*(){o(!0),yield e(),n(!0),o(!1)})),function(){return d.apply(this,arguments)}),onMouseLeave:()=>{a(!0)},onMouseEnter:()=>{a(!1),s&&(n(!1),clearTimeout(l.current))},DownloadIcon:c};var d},Xr=({handle:e})=>{const[t,n]=(0,f.useState)(!1),[i,o]=(0,f.useState)(!1),[s,a]=(0,f.useState)(!1),l=(0,f.useRef)(-1),c=(0,f.useMemo)((()=>t?be.eWz:be.fFY),[t,i]);return(0,f.useEffect)((()=>{t&&(l.current=Number(setTimeout((()=>{n(!1)}),3e3)))}),[t]),{onCopyClick:(d=(0,r.A)((function*(){o(!0),yield e(),n(!0),o(!1)})),function(){return d.apply(this,arguments)}),onMouseLeave:()=>{a(!0)},onMouseEnter:()=>{a(!1),s&&(n(!1),clearTimeout(l.current))},CopyIcon:c};var d},el={container:"container-UI5RYJ",header:"header-lcHz2Q",actionMenu:"actionMenu-ub0row",otherBtnMenu:"otherBtnMenu-pes9Xn",markmapContent:"markmapContent-jjJLIS"},tl=(0,l.jco)(),nl=({handleExitFullscreen:e,value:t,t:n,enableCopyImage:i,handleCopy:o,handleDownload:s,getPopupContainer:a})=>{const{markmapComponent:r,handleZoomFit:l,handleZoomIn:c,handleZoomOut:d}=Jr({value:t}),u=(0,f.useRef)(null);(0,f.useEffect)((()=>{const{cssText:t}=document.body.style;document.body.style.overflow="hidden";const n=t=>{"Escape"===t.code&&(t.preventDefault(),t.stopPropagation(),e())};return document.addEventListener("keydown",n,!0),()=>{document.body.style.cssText=t,document.removeEventListener("keydown",n,!0)}}),[]),(0,f.useEffect)((()=>{u.current&&(u.current.style.pointerEvents="none",setTimeout((()=>{u.current&&(u.current.style.pointerEvents="unset")}),600))}),[u.current]);const{onCopyClick:h,onMouseEnter:m,onMouseLeave:p,CopyIcon:g}=Xr({handle:o}),{onDownloadClick:v,DownloadIcon:_}=Qr({handle:s});return(0,Le.jsxs)("div",{className:el.container,ref:u,children:[(0,Le.jsxs)("div",{className:el.header,children:[(0,Le.jsxs)("div",{className:el.actionMenu,children:[(0,Le.jsxs)("button",{onClick:v,className:el.download,children:[(0,Le.jsx)(_,{}),(0,Le.jsx)("span",{children:n("flow_web_ext_search_mindmap_download")})]}),i&&(0,Le.jsxs)("button",{onClick:h,onMouseEnter:m,onMouseLeave:p,className:el.copyImg,children:[(0,Le.jsx)(g,{}),(0,Le.jsx)("span",{children:n("flow_web_ext_search_mindmap_copy")})]})]}),(0,Le.jsxs)("div",{className:el.otherBtnMenu,children:[(0,Le.jsx)(Be.m_,{content:tl?void 0:n("flow_web_ext_search_mindmap_zoom_out"),getPopupContainer:a,spacing:{y:12,x:0},children:(0,Le.jsx)("button",{className:el.zoomOut,onClick:d,children:(0,Le.jsx)(be.bed,{style:{fontSize:"20px"}})})}),(0,Le.jsx)(Be.m_,{content:tl?void 0:n("flow_web_ext_search_mindmap_zoom_in"),getPopupContainer:a,spacing:{y:12,x:0},children:(0,Le.jsx)("button",{className:el.zoomIn,onClick:c,children:(0,Le.jsx)(be.wJ,{style:{fontSize:"20px"}})})}),(0,Le.jsx)(Be.m_,{content:tl?void 0:n("flow_web_ext_search_mindmap_fit"),getPopupContainer:a,spacing:{y:12,x:0},children:(0,Le.jsx)("button",{className:el.zoomFit,onClick:l,children:(0,Le.jsx)(be.aoI,{style:{fontSize:"20px"}})})}),(0,Le.jsx)(Be.cG,{layout:"vertical",margin:"0px"}),(0,Le.jsx)("button",{className:el.closeBtn,onClick:e,children:(0,Le.jsx)(be.abE,{style:{fontSize:"20px"}})})]})]}),(0,Le.jsx)("div",{className:el.markmapContent,children:r})]})},il="actionContainer-aTtMUR",ol="actionBtn-Ws4Z7x",sl="name-B3NQm0",al=({t:e,onClickCopy:t,onClickDownload:n,onClickEnterFullscreen:i,getPopupContainer:o,value:s,refSvg:a,uiLanguage:c,registerRecyclable:d,fullscreenRootElement:u,iconUrl:h,extName:p})=>{const g=(0,l.jco)(),v=(0,f.useRef)(null),[_,x]=(0,f.useState)(!1),[y,b]=(0,f.useState)(!0),{mindmapExportShadowComponent:w,handleCopy:C,handleDownload:A}=Vr({refSvg:a,iconUrl:h,t:e,extName:p}),{onCopyClick:S,onMouseEnter:I,onMouseLeave:k,CopyIcon:j}=Xr({handle:(E=(0,r.A)((function*(){null==t||t(!1),yield C()})),function(){return E.apply(this,arguments)})});var E;const{onDownloadClick:T,DownloadIcon:N}=Qr({handle:(M=(0,r.A)((function*(){null==n||n(!1),yield A()})),function(){return M.apply(this,arguments)})});var M;const{handleEnterFullscreen:R}=(({value:e,t,enableCopyImage:n,handleCopy:i,handleDownload:o,registerRecyclable:s,fullscreenRootElement:a})=>{const r=(0,f.useRef)(),l=(0,f.useRef)(),c=()=>{var e,t;null===(e=l.current)||void 0===e||e.unmount(),l.current=void 0,null===(t=r.current)||void 0===t||t.remove(),r.current=void 0};return(0,f.useEffect)((()=>{null==s||s(c)}),[s]),{handleEnterFullscreen:()=>{if(!a)return;if(r.current)return;const s=document.createElement("div");s.id="cici-fullscreen-mark-map-container",s.style.position="fixed",s.style.left="0",s.style.top="0",s.style.right="0",s.style.bottom="0",s.style.zIndex="9999",a.appendChild(s);const d=(0,m.createRoot)(s);r.current=s,l.current=d,d.render((0,Le.jsx)(nl,{handleExitFullscreen:c,value:e,t,enableCopyImage:n,handleCopy:i,handleDownload:o,getPopupContainer:()=>s}))},handleExitFullscreen:c}})({value:s,t:e,enableCopyImage:y,handleCopy:(P=(0,r.A)((function*(){null==t||t(!0),yield C()})),function(){return P.apply(this,arguments)}),handleDownload:(L=(0,r.A)((function*(){null==n||n(!0),yield A()})),function(){return L.apply(this,arguments)}),registerRecyclable:d,fullscreenRootElement:u});var L,P;const B=()=>{null==i||i(),R()};return(0,f.useEffect)((()=>{var e;null!==(e=navigator)&&void 0!==e&&null!==(e=e.permissions)&&void 0!==e&&e.query&&navigator.permissions.query({name:"clipboard-write"}).then((e=>{b("granted"===e.state)})).catch((()=>b(!1)))}),[]),(0,f.useEffect)((()=>{if(!v.current)return;const e=v.current.parentElement;if(!e)return;const t=v.current.getBoundingClientRect(),n=e.getBoundingClientRect();t.right>n.right?x(!0):x(!1)}),[c,y]),(0,Le.jsxs)("div",{className:il,ref:v,children:[w,_?(0,Le.jsxs)(Le.Fragment,{children:[u&&(0,Le.jsx)(Be.m_,{content:g?void 0:e("flow_web_ext_search_mindmap_full"),getPopupContainer:o,spacing:{y:10,x:0},children:(0,Le.jsx)(ya.c,{type:"tertiary",icon:(0,Le.jsx)(be.qO4,{}),size:"small",onClick:B})}),(0,Le.jsx)(Be.m_,{content:g?void 0:e("flow_web_ext_search_mindmap_download"),getPopupContainer:o,spacing:{y:10,x:0},children:(0,Le.jsx)(ya.c,{type:"tertiary",icon:(0,Le.jsx)(N,{}),size:"small",onClick:T})}),y&&(0,Le.jsx)(Be.m_,{content:g?void 0:e("flow_web_ext_search_mindmap_copy"),getPopupContainer:o,spacing:{y:10,x:0},children:(0,Le.jsx)(ya.c,{type:"tertiary",icon:(0,Le.jsx)(j,{}),size:"small",onClick:S,onMouseEnter:I,onMouseLeave:k})})]}):(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsxs)("button",{className:ol,onClick:B,children:[(0,Le.jsx)(be.qO4,{}),(0,Le.jsx)("span",{className:sl,children:e("flow_web_ext_search_mindmap_full")})]}),(0,Le.jsxs)("button",{className:ol,onClick:T,children:[(0,Le.jsx)(N,{}),(0,Le.jsx)("span",{className:sl,children:e("flow_web_ext_search_mindmap_download")})]}),y&&(0,Le.jsxs)("button",{className:ol,onClick:S,onMouseEnter:I,onMouseLeave:k,children:[(0,Le.jsx)(j,{}),(0,Le.jsx)("span",{className:sl,children:e("flow_web_ext_search_mindmap_copy")})]})]})]})},rl="markmapContent-BpkXhS",ll="markmapActionButton-SGLLLb",cl=({t:e,value:t,isDone:n,getPopupContainer:i,onCopy:o,onDownload:s,onEnterFullcreen:a,autoHeight:r,markmapRef:l,uiLanguage:c,registerRecyclable:d,fullscreenRootElement:u,iconUrl:h,extName:m})=>{const{markmapComponent:p,refSvg:g,refMarkmap:v}=Jr({value:t,autoHeight:r,style:{maxHeight:"1200px",minHeight:"200px"}});return(0,f.useEffect)((()=>{v.current&&l&&(l.current=v.current)}),[v.current,l]),(0,Le.jsx)(Le.Fragment,{children:t?(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsx)("div",{className:rl,children:p}),n&&(0,Le.jsx)("div",{className:ll,children:(0,Le.jsx)(al,{value:t,refSvg:g,t:e,getPopupContainer:i,onClickDownload:s,onClickCopy:o,onClickEnterFullscreen:a,uiLanguage:c,registerRecyclable:d,fullscreenRootElement:u,iconUrl:h,extName:m})})]}):(0,Le.jsx)(Mr,{t:e})})},dl={},ul=({t:e,value:t,isDone:n,isError:i,getPopupContainer:o,onCopy:s,onDownload:a,onEnterFullcreen:r,handleRetry:l,autoHeight:c=!0,markmapRef:d,uiLanguage:u,registerRecyclable:h,fullscreenRootElement:m,iconUrl:p,extName:g})=>(0,Le.jsx)("div",{className:dl.markmapContainter,children:i?(0,Le.jsx)(Er,{t:e,handleRetry:l}):(0,Le.jsx)(cl,{t:e,value:t,isDone:n,getPopupContainer:o,onCopy:s,onDownload:a,onEnterFullcreen:r,autoHeight:c,markmapRef:d,uiLanguage:u,registerRecyclable:h,fullscreenRootElement:m,iconUrl:p,extName:g})}),hl=({t:e,isActive:t,getPopupContainer:n,onFirstShow:i,onCopy:o,onDownload:s,onEnterFullcreen:r,getSendMessageParams:l,translateLanguage:c})=>{const[d,h]=(0,f.useState)(""),m=(0,f.useRef)(),[p]=(0,v.Y)("uiLanguage"),[g,_]=(0,f.useState)(!1),[x,y]=(0,f.useState)(""),b=(0,ha.P)((e=>e.sendMessage)),w=()=>{const e=b((0,a.A)((0,a.A)({},l()),{},{sec_scene:kr._o.mind_note}));y(e)},C=()=>{h(""),y(""),T(!1)},A=(0,ha.P)((e=>e.messages[x])),{isDone:S,text:I="",isError:k,isOpen:j}=A||{},[E,T]=(0,f.useState)(!1);(0,f.useEffect)((()=>{c&&(C(),t&&w())}),[c]),(0,f.useEffect)((()=>{var e;t&&(g&&(null==i||i(),_(!1)),x||w(),E?null===(e=m.current)||void 0===e||e.fit():(I!==d&&h(I),S&&T(!0)))}),[I,t,S]);return(0,Le.jsx)(ul,{t:e,value:d,isDone:Boolean(S),isError:j&&(k||S&&!d),getPopupContainer:n,onCopy:o,onDownload:s,onEnterFullcreen:r,handleRetry:()=>{C(),w()},markmapRef:m,uiLanguage:p,registerRecyclable:u.A,fullscreenRootElement:null===(N=document.querySelector("#doubao-ai-assistant"))||void 0===N||null===(N=N.shadowRoot)||void 0===N?void 0:N.querySelector("#ciciai-shadow-container"),iconUrl:(0,Se.Nf)(),extName:(0,Se.L2)()||""});var N};var ml=n(99824);const pl=({isActive:e,getPopupContainer:t,transcript_list:n=[],translateLanguage:i})=>{const o=(0,g.B)();return(0,Le.jsx)(hl,{t:o,isActive:e,getPopupContainer:t,getSendMessageParams:()=>({text:location.href,answerWithSuggest:!1,current_page:(0,tn.M5)(location.href),scene:kr.sJ.video_click,replyLang:null!=i?i:(0,No.wz)((0,J.TK)("uiLanguage")),prompt:ml.EU.browser_plugin_info,browser_plugin_info:JSON.stringify({skill_name:"text_to_mindnote",mindnote_source:"transcript",transcript_list:n})}),translateLanguage:i})},gl=()=>{mn._1.recordClickRelayBtnType(mn.X_.playNext)},vl=()=>{mn._1.recordClickRelayBtnType(mn.X_.recommendVideo)},fl=()=>{mn._1.recordClickRelayBtnType(mn.X_.recommendVideoEnding)};var _l=n(94870);const xl="tabs-bD7J4T",yl="tab-item-emA2C7",bl="tab-icon-rope33",wl="tab-text-INjVpq",Cl="active-tab-text-t3v4X3",Al="active-mfAmqD",Sl="loading-container-vxKfcs",Il=({onSetPreviousActiveTabKey:e,onSetFirstShow:t,activeKey:n,webpageTabs:i,className:o,onChange:s,tabItemStyle:a})=>{const r=i.filter((e=>(e.itemTitle||e.icon)&&e.itemKey)),[l,c]=(0,f.useState)(n||r[0].itemKey);return(0,Le.jsx)(Le.Fragment,{children:(0,Le.jsx)("div",{className:ie()(xl,o),children:r.map((n=>{const{itemTitle:i,itemKey:o,icon:r,loading:d}=n;return(0,Le.jsxs)("div",{className:ie()(yl,{[Al]:l===o}),style:a,onClick:()=>{l!==o&&(null==e||e(l),c(o),null==t||t(!1),null==s||s(o))},"data-testid":`webpage-tab-${o}`,children:[r&&(0,Le.jsx)(_l.Ay$,{className:bl,svg:r}),i&&(0,Le.jsx)("div",{className:ie()(wl,{[Cl]:l===o}),children:i}),d&&(0,Le.jsx)(Be.tK,{size:"small",wrapperClassName:Sl})]},o)}))})})};var kl=n(68252);let jl=function(e){return e.summary="summary",e.memo="memo",e.mindmap="mindmap",e}({});var El=n(57717);var Tl=n(31937),Nl=n(79124),Ml=n.n(Nl),Rl=n(42664),Ll=n.n(Rl);const Pl=function(){var e=(0,r.A)((function*({videoID:e,useUILang:t=!0,lang:n="en"}){const i=yield fetch(location.href),o=yield i.text();if(!o.includes("captionTracks"))return console.warn(`No captions found for video: ${e}`),{subtitles:[]};const s=/"captionTracks":(\[.*?\])/.exec(o);if(!s)return console.warn(`Failed to extract captionTracks from video: ${e}`),{subtitles:[]};const[a,r]=s,l=JSON.parse(r),c=t?(0,No.wz)((0,J.TK)("uiLanguage")):n;let d;d=c.includes("zh")?[c,"zh","zh-Hans","zh-Hant","en","es","ja"]:[c,"en","es","ja"];const u=(0,Tl.A)(d.map((e=>{const t=l.find((t=>"en"===e?t.languageCode.includes(e):t.languageCode===e));return t}))),h=l[0],m=u[0]||h;if(null==m||!m.baseUrl)return console.warn(`Could not find ${n} captions for ${e}`),{subtitles:[]};const p=yield fetch(m.baseUrl),g=yield p.text(),v=/start="([\d.]+)"/,f=/dur="([\d.]+)"/,_=g.replace('<?xml version="1.0" encoding="utf-8" ?><transcript>',"").replace("</transcript>","").split("</text>").filter((e=>e&&e.trim())).reduce(((e,t)=>{const n=v.exec(t),i=f.exec(t);if(!n||!i)return console.warn(`Failed to extract start or duration from line: ${t}`),e;const[,o]=n,[,s]=i,a=t.replace(/<text.+>/,"").replace(/&amp;/gi,"&").replace(/<\/?[^>]+(>|$)/g,""),r=Ll().decode(a),l=Ml()(r);return e.push({start:o,dur:s,text:l}),e}),[]),x=_.map((e=>{const{start:t,dur:n,text:i}=e;return{text:i,duration:1e3*parseInt(n),offset:1e3*parseInt(t)}}));return{subtitles:x}}));return function(t){return e.apply(this,arguments)}}(),Bl=function(){var e=(0,r.A)((function*({videoId:e}){return(0,Io.jB)("youtube")?yield Pl({videoID:e}):(0,Io.jB)("bilibili")?yield(0,ua.S)({videoId:e}):void 0}));return function(t){return e.apply(this,arguments)}}();var Dl=n(89369),Fl=n(37526),Ul=n(82587);function Hl(){return(Hl=(0,r.A)((function*(e){const t=yield(0,Gn.S6)({method:"POST",url:`${Un.kD}/plugin/web_meta_upload`,data:{source_url:location.href,web_meta:e}});if(t instanceof Error)throw t;return t}))).apply(this,arguments)}const zl=function(){var e=(0,r.A)((function*(e){try{yield function(e){return Hl.apply(this,arguments)}(e)}catch(t){p.vF.persist.error({message:"upload media data to cache failed",error:t})}}));return function(t){return e.apply(this,arguments)}}();let Ol;const ql="has_showed_user_guidance",Vl=function(){var e=(0,r.A)((function*(e){var t;const n=yield de.A.get(ql);Ol=void 0!==n&&Boolean(n),e(null!==(t=Boolean(n))&&void 0!==t&&t)}));return function(t){return e.apply(this,arguments)}}(),$l=({videoParamId:e,videoTitle:t,isImmersionMode:n})=>{const i=(0,f.useRef)((0,$o.o6)()),[o,s]=(0,f.useState)(""),[l,c]=(0,f.useState)(""),d=(0,J.TK)("uiLanguage"),[u,h]=(0,f.useState)(d),m=(0,ha.P)((e=>e.sendMessage)),p=(0,ha.P)((e=>e.messages));(0,f.useEffect)((()=>{El.A.on("SUMMARIZE VIDEO",El.x.PAGE,(()=>{q({clickFrom:ro.ONBOARDING})}))}),[]);const g=(0,f.useMemo)((()=>Fl.Qz.create("cici_video_summary_action_perf")),[]),[v,x]=(0,f.useState)(!1),[y,b]=(0,mn.I_)(),[w,C]=(0,f.useState)(!1),[A,S]=(0,f.useState)(!1),[I,k]=(0,f.useState)(Ol),[j,E]=(0,Ul.r)(ql),[T,N]=(0,f.useState)(!0),{isDone:M,text:R="",isUnAuthorized:L}=p[o]||{},{isDone:P,text:B="",isUnAuthorized:D}=p[l]||{},F=mn._1.hasTranscript(),{setIsLoadingDone:U}=(0,cn.e)();(0,f.useEffect)((()=>{U(!(!P||!B))}),[P,B]);const H=A&&F&&P&&M&&!(0,un.ld)(B)&&!R,z=!F&&v&&!w,O=function(){var t=(0,r.A)((function*(){try{const t=yield Bl({videoId:e}),n=null==t?void 0:t.subtitles;return N(!(null==t||!t.isUserLogin)),mn._1.updateTranscriptData(n),n}catch(t){mn._1.updateTranscriptData([])}finally{x(!0),C(!1)}}));return function(){return t.apply(this,arguments)}}(),q=function(){var n=(0,r.A)((function*({clickFrom:n,translateLang:i}){if(_o({click_from:n}),mn._1.updateModuleClickFrom(n),S(!0),b(!0),k(!0),(0,Dl.BB)({action:"web_video_summary",loginParams:{}}))return;null==g||g.start(),null==g||g.mark("request_transcript_start");const o=yield O(),r=(0,un.mJ)(e),l=(0,un.qZ)();null==g||g.mark("request_start");const u={title:t,url:location.href,transcript_list:o};o&&o.length>0&&(((e,t)=>{const n=m((0,a.A)((0,a.A)({},e),{},{browser_language:(0,No.wz)(null!=t?t:d),current_page:(0,tn.M5)(location.href),scene:kr.sJ.video_click,sec_scene:kr._o.video_click_summarize}));s(n),mn._1.updateVideoSummaryId(n)})({text:location.href,prompt:ml.EU.youtube,browser_youtube_transcript:{browser_youtube_summary_transcript:JSON.stringify(u)}},i),((e,t)=>{const n=m((0,a.A)((0,a.A)({},e),{},{browser_language:(0,No.wz)(null!=t?t:d),current_page:(0,tn.M5)(location.href),scene:kr.sJ.video_click,sec_scene:kr._o.video_click_summarize}));c(n),mn._1.updateVideoHighlightsId(n)})({text:location.href,prompt:ml.EU.youtube,browser_youtube_transcript:{browser_youtube_timeline_transcript:JSON.stringify(u)}},i),zl({cover_url:r,title:t,duration:l,timeline_transcript:JSON.stringify(o)}))}));return function(e){return n.apply(this,arguments)}}();(0,f.useEffect)((()=>{if(mn._1.resetVideoSummaryStatus(),y||(0,$o.o6)()||(0,$o.$Z)()){const e=mn._1.getLastClickRelayBtnType()||ro.UPPER_RIGHT;e&&q({clickFrom:e})}}),[]),(0,f.useEffect)((()=>{Vl((e=>{k(e)}))}),[]),(0,f.useEffect)((()=>{var t;t=i.current?lo.ONBOARDING:lo.UPPER_RIGHT,(0,tn.z8)(_.Ur.showVideoAssistant,{show_from:t}),e&&(C(!0),O()),E(!0)}),[]),(0,f.useEffect)((()=>{M&&(null==g||g.mark("response_summary_done")),P&&(null==g||g.mark("response_timeline_done"))}),[M,P]),(0,f.useEffect)((()=>{var e;M&&P&&(null==g||g.end("response_end"),e={summary_message_id:R?o:"",highlights_message_id:(0,un.ld)(B)?l:"",language:(0,No.wz)(u),is_immersion:n,click_from:mn._1.getModuleClickFrom()},fo(_.Ur.showVideoAssistantSummarizeResult,e))}),[M,P,n]);const V=(0,f.useMemo)((()=>({videoSummaryId:o,videoHighlightsId:l,translateLanguage:u,transcript:mn._1.getTranscriptData(),isTranscriptLoaded:v,isSummaryDone:Boolean(M),isHighlightsDone:Boolean(P),hasTranscript:F,summarizeTriggered:y,summaryResult:R,highlightsResult:B,hasNoSubtitles:z})),[o,l,u,v,M,P,F,y,R,B,z]),$=(0,f.useMemo)((()=>({setTranslateLanguage:h,handleSummarizeVideo:q})),[h,q]);return{contentVisible:A,noContent:H,hasNoSubtitles:z,hasShowedUserGuidance:I,isMessageUnAuthorized:D||L,isLoginBilibili:T,controlller:$,videoSummaryInfo:V}};function Kl(e){(0,f.useEffect)((()=>{var t;if(!(0,vt.ku)()||!e)return;const n=null===(t=Mn())||void 0===t?void 0:t.getVideoControlContainer();let i;return n&&(i=function(e){if(!e)return;const t=Mn();if(!t)return;const n=u.m.getInstance().getHostId(),i=`${he.tI}${n}`,o=document.createElement("div");o.id=i,t.configMemoBtn(o);const s=`${he.tm}${n}`,a=e.querySelector(`#${s}`);a?e.insertBefore(o,a.nextSibling):e.prepend(o);const r=o.attachShadow({mode:"open"});return(0,rt.NR)(r,he.QN).then((()=>{(0,m.createRoot)(r).render(f.createElement(Ni))})),()=>{var t;return null===(t=e.querySelector(`#${i}`))||void 0===t?void 0:t.remove()}}(n)),()=>{var e;null===(e=i)||void 0===e||e()}}),[e])}function Wl(e,t,n,i,o){if(!e)return;if(!t)return;if(n)return;o({clickFrom:mn._1.getLastEntryFullScreenFrom()||ro.IMMERSION_FULLSCREEN_BTN,translateLang:i})}class Gl{canPlay(){return(0,$o.id)()}clearScreen(){const e=document.querySelector(".bpx-player-top-wrap");e&&(e.style.display="none")}enterImmersionMode(e){}exitImmersionMode(){}getFullScreenBtnSelector(){return"div.bpx-player-control-bottom-right div.bpx-player-ctrl-full div.bpx-player-ctrl-btn-icon"}getVideoElementSelector(){return".bpx-player-video-wrap"}getVideoContainerSelector(){return".bpx-player-video-wrap"}getFullScreenShortKey(){return"f"}getCustomImmersionBtnStyleStr(){return"\n    .immersion-btn-container {\n        height: 28px !important;\n        margin: -1px 5px 0px 10px;\n        border: 0;\n        cursor: pointer;\n        white-space: nowrap;\n      }\n     .immersion-btn-container > div{\n        height: 28px !important;\n    }\n    "}onImmersionBtnClick(){var e;const t=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});null===(e=document.querySelector("div.bpx-player-control-bottom-right div.bpx-player-ctrl-full"))||void 0===e||e.dispatchEvent(t)}getImmersionBtnContainer(){const e=document.querySelector("div.bpx-player-control-wrap div.bpx-player-control-bottom-right");return e&&(e.style.alignItems="center",e.style.marginBottom="5px"),e}}class Zl{constructor(){(0,y.A)(this,"ytNavigateEnd",void 0),(0,y.A)(this,"ytNavigatedStart",void 0)}canPlay(){return(0,$o.tY)()}clearScreen(){const e=document.querySelector("div.html5-video-player");if(!e)return;const t=e.querySelector(".ytp-chrome-top");t&&(t.style.display="none");const n=e.querySelector(".ytp-chapter-container");n&&(n.style.display="none")}enterImmersionMode(e){this.ytNavigateEnd=t=>{var n;if(e.isImmersionMode)return void Wl(e.isImmersionMode,e.videoSummaryInfo.hasTranscript,e.videoSummaryInfo.summarizeTriggered,e.videoSummaryInfo.translateLanguage,e.handleSummarizeVideo);"watch"!==(null==t||null===(n=t.detail)||void 0===n?void 0:n.pageType)&&(mn._1.resetClickRelayBtnType(!0),mn._1.updateShouldSummaryVideoDefault(!1))},this.ytNavigatedStart=e=>{mn._1.resetClickRelayBtnType()},document.addEventListener("yt-navigate-start",this.ytNavigatedStart),document.addEventListener("yt-navigate-finish",this.ytNavigateEnd)}exitImmersionMode(){this.ytNavigatedStart&&document.removeEventListener("yt-navigate-start",this.ytNavigatedStart),this.ytNavigateEnd&&document.removeEventListener("yt-navigate-finish",this.ytNavigateEnd)}getFullScreenBtnSelector(){return"button.ytp-fullscreen-button"}getVideoElementSelector(){return".html5-main-video"}getVideoContainerSelector(){return"div.html5-video-container"}getFullScreenShortKey(){return"f"}getCustomImmersionBtnStyleStr(){return"\n    .immersion-btn-container {\n        margin: 7px 10px 0px 10px;\n      }\n    "}onImmersionBtnClick(){var e;null===(e=document.querySelector("html"))||void 0===e||e.requestFullscreen()}getImmersionBtnContainer(){return document.querySelector("div.ytp-chrome-controls div.ytp-right-controls")}}const Yl={width:"350px",position:"absolute",right:"10px",top:"100px",pointerEvents:"none"},Jl="\n.immersion-btn-container {\n  height: 33px !important;\n  width: auto !important;\n  border-radius: 16px;\n  padding: 0 14px 0 10px !important;\n  background-blend-mode: lighten;\n  vertical-align: top;\n  color: #ffffff;\n  position: relative;\n  overflow: hidden;\n\n  span, div {\n    z-index: 1;\n  }\n\n  &::before {\n    content: '';\n    left: 50%;\n    top: 50%;\n    position: absolute;\n    width: 200px;\n    height: 200px;\n    transform: translate(-50%, -50%);\n    background:\n      radial-gradient(115.45% 162.76% at 19.33% 22.04%, #0057FF 0%, #4298FD 50%);\n  }\n}\n  .immersion-btn-container:hover::before {\n    animation: inactive-btn-hover-animation 3s linear infinite;\n  }\n\n  @keyframes inactive-btn-hover-animation {\n    0% {\n      transform: translate(-50%, -50%) rotate(0);\n    }\n    100% {\n      transform: translate(-50%, -50%) rotate(1turn);\n    }\n  }\n",Ql='<svg width="20" height="23" viewBox="0 0 12 13" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M6.37888 10.7863C6.27162 10.7863 6.17707 10.7496 6.09521 10.6762C6.01618 10.6028 5.96679 10.5097 5.94703 10.3968C5.87082 9.96209 5.7932 9.59658 5.71417 9.30021C5.63514 9.00667 5.53776 8.76675 5.42204 8.58047C5.30914 8.39418 5.16096 8.24458 4.97749 8.13168C4.79403 8.01878 4.55976 7.92846 4.27468 7.86072C3.99243 7.79298 3.64102 7.72806 3.22047 7.66597C3.10474 7.64903 3.00878 7.59964 2.93257 7.51778C2.85918 7.43593 2.82249 7.33855 2.82249 7.22565C2.82249 7.11275 2.8606 7.01537 2.9368 6.93352C3.01301 6.84885 3.10898 6.79945 3.2247 6.78534C3.64526 6.73736 3.99949 6.6809 4.28738 6.61599C4.57528 6.55107 4.81237 6.46216 4.99866 6.34926C5.18495 6.23353 5.33595 6.08112 5.45168 5.89201C5.57022 5.70008 5.66619 5.45593 5.73957 5.15956C5.81296 4.86037 5.88211 4.49344 5.94703 4.05878C5.96397 3.94305 6.01195 3.84991 6.09098 3.77934C6.17283 3.70596 6.2688 3.66927 6.37888 3.66927C6.48896 3.66927 6.58351 3.70596 6.66254 3.77934C6.74439 3.84991 6.7952 3.94305 6.81496 4.05878C6.89117 4.49344 6.96737 4.85896 7.04358 5.15533C7.12261 5.44887 7.21999 5.68879 7.33571 5.87507C7.45144 6.06136 7.60103 6.21095 7.7845 6.32386C7.96796 6.43676 8.20082 6.52708 8.48307 6.59482C8.76815 6.66256 9.11955 6.72607 9.53729 6.78534C9.65583 6.8051 9.7518 6.8559 9.82518 6.93776C9.90139 7.01961 9.9395 7.11557 9.9395 7.22565C9.9395 7.34138 9.90139 7.44158 9.82518 7.52625C9.74898 7.6081 9.6516 7.65468 9.53305 7.66597C9.11532 7.71395 8.7625 7.77181 8.4746 7.83955C8.18671 7.90447 7.9482 7.99338 7.75909 8.10628C7.57281 8.21918 7.4218 8.3716 7.30608 8.56353C7.19035 8.75546 7.0958 8.99961 7.02241 9.29598C6.94903 9.59517 6.87988 9.96209 6.81496 10.3968C6.79802 10.5097 6.74863 10.6028 6.66677 10.6762C6.58774 10.7496 6.49178 10.7863 6.37888 10.7863ZM3.24604 5.71619C3.10491 5.71619 3.02588 5.64281 3.00895 5.49603C2.97508 5.22507 2.9412 5.01197 2.90733 4.85673C2.87346 4.70149 2.81701 4.58436 2.73798 4.50533C2.65895 4.42347 2.54041 4.36279 2.38234 4.32327C2.22428 4.28376 2.00413 4.24424 1.72187 4.20473C1.56663 4.18215 1.48901 4.10312 1.48901 3.96763C1.48901 3.83215 1.55817 3.75312 1.69647 3.73054C1.98437 3.67974 2.21017 3.63316 2.37388 3.59083C2.53758 3.54849 2.65895 3.48922 2.73798 3.41301C2.81701 3.33398 2.87346 3.21966 2.90733 3.07007C2.9412 2.91765 2.97508 2.70738 3.00895 2.43923C3.02588 2.28964 3.10491 2.21484 3.24604 2.21484C3.38434 2.21484 3.46337 2.28682 3.48313 2.43077C3.517 2.71302 3.55087 2.93318 3.58474 3.09124C3.62143 3.2493 3.6793 3.36785 3.75833 3.44688C3.83736 3.52309 3.95732 3.57954 4.1182 3.61623C4.27908 3.65292 4.50206 3.69103 4.78714 3.73054C4.84923 3.73619 4.90004 3.76159 4.93956 3.80675C4.97907 3.85191 4.99883 3.90554 4.99883 3.96763C4.99883 4.10029 4.93109 4.17932 4.79561 4.20473C4.50489 4.25271 4.27767 4.29928 4.11397 4.34444C3.95308 4.38678 3.83312 4.44746 3.75409 4.5265C3.67506 4.6027 3.61861 4.71702 3.58474 4.86943C3.55087 5.02185 3.517 5.23354 3.48313 5.5045C3.47466 5.5666 3.44785 5.6174 3.40269 5.65692C3.35753 5.69643 3.30531 5.71619 3.24604 5.71619Z" fill="white"/>\n</svg>';var Xl=n(34870),ec=n(45498);const tc={showSubtitleTranslation:!0,showSetting:!1,buttonHeight:33,subtitleReady:!1,popoverPosition:{left:0,bottom:0},resetVideoUI:0,isFullscreen:!1},nc=(0,ec.vt)()((0,Xl.eh)((e=>(0,a.A)((0,a.A)({},tc),{},{setResetVideoUI:t=>e({resetVideoUI:t}),setShowSubtitleTranslation:t=>e({showSubtitleTranslation:t}),setShowSetting:t=>e({showSetting:t}),setButtonHeight:t=>e({buttonHeight:t}),setSubtitleReady:t=>e({subtitleReady:t}),setPopoverPosition:t=>e({popoverPosition:t}),setIsFullscreen:t=>e({isFullscreen:t})}))));var ic=n(70593);const oc={UNSPECIFIED:0,AA:1,AB:2,AE:3,AF:4,AK:5,AM:6,AN:7,AR:8,AS:9,AV:10,AY:11,AZ:12,BA:13,BE:14,BG:15,BH:16,BI:17,BM:18,BN:19,BO:20,BR:21,BS:22,CA:23,CE:24,CH:25,CO:26,CR:27,CS:28,CU:29,CV:30,CY:31,DA:32,DE:33,DV:34,DZ:35,EE:36,EL:37,EN:38,EO:39,ES:40,ET:41,EU:42,FA:43,FF:44,FI:45,FJ:46,FO:47,FR:48,FY:49,GA:50,GD:51,GL:52,GN:53,GU:54,GV:55,HA:56,HE:57,HI:58,HO:59,HR:60,HT:61,HU:62,HY:63,HZ:64,IA:65,ID:66,IE:67,IG:68,II:69,IK:70,IO:71,IS:72,IT:73,IU:74,JA:75,JV:76,KA:77,KG:78,KI:79,KJ:80,KK:81,KL:82,KM:83,KN:84,KO:85,KR:86,KS:87,KU:88,KV:89,KW:90,KY:91,LA:92,LB:93,LG:94,LI:95,LN:96,LO:97,LT:98,LU:99,LV:100,MG:101,MH:102,MI:103,MK:104,ML:105,MN:106,MO:107,MR:108,MS:109,MT:110,MY:111,NA:112,NB:113,ND:114,NE:115,NG:116,NL:117,NN:118,NO:119,NR:120,NV:121,NY:122,OC:123,OJ:124,OM:125,OR:126,OS:127,PA:128,PI:129,PL:130,PS:131,PT:132,QU:133,RM:134,RN:135,RO:136,RU:137,RW:138,SA:139,SC:140,SD:141,SE:142,SG:143,SH:144,SI:145,SK:146,SL:147,SM:148,SN:149,SO:150,SQ:151,SR:152,SS:153,ST:154,SU:155,SV:156,SW:157,TA:158,TE:159,TG:160,TH:161,TI:162,TK:163,FIL:164,TN:165,TO:166,TR:167,TS:168,TT:169,TW:170,TY:171,UG:172,UK:173,UR:174,UZ:175,VE:176,VI:177,VO:178,WA:179,WO:180,XH:181,YI:182,YO:183,ZA:184,ZH:185,ZU:186,"HI-LATN":1001,"ZH-HANT":1002,"ZH-HANT-HK":1003,"ZH-HANT-TW":1004,CEB:2001,CKB:2002,KMR:2003,UMB:2004,NSO:2005,KAM:2006,LUO:2007,FUV:2008,LZH:3001,YUE:3002,CMN:3003,WUU:3004,NAN:3005};var sc;const ac=e=>{let t=e;return"zh-CN"===e&&(t="zh"),"es-ES"===e&&(t="es"),t};let rc=0;class lc{constructor(){var e=this;(0,y.A)(this,"isTranslating",!1),(0,y.A)(this,"id",0),(0,y.A)(this,"texts",[]),(0,y.A)(this,"translatePromise",void 0),(0,y.A)(this,"resolveTranslate",void 0),(0,y.A)(this,"translateFinished",!1),(0,y.A)(this,"startTime",void 0),(0,y.A)(this,"endTime",void 0),(0,y.A)(this,"addText",((e,t,n)=>{(void 0===this.startTime||this.startTime>t)&&(this.startTime=t);const i=t+n;(void 0===this.endTime||this.endTime<i)&&(this.endTime=i),this.texts.push(e);const o=100===this.texts.length?new lc:this,s=this.texts.length-1,a=this.translatePromise.then((t=>[e,t[s]]));return this.triggerTranslate(),{nextThread:o,translateResult:a}})),(0,y.A)(this,"detectLang",(e=>e?new Promise((t=>{chrome.i18n.detectLanguage(e,(e=>{var n;const i=null==e||null===(n=e.languages[0])||void 0===n?void 0:n.language;t(ac(i))}))})).catch((e=>"en")):"en")),(0,y.A)(this,"handleTranslateFinished",void 0),(0,y.A)(this,"onReady",(e=>{this.handleTranslateFinished=e})),(0,y.A)(this,"translate",(0,r.A)((function*(){const t="system"===lc.translateTargetLang?ac(chrome.i18n.getUILanguage()):lc.translateTargetLang;if(0===e.texts.length)return yield(n=300,new Promise((e=>{setTimeout((()=>{e(!0)}),n)}))),e.translate();var n;const i=e.texts[0]+(e.texts[1]||"")+(e.texts[2]||"")+(e.texts[3]||"");var o,s;return(yield e.detectLang(i))===t?(null===(o=e.resolveTranslate)||void 0===o||o.call(e,e.texts),e.translateFinished=!0,void(null===(s=e.handleTranslateFinished)||void 0===s||s.call(e,e.id))):cc(e.texts,t).then((t=>{var n,i;null===(n=e.resolveTranslate)||void 0===n||n.call(e,t),e.translateFinished=!0,null===(i=e.handleTranslateFinished)||void 0===i||i.call(e,e.id)})).catch((e=>{console.log("fetch err: ",e)}))}))),(0,y.A)(this,"triggerTranslate",(()=>{this.isTranslating||(this.isTranslating=!0,lc.doTheTranslate(this))})),this.id=rc,rc+=1,lc.translateThreads.push(this),this.translatePromise=new Promise((e=>{this.resolveTranslate=e}))}}sc=lc,(0,y.A)(lc,"translateTargetLang","system"),(0,y.A)(lc,"onThreadReady",((e,t)=>{const n=sc.translateThreads.find((t=>t.id===e));n&&n.onReady(t)})),(0,y.A)(lc,"setTranslateTargetLang",(e=>{sc.translateTargetLang=e})),(0,y.A)(lc,"translateTasks",[]),(0,y.A)(lc,"resetTranslateTasks",(()=>{sc.translateTasks=[]})),(0,y.A)(lc,"sortTranslateThreads",(e=>{const t=(0,ic.A)(sc.translateTasks,(t=>Boolean(t.startTime&&t.endTime&&t.startTime<=e&&e<=t.endTime)));if(t<=0)return;const n=sc.translateTasks.splice(t);sc.translateTasks=[...n,...sc.translateTasks]})),(0,y.A)(lc,"doTheTranslate",(e=>{sc.translateTasks.push(e),sc.loopTasks()})),(0,y.A)(lc,"isLooping",!1),(0,y.A)(lc,"loopTasks",(0,r.A)((function*(){if(!sc.isLooping){for(;sc.translateTasks.length>0;){sc.isLooping=!0;const e=sc.translateTasks.shift();e&&(yield e.translate())}sc.isLooping=!1}}))),(0,y.A)(lc,"translateThreads",[]),(0,y.A)(lc,"findTranslateReady",(e=>{if(void 0===e||e<0)return!1;const{translateFinished:t}=sc.translateThreads.find((t=>t.id===e))||{};return!!t}));const cc=function(){var e=(0,r.A)((function*(e,t="zh"){const n=function(e){return oc[e.toUpperCase()]}(t);if(void 0===n)return e;return(yield(0,me.Pt)(e,n)).items.map((e=>e.res))}));return function(t){return e.apply(this,arguments)}}();var dc=n(57650);class uc{constructor(){(0,y.A)(this,"videoPlaying",!1),(0,y.A)(this,"timeUpdateHandler",void 0),(0,y.A)(this,"lastTime",0),(0,y.A)(this,"handleBottomVisibilityToggle",void 0),(0,y.A)(this,"handleYoutubeToggleFullscreen",void 0),(0,y.A)(this,"getYoutubeVideoContainer",(()=>document.querySelector(".html5-video-player"))),(0,y.A)(this,"getVideoSetting",(()=>document.querySelector(".ytp-settings-menu"))),(0,y.A)(this,"getYoutubeVideo",(()=>document.querySelector(".html5-main-video"))),(0,y.A)(this,"watchVideoStatus",(()=>{const e=this.getYoutubeVideoContainer();e?(0,dc.SM)(e,(e=>{var t,n,i,o;(e.includes("playing-mode")?this.videoPlaying=!0:e.includes("paused-mode")&&(this.videoPlaying=!1),e.includes("ytp-autohide"))?null===(t=this.handleBottomVisibilityToggle)||void 0===t||t.call(this,!1):null===(n=this.handleBottomVisibilityToggle)||void 0===n||n.call(this,!0);e.includes("ytp-fullscreen")?null===(i=this.handleYoutubeToggleFullscreen)||void 0===i||i.call(this,!0):null===(o=this.handleYoutubeToggleFullscreen)||void 0===o||o.call(this,!1)})):setTimeout(this.watchVideoStatus,300)})),(0,y.A)(this,"pauseVideo",(()=>{var e;null===(e=this.getYoutubeVideo())||void 0===e||e.pause()})),(0,y.A)(this,"playVideo",(()=>{var e;null===(e=this.getYoutubeVideo())||void 0===e||e.play()})),(0,y.A)(this,"bindVideoOnclickHandler",(e=>{e.addEventListener("click",(()=>{this.videoPlaying?this.pauseVideo():this.playVideo()}))})),(0,y.A)(this,"getBoundingClientRect",(()=>{const e=this.getYoutubeVideoContainer();if(!e)return{left:0,bottom:0};const{left:t,bottom:n}=e.getBoundingClientRect();return{left:t,bottom:n}})),(0,y.A)(this,"onVideoResizeHandler",(e=>{const t=this.getYoutubeVideoContainer();if(t){new ResizeObserver(e).observe(t)}else setTimeout(e,300)})),(0,y.A)(this,"onBottomVisibilityToggle",(e=>{e(!0),this.handleBottomVisibilityToggle=e})),(0,y.A)(this,"onYoutubeToggleFullscreen",(e=>{this.handleYoutubeToggleFullscreen=e})),(0,y.A)(this,"handleTimeupdate",null),(0,y.A)(this,"handleTimeJump",null),(0,y.A)(this,"watchSettingChange",((e,t=3)=>{const n=this.getVideoSetting();n?((0,dc.V$)(n,e),e()):t&&setTimeout((()=>{this.watchSettingChange(e,t-1)}),600)})),(0,y.A)(this,"onTimeUpdated",(e=>{this.handleTimeupdate=e;const t=this.getYoutubeVideo();t&&(this.timeUpdateHandler&&t.removeEventListener("timeupdate",this.timeUpdateHandler),this.timeUpdateHandler=(0,k.A)((()=>{var e;const n=1e3*t.currentTime;var i;Math.abs(n-this.lastTime)>2e4&&(null===(i=this.handleTimeJump)||void 0===i||i.call(this));this.lastTime=n,null===(e=this.handleTimeupdate)||void 0===e||e.call(this,n)}),50),t.addEventListener("timeupdate",this.timeUpdateHandler))})),(0,y.A)(this,"fireTimeUpdateEvent",(()=>{var e;const t=this.getYoutubeVideo();t&&(null===(e=this.handleTimeupdate)||void 0===e||e.call(this,1e3*t.currentTime))})),(0,y.A)(this,"pause",(()=>{var e;null===(e=this.getYoutubeVideo())||void 0===e||e.pause()})),(0,y.A)(this,"onTimeJump",(e=>{this.handleTimeJump=e})),this.watchVideoStatus()}}const hc=()=>{const e=document.querySelector(".ytp-caption-window-container");e&&"none"!==e.style.display&&(e.style.display="none")},mc=(e,t=3)=>e().catch((n=>{if(0===t)throw n;return mc(e,t-1)}));const pc=new class{constructor(){var e=this;(0,y.A)(this,"youtubeVideoManager",new uc),(0,y.A)(this,"uiStore",void 0),(0,y.A)(this,"currentSubtitle",void 0),(0,y.A)(this,"lastLang",void 0),(0,y.A)(this,"currentVideoId",""),(0,y.A)(this,"fetchingVideoId",""),(0,y.A)(this,"subtitleButtonContainer",null),(0,y.A)(this,"getVideoIdFromUrl",(()=>new URL(window.location.href).searchParams.get("v")||"")),(0,y.A)(this,"urlChangeHandler",(e=>{var t;const n=null==e||null===(t=e.detail)||void 0===t||null===(t=t.response)||void 0===t||null===(t=t.playerResponse)||void 0===t?void 0:t.videoDetails;if(this.currentVideoId=(null==n?void 0:n.videoId)||"",this.currentVideoId||(this.currentVideoId=this.getVideoIdFromUrl()),this.watchSettingLang(),this.currentVideoId){this.preloadSubtitles();try{de.A.get("autoTranslateSubtitles").then((e=>{e&&this.openBilingualSubtitle()}))}catch(i){}}})),(0,y.A)(this,"measureRightControls",(()=>{const e=document.querySelector(".ytp-right-controls");return e?e.getBoundingClientRect().height:0})),(0,y.A)(this,"computeButtonHeight",(()=>{var e,t;const{height:n}=(null===(e=this.subtitleButtonContainer)||void 0===e?void 0:e.getBoundingClientRect())||{height:0};null===(t=this.uiStore)||void 0===t||t.setButtonHeight(n)})),(0,y.A)(this,"pauseVideo",(()=>{this.youtubeVideoManager.pause()})),(0,y.A)(this,"computePopoverPosition",(()=>{var e,t;const{left:n}=(null===(e=this.subtitleButtonContainer)||void 0===e?void 0:e.getBoundingClientRect())||{left:0},{left:i}=this.youtubeVideoManager.getBoundingClientRect(),o=n-i+20,s=this.measureRightControls()+16-72;null===(t=this.uiStore)||void 0===t||t.setPopoverPosition({left:o,bottom:s})})),(0,y.A)(this,"preloadSubtitles",(()=>{this.fetchSubtitles()})),(0,y.A)(this,"fetchSubtitles",(0,r.A)((function*(){e.currentVideoId=e.currentVideoId||e.getVideoIdFromUrl();const t=e.getSubtitleLang();if(!e.currentVideoId)return;if(e.fetchingVideoId===e.currentVideoId&&e.lastLang===t)return;e.lastLang=t,e.fetchingVideoId=e.currentVideoId;const n=yield mc((()=>Pl({videoID:e.currentVideoId,useUILang:!t,lang:t})),10),i=null==n?void 0:n.subtitles;var o;(i&&(e.currentSubtitle=i),e.currentVideoId===e.fetchingVideoId)&&(null===(o=e.uiStore)||void 0===o||o.setSubtitleReady(!0));return i}))),(0,y.A)(this,"restart",(()=>{this.reset(),this.fetchSubtitles()})),(0,y.A)(this,"reset",(()=>{var e,t;null===(e=this.uiStore)||void 0===e||e.setSubtitleReady(!1),this.stopWatchingSubtitles(),null===(t=this.uiStore)||void 0===t||t.setResetVideoUI((new Date).getTime()),lc.resetTranslateTasks()})),(0,y.A)(this,"getCurrentSubtitles",(()=>this.currentSubtitle)),(0,y.A)(this,"setSubtitleButtonContainer",(e=>{this.subtitleButtonContainer=e})),(0,y.A)(this,"watchButtonPosition",(()=>{this.youtubeVideoManager.onVideoResizeHandler((()=>{this.computePopoverPosition(),this.computeButtonHeight()}))})),(0,y.A)(this,"bindVideoOnclickHandler",this.youtubeVideoManager.bindVideoOnclickHandler),(0,y.A)(this,"onBottomVisibilityToggle",this.youtubeVideoManager.onBottomVisibilityToggle),(0,y.A)(this,"closeBilingualSubtitle",(()=>{(()=>{const e=document.querySelector(".ytp-caption-window-container");e&&(e.style.display="")})()})),(0,y.A)(this,"openBilingualSubtitle",(0,r.A)((function*(){hc(),yield e.fetchSubtitles()}))),(0,y.A)(this,"reopenTranslate",(e=>{lc.setTranslateTargetLang(e),this.openBilingualSubtitle()})),(0,y.A)(this,"stopWatchingSubtitles",(()=>{this.youtubeVideoManager.onTimeUpdated(null),this.youtubeVideoManager.onTimeJump(null)})),(0,y.A)(this,"watchCurrentSubtitle",((e,t)=>{const n=this.currentVideoId;this.youtubeVideoManager.onTimeUpdated((i=>{if(n!==this.currentVideoId)return;lc.sortTranslateThreads(i);const o=e.find((e=>e.offset<=i&&i<e.offset+e.duration));t(o?o.text:{threadId:-1,originalText:"",getTranslate:()=>Promise.resolve(["",""])})})),setTimeout((()=>{this.youtubeVideoManager.fireTimeUpdateEvent()}))})),(0,y.A)(this,"getSubtitleLang",(()=>{let e="";const t=localStorage.getItem("yt-player-caption-sticky-language");if(t){const n=JSON.parse(t);e=(null==n?void 0:n.data)||""}return e})),(0,y.A)(this,"updateSubtitlesIfLangChange",(()=>{this.getSubtitleLang()!==this.lastLang&&this.restart()})),(0,y.A)(this,"watchSettingLang",(()=>{this.youtubeVideoManager.watchSettingChange(this.updateSubtitlesIfLangChange)})),(0,y.A)(this,"onVideoToggleFullscreen",this.youtubeVideoManager.onYoutubeToggleFullscreen),(0,y.A)(this,"makeSureOriginalSubtitleHide",(()=>{hc()})),(0,y.A)(this,"onTimeJump",this.youtubeVideoManager.onTimeJump),this.urlChangeHandler(),"navigation"in window?window.navigation.addEventListener("navigate",(()=>{this.reset(),this.urlChangeHandler()})):window.addEventListener("yt-navigate-start",this.reset),window.addEventListener("yt-navigate-finish",this.urlChangeHandler),window.addEventListener("yt-navigate-cache",this.reset),this.uiStore=nc.getState()}},gc=pc;var vc=n(33388),fc=n(13959);const _c="subtitles_container-XYzb2H",xc="original_subtitle-vSPrki",yc="translated_subtitle-RT8XdR",bc=()=>{const[e]=(0,v.Y)("subtitleTranslateLang"),[t]=(0,v.Y)("autoTranslateSubtitles"),[n,i]=(0,f.useState)(1),[o,s]=(0,f.useState)(""),[a,r]=(0,f.useState)(["",""]),[l,c]=(0,f.useState)(!1),[d,u]=(0,f.useState)(),[h,m]=(0,f.useState)(),[p,g]=(0,f.useState)(),{subtitleReady:_,isFullscreen:x,resetVideoUI:y}=nc();if((0,f.useEffect)((()=>{g(void 0),m(void 0),s(""),r(["",""])}),[y]),(0,f.useEffect)((()=>{e&&t&&(i((new Date).getTime()),gc.reopenTranslate(e),m(void 0),r(["",""]))}),[e,t]),(0,f.useEffect)((()=>{if(_||n){const e=gc.getCurrentSubtitles();if(!e)return;const t=(e=>{const t=[];let n=new lc;return e.forEach((e=>{const{text:i,offset:o,duration:s}=e,{nextThread:a,translateResult:r}=n.addText(i,o,s);t.push({text:{threadId:n.id,originalText:i,getTranslate:()=>r},offset:o,duration:s}),n=a})),t})(e);t&&g(t)}}),[_,n]),(0,f.useEffect)((()=>(p&&(gc.watchCurrentSubtitle(p,(e=>{m(e),u(e.threadId),s(e.originalText)})),gc.onTimeJump((()=>{r(["",""])}))),()=>{gc.stopWatchingSubtitles()})),[p]),(0,f.useEffect)((()=>{if(void 0===d||d<0)return;lc.findTranslateReady(d)?c(!0):(c(!1),lc.onThreadReady(d,(e=>{e===d&&c(!0)})))}),[d]),(0,f.useEffect)((()=>{if(!l)return;const{getTranslate:e}=h||{};null==e||e().then((([e,t])=>{r([e,t])}))}),[l,h]),!h||!_)return null;if(!t)return null;if(-1===(null==h?void 0:h.threadId))return null;if(!o)return null;gc.makeSureOriginalSubtitleHide();const b=o===a[0]?a[1]:"...",w=o!==b;return(0,Le.jsxs)("div",{className:_c,"data-testid":"video-assistant-subtitle-container",children:[(0,Le.jsx)("div",{className:xc,style:{fontSize:x?"2.4em":"2em"},children:o}),w?(0,Le.jsx)("div",{className:yc,style:{fontSize:x?"2.4em":"2em"},children:b}):null]})},wc="translate_target-YPSdRA",Cc="translate_target_names-MzTahw",Ac="translate_target_lang_name-Zx5GGz",Sc="selected-CN1cnk",Ic="dark-MZOLTG",kc="translate_target_lang_translated_name-OtoxsR",jc="translate_target_selected_icon_container-msUmt5",Ec=e=>{const{code:t,langTranslatedName:n,langLocName:i,selected:o,onSelect:s,theme:a="light"}=e;return(0,Le.jsxs)("div",{className:wc,onClick:()=>{s(t)},children:[(0,Le.jsxs)("div",{className:Cc,children:[(0,Le.jsx)("div",{className:ie()({[Ac]:!0,[Sc]:o,[Ic]:"dark"===a}),children:i}),(0,Le.jsx)("div",{className:ie()({[kc]:!0,[Ic]:"dark"===a}),children:n})]}),(0,Le.jsx)("div",{className:jc,children:o&&(0,Le.jsx)(ze.Tf,{})})]})};var Tc=n(99301);const Nc="subtitle_setting_wrapper-kvmobz",Mc="mask-e7zwtJ",Rc="subtitle_target_lang_title-zPumr7",Lc="subtitle_target_lang_list-_zVVpf",Pc="disable-setting-TOuOKD",Bc="disable-options-uQYAtc",Dc="disable-options-menus-VaMtAW",Fc=()=>{const{setShowSubtitleTranslation:e}=nc(),[t,n]=(0,f.useState)(!1),[i,o]=(0,v.Y)("subtitleTranslateLang"),s=(0,at.Uk)(),a=(0,Po.e)(),r=e=>{o(e)};return(0,Le.jsxs)("div",{className:ie()(Nc),onClick:e=>{e.stopPropagation()},children:[(0,Le.jsx)(Ae.A,{className:Bc,dropdownClassName:Dc,show:t,setShow:n,position:"rightTop",disableKey:Tc.lf.videoSubtitle,optionPageSection:"video-summary",onDisableOnceClick:()=>e(!1),children:(0,Le.jsx)("div",{className:Mc})}),(0,Le.jsxs)("div",{className:"p-12",children:[(0,Le.jsxs)("div",{className:"flex items-center",children:[(0,Le.jsx)("span",{className:ie()(Rc,"flex-1"),children:s("flow_web_youtube_subtitles_setting_language")}),(0,Le.jsx)("span",{className:ie()(Pc,"flex-initial"),onClick:()=>n(!0),children:s("flow_web_ext_setting")})]}),(0,Le.jsxs)("div",{className:Lc,children:[(0,Le.jsx)(Ec,{theme:"dark",selected:"system"===i,code:"system",langTranslatedName:s("flow_web_youtube_subtitles_setting_systemlanguage"),langLocName:s("background_follow_system"),onSelect:()=>{o("system")}},"system"),null==a?void 0:a.map((e=>(0,Le.jsx)(Ec,{theme:"dark",selected:i===e.language_code,code:e.language_code,langTranslatedName:e.language,langLocName:e.language_loc,onSelect:r},e.language_code)))]})]})]})},Uc="subtitle_window-r78hdZ",Hc="subtitle_container-l66tBz",zc="subtitle_popover-VcCs4b",Oc=()=>{const{popoverPosition:e,setShowSetting:t,showSetting:n,showSubtitleTranslation:i}=nc(),o=(0,fc.A)((()=>{t(!1)})),[s]=(0,v.Y)("videoSubtitleDisableHosts"),[a]=(0,v.Y)("videoSubtitleDisableAll");return s.includes(window.location.host)||a||!i?null:(0,Le.jsx)("div",{className:ie()(Uc,"cici-ext-container"),children:(0,Le.jsxs)("div",{className:"cici-ext-always-dark semi-always-dark",children:[(0,Le.jsx)("div",{className:Hc,children:(0,Le.jsx)(bc,{})}),(0,Le.jsx)("div",{ref:o,className:zc,style:{left:e.left,bottom:e.bottom},children:n?(0,Le.jsx)(Fc,{}):null})]})})},qc=()=>{var e;const t=(0,at.Uk)();return(0,vc.A)(null===(e=document.querySelector(`[id*=${he.$9}]`))||void 0===e?void 0:e.shadowRoot),(0,Le.jsx)(p.Yd.Provider,{value:ue.vF,children:(0,Le.jsx)(g.C,{t,children:(0,Le.jsx)(Oc,{})})})},Vc="subtitle_button-lmC4ch",$c="setting_part-S380fg",Kc="setting_part_icon-y7_pqu",Wc="setting_part_text-w4VMKV",Gc="subtitle_button_divider-KIxXhg",Zc="toggle_part-iB9SjP",Yc="toggle_part_icon-jX7JTa",Jc=()=>{const[e]=(0,v.Y)("authInfo"),t=(null==e?void 0:e.isAuthenticated)||!1,[n,i]=(0,v.Y)("autoTranslateSubtitles"),o=(0,at.Uk)(),{buttonHeight:s,setShowSetting:a,showSetting:l,isFullscreen:c,setIsFullscreen:d}=nc();(0,f.useEffect)((()=>{n?gc.openBilingualSubtitle():gc.closeBilingualSubtitle()}),[n]),(0,f.useEffect)((()=>{!t&&n&&(gc.closeBilingualSubtitle(),i(!1))}),[t,n]),(0,f.useEffect)((()=>{gc.onVideoToggleFullscreen(d)}),[]);const u=function(){var e=(0,r.A)((function*(){if(n)yield gc.closeBilingualSubtitle(),i(!1);else{if(!t)return void(0,Ce.DT)({trackMeta:{login_entrance:"bilingual_subtitles"}});yield gc.openBilingualSubtitle(),i(!0)}}));return function(){return e.apply(this,arguments)}}();return(0,Le.jsxs)("div",{className:Vc,style:{height:c?38:33,marginTop:c?3:0},children:[(0,Le.jsxs)("div",{className:$c,onClick:()=>{l||(gc.pauseVideo(),gc.computePopoverPosition()),a(!l)},children:[(0,Le.jsx)("div",{className:Kc,children:(0,Le.jsx)(ze.eI,{})}),(0,Le.jsx)("div",{className:Wc,children:o("flow_web_youtube_subtitles_bilingual")})]}),(0,Le.jsx)("div",{className:Gc}),(0,Le.jsx)("div",{className:ie()(Zc),style:{height:s},onClick:u,"data-testid":"video-assistant-subtitle-toggle",children:(0,Le.jsx)("div",{className:Yc,children:n?(0,Le.jsx)(ze.$N,{}):(0,Le.jsx)(ze.JW,{})})})]})},Qc="subtitle_assistant_container-_RjPH3",Xc=()=>{const e=(0,f.useRef)(null),{showSubtitleTranslation:t}=nc(),[n]=(0,v.Y)("videoSubtitleDisableHosts"),[i]=(0,v.Y)("videoSubtitleDisableAll"),o=n.includes(window.location.host)||i;return(0,f.useEffect)((()=>{const t=e.current;t&&(gc.setSubtitleButtonContainer(t),gc.watchButtonPosition())}),[e]),o||!t?null:(0,Le.jsx)("div",{ref:e,className:Qc,children:(0,Le.jsx)(Jc,{})})},ed=()=>{var e;const t=(0,at.Uk)();return(0,vc.A)(null===(e=document.querySelector(`[id*=${he.$9}]`))||void 0===e?void 0:e.shadowRoot),(0,Le.jsx)(p.Yd.Provider,{value:ue.vF,children:(0,Le.jsx)(g.C,{t,children:(0,Le.jsx)(Xc,{})})})},td=`${(0,Se.L2)()}_subtitle_assistant`,nd=e=>{const t=document.createElement("div");t.id=td,t.className="ytp-button",t.style.cssText="width: fit-content; height: 100%;";const n=u.m.getInstance().getHostId(),i=`${he.tm}${n}`,o=e.querySelector(`#${i}`);if(null!=o&&o.nextSibling){if(Boolean(document.querySelector(`#${td}`)))return;e.insertBefore(t,o.nextSibling);const n=t.attachShadow({mode:"open"}),i=(0,m.createRoot)(n);(0,rt.NR)(n,he.QN).then((()=>{i.render((0,Le.jsx)(Xt,{element:t,children:(0,Le.jsx)(ed,{})}))})),(0,u.A)((()=>{var e;i.unmount(),null===(e=document.querySelector(`#${td}`))||void 0===e||e.remove()}))}},id=e=>{const t=document.querySelector(`#${td}`);t&&(t.style.display=e?"inline-block":"none")},od=`${(0,Se.L2)()}_subtitle_window`,sd=e=>{const t=document.createElement("div");t.id=od,t.style.cssText="position: absolute; width: 100%; top: 0; bottom: 0; left: 0; z-index: 12; pointer-events: none;";if(Boolean(document.querySelector(`#${od}`)))return;e.appendChild(t);const n=t.attachShadow({mode:"open"}),i=(0,m.createRoot)(n);gc.bindVideoOnclickHandler(t),gc.onBottomVisibilityToggle((e=>{t.style.bottom=e?"60px":"12px"})),(0,rt.NR)(n,he.QN).then((()=>{i.render((0,Le.jsx)(Xt,{element:t,children:(0,Le.jsx)(qc,{})}))})),(0,u.A)((()=>{var e;i.unmount(),null===(e=document.querySelector(`#${od}`))||void 0===e||e.remove()}))},ad=e=>{const t=document.querySelector(`#${od}`);t&&(t.style.display=e?"block":"none")},rd="immersion-button-container-style";let ld=!1;function cd(e,t,n){if(!e)return;const{videoSummaryInfo:{hasNoSubtitles:i},isMessageUnAuthorized:o,isSummaryAssistantClose:s}=n;ld=Boolean(o);const a=e.getImmersionBtnContainer();if(!a)return;!function(e){if(!e)return;let t=document.getElementById(rd);t||(t=document.createElement("style"),t.id=rd,t.innerHTML=`${Jl} ${e.getCustomImmersionBtnStyleStr()}`,(0,ht.EY)(t))}(e);const r=u.m.getInstance().getHostId(),l=`${he.tm}${r}`;let c=a.querySelector(`#${l}`);if(c){s&&c.remove();const e=document.fullscreenElement;return c.style.display=e?"none":"inline-block",void(i?(c.style.display="none",gc.closeBilingualSubtitle(),id(!1),ad(!1)):(gc.openBilingualSubtitle(),id(!0),ad(!0)))}if(c=function(e,t,n){const i=document.createElement("button");i.addEventListener("click",(()=>{ld?(0,Ce.DT)({trackMeta:{previous_page:(0,$o.pQ)(),login_entrance:(0,$o.pQ)()}}):(mn._1.updateEntryFullScreenFrom(ro.IMMERSION_BTN),mn._1.updateShouldSummaryVideoDefault(!0),null==e||e.onImmersionBtnClick(),xo(ho.TOOLBAR))})),i.id=t,i.className="ytp-button",i.classList.add("immersion-btn-container"),i.setAttribute("data-testid","video-assistant-immersionBtn");const o=document.createElement("div"),s=document.createElement("span");s.style.marginRight="4px",s.style.display="inline-block",s.innerHTML=Ql;const a=document.createElement("span");return a.textContent=n("flow_web_ext_youtube_sharepage_immersionbutton"),a.style.fontWeight="600",a.style.fontSize="12px",de.A.watch({uiLanguage:()=>{a.textContent=n("flow_web_ext_youtube_sharepage_immersionbutton")}}),o.style.height="33px",o.style.lineHeight="initial",o.style.display="flex",o.style.alignItems="center",o.prepend(a),o.prepend(s),i.appendChild(o),i}(e,l,t),i?c.style.display="none":yo(mo.TOOLBAR),s||a.prepend(c),(0,u.A)((()=>{var e;null===(e=a.querySelector(`#${l}`))||void 0===e||e.remove()})),(0,Io.jB)("youtube")){const e=document.querySelector(".ytp-right-controls");nd(e);const t=document.querySelector("#container .html5-video-player");sd(t)}}var dd=n(99153),ud=n(1948);const hd="ytFullscreenContainer-iAvZg0",md="loadingContainer-N3dTT8",pd="autoLoading-IF5g74",gd="loadingContent-sgcYBz",vd="loadingText-vo4h92",fd="icon-qQ0HXm",_d="dotFlashingContainer-UAwJZz",xd="guideTipsContainer-ga1OJ3",yd="divider-I_F_yj",bd="guideText-m5YbJh",wd="openImmersionMode-rkXDIk",Cd="iconBtnContainer-f0Fdke",Ad="noSubTitleTipsContainer-gYyhRs",Sd="noSubTitleTips-RHSGvj",Id="immersionExpandContainer-yAwhmC",kd="immersionFoldIcon-uz017x",jd="immersionExpandContent-kK5Nlq",Ed="immersionFold-x4jqlA",Td="immersionExpandTooltip-ZpperL",Nd="login-button-puEXGC",Md=e=>{const{setSummaryAssistantClose:t}=e,n=(0,g.B)(),i=(0,f.useCallback)((()=>{null==t||t(!0)}),[t]);return(0,Le.jsx)("div",{className:Ad,children:(0,Le.jsxs)("div",{className:Sd,children:[n("flow_web_ext_youtube_nosubtitles",{brand:(0,Se.L2)()}),(0,Le.jsx)(ud.A,{style:{cursor:"pointer"},onClick:i})]})})},Rd=({loadingTextRef:e,loadingTextWidth:t,isAutoSummarize:n})=>{const i=(0,g.B)(),o=(0,La.zh)({from:{width:32},to:{width:t+32},config:{duration:300}}),s=(0,La.zh)({from:{opacity:0},to:{opacity:1},config:{duration:1500}});return(0,Le.jsx)("div",{className:ie()(md,{[pd]:n}),children:(0,Le.jsxs)(La.CS.div,{className:gd,style:o,children:[(0,Le.jsx)(La.CS.div,{ref:e,className:vd,style:s,children:(0,Le.jsxs)(Le.Fragment,{children:[n&&(0,Le.jsx)(be.k4K,{className:fd}),i("flow_web_ext_youtube_summarizing")]})}),(0,Le.jsx)("div",{className:_d,children:(0,Le.jsx)(br.c,{})})]})})};var Ld=function(e){return e.INDEPENDENT="independent",e.FOLD="fold",e.EXPAND="expand",e}(Ld||{});const Pd={[Ld.INDEPENDENT]:(0,Le.jsx)(ze.yZ,{}),[Ld.FOLD]:(0,Le.jsx)(ze.ut,{}),[Ld.EXPAND]:(0,Le.jsx)(ze.hk,{})},Bd=({immersionHighlightExpand:e,onToggleExpand:t})=>{const n=(0,g.B)(),i=(0,ma.A)(),[o,s]=(0,f.useState)(Ld.INDEPENDENT),[a,r]=(0,f.useState)(!1);return(0,f.useEffect)((()=>{const e=setTimeout((()=>{r(!0)}),1e3);return()=>{clearTimeout(e)}}),[]),a?(0,Le.jsx)("div",{className:ie()(Id,{[kd]:o===Ld.FOLD,[Ed]:!e}),onMouseEnter:()=>{s(e?Ld.FOLD:Ld.EXPAND)},onMouseLeave:()=>s(Ld.INDEPENDENT),children:(0,Le.jsx)(Be.m_,{content:n(e?"flow_web_ext_youtube_sharepage_putaway":"flow_web_ext_youtube_sharepage_expand"),position:"left",getPopupContainer:null==i?void 0:i.getPopupContainer,className:Td,children:(0,Le.jsx)("div",{className:jd,onClickCapture:e=>{e.stopPropagation(),null==t||t()},children:(0,Le.jsx)("div",{children:Pd[o]})})})}):null},Dd=({text:e,trackResultEvent:t,trackHighlightEvent:n,videoDuration:i=0,videoState:o,setVideoState:s,loadingTextWidth:a,isNeedLoadingAnimation:r,handleUserInteract:l,userInteracting:c,activeScroll:d})=>{const[u,h]=(0,La.zh)((()=>({from:{width:a+44+32}})));return(0,f.useEffect)((()=>{h.start({to:{width:a+44+12},config:{duration:300}}),setTimeout((()=>{h.start({to:{width:300}})}),500)}),[]),(0,Le.jsx)(Le.Fragment,{children:r?(0,Le.jsx)(La.CS.div,{className:md,style:u}):(0,Le.jsx)(sr,{videoDuration:i,text:e,trackResultEvent:t,trackHighlightEvent:n,videoState:o,setVideoState:s,isImmersionMode:!0,handleUserInteract:l,userInteracting:c,activeScroll:d})})};var Fd=n(26069);const Ud=({loadingTextWidth:e,onClickGuideBtn:t})=>{const n=(0,g.B)(),[i,o]=(0,f.useState)(!1),[s,{width:a}]=(0,Fd.A)(),r=mn._1.getModuleClickFrom();(0,f.useEffect)((()=>{var e;e=r,(0,tn.z8)(_.Ur.showVideoImmersionGuideTips,{click_from:e})}),[]),(0,f.useEffect)((()=>{setTimeout((()=>{o(!0)}),5e3)}),[]),(0,f.useEffect)((()=>{var e;i&&(e=r,(0,tn.z8)(_.Ur.showVideoImmersionGuideIcon,{click_from:e}))}),[i]);const l=(0,La.zh)({from:{width:i?a+32:e+32},to:{width:i?40:a+32},config:{duration:300}}),c=(0,La.zh)({from:{opacity:0},to:{opacity:1},config:{duration:1500}});return(0,Le.jsx)(La.CS.div,{className:ie()(xd,{[Cd]:i}),style:l,children:i?(0,Le.jsx)(be.k4K,{className:fd,onClick:()=>{var e;t(),e=r,(0,tn.z8)(_.Ur.clickVideoImmersionGuideIcon,{click_from:e,button_name:_._h.immersionGuideIcon})}}):(0,Le.jsxs)(La.CS.div,{className:bd,ref:s,style:c,children:[(0,Le.jsx)("div",{children:n("flow_web_ext_youtube_summary_generated")}),(0,Le.jsx)(Be.cG,{layout:"vertical",className:yd}),(0,Le.jsx)("div",{onClickCapture:e=>{var n;e.stopPropagation(),t(),n=r,(0,tn.z8)(_.Ur.clickVideoImmersionGuideTips,{click_from:n,button_name:_._h.immersionGuideTips})},className:wd,children:n("flow_web_ext_youtube_summary_view")})]})})},Hd=(0,f.forwardRef)(((e,t)=>{const n=(0,f.useRef)(null),[i,o]=(0,f.useState)(e),{videoSummaryInfo:s,trackers:{trackResultEvent:a,trackHighlightEvent:r},videoState:l,setVideoState:c,isSummaryAssistantClose:d,setSummaryAssistantClose:u,userInteracting:h,handleUserInteract:m,isImmersionMode:p,defaulTimmersionHighlightExpand:v=!1,isMessageUnAuthorized:x}=i,{transcript:y,highlightsResult:b,hasNoSubtitles:w,summarizeTriggered:C}=s,A=Boolean(!C&&y&&y.length>0),S=Boolean(s.isHighlightsDone&&b),I=(0,Dl.vh)("web_video_summary",x),k=(0,at.Uk)(),[j,E]=(0,f.useState)(w),T=y&&(null==y?void 0:y.length)>0,[N,M]=(0,f.useState)(v),{isLoadingDone:R}=(0,cn.e)(),[L,P]=(0,f.useState)(!N&&!R),{videoId:B}=(0,cn.e)();(0,f.useEffect)((()=>{P(!N&&!R)}),[B]);const[D,{width:F}]=(0,dd.A)();(0,f.useImperativeHandle)(t,(()=>({updateProps:e=>{o(e)}})),[o]);const[U,H]=(0,f.useState)(!S&&!L);if((0,f.useEffect)((()=>{S&&!L&&setTimeout((()=>{H(!1)}),800)}),[S]),d)return null;const z=(0,f.useMemo)((()=>{var e,t;if(w)return j&&N?(0,Le.jsx)(Md,{setSummaryAssistantClose:()=>E(!1)}):null;if(!I)return(0,Le.jsx)(To,{className:Nd});if(!S)return(0,Le.jsx)(Rd,{loadingTextRef:D,loadingTextWidth:F,isAutoSummarize:L});if(L)return(0,Le.jsx)(Ud,{loadingTextWidth:F,onClickGuideBtn:()=>{P(!1),M(!0)}});const n=(null==y||null===(e=y[(null==y?void 0:y.length)-1])||void 0===e?void 0:e.offset)||0,i=(null==y||null===(t=y[(null==y?void 0:y.length)-1])||void 0===t?void 0:t.duration)||0;return(0,Le.jsx)(Dd,{videoDuration:(n+i)/1e3,text:b,trackResultEvent:a,trackHighlightEvent:r,videoState:l,setVideoState:c,loadingTextWidth:F,isFirstSummarizing:A,isNeedLoadingAnimation:U,userInteracting:h,handleUserInteract:m,isImmersionMode:p,activeScroll:N&&p})}),[S,w,D,F,u,y,b,a,r,l,c,T,A,U,j,E,N,h,m,L,P,M]),O=(0,f.useCallback)((()=>{bo(N?po.COLLAPSED:po.EXPANDED),a(N?_._h.collapsed:_._h.expanded),M(!N)}),[N,M,a,bo]);return(0,Le.jsx)(g.C,{t:k,children:(0,Le.jsx)(Ca.A.Provider,{value:{getPopupContainer:()=>n.current||document.body},children:(0,Le.jsxs)("div",{ref:n,className:ie()("cici-ext-container",hd),children:[(0,Le.jsx)("div",{style:{pointerEvents:"all",transform:N||L?void 0:"translate(110%, 0px)"},children:z}),S&&!L&&(0,Le.jsx)(Bd,{immersionHighlightExpand:N,onToggleExpand:O})]})})})})),zd=Hd;let Od,qd;const Vd=f.createRef();function $d(e,t){if(!e)return;const n=u.m.getInstance().getHostId(),i=document.querySelector(e.getVideoContainerSelector());if(!n||!i)return;const o=`${he.M0}-${n}`;let s=document.getElementById(o);const r=()=>{var e,t;null===(e=document.getElementById(o))||void 0===e||e.remove(),null===(t=Od)||void 0===t||t.unmount(),s=null,Od=void 0,qd=void 0};var l;if(s)return null===(l=Vd.current)||void 0===l||l.updateProps(t),r;s=document.createElement("div"),s.id=o;const c=s.attachShadow({mode:"open"}),d=document.createElement("div");return c.appendChild(d),(0,b.A)(d.style,Yl),i.appendChild(s),(0,rt.NR)(c,he.QN).then((()=>{Od=(0,m.createRoot)(d),qd=f.createElement(zd,(0,a.A)((0,a.A)({ref:Vd},t),{},{defaulTimmersionHighlightExpand:mn._1.getLastEntryFullScreenFrom()===ro.IMMERSION_BTN})),Od.render(qd)})),(0,u.A)(r),r}const Kd=Object.entries(i).map((e=>e[1]));function Wd(e){const t=(0,g.B)(),n=(0,f.useMemo)((()=>{var e;return null===(e=Kd.map((e=>new e)).filter((e=>e.canPlay())))||void 0===e?void 0:e[0]}),[]);var i,o;i=n,o=e.videoSummaryInfo.hasNoSubtitles,(0,f.useEffect)((()=>{var e,t;if(o||!i)return;const n=e=>{!document.fullscreenElement&&e.key&&(xo(ho.SHORTCUT),mn._1.updateEntryFullScreenFrom(ro.IMMERSION_FULLSCREEN_SHORT_CUT))},s=e=>{document.fullscreenElement||(xo(ho.FULLSCREEN),mn._1.updateEntryFullScreenFrom(ro.IMMERSION_FULLSCREEN_BTN))},a=e=>{document.fullscreenElement||(xo(ho.VIDEO_DB_CLICK),mn._1.updateEntryFullScreenFrom(ro.VIDEO_DB_CLICK))};return document.addEventListener("keydown",n,!0),null===(e=document.querySelector(i.getFullScreenBtnSelector()))||void 0===e||e.addEventListener("click",s,!0),null===(t=document.querySelector(i.getVideoElementSelector()))||void 0===t||t.addEventListener("dblclick",a,!0),()=>{var e,t;document.removeEventListener("keydown",n,!0),null===(e=document.querySelector(i.getFullScreenBtnSelector()))||void 0===e||e.removeEventListener("click",s,!0),null===(t=document.querySelector(i.getVideoElementSelector()))||void 0===t||t.removeEventListener("dblclick",a,!0)}}),[o,i]);const s=function(e){const{isImmersionMode:t,videoSummaryInfo:{hasTranscript:n,summarizeTriggered:i,translateLanguage:o},handleSummarizeVideo:s}=e;return(0,f.useCallback)((()=>{Wl(t,n,i,o,s)}),[t,n,i,o,s])}(e);(0,f.useEffect)((()=>{if(!n)return;let i;n.clearScreen(),cd(n,t,e);const o=()=>{var o;(cd(n,t,e),document.fullscreenElement)?(e.setImmersionMode(!0),s(),i=$d(n,e)):(e.setImmersionMode(!1),null===(o=i)||void 0===o||o(),i=void 0)};return document.addEventListener("fullscreenchange",o,!0),e.isImmersionMode&&(s(),i=$d(n,e)),()=>{document.removeEventListener("fullscreenchange",o,!0)}}),[e,t,n]),(0,f.useEffect)((()=>(n.enterImmersionMode(e),()=>{n.exitImmersionMode()})),[n,e])}var Gd=n(22007),Zd=n(27675),Yd=n(16110);const Jd=({videoSummaryId:e,videoHighlightsId:t})=>{const[n,i]=(0,f.useState)(!1),o=(0,dn.l)((e=>e.setIsShowSidebar)),s=(0,ha.P)((e=>e.messages)),{text:l="",body:c}=s[e]||{},{text:d=""}=s[t]||{},u=()=>({summary_message_id:l?e:"",highlights_message_id:(0,un.ld)(d)?t:""}),h=function(){var e=(0,r.A)((function*(){var e,t,o,s;if(n)return;i(!0);const a={messageIds:[null!==(e=null==c||null===(t=c.message)||void 0===t?void 0:t.reply_id)&&void 0!==e?e:"",null!==(o=null==c||null===(s=c.message)||void 0===s?void 0:s.message_id)&&void 0!==o?o:""]};yield(0,Zd.ci)(a)}));return function(){return e.apply(this,arguments)}}();return{trackResultEvent:(e,t,n)=>{var i;i=(0,a.A)((0,a.A)({},u()),{},{button_name:e,is_immersion:t,show_from:n}),fo(_.Ur.clickVideoAssistantSummarizeResult,i)},handleClickContinueInChat:function(){var e=(0,r.A)((function*(){var e,t;if(t=(0,a.A)({},u()),(0,nn.Kp)((0,a.A)((0,a.A)({},vo(t)),{},{click_from:_.Z5.videoAssistant})),null!==(e=(0,J.TK)("authInfo"))&&void 0!==e&&e.isAuthenticated)Gd.on.getState().setFloatingCardVisible(!1),Gd.on.getState().setSummaryActionVisible(!1),o(!0,_.cz.videoAssistant),yield(0,Yd.Z)(),yield h();else{const e=(0,Io.jB)("youtube");(0,Ce.DT)({trackMeta:{previous_page:e?"youtube":"bilibili",login_entrance:e?"youtube":"bilibili"}})}}));return function(){return e.apply(this,arguments)}}(),handleClickLogin:()=>{const e=(0,Io.jB)("youtube");(0,Ce.DT)({trackMeta:{previous_page:e?"youtube":"bilibili",login_entrance:e?"youtube":"bilibili"}})},trackHighlightEvent:(e,t,n,i)=>{var o,s;o=e,s=(0,a.A)((0,a.A)({},u()),{},{video_time:t,position:n,is_immersion:i?1:0}),fo(o,s)},trackShareEvent:(e,t)=>{var n;n=(0,a.A)((0,a.A)({},u()),{},{click_from:e,range:t}),fo(_.Ur.share,n)},handleCopy:()=>{const e=(0,un.mW)(d),t=es()(`${l}${e}`);var n;return n=(0,a.A)({},u()),(0,nn.ct)((0,a.A)((0,a.A)({},vo(n)),{},{click_from:_.Z5.videoAssistant})),t}}};function Qd({videoParamId:e,videoTitle:t}){const[n,i]=(0,mn.gq)(),[o,s]=(0,f.useState)(!1),[a,l]=(0,f.useState)(void 0),{videoSummaryInfo:c,contentVisible:d,noContent:u,hasNoSubtitles:h,hasShowedUserGuidance:m,isLoginBilibili:p,controlller:{setTranslateLanguage:g,handleSummarizeVideo:v},isMessageUnAuthorized:x}=$l({videoParamId:e,videoTitle:t,isImmersionMode:n}),{videoSummaryId:y,videoHighlightsId:b,translateLanguage:w,transcript:C,isTranscriptLoaded:A,summarizeTriggered:S,isSummaryDone:I,isHighlightsDone:k,hasTranscript:j,summaryResult:E,highlightsResult:T}=c,N=(0,Dl.vh)("web_video_summary",x),{trackResultEvent:M,handleClickContinueInChat:R,handleClickLogin:L,trackHighlightEvent:P,trackShareEvent:B,handleCopy:D}=Jd({videoSummaryId:y,videoHighlightsId:b}),F=e=>{M(e,n,a||mn._1.getLastClickRelayBtnType())},U=(0,f.useCallback)(function(){var e=(0,r.A)((function*(e){void 0===a&&l(e.clickFrom),yield v(e)}));return function(t){return e.apply(this,arguments)}}(),[v,a,l]),[H,z]=(0,f.useState)(!1),[O,q]=(0,f.useState)({currentActiveBreakdownIndex:-1,currentActiveBulletPointIndex:-1,progress:0}),[V,$]=(0,f.useState)(!1),K=(0,f.useRef)(),W=()=>{$(!0),clearTimeout(K.current),K.current=setTimeout((()=>{$(!1)}),1e4)};(0,f.useEffect)((()=>{V||clearTimeout(K.current)}),[V]);const G=(0,f.useMemo)((()=>({videoState:O,setVideoState:q,handleSummarizeVideo:U,isSummaryAssistantClose:H,setSummaryAssistantClose:z,userInteracting:V,handleUserInteract:W,isImmersionMode:n,setImmersionMode:i,isMessageUnAuthorized:x,videoSummaryInfo:c,trackers:{trackResultEvent:F,trackHighlightEvent:P}})),[F,P,O,q,U,H,z,V,W,n,i,x,c]);Kl(I&&k),Wd(G),function(){if(!(0,$o.tY)())return;const e=(0,f.useMemo)((()=>new MutationObserver((function(e){document.querySelectorAll("ytd-item-section-renderer").forEach((e=>{e.removeEventListener("click",vl,!0),e.addEventListener("click",vl,!0)}))}))),[]);(0,f.useEffect)((()=>{const t=document.querySelector("ytd-watch-next-secondary-results-renderer #contents");if(t)return e.observe(t,{childList:!0,subtree:!0}),()=>{e.disconnect()}}),[e]),(0,f.useEffect)((()=>{const e=document.querySelector(".ytp-next-button");if(e)return e.addEventListener("click",gl,!0),()=>{e.removeEventListener("click",gl,!0)}}),[]),(0,f.useEffect)((()=>{var e,t;return null===(e=document.querySelector(".ytp-autonav-endscreen-countdown-overlay"))||void 0===e||e.addEventListener("click",fl,!0),null===(t=document.querySelector(".html5-endscreen"))||void 0===t||t.addEventListener("click",fl,!0),()=>{var e,t;null===(e=document.querySelector(".ytp-autonav-endscreen-countdown-overlay"))||void 0===e||e.removeEventListener("click",fl,!0),null===(t=document.querySelector(".html5-endscreen"))||void 0===t||t.removeEventListener("click",fl,!0)}}),[])}(),(0,$o.id)()&&((0,f.useEffect)((()=>{mn._1.resetClickRelayBtnType()}),[]),(0,f.useEffect)((()=>{var e,t;return null===(e=document.querySelector(".bpx-player-ctrl-next"))||void 0===e||e.addEventListener("click",gl,!0),null===(t=document.querySelector(".bpx-player-ctrl-prev"))||void 0===t||t.addEventListener("click",gl,!0),()=>{var e,t;null===(e=document.querySelector(".bpx-player-ctrl-prev"))||void 0===e||e.removeEventListener("click",gl,!0),null===(t=document.querySelector(".bpx-player-ctrl-next"))||void 0===t||t.removeEventListener("click",gl,!0)}}),[]),(0,f.useEffect)((()=>{const e=document.querySelector(".right-container");if(e)return e.addEventListener("click",vl,!0),()=>{e.removeEventListener("click",vl,!0)}}),[]),(0,f.useEffect)((()=>{const e=document.querySelector(".bpx-player-ending-panel");if(e)return e.addEventListener("click",fl,!0),()=>{e.removeEventListener("click",fl,!0)}}),[]));const{activeTab:Z,renderTab:Y}=(()=>{const e=(0,at.Uk)(),t=(0,kl.A)("video_assistant"),[n,i]=(0,f.useState)(jl.summary),o=(0,f.useMemo)((()=>[{itemKey:jl.summary,itemTitle:e("flow_web_ext_youtube_summary"),enable:!0},{itemKey:jl.mindmap,itemTitle:e("flow_web_ext_search_mindmap"),enable:t.mindmap_show},{itemKey:jl.memo,itemTitle:e("flow_web_ext_youtube_notes"),enable:(0,vt.ku)()}]),[t]);(0,f.useEffect)((()=>{_o({click_from:ro.UPPER_RIGHT,button_name:go.summary})}),[]);const s=(0,f.useCallback)((()=>{const e=o.filter((e=>e.enable));return e.length<=1?(0,Le.jsx)(Le.Fragment,{}):(0,Le.jsx)(Il,{webpageTabs:e,activeKey:n,onChange:e=>{let t;e===jl.memo?t=go.note:e===jl.summary&&(t=go.summary),t&&_o({click_from:ro.UPPER_RIGHT,button_name:t}),i(e)}})}),[n,o]);return{activeTab:n,renderTab:s}})(),J=(0,f.useRef)(null),Q=N&&d&&I&&k&&!u&&Z===jl.summary;return(0,Le.jsxs)("div",{className:ie()(wo.videoSummaryAssistantContainer,{[wo.closeAssistant]:H}),ref:J,"data-testid":"video-assistant-container",style:{maxHeight:(0,Io.jB)("bilibili")?"calc(100vh - 198px)":"calc(100vh - 110px)"},children:[!H&&(0,Le.jsx)(Ae.A,{className:ie()(wo.area),show:o,optionPageSection:"video-summary",setShow:s,position:"bottomRight",disableKey:Tc.lf.videoSummary,getPopupContainer:ht.E8,onDisableOnceClick:()=>{z(!0)},children:(0,Le.jsx)("div",{className:wo.closeIcon,"data-testid":"video-assistant-close-btn",onPointerDown:()=>s(!0),children:(0,Le.jsx)(ze.gz,{className:wo.icon})})}),(0,Le.jsx)(Wo,{available:N,contentVisible:d,popContainerRef:J,isSummaryDone:!!I,renderActionBtnTabs:S?Y:void 0,isHighlightsDone:!!k,noContent:!!u,hasTranscript:!!j,isTranscriptLoaded:A,summarizeTriggered:S,hasNoSubtitles:h,hasShowedUserGuidance:m,translateLanguage:w,onTranslateLanguage:e=>{g(e),U({translateLang:e,clickFrom:ro.UPPER_RIGHT}),_o({click_from:ro.UPPER_RIGHT,button_name:go.language})},onSummarizeVideo:({clickFrom:e,translateLang:t})=>U({clickFrom:e,translateLang:t}),onClickLogin:L,trackResultEvent:F}),(0,Le.jsxs)(Be.tU,{activeKey:Z,renderTabBar:()=>null,children:[(0,Le.jsx)(Be.mF,{itemKey:jl.summary,children:(0,Le.jsx)(Ir,{available:N,hasNoSubtitles:h,hasShowedUserGuidance:m,noContent:!!u,contentVisible:d,videoSummaryId:y,onRetry:()=>U({translateLang:w,clickFrom:ro.UPPER_RIGHT}),isHighlightsDone:!!k,transcript:C,highlightsResult:T,trackResultEvent:F,trackHighlightEvent:(e,t,n,i)=>{e===_.Ur.clickVideoAssistantHighlightsTimeline&&_o({click_from:ro.UPPER_RIGHT,button_name:go.clickHighlight}),P(e,t,n,i)},videoState:O,setVideoState:q,handleUserInteract:W,userInteracting:V,isImmersionMode:n,isNotLoginBilibili:!p&&(0,Io.jB)("bilibili")})}),(0,Le.jsx)(Be.mF,{itemKey:jl.mindmap,children:(0,Le.jsx)(pl,{isActive:Z===jl.mindmap,getPopupContainer:()=>J.current,transcript_list:C,translateLanguage:w})}),(0,Le.jsx)(Be.mF,{itemKey:jl.memo,children:(0,Le.jsx)(So,{})})]}),Q&&(0,Le.jsx)(Ra,{videoTitle:t,onClickContinueInChat:R,popContainerRef:J,onCopy:()=>{_o({click_from:ro.UPPER_RIGHT,button_name:go.copy}),D()},videoId:e,currentPlayingClip:O.currentActiveBreakdownIndex,summaryResult:E,highlightResult:(0,un.Bq)(T),trackShareEvent:(e,t)=>{_o({click_from:ro.UPPER_RIGHT,button_name:go.share}),B(e,t)},transcript:C,videoSummaryId:y,videoHighlightsId:b})]})}const Xd=f.memo(Qd),eu=()=>{const{videoId:e,title:t,partId:n}=(0,cn.e)(),{isAuthenticated:i}=(0,v.Y)("authInfo")[0]||{},[o]=(0,v.Y)("videoSummaryDisableHosts"),[s]=(0,v.Y)("videoSummaryDisableAll"),a=o.includes(window.location.host)||s;return e?(0,Le.jsx)("div",{className:"cici-ext-always-light semi-always-light",children:e&&!a&&(0,Le.jsx)(Xd,{videoParamId:e,videoTitle:t},e)},`${e}${n}-${i?1:0}`):null},tu="shadow-gOHjLs",nu="card-GuZv6w",iu="card-head-AQDnFu",ou="close-btn-rblErX",su="card-image-pQ3Ueo",au="card-body-WIStjJ",ru="card-content-i5U_lT",lu="card-captain-iDr9x0",cu="title-glwrvs",du="desc-PXpfS0",uu="divider-WoV3Uh",hu="md-nOukJF",mu="card-footer-YdbKVS",pu="brand-blUqVP",gu="card-action-OrCp56",vu=({searchResult:e,query:t,content:n,onClose:i=h.A,extIconUrl:o,extName:s,t:a,onCopy:l=h.A,onDownload:c=h.A})=>{const d=(0,f.useRef)(null),u=(0,f.useMemo)((()=>{var t;return((null==e||null===(t=e.text_card)||void 0===t?void 0:t.card_list)||[]).length}),[e]),[m,p]=(0,f.useState)(""),[g,v]=(0,f.useState)(!1),_=(0,f.useRef)(null),x=function(){var e=(0,r.A)((function*(){g||(l(),_.current?yield as(_.current):yield ss(d.current),v(!0),setTimeout((()=>v(!1)),2e3))}));return function(){return e.apply(this,arguments)}}();return(0,f.useEffect)((()=>{const e=function(){var e=(0,r.A)((function*(){const e=yield os(d.current);_.current=e;const t=(null==e?void 0:e.toDataURL("image/png"))||"";p(t)}));return function(){return e.apply(this,arguments)}}(),t=setTimeout((()=>e()),500);return()=>clearTimeout(t)}),[]),(0,Le.jsxs)("div",{className:nu,children:[(0,Le.jsx)("div",{className:tu,children:(0,Le.jsxs)("div",{className:au,ref:d,children:[(0,Le.jsxs)("div",{className:ru,children:[(0,Le.jsxs)("div",{className:lu,children:[(0,Le.jsx)("div",{className:ie()(cu,"font-semibold mb-5px"),children:t}),(0,Le.jsx)("div",{className:du,children:u>0?a("flow_web_ext_search_share_pic_tips",{sourceCount:u}):a("flow_web_ext_search_share_pic_tips2")})]}),(0,Le.jsx)("div",{className:uu}),(0,Le.jsx)(_s.FH,{markDown:n,className:hu})]}),(0,Le.jsx)("div",{className:mu,children:(0,Le.jsxs)("div",{className:pu,children:[(0,Le.jsx)("img",{src:o}),(0,Le.jsxs)("div",{children:[(0,Le.jsx)("div",{className:"text-[16px] font-semibold",children:s}),(0,Le.jsx)("div",{className:"text-[12px]",children:a("flow_web_ext_search_share_pic_doubao")})]})]})})]})}),m?(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsx)("div",{className:iu,children:(0,Le.jsx)(be.o40,{onClick:i,className:ou})}),(0,Le.jsx)("img",{src:m,className:su}),(0,Le.jsxs)("div",{className:gu,children:[(0,Le.jsx)(ya.c,{type:"tertiary",icon:(0,Le.jsx)(be.sxB,{}),onClick:()=>{c(),ls(m,"search-card.png")},children:a("flow_web_ext_search_share_pic_download")}),(0,Le.jsx)(ya.c,{type:"tertiary",icon:g?(0,Le.jsx)(be.eWz,{}):(0,Le.jsx)(be.fFY,{}),onClick:x,children:a("flow_web_ext_search_share_pic_copy")})]})]}):(0,Le.jsx)(Be.tK,{spinning:!0,style:{alignSelf:"center"}})]})};var fu=n(41264);const _u="wrapper-DMqCMk",xu="mask-IMzqIW",yu=({searchId:e,query:t,shareLink:n,onClose:i})=>{const o=(0,g.B)(),s=(0,ha.P)((e=>e.messages)),{text:a="",searchCardData:r}=s[e]||{};(0,f.useEffect)((()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow=""})),[]);return(0,Le.jsxs)("div",{className:_u,children:[(0,Le.jsx)("div",{className:xu,onClick:i}),(0,Le.jsx)(vu,{content:a,searchResult:null==r?void 0:r.search_result,shareLink:n,query:t,t:o,extIconUrl:(0,Se.Nf)(),extName:(0,Se.L2)(),onClose:i,onCopy:()=>(0,et.s)("share_card_result_click",{current_page:(0,tn.M5)(location.href),content_type:"search_card",button_name:"copy"}),onDownload:()=>(0,et.s)("share_card_result_click",{current_page:(0,tn.M5)(location.href),content_type:"search_card",button_name:"download"})})]})};var bu=n(51242);const wu=()=>{(0,J.vE)("searchUsageTimesInfo",{lastUseTime:Date.now(),usageTimes:0})},Cu="searchAssistantContainer-dCwn7m",Au="header-YtilIR",Su="headerName-k4Ij57",Iu="controls-If21mO",ku="isSearchIdEmpty-XXguxl",ju="footer-KEZpq4",Eu="buttonGroup-OCyzPQ",Tu="content-DWiwJ2",Nu="content-loading-auKMT6",Mu="content-collapse-IB4d3g",Ru="content-expand-button-c1o1xs",Lu="closeIcon-SQi8TC",Pu="loginButton-QV9e95",Bu="suggest-message-list-wrapper-VsKrvI",Du="suggest-message-title-Kd6i2s",Fu="suggest-message-title-icon-_VDoIY",Uu="suggest-message-title-deep-FqjPXb",Hu="suggest-message-container-oneLine-qJavRT",zu="suggest-message-iywAli",Ou="fadeIn-dVad2K",qu=({type:e,text:t,onClick:n,getPopupContainer:i})=>"icon"===e?(0,Le.jsx)(Be.m_,{getPopupContainer:i,content:t,spacing:{y:10,x:0},children:(0,Le.jsx)(ya.c,{type:"tertiary",icon:(0,Le.jsx)(be.EGn,{}),size:"small",onClick:n})}):(0,Le.jsx)(ya.c,{type:"tertiary",icon:(0,Le.jsx)(be.EGn,{}),size:"small",onClick:n,children:t}),Vu=({message_id:e,search_id:t,search_from:n,show_from:i,from_search_id:o})=>{(0,tn.z8)(_.Ur.showDeepSearchAssistant,{search_engine_name:"google",message_id:e,search_id:t,search_from:n,show_from:i,from_search_id:o})},$u=({search_id:e,title:t,show_content_message_id:n,show_content_wordlength:i,sources_count:o,rnk:s,source_name:a,source_publishtime:r,location_pagenum:l})=>{(0,tn.z8)(_.Ur.showSources,{current_page:"search_engine",search_engine_name:"google",search_id:e,title:t,show_content_message_id:n,show_content_wordlength:i,sources_count:o,rnk:s,source_name:a,source_publishtime:r,location_pagenum:l})},Ku=({search_id:e,title:t,show_content_message_id:n,show_content_wordlength:i,sources_count:o,rnk:s,source_name:a,source_publishtime:r,location_pagenum:l})=>{(0,tn.z8)(_.Ur.showSources,{current_page:"search_engine",search_engine_name:"google",search_id:e,title:t,show_content_message_id:n,show_content_wordlength:i,sources_count:o,rnk:s,source_name:a,source_publishtime:r,location_pagenum:l})},Wu=({show_from:e})=>{(0,tn.z8)(_.Ur.showDeepSearchBtn,{current_page:"search_engine",search_engine_name:"google",show_from:e})},Gu=({search_id:e,click_from:t})=>{(0,tn.z8)(_.Ur.clickDeepSearchBtn,{current_page:"search_engine",search_engine_name:"google",search_id:e,click_from:t})},Zu=({click_from:e,message_id:t,search_id:n})=>{(0,tn.z8)(_.Ur.copy,{click_from:e,message_id:t,search_id:n,button_name:"copy"})},Yu={searchList:[],isDeepSearchMode:!1},Ju=(0,ec.vt)()((0,Xl.eh)((e=>(0,a.A)((0,a.A)({},Yu),{},{addSearch:t=>e((e=>({searchList:[...e.searchList,t]}))),replaceSearch:(t,n)=>e((e=>({searchList:e.searchList.map(((e,i)=>i===n?t:e))}))),resetSearch:t=>e((()=>({searchList:[t]}))),clearSearch:()=>e((()=>({searchList:[]}))),setDeepSearchMode:t=>e((()=>({isDeepSearchMode:t})))})))),Qu=({hasDeepSearchEntry:e,isFeatureAvailable:t,query:n,searchId:i,popContainerRef:o,syncToChat:s,onOpenShareCard:a})=>{const l=(0,g.B)(),c=(0,ha.P)((e=>e.sendMessage)),d=(0,ha.P)((e=>e.messages)),{text:u="",body:h,isDone:m}=d[i]||{},p=e&&t&&m,{searchList:v,resetSearch:f,setDeepSearchMode:x}=Ju((e=>({searchList:e.searchList,resetSearch:e.resetSearch,setDeepSearchMode:e.setDeepSearchMode}))),{CollectionIcon:y,onCollectionClick:b,collected:w}=_a({getCollectionParam:()=>{var e;return{collectFrom:pt.vP.search_result_card,collectionType:mt.X.SearchResult,messageId:null==h||null===(e=h.message)||void 0===e?void 0:e.message_id,localMessageId:i,userInput:n}}}),{onCopyClick:C,onMouseEnter:A,onMouseLeave:S,checked:I}=fa((()=>{var e;es()(u),(({message_id:e})=>{(0,nn.ct)({message_id:e,click_from:_.Z5.searchAssistant})})({message_id:null==h||null===(e=h.message)||void 0===e?void 0:e.message_id})})),k=I?be.eWz:be.fFY,j=function(){var e=(0,r.A)((function*(){var e;null!==(e=(0,J.TK)("authInfo"))&&void 0!==e&&e.isAuthenticated?(wu(),Gd.on.getState().setFloatingCardVisible(!1),Gd.on.getState().setSummaryActionVisible(!1),dn.l.getState().setIsShowSidebar(!0,_.cz.searchAssistant),yield(0,Yd.Z)(),yield s()):(0,Ce.DT)({trackMeta:{previous_page:"search_engine",login_entrance:"search_result_card"}})}));return function(){return e.apply(this,arguments)}}();return(0,Le.jsxs)("div",{className:ju,children:[(0,Le.jsx)("div",{className:Eu,children:p?(0,Le.jsx)(ya.c,{type:"ai-primary",icon:(0,Le.jsx)(be.zSs,{}),size:"small",onClick:()=>{if(wu(),!v.length){const e=(0,No.wz)((0,J.TK)("uiLanguage")),t={skill_id:"8",skill_type:8},i=c({text:n,prompt:ml.EU.input_skill,answerWithSuggest:!0,current_page:"search_engine",scene:"search_engine",sec_scene:"deep_search_mode",input_skill:JSON.stringify(t),replyLang:e});f({searchId:i,searchQuery:n})}x(!0),Gu({search_id:i,click_from:"search_result_card"})},"data-testid":"search-assistant-deep-btn",children:l("flow_web_ext_search_deepinsearch")}):(0,Le.jsx)(qu,{getPopupContainer:()=>o.current,type:"normal",text:l("flow_web_ext_action_translate_chat"),onClick:j})}),(0,Le.jsxs)("div",{className:Eu,children:[p&&(0,Le.jsx)(qu,{getPopupContainer:()=>o.current,type:"icon",text:l("flow_web_ext_action_translate_chat"),onClick:j}),(0,Le.jsx)(Na,{text:u,style:{fontSize:16},getPopupContainer:()=>o.current}),(0,Le.jsx)(Be.m_,{content:l("flow_web_ext_search_share"),getPopupContainer:()=>o.current,spacing:{y:10,x:0},children:(0,Le.jsx)(ya.c,{type:"tertiary",icon:(0,Le.jsx)(be.d0m,{}),size:"small",onClick:()=>{a(),wu()}})}),(0,vt.ku)()&&(0,Le.jsx)(Be.m_,{content:l(w?"bookmarks_list_remove_hover":"flow_web_ext_action_bookmarks"),getPopupContainer:()=>o.current,spacing:{y:10,x:0},children:(0,Le.jsx)(ya.c,{type:"tertiary",icon:(0,Le.jsx)(y,{}),size:"small",onClick:()=>{b(),wu()}})}),(0,Le.jsx)(Be.m_,{content:l("message_long_press_copy"),getPopupContainer:()=>o.current,spacing:{y:10,x:0},children:(0,Le.jsx)(ya.c,{type:"tertiary",icon:(0,Le.jsx)(k,{}),size:"small",onMouseEnter:A,onMouseLeave:S,onClick:()=>{C(),wu()},"data-testid":"search-assistant-copy-btn"})})]})]})};var Xu=n(60143),eh=n(72186);const th={"card-list":"card-list-T40dCM",cardList:"card-list-T40dCM","carousel-item":"carousel-item-fmD69A",carouselItem:"carousel-item-fmD69A","carousel-arrow-left":"carousel-arrow-left-qE_12K",carouselArrowLeft:"carousel-arrow-left-qE_12K","carousel-arrow-right":"carousel-arrow-right-NfduEb",carouselArrowRight:"carousel-arrow-right-NfduEb","s-card":"s-card-Ry_oF_",sCard:"s-card-Ry_oF_","s-card-content":"s-card-content-EmaR4e",sCardContent:"s-card-content-EmaR4e","s-card-content-header":"s-card-content-header-X5hOTw",sCardContentHeader:"s-card-content-header-X5hOTw","s-card-content-header-title":"s-card-content-header-title-Dtywnn",sCardContentHeaderTitle:"s-card-content-header-title-Dtywnn","s-card-content-header-image":"s-card-content-header-image-iO_N5N",sCardContentHeaderImage:"s-card-content-header-image-iO_N5N","s-card-content-footer":"s-card-content-footer-igTo1M",sCardContentFooter:"s-card-content-footer-igTo1M","s-card-content-footer-icon":"s-card-content-footer-icon-hEdS21",sCardContentFooterIcon:"s-card-content-footer-icon-hEdS21","s-card-content-footer-site-name":"s-card-content-footer-site-name-oTEVSY",sCardContentFooterSiteName:"s-card-content-footer-site-name-oTEVSY","s-card-content-footer-card-index":"s-card-content-footer-card-index-tVOMLm",sCardContentFooterCardIndex:"s-card-content-footer-card-index-tVOMLm"},nh=e=>{const{source:t,className:n,index:i}=e;return(0,Le.jsx)("a",{className:ie()(n,th["s-card"]),href:t.url,target:"_blank",rel:"noreferrer noopener",onClick:()=>{},children:(0,Le.jsxs)("div",{className:th["s-card-content"],children:[(0,Le.jsxs)("div",{className:th["s-card-content-header"],children:[(0,Le.jsx)("div",{className:th["s-card-content-header-title"],children:t.title}),t.image_url?(0,Le.jsx)("img",{className:th["s-card-content-header-image"],src:t.image_url}):null]}),(0,Le.jsxs)("div",{className:th["s-card-content-footer"],children:[t.logo_url?(0,Le.jsx)("img",{className:th["s-card-content-footer-icon"],src:t.logo_url}):(0,Le.jsx)(be.gXP,{className:ie()(th["search-source-shortcuts-img-icon"],"!ml-0 text-12 text-gray-500 bg-[rgba(0,0,0,0.05)] flex justify-center items-center")}),(0,Le.jsx)("span",{className:th["s-card-content-footer-site-name"],children:`${t.site_name}`}),(0,Le.jsx)("div",{className:th["s-card-content-footer-card-index"],children:i})]})]})})},ih=({sources:e=[]})=>(0,Le.jsx)("div",{className:th["card-list"],children:(0,Le.jsx)(eh.F,{rows:1,scrollStep:.9,itemClassName:th["carousel-item"],leftArrowClassName:th["carousel-arrow-left"],rightArrowClassName:th["carousel-arrow-right"],children:e.map(((e,t)=>(0,Le.jsx)(nh,{source:e,index:t+1},t)))})}),oh="step-container-j3lpCB",sh="step-head-JUpUMG",ah="clickable-Cqyhd0",rh="left-iLZ7Z1",lh="prefix-OsiZ7n",ch="children-a0klQZ",dh=e=>{const{className:t,children:n,title:i,right:o,onClick:s}=e;return(0,Le.jsxs)("div",{className:ie()(oh,t),children:[(0,Le.jsxs)("div",{className:ie()(sh,{[ah]:Boolean(s)}),onClick:s,children:[(0,Le.jsxs)("div",{className:rh,children:[(0,Le.jsx)("span",{className:lh,children:(0,Le.jsx)(be.WsO,{})}),(0,Le.jsx)("span",{children:i})]}),o]}),n?(0,Le.jsx)("div",{className:ch,children:n}):null]})},uh=e=>(0,Le.jsx)("svg",(0,a.A)((0,a.A)({xmlns:"http://www.w3.org/2000/svg",width:12,height:12,fill:"none",viewBox:"0 0 12 12"},e),{},{children:(0,Le.jsx)("path",{fill:"#000",fillOpacity:.3,d:"M6.262 4.477q.315.066.547.187.234.12.394.285.492.488.656 1.082.165.59 0 1.184-.163.59-.652 1.078L5.832 9.668a2.43 2.43 0 0 1-1.074.648q-.59.165-1.184 0-.59-.16-1.082-.656a2.43 2.43 0 0 1-.656-1.082q-.165-.594 0-1.183t.652-1.079L3.59 5.223q-.066.254-.035.53.03.274.132.509l-.597.597a1.63 1.63 0 0 0-.434.711q-.105.387.004.778.11.39.434.714.32.325.71.43.391.106.778-.004.387-.105.711-.425L6.605 7.75q.325-.321.43-.707.106-.39-.004-.781a1.6 1.6 0 0 0-.43-.715 1.4 1.4 0 0 0-.417-.274 1.9 1.9 0 0 0-.57-.144zm-.528 3.347a2 2 0 0 1-.55-.18 1.6 1.6 0 0 1-.391-.289 2.46 2.46 0 0 1-.656-1.082q-.165-.593 0-1.183t.652-1.078L6.16 2.64a2.44 2.44 0 0 1 1.078-.653q.59-.165 1.18 0 .595.16 1.09.657.488.492.652 1.085.165.59 0 1.18-.164.59-.648 1.074L8.406 7.082q.067-.255.035-.527a1.8 1.8 0 0 0-.132-.512l.597-.598q.324-.32.43-.707.105-.39-.004-.777a1.6 1.6 0 0 0-.43-.715 1.6 1.6 0 0 0-.71-.43 1.4 1.4 0 0 0-.778 0q-.387.106-.71.426L5.39 4.555a1.63 1.63 0 0 0-.434.71q-.105.387.004.778.109.387.434.715.17.168.418.277.246.105.57.137z"})})),hh="shortcuts-ZSaYXt",mh="site-image-Y33_kY",ph="ready-o34Fme",gh="site-image-border-KiLGCO",vh="site-image-icon-AD17An",fh=({url:e="",zIndex:t})=>{const[n,i]=(0,f.useState)(!1);return(0,f.useEffect)((()=>{const t=new Image;t.src=e,t.onload=()=>i(!0)}),[]),(0,Le.jsxs)("span",{className:ie()(mh,{[ph]:n}),style:{zIndex:t},children:[n?(0,Le.jsx)("img",{src:e}):(0,Le.jsx)(uh,{className:vh}),(0,Le.jsx)("span",{className:gh})]})},_h=({sources:e=[]})=>{const t=(0,f.useMemo)((()=>e.filter((e=>e.logo_url&&e.site_name)).map((e=>e.logo_url)).slice(0,8)),[e]);return(0,Le.jsx)("span",{className:hh,children:t.map(((e,n)=>(0,Le.jsx)(fh,{url:e,zIndex:t.length-n},n)))})},xh="brief-iN2H4J",yh="brief-prefix-zLwYwZ",bh="brief-prefix-icon-mKz7is",wh="brief-prefix-title-CRd8nT",Ch=e=>{const t=(0,g.B)(),{onClick:n,sources:i=[]}=e,o=t("flow_web_ext_search_deepinsearch_title",{number:i.length});return(0,Le.jsxs)("div",{onClick:n,className:xh,children:[(0,Le.jsxs)("span",{className:yh,children:[(0,Le.jsx)("span",{className:ie()(bh),children:(0,Le.jsx)(be.zSs,{})}),(0,Le.jsx)("span",{className:wh,children:o})]}),(0,Le.jsx)(_h,{sources:i})]})},Ah="tag-item-list-nfsCTL",Sh="tag-item-zUvqBC",Ih=e=>{const{style:t,queryParams:n={}}=e,i=(0,f.useMemo)((()=>{const{text_card:e,video_card:t}=n,i=[...(e||[]).map((e=>e.query)),...(t||[]).map((e=>e.query))].filter((e=>Boolean(e)));return[...new Set(i)]}),[n]);return(0,Le.jsx)("div",{className:Ah,style:t,children:i.map(((e,t)=>(0,Le.jsx)("span",{className:Sh,children:e},t)))})},kh="container-U4dRxy",jh="expanded-QjCzuN",Eh="search-children-oCTSPv",Th="search-children-visible-FcM1_h",Nh="search-children-display-k8XR1y",Mh=({searchId:e="",style:t={},query:n=""})=>{const{searchCardData:i,text:o,isError:s,isAborted:r}=(0,ha.P)((t=>t.messages[e]||{})),{expanded:l,childrenDisplay:c,transStyle:d,containerRef:u,handleExpand:h,handleClose:m,onTransitionEnd:p}=(()=>{const[e,t]=(0,f.useState)(!1),[n,i]=(0,f.useState)(!1),[o,s]=(0,f.useState)(0),r=(0,f.useRef)(null),[l,c]=(0,f.useState)({width:"fit-content",height:"44px"});return(0,f.useEffect)((()=>{if(!e&&0===o&&r.current){const e=new ResizeObserver((()=>{r.current&&s(r.current.scrollWidth)}));return e.observe(r.current),()=>{e.disconnect()}}}),[e,r.current]),{expanded:e,childrenDisplay:n,transStyle:l,containerRef:r,handleExpand:()=>{i(!0),t(!0),setTimeout((()=>{c((()=>{var e;return{width:"100%",height:`${null===(e=r.current)||void 0===e?void 0:e.scrollHeight}px`}}))}),0)},handleClose:()=>{t(!1),c({width:`${o}px`,height:"44px"})},onTransitionEnd:()=>{e||(i(!1),c((e=>(0,a.A)((0,a.A)({},e),{},{width:"fit-content"}))))}}})(),{search_result:v,query_params:_}=i||{},x=!o&&!i,{sources:y}=(0,f.useMemo)((()=>{var e;const t=(null==v||null===(e=v.text_card)||void 0===e?void 0:e.card_list)||[];return{sources:null==t?void 0:t.map((e=>({title:e.title,url:e.url,logo_url:e.logo_url,site_name:e.sitename,image_url:e.image_url})))}}),[v]),b=(0,g.B)();return s||r?null:x?(0,Le.jsx)(Xu.c_,{text:n,t:b}):(0,Le.jsx)("div",{ref:u,className:ie()(kh,{[jh]:l}),onTransitionEnd:p,style:(0,a.A)((0,a.A)({},d),t),children:(0,Le.jsxs)(Le.Fragment,{children:[l?(0,Le.jsx)(dh,{title:b("flow_web_ext_search_deepinsearch_understand"),right:(0,Le.jsx)(be.HXh,{}),onClick:m}):(0,Le.jsx)(Ch,{onClick:()=>(null==y?void 0:y.length)>0&&h(),sources:y}),(0,Le.jsxs)("div",{className:ie()(Eh,{[Th]:l,[Nh]:c}),children:[(0,Le.jsx)(dh,{title:b("flow_web_ext_search_deepinsearch_search"),children:(0,Le.jsx)(Ih,{queryParams:_,style:{marginBottom:-4,paddingLeft:28}})}),(0,Le.jsx)(dh,{title:b("flow_web_ext_search_deepinsearch_soure",{number:y.length}),children:(0,Le.jsx)(ih,{sources:y})}),(0,Le.jsx)(dh,{title:b("flow_web_ext_search_deepinsearch_answer")})]})]})})},Rh=({suggestMessageListWithStatus:e,className:t,onClick:n,fullMode:i=!1})=>{const{failed:o,suggests:s=[],isRegen:a}=e||{},r=(0,g.B)(),l=(e,t)=>{n(e,t)};return o||!s.length?null:(0,Le.jsxs)("div",{className:ie()(Bu,t),children:[(0,Le.jsxs)("div",{className:ie()(Du,{[Uu]:i}),children:[i?(0,Le.jsx)(ze.oE,{className:Fu}):(0,Le.jsx)(be.k4K,{className:Fu}),(0,Le.jsx)("div",{children:r("flow_web_ext_search_ask_more",{brand:(0,Se.L2)()})})]}),i?(0,Le.jsx)("div",{className:ie()(Hu),children:s.map(((e,t)=>(0,Le.jsxs)("div",{className:ie()(zu,{[Ou]:!a}),onClick:()=>l(e,t),children:[(0,Le.jsx)("span",{style:{marginRight:8,fontSize:i?"14px":"12px"},children:e}),(0,Le.jsx)(ze.n4,{})]},t)))}):(0,Le.jsx)(Le.Fragment,{children:s.map(((e,t)=>(0,Le.jsxs)("div",{className:ie()(zu,{[Ou]:!a}),onClick:()=>l(e,t),children:[(0,Le.jsx)("span",{style:{marginRight:8,fontSize:i?"14px":"12px"},children:e}),(0,Le.jsx)(ze.n4,{})]},t)))})]})},Lh="expandSummaryButton-wchrB9",Ph=({onClick:e,getPopupContainer:t})=>{var n;const i=null===(n=(0,f.useContext)(fu.mn))||void 0===n?void 0:n.engine,o=(0,g.B)(),s=(0,f.useRef)(null),[a,r]=(0,f.useState)(!1);return(0,Le.jsx)(Be.m_,{getPopupContainer:t,content:o("flow_web_ext_search_btn_start"),trigger:"custom",visible:a,spacing:{y:12,x:0},children:(0,Le.jsx)(ya.c,{onMouseEnter:()=>{var e;const t=null===(e=s.current)||void 0===e?void 0:e.parentElement;t&&(t.clientWidth<t.scrollWidth?r(!0):r(!1))},onMouseLeave:()=>{r(!1)},type:"ai-primary",icon:(0,Le.jsx)(be.k4K,{}),size:"medium",onClick:()=>{wu(),e(),on({search_engine_name:null==i?void 0:i.name,result_type:"summary",show_type:"full_content_manual"}),ln({search_engine_name:null==i?void 0:i.name,button_name:"start_ai_search",whether_full_screen:0})},className:Lh,"data-testid":"search-assistant-start-btn",children:(0,Le.jsx)("span",{ref:s,children:o("flow_web_ext_search_btn_start")})})})},Bh="spacing-KduYLV",Dh="link-JieA9Q",Fh="linkIcon-_nuf2A",Uh="text-Nef5ie",Hh=({href:e=""})=>{const t=(0,f.useMemo)((()=>{try{return new URL(e).hostname.replace(/^www\./,"")}catch(t){return""}}),[e]);return t?(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsx)("span",{className:Bh}),(0,Le.jsxs)("a",{href:e,target:"_blank",className:Dh,children:[(0,Le.jsx)(be.Dkt,{className:Fh}),(0,Le.jsx)("span",{className:Uh,children:t})]})]}):null};var zh=n(62962),Oh=n(37524);const qh=({isFeatureAvailable:e,hasDeepSearchEntry:t,enableWebAISearchCard:n,popContainerRef:i,searchId:o,query:s,handleSearch:a,isContentCollapse:l,setIsContentCollapse:c,onOpenShareCard:d})=>{const[u,h]=(0,f.useState)(!1),[m,p]=(0,f.useState)(!1),g=(0,f.useRef)(null),v=(0,ha.P)((e=>e.messages)),{isDeepSearchMode:x}=Ju((e=>({isDeepSearchMode:e.isDeepSearchMode}))),{insertedElements:y}=(e=>{var t;const n=(null==e||null===(t=e.body)||void 0===t||null===(t=t.message)||void 0===t?void 0:t.meta_infos)||[],i=(null==e?void 0:e.id)||"",o=(0,f.useRef)({id:null==e?void 0:e.id,links:[]}),s=(0,f.useMemo)((()=>{i!==o.current.id&&(o.current.id=i,o.current.links=[]);const{links:e}=o.current;return n.forEach((t=>{if(-1===t.type){const n=(0,N.O)(t.info,{});null!=n&&n.url&&!e.find((e=>e.position===n.position))&&e.push(n)}})),o.current.links=e,e.map((e=>({range:e.position,render:()=>(0,Le.jsx)(Hh,{href:e.url})})))}),[i,n]);return{insertedElements:s}})(x?void 0:v[o]),{isDone:b,isError:w,isAborted:C,text:A="",suggests:S=[],body:I}=v[o]||{},k=!(A||w||b||C),j=function(){var e=(0,r.A)((function*(){var e,t,n,i,o,s;if((({message_id:e})=>{(0,nn.Kp)({message_id:e,click_from:_.Z5.searchAssistant})})({message_id:null!==(e=null==I||null===(t=I.message)||void 0===t?void 0:t.message_id)&&void 0!==e?e:""}),u)return;h(!0);const a={messageIds:[null!==(n=null==I||null===(i=I.message)||void 0===i?void 0:i.reply_id)&&void 0!==n?n:"",null!==(o=null==I||null===(s=I.message)||void 0===s?void 0:s.message_id)&&void 0!==o?o:""]};yield(0,Zd.ci)(a)}));return function(){return e.apply(this,arguments)}}(),E=function(){var e=(0,r.A)((function*(e,t){var n,i;if(wu(),rn({click_position:`${t+1}`,message_id:null==I||null===(n=I.message)||void 0===n?void 0:n.message_id}),null===(i=(0,J.TK)("authInfo"))||void 0===i||!i.isAuthenticated)return void(0,Ce.DT)({trackMeta:{previous_page:"search_engine",login_entrance:"search_result_card"}});Gd.on.getState().setFloatingCardVisible(!1),Gd.on.getState().setSummaryActionVisible(!1),dn.l.getState().setIsShowSidebar(!0,_.cz.searchAssistant),yield(0,Yd.Z)(),yield j();const{convId:o,convType:s,mainBotId:a}=(0,Oh.IK)(),r={text:e,scene:kr.sJ.search_related_suggested_prompt,extraExt:{need_create_thread:s===bu.H.NewThread?"1":"0",browser_language:(0,No.wz)((0,J.TK)("uiLanguage"))},ctx:(0,Zd.Pe)(s,o,a)};yield(0,Yd.Z)(),yield(0,Zd.Bc)(s,r)}));return function(t,n){return e.apply(this,arguments)}}();return(0,f.useEffect)((()=>{if(!g.current||!l)return;const{height:e}=g.current.getBoundingClientRect();e>=260&&p(!0)}),[v]),(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsxs)("div",{className:ie()(Tu,{[Nu]:k,[Mu]:l}),ref:g,children:[n&&(0,Le.jsx)(Mh,{searchId:o,style:{marginBottom:12},query:s}),(0,Le.jsx)(Sr,{id:o,onRetry:()=>{var e;a(),(({message_id:e})=>{(0,nn.hc)({message_id:e,click_from:_.Z5.searchAssistant})})({message_id:null==I||null===(e=I.message)||void 0===e?void 0:e.message_id})},type:"search",loadingSlot:n?null:void 0,MDBoxProps:{insertedElements:y}}),(0,Le.jsx)(Rh,{suggestMessageListWithStatus:{isRegen:!1,loading:!1,suggests:S.filter((e=>e)),failed:!1},onClick:E}),(0,zh.s)()&&(0,Le.jsx)("textarea",{style:{visibility:"hidden",position:"absolute"},"data-testid":"search-assistant-copy-result",value:A}),l&&m&&(0,Le.jsx)("div",{className:Ru,children:(0,Le.jsx)(Ph,{getPopupContainer:()=>i.current,onClick:()=>{c(!1)}})})]}),b&&!l&&(0,Le.jsx)(Qu,{popContainerRef:i,isFeatureAvailable:e,hasDeepSearchEntry:t,query:s,searchId:o,syncToChat:j,onOpenShareCard:d})]})},Vh=({provider:e,popContainerRef:t,activeKey:n,query:i})=>{const o=(0,g.B)();return(0,Le.jsx)(hl,{t:o,isActive:"mindmap"===n,getPopupContainer:()=>t.current,onFirstShow:()=>{on({search_engine_name:null==e?void 0:e.name,result_type:"mind_map",show_type:"full_content_manual"})},onCopy:t=>{ln({search_engine_name:null==e?void 0:e.name,button_name:"copy",whether_full_screen:t?1:0})},onDownload:t=>{ln({search_engine_name:null==e?void 0:e.name,button_name:"download",whether_full_screen:t?1:0})},onEnterFullcreen:()=>{ln({search_engine_name:null==e?void 0:e.name,button_name:"full_screen"})},getSendMessageParams:()=>({text:i,answerWithSuggest:!1,current_page:"search_engine",scene:"search_engine",replyLang:(0,No.wz)((0,J.TK)("uiLanguage")),prompt:ml.EU.browser_plugin_info,browser_plugin_info:JSON.stringify({skill_name:"search_mindnote",frontend_source:"plugin"})})})},$h="container-hMHPJo",Kh="btn-jV7wPW",Wh="iconBtn-vhHKne",Gh="active-z2xEVk",Zh=(0,l.jco)(),Yh=({setActiveKey:e,activeKey:t,getPopupContainer:n})=>{var i;const o=null===(i=(0,f.useContext)(fu.mn))||void 0===i?void 0:i.engine,s=(0,g.B)(),a=(0,f.useRef)(null),[r,l]=(0,f.useState)(!1),[c]=(0,v.Y)("uiLanguage"),d=[{key:"summary",content:s("flow_web_ext_search_summary"),icon:(0,Le.jsx)(be.K4,{})},{key:"mindmap",content:s("flow_web_ext_search_mindmap"),icon:(0,Le.jsx)(be.Gq1,{})}];(0,f.useEffect)((()=>{var e;if(!a.current)return;const t=null===(e=a.current.parentElement)||void 0===e?void 0:e.parentElement;if(!t)return;const n=a.current.getBoundingClientRect(),i=t.getBoundingClientRect();n.right>i.right?l(!0):l(!1)}),[c]);const u=t=>{wu(),ln({search_engine_name:null==o?void 0:o.name,button_name:"switch_result_type"}),e(t)};return(0,Le.jsx)("div",{className:$h,ref:a,children:d.map((e=>r?(0,Le.jsx)(Be.m_,{content:Zh?void 0:e.content,getPopupContainer:n,spacing:{y:12,x:0},children:(0,Le.jsx)("button",{className:ie()(Wh,{[Gh]:t===e.key}),onClick:()=>u(e.key),"data-testid":`search-assistant-tab-${e.key}`,children:e.icon},e.key)}):(0,Le.jsx)("button",{className:ie()(Kh,{[Gh]:t===e.key}),onClick:()=>u(e.key),"data-testid":`search-assistant-tab-${e.key}`,children:e.content},e.key)))})},{Text:Jh}=Be.Typography,Qh=({searchId:e,isFeatureAvailable:t,popContainerRef:n,activeKey:i,setActiveKey:o,setIsContentCollapse:s,handleSearch:a,isSearchIdReady:r})=>{const l=(0,g.B)(),c=(0,kl.A)("search_assistant");return(0,Le.jsxs)("div",{className:ie()(Iu,{[ku]:!e}),children:[!t&&(0,Le.jsx)(Be.$n,{theme:"solid",size:"small",className:Pu,icon:(0,Le.jsx)(ze.oE,{}),onClick:()=>{(0,Ce.DT)({trackMeta:{previous_page:"search_engine",login_entrance:"search_result_card"}})},type:"primary",children:(0,Le.jsx)(Jh,{ellipsis:{showTooltip:{opts:{getPopupContainer:()=>n.current}}},style:{maxWidth:125},size:"small",children:l("flow_web_ext_search_login",{brand:(0,Se.L2)()})})}),t&&e&&c.mindmap_show&&(0,Le.jsx)(Yh,{activeKey:i,setActiveKey:o,getPopupContainer:()=>n.current}),t&&r&&!e&&(0,Le.jsx)(Ph,{getPopupContainer:()=>n.current,onClick:()=>{s(!1),a()}})]})},Xh=({provider:e,activeKey:t,searchId:n,isFeatureAvailable:i,hasDeepSearchEntry:o,isContentCollapse:s,isSearchIdReady:a})=>{const r=(0,f.useRef)(0),l=(0,ha.P)((e=>e.messages)),{isDone:c,suggests:d=[],body:u}=l[n]||{};(0,f.useEffect)((()=>{if(!a)return;let i="half_content";s||(i=n?"full_content_auto":"no_content"),on({search_engine_name:null==e?void 0:e.name,result_type:"summary"===t?"summary":"mind_map",show_type:i})}),[a]),(0,f.useEffect)((()=>{if(c){var t;sn({prompt_cnt:d.length,message_id:null==u||null===(t=u.message)||void 0===t?void 0:t.message_id,search_engine_name:null==e?void 0:e.name});o&&i&&c&&Wu({show_from:"search_result_card"})}}),[c]),(0,f.useEffect)((()=>{if(d.length&&d.length>r.current){for(let n=r.current;n<d.length;n++){var t;an({prompt_position:`${n+1}`,message_id:null==u||null===(t=u.message)||void 0===t?void 0:t.message_id,search_engine_name:null==e?void 0:e.name})}r.current=d.length}}),[d]),(0,f.useEffect)((()=>{i&&c&&(0,vt.ku)()&&(0,pt.ae)(pt.vP.search_result_card,pt.p6.searchresult)}),[i,c])},em=({enableWebAISearchCard:e,query:t,searchCardAutoSummary:n})=>{const[i,o]=(0,f.useState)(""),[s,r]=(0,f.useState)(!1),l=(0,ha.P)((e=>e.sendMessage)),c=(0,ha.P)((e=>e.messages)),{isUnAuthorized:d}=c[i]||{},u=(0,kl.A)("search_assistant"),[h]=(0,v.Y)("searchUsageTimesInfo"),m=(0,Dl.vh)((0,Dl.OB)(ml.EU.search),d),p=(n={})=>{const i={text:t,answerWithSuggest:!0,current_page:"search_engine",scene:"search_engine"},s=e?{prompt:ml.EU.input_skill,input_skill:JSON.stringify({skill_id:"4",skill_type:4})}:{prompt:ml.EU.browser_plugin_info,browser_plugin_info:'{"skill_name":"search"}'},r=(0,No.wz)((0,J.TK)("uiLanguage")),c=l((0,a.A)((0,a.A)((0,a.A)((0,a.A)({},i),n),s),{},{replyLang:r}));o(c)},{clearSearch:g,setDeepSearchMode:_}=Ju((e=>({clearSearch:e.clearSearch,setDeepSearchMode:e.setDeepSearchMode})));return(0,f.useEffect)((()=>{m&&t&&((n||(()=>{const e=(0,J.TK)("searchUsageTimesInfo"),t=(0,J.tl)("search_assistant");if(!e.usageTimes&&!e.lastUseTime)return!e.haflContentShowCount||e.haflContentShowCount<t.max_half_content_show_count;if(e.usageTimes&&e.usageTimes>=t.max_search_auto_summary_count)return!1;const n=Date.now();return!(e.lastUseTime&&n-e.lastUseTime>=t.max_search_auto_summary_time)})())&&((0,Dl.BB)({action:"web_search",triggerLogin:!1}),g(),_(!1),p(),h.lastUseTime||h.usageTimes?(0,J.vE)("searchUsageTimesInfo",{lastUseTime:h.lastUseTime||Date.now(),usageTimes:h.usageTimes?Math.min(h.usageTimes,u.max_search_auto_summary_count)+1:1}):(0,J.vE)("searchUsageTimesInfo",{haflContentShowCount:h.haflContentShowCount?h.haflContentShowCount+1:1}),ue.vF.persist.log({message:"[search - ui-creation] component mounted"})),r(!0))}),[m,t,n]),{searchId:i,handleSearch:p,isFeatureAvailable:m,isSearchIdReady:s}},tm="autoSummaryTips-BYtjtA",nm="content-OztiZ5",im="tips-hrtxDb",om="text-Xg7cNo",sm=({getPopupContainer:e})=>{const[t,n]=(0,f.useState)(!0),i=(0,g.B)(),{isDeepSearchMode:o}=Ju((e=>({isDeepSearchMode:e.isDeepSearchMode}))),s=(0,f.useRef)(null);return(0,Le.jsx)(Le.Fragment,{children:t&&!o&&(0,Le.jsx)("div",{className:ie()(tm,"cici-ext-always-light","semi-always-light"),children:(0,Le.jsxs)("div",{className:nm,children:[(0,Le.jsxs)("div",{className:im,children:[(0,Le.jsx)("span",{ref:s,className:om,children:i("flow_web_ext_search_tips")}),(0,Le.jsx)(Be.m_,{getPopupContainer:e,content:i("flow_web_ext_search_tips_hover"),spacing:{y:12,x:0},children:(0,Le.jsx)("span",{style:{display:"flex"},children:(0,Le.jsx)(be.oBA,{})})})]}),(0,Le.jsx)(be.abE,{onClick:()=>n(!1)})]})})})},am=e=>{if(!e)return"";let t;const n=document.querySelector(e.inputQuery[0]);if(n&&(t=n.value),!t){t=new URL(location.href).searchParams.get(e.searchParam)||""}return t};function rm({hasDeepSearchEntry:e,enableWebAISearchCard:t}){var n;const i=(0,g.B)(),[o,s]=(0,f.useState)(""),[r,l]=(0,f.useState)(!1),[c,d]=(0,f.useState)("summary"),u=(0,dn.l)((e=>e.setIsShowSearch)),{value:h}=(0,en.Tu)(en.FM.searchCardAutoSummary,!0),m=(0,kl.A)("search_assistant"),[p]=(0,v.Y)("searchUsageTimesInfo"),[_,x]=(0,f.useState)(!p.lastUseTime&&!p.usageTimes&&(!p.haflContentShowCount||p.haflContentShowCount<m.max_half_content_show_count)),{searchId:y,handleSearch:b,isFeatureAvailable:w,isSearchIdReady:C}=em({enableWebAISearchCard:t,query:o,searchCardAutoSummary:Boolean(h)}),A=(0,ha.P)((e=>e.messages)),{isDone:S}=A[y]||{},{shareCardVisible:I,onCloseShareCard:k,onOpenShareCard:j}=(e=>{var t;const[n,i]=(0,f.useState)(!1),o=null===(t=(0,f.useContext)(fu.mn))||void 0===t?void 0:t.engine;return{shareCardVisible:n,onCloseShareCard:()=>{i(!1)},onOpenShareCard:()=>{ln({search_engine_name:null==o?void 0:o.name,button_name:"share",whether_full_screen:0}),i(!0)}}})(),E=null===(n=(0,f.useContext)(fu.mn))||void 0===n?void 0:n.engine;Xh({provider:E,activeKey:c,searchId:y,isFeatureAvailable:w,hasDeepSearchEntry:e,isContentCollapse:!h&&_,isSearchIdReady:C});const{isDeepSearchMode:T}=Ju((e=>({isDeepSearchMode:e.isDeepSearchMode})));(0,f.useEffect)((()=>{const e=am(E);e&&s(e)}),[]);const N=(0,f.useRef)(null),M=(null==E?void 0:E.containerStyle)||{};return(0,Le.jsxs)("div",{style:(0,a.A)({marginBottom:"24px",display:"flex",flexDirection:"column-reverse"},M),children:[!h&&!_&&S&&(0,Le.jsx)(sm,{getPopupContainer:()=>N.current}),(0,Le.jsxs)("div",{"data-testid":"search-assistant-container",className:ie()(Cu,"cici-ext-always-light","semi-always-light"),style:{display:T?"none":"block"},onMouseLeave:()=>l(!1),ref:N,children:[(0,Le.jsx)(Ae.A,{className:Lu,show:r,optionPageSection:"search-engin-summary",disableKey:Tc.lf.searchAssistant,onDisableOnceClick:()=>u(!1),setShow:l,cssStyle:{zIndex:100}}),(0,Le.jsxs)("div",{className:Au,children:[(0,Le.jsx)(Ko.A,{size:"large",disable:!0,bransNameVisible:!1,style:{maxWidth:"calc(100% - 54px)"},children:(0,Le.jsx)("span",{className:Su,children:i("flow_web_ext_search_summarytitle1",{brandName:(0,Se.L2)()})})}),(0,Le.jsx)(Qh,{searchId:y,isFeatureAvailable:w,popContainerRef:N,activeKey:c,setActiveKey:d,setIsContentCollapse:x,handleSearch:b,isSearchIdReady:C})]}),w&&y&&(0,Le.jsxs)(Be.tU,{activeKey:c,renderTabBar:()=>null,children:[(0,Le.jsx)(Be.mF,{itemKey:"summary","data-testid":"search-assistant-content-summary",children:(0,Le.jsx)(qh,{isFeatureAvailable:w,hasDeepSearchEntry:e,enableWebAISearchCard:t,popContainerRef:N,searchId:y,query:o,handleSearch:b,isContentCollapse:!h&&_,setIsContentCollapse:x,onOpenShareCard:j})}),m.mindmap_show&&(0,Le.jsx)(Be.mF,{itemKey:"mindmap","data-testid":"search-assistant-content-mindmap",children:(0,Le.jsx)(Vh,{provider:E,popContainerRef:N,activeKey:c,query:o})})]}),I&&(0,Le.jsx)(yu,{onClose:k,searchId:y,query:o})]})]})}let lm=function(e){return e.default="default",e.loading="loading",e.done="done",e.commonFailed="commonFailed",e.exceedSizeFailed="exceedSizeFailed",e}({});const cm=e=>{const t=(0,g.B)(),{buttonState:n,handleClick:i}=e,o=(0,f.useRef)(null);(0,f.useEffect)((()=>{o.current&&(n===lm.loading?o.current.classList.add("loading"):o.current.classList.remove("loading"))}),[n]);const s=(0,f.useMemo)((()=>{const e={display:"flex",alignItems:"center",gap:"3px",border:"none",borderRadius:"16px",padding:"5px 10px 5px 8px",boxShadow:"0px 2px 12px 0px rgba(255, 255, 255, 0.25) inset",fontSize:"12px",lineHeight:"18px",fontWeight:500,cursor:"pointer",position:"relative"};return{[lm.default]:(0,a.A)((0,a.A)({},e),{},{background:"radial-gradient(78.87% 125% at 21.13% 50%, #0057FF 0%, #5A91FC 81.94%)",color:"var(--s-color-text-invert-intact-primary, rgba(255, 255, 255, 1))"}),[lm.loading]:(0,a.A)((0,a.A)({},e),{},{color:"var(--s-color-text-invert-intact-primary, rgba(255, 255, 255, 1))",background:"transparent",overflow:"hidden"}),[lm.done]:(0,a.A)((0,a.A)({},e),{},{background:"var(--s-color-brand-primary-transparent-3, rgba(0, 102, 255, 0.15))",color:"var(--s-color-brand-primary-default, rgba(0, 87, 255, 1))"})}}),[]),r=n===lm.default||n===lm.commonFailed||n===lm.exceedSizeFailed;return(0,Le.jsxs)("div",{children:[(0,Le.jsx)("style",{children:'\n    @keyframes btn-spin-animation {\n      0% {\n        transform: translate(-50%, -50%) rotate(0);\n      }\n      100% {\n        transform: translate(-50%, -50%) rotate(1turn);\n      }\n    }\n\n    .loading::before {\n      content: "";\n      top: 50%;\n      left: 50%;\n      position: absolute;\n      transform: translate(-50%, -50%);\n      width: 150%;\n      height: 400%;\n      background: radial-gradient(78.87% 125% at 21.13% 50%, #0057FF 0%, #5A91FC 81.94%);\n      animation: btn-spin-animation 3s linear infinite;\n      z-index: -1;\n    }\n  '}),(0,Le.jsx)("button",{ref:o,style:s[r?lm.default:n],onClick:i,"data-testid":"podcast-assistant-summary-btn",children:r?(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,Le.jsx)("path",{d:"M9.13292 13.5547C8.98276 13.5547 8.85038 13.5033 8.73579 13.4006C8.62515 13.2978 8.55599 13.1674 8.52833 13.0094C8.42164 12.4008 8.31297 11.8891 8.20233 11.4742C8.09169 11.0632 7.95536 10.7274 7.79335 10.4666C7.63529 10.2058 7.42783 9.99633 7.17098 9.83826C6.91413 9.6802 6.58615 9.55375 6.18705 9.45892C5.79189 9.36408 5.29992 9.27319 4.71115 9.18626C4.54913 9.16255 4.41478 9.0934 4.30809 8.9788C4.20535 8.86421 4.15398 8.72788 4.15398 8.56982C4.15398 8.41176 4.20732 8.27543 4.31402 8.16084C4.42071 8.04229 4.55506 7.97314 4.71707 7.95338C5.30585 7.8862 5.80177 7.80717 6.20483 7.71629C6.60788 7.6254 6.93981 7.50093 7.20062 7.34287C7.46142 7.18085 7.67283 6.96747 7.83484 6.70272C8.0008 6.43401 8.13516 6.0922 8.2379 5.67729C8.34064 5.25843 8.43745 4.74473 8.52833 4.13619C8.55204 3.97418 8.61922 3.84378 8.72986 3.74499C8.84446 3.64225 8.97881 3.59088 9.13292 3.59088C9.28703 3.59088 9.41941 3.64225 9.53005 3.74499C9.64464 3.84378 9.71577 3.97418 9.74343 4.13619C9.85012 4.74473 9.95682 5.25645 10.0635 5.67137C10.1741 6.08233 10.3105 6.41821 10.4725 6.67901C10.6345 6.93981 10.8439 7.14924 11.1008 7.3073C11.3576 7.46536 11.6836 7.59181 12.0788 7.68665C12.4779 7.78149 12.9699 7.8704 13.5547 7.95338C13.7207 7.98104 13.855 8.05217 13.9578 8.16676C14.0644 8.28136 14.1178 8.41571 14.1178 8.56982C14.1178 8.73183 14.0644 8.87211 13.9578 8.99066C13.8511 9.10525 13.7147 9.17045 13.5488 9.18626C12.9639 9.25344 12.47 9.33444 12.0669 9.42928C11.6639 9.52016 11.33 9.64464 11.0652 9.8027C10.8044 9.96076 10.593 10.1741 10.431 10.4428C10.269 10.7116 10.1366 11.0534 10.0339 11.4683C9.93113 11.8871 9.83432 12.4008 9.74343 13.0094C9.71972 13.1674 9.65057 13.2978 9.53598 13.4006C9.42533 13.5033 9.29098 13.5547 9.13292 13.5547ZM4.74694 6.45657C4.54937 6.45657 4.43872 6.35383 4.41501 6.14835C4.3676 5.76901 4.32018 5.47066 4.27276 5.25333C4.22534 5.036 4.14631 4.87201 4.03567 4.76136C3.92502 4.64677 3.75906 4.56181 3.53777 4.50649C3.31649 4.45117 3.00827 4.39585 2.61311 4.34052C2.39578 4.30891 2.28711 4.19827 2.28711 4.00859C2.28711 3.81892 2.38392 3.70828 2.57755 3.67666C2.9806 3.60554 3.29673 3.54034 3.52592 3.48106C3.75511 3.42179 3.92502 3.33881 4.03567 3.23212C4.14631 3.12147 4.22534 2.96144 4.27276 2.752C4.32018 2.53862 4.3676 2.24423 4.41501 1.86884C4.43872 1.6594 4.54937 1.55469 4.74694 1.55469C4.94057 1.55469 5.05121 1.65545 5.07887 1.85698C5.12629 2.25213 5.17371 2.56035 5.22113 2.78164C5.2725 3.00293 5.35351 3.16889 5.46415 3.27954C5.57479 3.38623 5.74273 3.46526 5.96797 3.51663C6.19321 3.568 6.50538 3.62134 6.90448 3.67666C6.99142 3.68457 7.06255 3.72013 7.11787 3.78336C7.17319 3.84658 7.20085 3.92166 7.20085 4.00859C7.20085 4.19432 7.10601 4.30496 6.91634 4.34052C6.50933 4.4077 6.19123 4.4729 5.96204 4.53612C5.7368 4.5954 5.56886 4.68036 5.45822 4.791C5.34758 4.89769 5.26855 5.05773 5.22113 5.27111C5.17371 5.48449 5.12629 5.78086 5.07887 6.16021C5.06702 6.24714 5.02948 6.31827 4.96625 6.37359C4.90303 6.42891 4.82993 6.45657 4.74694 6.45657Z",fill:"white"})}),t("flow_web_ext_podcast_summarize")]}):n===lm.loading?(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,Le.jsx)("path",{d:"M9.13292 13.5547C8.98276 13.5547 8.85038 13.5033 8.73579 13.4006C8.62515 13.2978 8.55599 13.1674 8.52833 13.0094C8.42164 12.4008 8.31297 11.8891 8.20233 11.4742C8.09169 11.0632 7.95536 10.7274 7.79335 10.4666C7.63529 10.2058 7.42783 9.99633 7.17098 9.83826C6.91413 9.6802 6.58615 9.55375 6.18705 9.45892C5.79189 9.36408 5.29992 9.27319 4.71115 9.18626C4.54913 9.16255 4.41478 9.0934 4.30809 8.9788C4.20535 8.86421 4.15398 8.72788 4.15398 8.56982C4.15398 8.41176 4.20732 8.27543 4.31402 8.16084C4.42071 8.04229 4.55506 7.97314 4.71707 7.95338C5.30585 7.8862 5.80177 7.80717 6.20483 7.71629C6.60788 7.6254 6.93981 7.50093 7.20062 7.34287C7.46142 7.18085 7.67283 6.96747 7.83484 6.70272C8.0008 6.43401 8.13516 6.0922 8.2379 5.67729C8.34064 5.25843 8.43745 4.74473 8.52833 4.13619C8.55204 3.97418 8.61922 3.84378 8.72986 3.74499C8.84446 3.64225 8.97881 3.59088 9.13292 3.59088C9.28703 3.59088 9.41941 3.64225 9.53005 3.74499C9.64464 3.84378 9.71577 3.97418 9.74343 4.13619C9.85012 4.74473 9.95682 5.25645 10.0635 5.67137C10.1741 6.08233 10.3105 6.41821 10.4725 6.67901C10.6345 6.93981 10.8439 7.14924 11.1008 7.3073C11.3576 7.46536 11.6836 7.59181 12.0788 7.68665C12.4779 7.78149 12.9699 7.8704 13.5547 7.95338C13.7207 7.98104 13.855 8.05217 13.9578 8.16676C14.0644 8.28136 14.1178 8.41571 14.1178 8.56982C14.1178 8.73183 14.0644 8.87211 13.9578 8.99066C13.8511 9.10525 13.7147 9.17045 13.5488 9.18626C12.9639 9.25344 12.47 9.33444 12.0669 9.42928C11.6639 9.52016 11.33 9.64464 11.0652 9.8027C10.8044 9.96076 10.593 10.1741 10.431 10.4428C10.269 10.7116 10.1366 11.0534 10.0339 11.4683C9.93113 11.8871 9.83432 12.4008 9.74343 13.0094C9.71972 13.1674 9.65057 13.2978 9.53598 13.4006C9.42533 13.5033 9.29098 13.5547 9.13292 13.5547ZM4.74694 6.45657C4.54937 6.45657 4.43872 6.35383 4.41501 6.14835C4.3676 5.76901 4.32018 5.47066 4.27276 5.25333C4.22534 5.036 4.14631 4.87201 4.03567 4.76136C3.92502 4.64677 3.75906 4.56181 3.53777 4.50649C3.31649 4.45117 3.00827 4.39585 2.61311 4.34052C2.39578 4.30891 2.28711 4.19827 2.28711 4.00859C2.28711 3.81892 2.38392 3.70828 2.57755 3.67666C2.9806 3.60554 3.29673 3.54034 3.52592 3.48106C3.75511 3.42179 3.92502 3.33881 4.03567 3.23212C4.14631 3.12147 4.22534 2.96144 4.27276 2.752C4.32018 2.53862 4.3676 2.24423 4.41501 1.86884C4.43872 1.6594 4.54937 1.55469 4.74694 1.55469C4.94057 1.55469 5.05121 1.65545 5.07887 1.85698C5.12629 2.25213 5.17371 2.56035 5.22113 2.78164C5.2725 3.00293 5.35351 3.16889 5.46415 3.27954C5.57479 3.38623 5.74273 3.46526 5.96797 3.51663C6.19321 3.568 6.50538 3.62134 6.90448 3.67666C6.99142 3.68457 7.06255 3.72013 7.11787 3.78336C7.17319 3.84658 7.20085 3.92166 7.20085 4.00859C7.20085 4.19432 7.10601 4.30496 6.91634 4.34052C6.50933 4.4077 6.19123 4.4729 5.96204 4.53612C5.7368 4.5954 5.56886 4.68036 5.45822 4.791C5.34758 4.89769 5.26855 5.05773 5.22113 5.27111C5.17371 5.48449 5.12629 5.78086 5.07887 6.16021C5.06702 6.24714 5.02948 6.31827 4.96625 6.37359C4.90303 6.42891 4.82993 6.45657 4.74694 6.45657Z",fill:"white"})}),t("flow_web_ext_podcast_summarizing","\u603b\u7ed3\u4e2d"),"..."]}):(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,Le.jsx)("path",{d:"M7.10905 12.5189C6.85905 12.5189 6.64551 12.4078 6.46842 12.1855L3.77051 8.81055C3.70454 8.73069 3.65592 8.65256 3.62467 8.57617C3.5969 8.49978 3.58301 8.42166 3.58301 8.3418C3.58301 8.16124 3.64204 8.01194 3.76009 7.89388C3.88162 7.77582 4.0344 7.7168 4.21842 7.7168C4.43023 7.7168 4.60905 7.81228 4.75488 8.00326L7.08822 10.998L11.609 3.81576C11.6889 3.69423 11.7705 3.60916 11.8538 3.56055C11.9372 3.50846 12.0448 3.48242 12.1768 3.48242C12.3573 3.48242 12.5049 3.53971 12.6195 3.6543C12.734 3.76541 12.7913 3.91124 12.7913 4.0918C12.7913 4.16471 12.7792 4.23937 12.7549 4.31576C12.7306 4.38867 12.6924 4.4668 12.6403 4.55013L7.74447 12.1803C7.59169 12.406 7.37988 12.5189 7.10905 12.5189Z",fill:"#0057FF"})}),t("flow_web_ext_podcast_summarized")]})})]})};let dm=function(e){return e.summary="summary",e.mindmap="mindmap",e}({});const um={closeAssistant:"closeAssistant-uLjECa",podcastSummaryContainer:"podcastSummaryContainer-y0iMf0",area:"area-hJcYAm",reminder:"reminder-NyfrPX"},hm=e=>{const t=(0,g.B)();let n=null;if(e.status===lm.loading)n=t("flow_web_ext_podcast_summarizing_desc","\u6b63\u5728\u4e3a\u4f60 AI \u603b\u7ed3\uff0c\u5927\u6982\u9700\u8981\u51e0\u5206\u949f\uff0c\u8bf7\u4e00\u4f1a\u518d\u6765\u3002");else{const i=e.status===lm.commonFailed,o=e.status===lm.exceedSizeFailed;i?n=t("flow_web_ext_podcast_summarizefail_desc2","\u62b1\u6b49\uff0c\u65e0\u6cd5\u603b\u7ed3\u8be5\u97f3\u9891\uff0c\u8bf7\u5237\u65b0\u6216\u8005\u6362\u4e00\u4e2a\u97f3\u9891\u8bd5\u8bd5"):o&&(n=t("flow_web_ext_podcast_summarizefail_desc","\u97f3\u9891\u65f6\u957f\u8d85\u8fc7\u9650\u5236\uff0c\u65e0\u6cd5\u4e3a\u4f60\u751f\u6210\u603b\u7ed3\uff0c\u8bf7\u6362\u4e00\u4e2a\u97f3\u9891\u518d\u8bd5\u8bd5\u3002"))}return(0,Le.jsx)("div",{className:um.reminder,children:n})},mm=({isActive:e,getPopupContainer:t,transcript_list:n=[],translateLanguage:i})=>{const o=(0,g.B)();return(0,Le.jsx)(hl,{t:o,isActive:e,getPopupContainer:t,getSendMessageParams:()=>({text:location.href,answerWithSuggest:!1,current_page:(0,tn.M5)(location.href),scene:kr.sJ.podcast,replyLang:null!=i?i:(0,No.wz)((0,J.TK)("uiLanguage")),prompt:ml.EU.browser_plugin_info,browser_plugin_info:JSON.stringify({skill_name:"text_to_mindnote",mindnote_source:"transcript",transcript_list:n})}),translateLanguage:i})},pm=e=>{const{audioElement:t,summaryId:n,highlightsId:i,transcript:o,lang:s,summaryStatus:a,summaryMaxHeight:r,handleLangChange:l,handleRetry:c,handleMsgDone:d,handleClickClose:u,handleSummary:h,onClickHighlight:m}=e,[p,g]=(0,f.useState)(!1),v=(0,f.useRef)(null),_=(0,ha.P)((e=>e.messages)),{isDone:x,text:y="",isError:b,isUnAuthorized:w}=_[n]||{},{isDone:C,text:A="",isUnAuthorized:S}=_[i]||{};(0,f.useEffect)((()=>{x&&C&&d()}),[x,C]);const I=C&&x&&!(0,un.ld)(A)&&!y,[k,j]=(0,f.useState)({currentActiveBreakdownIndex:-1,currentActiveBulletPointIndex:-1,progress:0}),[E,T]=(0,f.useState)(!1),N=(0,f.useRef)();(0,f.useEffect)((()=>{E||clearTimeout(N.current)}),[E]);const{handleClickContinueInChat:M,handleCopy:R,trackResultEvent:L,trackHighlightEvent:P}=Jd({videoSummaryId:n,videoHighlightsId:i}),B=(0,Dl.vh)("web_podcast_summary",w||S),D=Boolean(null==o?void 0:o.length),F=!(!b&&Boolean(y))&&!C,{activeTab:U,renderTab:H}=(()=>{const e=(0,at.Uk)(),t=(0,kl.A)("podcast_assistant"),[n,i]=(0,f.useState)(dm.summary),o=(0,f.useMemo)((()=>[{itemKey:dm.summary,itemTitle:e("flow_web_ext_youtube_summary"),enable:!0},{itemKey:dm.mindmap,itemTitle:e("flow_web_ext_search_mindmap"),enable:t.mindmap_show}]),[t]),s=(0,f.useCallback)((()=>{const e=o.filter((e=>e.enable));return e.length<=1?(0,Le.jsx)(Le.Fragment,{}):(0,Le.jsx)(Il,{webpageTabs:e,activeKey:n,onChange:e=>{i(e)}})}),[n,o]);return{activeTab:n,renderTab:s}})();return(0,Le.jsxs)("div",{"data-testid":"podcast-assistant-container",style:{maxHeight:r?`${r}px`:"unset"},className:ie()(um.podcastSummaryContainer),ref:v,children:[(0,Le.jsx)(Ae.A,{className:ie()(um.area),show:p,setShow:g,position:"bottomRight",optionPageSection:"podcast-summary",disableKey:Tc.lf.podcastSummary,onDisableOnceClick:u,children:(0,Le.jsx)("div",{className:um.closeIcon,"data-testid":"podcast-assistant-close-btn",onPointerDown:()=>g(!0),children:(0,Le.jsx)(ud.A,{className:um.icon})})}),(0,Le.jsx)(Wo,{available:B,contentVisible:a!==lm.default,popContainerRef:v,isSummaryDone:!!x,isHighlightsDone:!!C,noContent:!!I,hasTranscript:!0,isTranscriptLoaded:D,summarizeTriggered:a!==lm.default,hasNoSubtitles:!1,hasShowedUserGuidance:!0,translateLanguage:s,onTranslateLanguage:l,onSummarizeVideo:()=>h(),onClickLogin:()=>{(0,Ce.DT)({trackMeta:{previous_page:"podcast_page",login_entrance:"podcast_page"}})},renderActionBtnTabs:F?void 0:H}),F?(0,Le.jsx)(hm,{status:a}):(0,Le.jsxs)(Be.tU,{activeKey:U,renderTabBar:()=>null,children:[(0,Le.jsx)(Be.mF,{itemKey:dm.summary,children:(0,Le.jsx)(Ir,{mediaElement:t,onClickHighlight:m,available:B,hasNoSubtitles:!1,hasShowedUserGuidance:!0,noContent:!!I,contentVisible:!0,videoSummaryId:n,onRetry:c,isHighlightsDone:!!C,transcript:o,highlightsResult:A,trackResultEvent:e=>{L(e,!1,ro.PODCAST_BUTTON)},trackHighlightEvent:P,videoState:k,setVideoState:j,handleUserInteract:()=>{T(!0),clearTimeout(N.current),N.current=setTimeout((()=>{T(!1)}),1e4)},userInteracting:E,isImmersionMode:!1})}),(0,Le.jsx)(Be.mF,{itemKey:dm.mindmap,children:(0,Le.jsx)(mm,{isActive:U===dm.mindmap,getPopupContainer:()=>v.current,transcript_list:o,translateLanguage:s})})]}),B&&U===dm.summary&&x&&C&&!I&&(0,Le.jsx)(Ra,{videoTitle:"",onClickContinueInChat:M,popContainerRef:v,onCopy:R,transcript:o,videoId:"",currentPlayingClip:k.currentActiveBreakdownIndex,summaryResult:y,highlightResult:(0,un.Bq)(A),videoSummaryId:n,videoHighlightsId:i})]})},gm=f.memo(pm);var vm=n(32572),fm=n(39275);function _m(){return _m=(0,r.A)((function*(e,t,n){return yield(0,Gn.S6)({method:"POST",url:`${Un.C1}/samantha/plugin/podcast/transcript`,data:{url:e,type:t,resource_url:n}})})),_m.apply(this,arguments)}function xm(){return xm=(0,r.A)((function*(e,t){return yield(0,Gn.S6)({method:"POST",url:`${Un.C1}/samantha/plugin/podcast/should_upload`,data:{url:e,type:t}})})),xm.apply(this,arguments)}function ym(){return(ym=(0,r.A)((function*(e){let t="";try{const{data:n}=yield(0,fm.cs)({name:"add-fetch-cross-header",body:e}),i=yield fetch(e,{redirect:"follow"});if(t=n,!i.ok)throw new Error(`HTTP error! Status: ${i.status}`);return i.blob()}catch(i){throw(0,gt.z3)("[zx] podcast: dowload audio failed:",i),i}finally{n=t,(0,fm.cs)({name:"remove-fetch-cross-header",body:n})}var n}))).apply(this,arguments)}function bm(){return bm=(0,r.A)((function*(e){try{var t,n;const i=performance.now(),o=yield function(e){return ym.apply(this,arguments)}(e),s=o.size/1048576;if(s>=200)return(0,gt.Rm)("[zx] podcast: file size >= 200MB, cant transform to text"),{success:!1,failCode:lm.exceedSizeFailed};(0,gt.Rm)(`[zx] podcast: download audio resource(${o.type}, ${s.toFixed(3)}MB) success, start to upload to imageX...`);const a=yield(0,Fn.r)(o,"file"),{data:r}=yield vm.g.resource.GetFileURL({uris:[a],type:"file"}),l=performance.now();return(0,gt.Rm)(`[zx] podcast: upload resource, url(\n    ${null==r||null===(t=r.file_urls)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.main_url}), duration: ${((l-i)/1e3).toFixed(3)}s`),{success:!0,url:null==r||null===(n=r.file_urls)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.main_url}}catch(i){return(0,gt.z3)("[zx] podcast: upload failed",i),{success:!1,failCode:lm.commonFailed}}})),bm.apply(this,arguments)}const wm=[".mp3",".m4a",".wav",".ogg",".flac",".ape",".aac",".aiff",".wma",".webm"],Cm=()=>{var e;const t=(0,f.useRef)(document.querySelector("main")),n=(0,f.useRef)(document.querySelector("h1")),i=(0,f.useCallback)((()=>{var e;return((null===(e=n.current)||void 0===e?void 0:e.getBoundingClientRect().top)||110)<=30}),[]),[o,s]=(0,f.useState)({center:(window.innerWidth-((null===(e=t.current)||void 0===e?void 0:e.offsetWidth)||600))/2<450,sticky:i(),forceUpdate:0});(0,f.useEffect)((()=>{let e=null;const r=()=>{e&&cancelAnimationFrame(e),e=requestAnimationFrame((()=>{if(!n.current||o.center)return;const{top:e}=n.current.getBoundingClientRect();s((0,a.A)((0,a.A)({},o),{},{sticky:e<=30}))}))};window.addEventListener("scroll",r);let l=null;const c=()=>{l&&cancelAnimationFrame(l),l=requestAnimationFrame((()=>{var e;const n=(null===(e=t.current)||void 0===e?void 0:e.offsetWidth)||0;if((window.innerWidth-n)/2<450)s((0,a.A)((0,a.A)({},o),{},{sticky:!1,center:!0}));else{const e=i();s({forceUpdate:e?o.forceUpdate+1:o.forceUpdate,sticky:e,center:!1})}}))};return window.addEventListener("resize",c),()=>{window.removeEventListener("resize",c),window.removeEventListener("scroll",r)}}),[o.center,o.forceUpdate]);const r=(0,f.useMemo)((()=>{var e;if(o.center)return{padding:"0 20px"};const i=(null===(e=t.current)||void 0===e?void 0:e.getBoundingClientRect())||{left:0,width:0},s=o.sticky?i.left+i.width:i.width;let a=30;if(!o.sticky){const e=n.current;if(e){var r;const t=(null===(r=e.parentElement)||void 0===r||null===(r=r.nextElementSibling)||void 0===r?void 0:r.getBoundingClientRect().top)||0;a=e.getBoundingClientRect().top-t}else a=0}return{position:o.sticky?"fixed":"absolute",left:`${s}px`,top:`${a}px`,width:"450px",padding:"0 20px","z-index":"10"}}),[o.center,o.sticky,o.forceUpdate]);let l=600;var c;o.center||(l=o.sticky?window.innerHeight-30-100:window.innerHeight-((null===(c=n.current)||void 0===c?void 0:c.getBoundingClientRect().top)||0)-100);return{summaryMaxHeight:l,layoutCss:r}},Am=function(){var e=(0,r.A)((function*(){const e=yield fetch(location.href),t=yield e.text();let n="";const i=t.match(/[\\]*"assetUrl[\\]*":[\\]*"(.*?)[\\]*"/);null!=i&&i[1]&&(n=i[1]);let o="";const s=t.match(/[\\]*"name[\\]*":[\\]*"(.*?)[\\]*"/);null!=s&&s[1]&&(o=s[1]);let a="";const r=t.match(/[\\]*"durationInMilliseconds[\\]*":[\\]*(.*?),[\\]*/);null!=r&&r[1]&&(a=(0,hn.i)(parseInt(r[1])/1e3));let l="";const c=t.match(/<source srcset="(.*?0w\.(png|jpg|webp)).*,.*"/);return null!=c&&c[1]&&(l=c[1]),{mediaUrl:n,coverUrl:l,title:o,duration:a}}));return function(){return e.apply(this,arguments)}}(),Sm=e=>{const t=(0,f.useRef)(document.querySelector('button[class*="icon-play"]')),[,n]=(0,f.useState)(0),i=(0,f.useRef)();(0,f.useEffect)((()=>{if(e.current||!t.current)return;const o=new MutationObserver((function(){if(e.current)return;const t=document.querySelector("audio");var o;return"apple-music-player"===(null==t?void 0:t.id)&&t instanceof HTMLAudioElement&&""!==t.src?((0,gt.Rm)("[zx] podcast: find audio element"),e.current=t,null===(o=i.current)||void 0===o||o.call(i,e.current),void n((e=>e+1))):void 0}));return o.observe(document.body,{childList:!0,attributes:!0,subtree:!0}),()=>{o.disconnect()}}),[t.current,e.current]);return{summaryMaxHeight:600,onClickHighlight:n=>{!e.current&&t.current&&(i.current=n,t.current.click())}}},Im=e=>{const t=(0,f.useRef)(null),[n,i]=(0,f.useState)({mediaUrl:"",coverUrl:"",title:"",duration:""}),o="xiaoyuzhou"===(null==e?void 0:e.name),s="applepodcast"===(null==e?void 0:e.name),a=o?Cm:s?Sm:void 0,{summaryMaxHeight:r,layoutCss:l,onClickHighlight:c}=(null==a?void 0:a(t))||{};return(0,f.useEffect)((()=>{if(!e)return;const n=e=>{wm.find((t=>{var n;return null===(n=e.mediaUrl)||void 0===n?void 0:n.toLowerCase().endsWith(t)}))||(0,gt.z3)("[zx] podcast: audio src not valid",e.mediaUrl),(0,gt.Rm)("[zx] podcast: audio info:",e),i(e)},o=e.audioQuery?document.querySelector(e.audioQuery):null;switch(o instanceof HTMLAudioElement&&""!==o.src&&(t.current=o),e.name){case"xiaoyuzhou":{const e=(e=>{var t,n;const i=(null===(t=document.querySelector("h1.title"))||void 0===t?void 0:t.textContent)||"";let o="";const s=document.querySelector('img[class*="avatar"]');s instanceof HTMLImageElement&&(o=s.src);const a=null===(n=document.querySelector('div[class*="label right"]'))||void 0===n?void 0:n.textContent;let r=a||"";if(a){const e=a.split(":"),t=parseInt(e[0]),n=parseInt(e[1]);t>=60&&(r=(0,hn.i)(60*t+n))}return{mediaUrl:(null==e?void 0:e.src)||"",coverUrl:o,title:i,duration:r}})(t.current);n(e);break}case"applepodcast":Am().then((e=>{n(e)}))}}),[]),{summaryMaxHeight:r,layoutCss:l,audioEle:t.current,mediaUrl:n.mediaUrl,podcastTitle:n.title,podcastDuration:n.duration,coverUrl:n.coverUrl,onClickHighlight:c}};var km=n(24768);const jm=()=>{var e;const t=null===(e=(0,f.useContext)(km.s6))||void 0===e?void 0:e.platform,[n]=(0,v.Y)("podcastSummaryDisableHosts"),[i]=(0,v.Y)("podcastSummaryDisableAll"),o=n.includes(window.location.host)||i,[s,l]=(0,f.useState)(lm.default),[c,d]=(0,f.useState)(!1),{summaryMaxHeight:u,layoutCss:h={},audioEle:m,mediaUrl:p,podcastTitle:g,coverUrl:x,podcastDuration:y,onClickHighlight:b}=Im(t),[w,C]=(0,f.useState)(void 0),[A,S]=(0,f.useState)(void 0),[I,k]=(0,f.useState)(!1),j=(0,f.useRef)(null),[E,T]=(0,f.useState)(""),[N,M]=(0,f.useState)(""),R=(0,ha.P)((e=>e.sendMessage)),L=(0,J.TK)("uiLanguage"),[P,B]=(0,f.useState)(L),D=(0,f.useRef)();(0,f.useEffect)((()=>{const e=null!=t&&t.buttonContainerNodeQuery?document.querySelector(t.buttonContainerNodeQuery):null;return e?(D.current=document.createElement("div"),D.current.style.marginLeft="10px",e.appendChild(D.current)):d(!0),()=>{e&&D.current&&e.removeChild(D.current)}}),[]);const F=(0,f.useCallback)((e=>{l(e)}),[]),U=function(){var e=(0,r.A)((function*(e){(0,gt.Rm)("[zx] podcast: start polling to get podcast transcript");try{const n=location.href,i=yield function(e,t,n){return _m.apply(this,arguments)}(n,(null==t?void 0:t.name)||"",e);if("success"===i.status||"fail"===i.status)if(k(!1),j.current&&(clearInterval(j.current),j.current=null),"success"===i.status)C(i.transcript);else if("fail"===i.status)throw F(lm.commonFailed),new Error(`podacast url ${n}, resource url ${e}`)}catch(n){(0,gt.z3)("[zx] podcast: fetch podcast transcript failed",n)}}));return function(t){return e.apply(this,arguments)}}();(0,f.useEffect)((()=>(I?j.current=setInterval(U,1e4,A):j.current&&clearInterval(j.current),()=>{j.current&&clearInterval(j.current)})),[I]);const H=e=>{(0,tn.z8)(_.Ur.clickPodcastAssistantSummarizeBtn,{click_from:ro.PODCAST_BUTTON,button_name:_._h.summarizePodcast}),(0,gt.Rm)("[zx] podcast: start send message to ai summary(summary + highlight)");const t={title:g,url:location.href,transcript_list:w};((e,t)=>{const n=R((0,a.A)((0,a.A)({},e),{},{browser_language:(0,No.wz)(null!=t?t:L),current_page:(0,tn.M5)(location.href),scene:kr.sJ.podcast,sec_scene:kr._o.podcast_click_summary}));T(n),(0,gt.Rm)("[zx] podcast: summaryId",n)})({text:location.href,prompt:ml.EU.youtube,browser_youtube_transcript:{browser_youtube_summary_transcript:JSON.stringify(t)}},e),((e,t)=>{const n=R((0,a.A)((0,a.A)({},e),{},{browser_language:(0,No.wz)(null!=t?t:L),current_page:(0,tn.M5)(location.href),scene:kr.sJ.podcast,sec_scene:kr._o.podcast_click_summary}));M(n),(0,gt.Rm)("[zx] podcast: highlightId",n)})({text:location.href,prompt:ml.EU.youtube,browser_youtube_transcript:{browser_youtube_timeline_transcript:JSON.stringify(t)}},e)};(0,f.useEffect)((()=>{null!=w&&w.length&&(H(P),zl({cover_url:x,title:g,duration:y}))}),[w]);const z=function(){var e=(0,r.A)((function*(){if(s!==lm.default)return;if(!p)return;l(lm.loading),T(""),M(""),d(!0);const e=yield function(e,t){return xm.apply(this,arguments)}(location.href,(null==t?void 0:t.name)||"");let n;if((0,gt.Rm)(`[zx] podcast: ${e?"":"no "}need upload resource`),e){const e=yield function(e){return bm.apply(this,arguments)}(p);if(!e.success)return void F(e.failCode||lm.commonFailed);n=e.url,S(n)}k(!0),yield U(n)}));return function(){return e.apply(this,arguments)}}();return(0,f.useEffect)((()=>{(0,$o.$Z)()&&p&&z()}),[p]),o?null:p?(0,Le.jsx)(Ro.Provider,{value:{scene:"podcast",secScene:null==t?void 0:t.name},children:(0,Le.jsxs)("div",{className:ie()("cici-ext-always-light","semi-always-light"),style:{position:"relative"},children:[D.current&&Go.createPortal((0,Le.jsx)(cm,{buttonState:s,handleClick:z}),D.current),c&&(0,Le.jsx)("div",{style:h,children:(0,Le.jsx)(gm,{audioElement:m,summaryId:E,highlightsId:N,summaryStatus:s,transcript:w,lang:P,summaryMaxHeight:u,handleLangChange:e=>{(0,gt.Rm)("[zx] podcast: change language to",e),l(lm.loading),B(e),H(e)},handleClickClose:()=>{l(lm.default),d(!1)},handleRetry:()=>H(P),handleMsgDone:()=>{l(lm.done)},handleSummary:z,onClickHighlight:b})})]})}):null};var Em=n(21137),Tm=n(78449),Nm=n(28920),Mm=n(88034);function Rm(){const[e,t]=(0,f.useState)(void 0);return(0,f.useEffect)((()=>{const e=(0,k.A)((()=>{if(!(0,vt.ku)())return;const e=(0,Tm.OM)()?ts.e.VideoSummary:(0,Mm.ow)()?ts.e.Pdf:ts.e.Web;(0,Nm.K)(e,e===ts.e.Web?void 0:"").then((e=>{(0,Kn.NK)(e).then((e=>{t(e)})).catch((()=>t(void 0)))})).catch((()=>t(void 0)))}),1e4),n=new MutationObserver(e);n.observe(document,{attributes:!0,childList:!0,subtree:!0});const i=n=>{t(n),e()};return ni.A.on("onWebpageSaved",i),e(),()=>{n.disconnect(),ni.A.off("onWebpageSaved",i)}}),[]),e}var Lm=n(4580);const Pm=e=>{const t=(0,tn.M5)(location.href);(0,et.s)(_.Ur.showPdfAssistant,{current_page:t,show_from:e}),(0,Qe.M7)({current_page:t,show_from:_.Ur.showPdfAssistant})},Bm=e=>{const t=(0,tn.M5)(location.href);(0,et.s)(_.Ur.clickReadPdfBtn,{current_page:t,click_from:e}),(0,Qe.dn)({current_page:t,click_from:_.Ur.clickReadPdfBtn})};var Dm=n(89137);let Fm=function(e){return e.YOUTUBE_SUMMARIZE="onboarding_youtube_summarize",e.VIDEO_SUMMARIZE="onboarding_video_summarize",e.ARTICLE_SUMMARIZE="onboarding_article_summarize",e.CHAT="chat",e.PDF="pdf",e}({});const Um=({current_page:e})=>{(0,tn.z8)(_.Ur.enterPage,{current_page:e,previous_page:_.g6.welcome})};var Hm=n(16196);const zm="pdfAssistantContainer-tzWRfF",Om="pdfCollectBtn-z2TM9_",qm="name-rmIuEu",Vm="savedIcn-n9N3VS",$m="readButton-ZDzC9k",Km="text-kak2Ld",Wm="buttonArxiv-s7j92h",Gm="buttonPdfChrome-U0M4qX",Zm="buttonPdfEdge-uB3XIz",Ym="buttonPdfSafari-EZUGmo";function Jm(){var e;const t=(0,at.Uk)(),n=null===(e=(0,f.useContext)(Mm.Er))||void 0===e?void 0:e.platform,i=null==n?void 0:n.name,o=(0,dn.l)((e=>e.isSidePanelMode)),s=(0,dn.l)((e=>e.setIsShowSidebar)),a=(0,Gd.on)((e=>e.setFloatingCardVisible)),c=(0,Gd.on)((e=>e.setSummaryActionVisible)),[d,u]=(0,v.Y)("needOpenSideBar"),h="arxiv"===i,m=(0,l.UPE)(),p=(0,l.nrF)(),g=window.location.protocol.startsWith("file:"),x=!h&&!g&&(0,vt.ku)();(0,f.useEffect)((()=>{Pm(h?_.Z5.arxiv:_.Z5.pdf),d&&(u(!1),s(!0,_.cz.other),a(!1),c(!1))}),[]);const y=function(){var e=(0,r.A)((function*(){const e=h?location.href.replace("/abs/","/pdf/"):location.href;h?Bm(_.Z5.arxiv):(s(!0,_.cz.other),a(!1),c(!1),Bm(_.Z5.pdf)),o?(s(!0,_.cz.other),yield(0,Yd.Z)(),(0,fm.cs)({name:"read-pdf",body:{url:e}})):(yield(0,Oh.$D)(),(0,Hm.M)({url:e})),h&&(u(!0),location.href=e)}));return function(){return e.apply(this,arguments)}}(),[b,w]=(0,f.useState)(!1),[C,A]=(0,f.useState)(0),S=(0,f.useRef)({}),I=!(0,v.Y)("authInfo")[0].isAuthenticated&&g,k=(0,f.useMemo)((()=>"arxiv"===(null==n?void 0:n.name)?pt.vP.arxiv_view_pdf:pt.vP.chrome_pdf_viewer),[n]);(0,f.useEffect)((()=>{x&&(0,pt.ae)(k,pt.p6.pdf)}),[g]);const j=Rm(),E=(0,f.useMemo)((()=>j?t("flow_web_ext_sidebar_bookmarks_saved"):t("flow_web_ext_pdf_page_bookmarks").replace(/\{?\{brandName\}\}?/,(0,Se.L2)()||"")),[j,t]);return(0,f.useEffect)((()=>{var e;(null===(e=location.hash)||void 0===e?void 0:e.startsWith(Xe.RB))&&(y(),Um({current_page:Fm.PDF})),ue.vF.persist.info({eventName:"PDF ASSISTANT mounted",meta:{uriType:location.href.startsWith("file")?"file":"web"}})}),[]),(0,Le.jsxs)("div",{className:ie()(zm,{[Wm]:h,[Gm]:!h&&!m&&!p,[Zm]:!h&&m,[Ym]:!h&&p}),children:[(0,Le.jsxs)("div",{className:ie()($m),onClick:()=>{var e;if(Bm(h?_.Z5.arxiv:_.Z5.pdf),I)return void(0,Ce.DT)({trackMeta:{previous_page:"web",login_entrance:"web"}});if(b)return;const t=h?location.href.replace("/abs/","/pdf/"):location.href,n=h?"from_extention_read_pdf_arxiv":"from_extention_read_pdf_pdfviewer",i=null===(e=S.current)||void 0===e?void 0:e[t];g&&!i?(w(!0),Em.J.getFileBlob(t,"application/pdf",(e=>{e?((0,Lm.ab)(),(0,Hm.M)({url:t,blob:e,createMessage:!1},(e=>{A(e.percent),e.percent>=100&&(S.current[t]=e.key,w(!1),A(0),(0,Em.f)({pdfUrl:e.key,fromSource:n}))}))):w(!1)}))):(0,Em.f)({pdfUrl:i||t,fromSource:n})},"data-testid":"flow-pdf-assistant-airead",children:[b?(0,Le.jsx)(Be.tK,{spinning:!0,size:"small"}):(0,Le.jsx)(ze.HD,{}),(0,Le.jsx)("div",{className:Km,children:b?t("flow_web_ext_pdf_page_btn_immersive_uploading",{number:C}):t(I?"flow_web_ext_pdf_page_btn_log_out_immersive":"flow_web_ext_pdf_page_btn_immersive")})]}),x&&(0,Le.jsxs)("button",{className:Om,onPointerUp:()=>{j?(0,Vt.PU)(j):(0,Vt.XQ)({collectFrom:k,collectionType:mt.X.Pdf})},"data-testid":"flow-pdf-assistant-collect",children:[j?(0,Le.jsx)(be.u06,{className:Vm}):(0,Le.jsx)(be.Wur,{}),(0,Le.jsx)("span",{className:qm,children:E})]})]})}n(93976);const Qm=e=>{const[t,n]=(0,f.useState)(window.innerWidth),[i,o]=(0,f.useState)(28);return(0,f.useEffect)((()=>{const e=()=>{n(window.innerWidth)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,f.useEffect)((()=>{let e;e=t<1125?28:t>1300&&t<=1475?180:t>=1125&&t<=1300?(t-1124)/2+28:t>1475&&t<=1675?(t-1475)/4+180:230,o(e)}),[t]),e?"baidu"===e.name||"bing"===e.name?{marginLeft:0}:{marginLeft:i}:{marginLeft:0}};var Xm=n(42740),ep=n(39328);const tp={"cici-ext-container":"cici-ext-container-yzw_fL",ciciExtContainer:"cici-ext-container-yzw_fL","inactivelink-hover-animation":"inactivelink-hover-animation-wFN4yJ",inactivelinkHoverAnimation:"inactivelink-hover-animation-wFN4yJ","notactivelink-hover-animation":"notactivelink-hover-animation-P26GaQ",notactivelinkHoverAnimation:"notactivelink-hover-animation-P26GaQ","light-click-animation":"light-click-animation-cDIscK",lightClickAnimation:"light-click-animation-cDIscK","click-animation":"click-animation-Dv_EtT",clickAnimation:"click-animation-Dv_EtT","semi-animation-rotate":"semi-animation-rotate-XsXC6r",semiAnimationRotate:"semi-animation-rotate-XsXC6r","inactive-btn-hover-animation":"inactive-btn-hover-animation-p6M2XE",inactiveBtnHoverAnimation:"inactive-btn-hover-animation-p6M2XE","cici-ext-always-dark":"cici-ext-always-dark-yUc_nS",ciciExtAlwaysDark:"cici-ext-always-dark-yUc_nS","cici-ext-always-light":"cici-ext-always-light-W9IcgL",ciciExtAlwaysLight:"cici-ext-always-light-W9IcgL",ellipsis:"ellipsis-jZwXPH",searchTextResult:"searchTextResult-XBh4hJ",title:"title-zlKL9c",footer:"footer-Z3IUTP",searchMoreBtn:"searchMoreBtn-RHlNlZ",actionBtnContainer:"actionBtnContainer-WYRGZj",actionBtn:"actionBtn-XEBCCM",collectionBtn:"collectionBtn-NkBSVa","activelink-hover-animation":"activelink-hover-animation-o1pqTD",activelinkHoverAnimation:"activelink-hover-animation-o1pqTD"};function np({searchId:e,searchQuery:t,index:n,onReplaceSearch:i,onHeightChange:o}){const s=(0,g.B)(),a=(0,ha.P)((e=>e.messages)),r=(0,f.useRef)(null),{isDone:l,text:c="",body:d}=a[e]||{},{onCopyClick:u,onMouseEnter:h,onMouseLeave:m,checked:p}=fa((()=>{var t;es()(c),Zu({click_from:"deep_search_mode",search_id:e,message_id:null==d||null===(t=d.message)||void 0===t?void 0:t.message_id})})),v=p?ze.w_:ze.jw;(0,f.useEffect)((()=>{if(l){var e;const t=null==r||null===(e=r.current)||void 0===e?void 0:e.getBoundingClientRect().height;t&&o(t)}}),[l]),(0,f.useEffect)((()=>{l&&(0,vt.ku)()&&(0,pt.ae)(pt.vP.search_result_card,pt.p6.searchresult)}),[l]);const{CollectionIcon:_,onCollectionClick:x,collected:y}=_a({getCollectionParam:()=>{var n;return{collectFrom:pt.vP.search_result_card,collectionType:mt.X.SearchResult,messageId:null==d||null===(n=d.message)||void 0===n?void 0:n.message_id,localMessageId:e,userInput:t}}});return(0,Le.jsxs)("div",{ref:r,className:tp.searchTextResult,children:[0!==n&&(0,Le.jsx)("div",{className:tp.title,children:t}),(0,Le.jsx)(Sr,{id:e,query:t,type:"search",onRetry:()=>{i(t,n)},loadingSlot:(0,Le.jsx)(Xu.c_,{text:t,t:s,searchType:ep.n.DeepSearch})}),l&&(0,Le.jsx)("div",{className:tp.footer,children:(0,Le.jsxs)("div",{className:tp.actionBtnContainer,children:[(0,Le.jsxs)("div",{className:tp.actionBtn,onMouseEnter:h,onMouseLeave:m,onClick:u,children:[(0,Le.jsx)(v,{style:{fontSize:"20px"}}),(0,Le.jsx)("div",{children:s("message_long_press_copy")})]}),(0,vt.ku)()&&(0,Le.jsxs)("div",{className:tp.actionBtn,onClick:()=>{x()},children:[(0,Le.jsx)(_,{className:tp.collectionBtn}),(0,Le.jsx)("div",{children:s(y?"bookmarks_list_remove_hover":"flow_web_ext_action_bookmarks")})]})]})})]})}const ip={container:"container-NLZ6ge",content:"content-xMnYqX",title:"title-gfqOLi",footer:"footer-kANaph",icon:"icon-j0I9WC",siteName:"siteName-gIk9DV"};function op({index:e,source:t,onClick:n}){return(0,Le.jsx)("a",{className:ip.container,href:t.url,target:"_blank",rel:"noreferrer noopener",onClick:()=>n(e),children:(0,Le.jsxs)("div",{className:ip.content,children:[(0,Le.jsx)("div",{className:ip.title,children:t.title}),(0,Le.jsxs)("div",{className:ip.footer,children:[t.logo_url?(0,Le.jsx)("img",{className:ip.icon,src:t.logo_url}):null,(0,Le.jsx)("span",{className:ip.siteName,children:`${t.sitename} \xb7 ${e}`})]})]})})}const sp={searchSourceResult:"searchSourceResult-U65oyd",placeholder:"placeholder-SEg_go",loadingTitle:"loadingTitle-acF1Im",loadingParagraph:"loadingParagraph-hQR6xB",title:"title-KUjDzx",titleSource:"titleSource-_815Vn",sourceNum:"sourceNum-cUmfS1",content:"content-PQCuKv",pagination:"pagination-D124T5"};function ap({searchId:e,contentHeight:t}){var n;const i=(0,g.B)(),o=(0,ha.P)((e=>e.messages)),[s,a]=(0,f.useState)(1),{isDone:r,isError:l,isAborted:c,text:d="",searchCardData:u}=o[e]||{},h=!d&&!l&&!r&&!c||!t,m=(null==u||null===(n=u.search_result)||void 0===n||null===(n=n.text_card)||void 0===n?void 0:n.card_list)||[],p=m.length,v=2*Math.floor((t-32-36)/86),_=(s-1)*v,x=_+v,y=m.slice(_,x),b=y.map((({title:e})=>e)).join("");(0,f.useEffect)((()=>{for(let n=0;n<y.length;n++){var t;const i=y[n];$u({search_id:e,title:i.title,show_content_message_id:i.doc_id,show_content_wordlength:String(null===(t=i.sitename)||void 0===t?void 0:t.length),sources_count:String(p),rnk:n+1,source_name:i.sitename,source_publishtime:i.publish_time_second,location_pagenum:s})}}),[b]);const w=t=>{var n;const i=y[t-1];Ku({search_id:e,title:i.title,show_content_message_id:i.doc_id,show_content_wordlength:String(null===(n=i.sitename)||void 0===n?void 0:n.length),sources_count:String(p),rnk:t,source_name:i.sitename,source_publishtime:i.publish_time_second,location_pagenum:s})};return(0,Le.jsx)("div",{className:sp.searchSourceResult,children:!h&&y.length>0&&(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsxs)("div",{className:sp.title,children:[(0,Le.jsxs)("div",{className:sp.titleSource,children:[(0,Le.jsx)(ze.jZ,{}),(0,Le.jsx)("div",{children:i("flow_web_ext_search_sources")})]}),(0,Le.jsx)("div",{className:sp.sourceNum,children:i("flow_web_ext_search_deepinsearch_close",{number:p})})]}),(0,Le.jsx)("div",{className:sp.content,children:y.map(((e,t)=>(0,Le.jsx)(op,{source:e,index:t+1,onClick:w},t)))}),(0,Le.jsx)(Be.dK,{hideOnSinglePage:!0,className:sp.pagination,total:p,pageSize:v,currentPage:s,onPageChange:e=>{a(e)}})]})})}const rp={searchResult:"searchResult-Iav9sW"};function lp({searchId:e,searchQuery:t,index:n,onReplaceSearch:i}){const[o,s]=(0,f.useState)(0);return(0,Le.jsxs)("div",{className:rp.searchResult,children:[(0,Le.jsx)(np,{searchId:e,searchQuery:t,index:n,onReplaceSearch:i,onHeightChange:s}),(0,Le.jsx)(ap,{searchId:e,contentHeight:o})]})}const cp=(0,f.createContext)(null),dp=e=>/^https:\/\/www.baidu.com\//.test(e)?{name:"baidu",inputQuery:["input[name='wd']"],containerQuery:"#container",searchParam:"wd",watchRouteChange:e=>{const t=document.getElementById("wrapper_wrapper");if(!t)return;const n=new MutationObserver((function(t){for(const n of t){if("childList"!==n.type)break;for(const t of n.addedNodes)if("container"===(null==t?void 0:t.id))return void e()}}));return n.observe(t,{childList:!0}),()=>{n.disconnect()}}}:/^https:\/\/www.google.com?(?:.\w+)?\/search\?/.test(e)?{name:"google",inputQuery:["input[name='q']","textarea[name='q']"],containerQuery:"#rcnt",searchParam:"q",disabled:()=>"2"===(0,fu.QK)("udm",e)}:/^https:\/\/\w+.bing.com\/search\?/.test(e)?{name:"bing",inputQuery:["[name='q']"],containerQuery:"#b_content",searchParam:"q"}:null,up={entryContainer:"entryContainer-qt6YHi",deepSearchAssistantContainer:"deepSearchAssistantContainer-fdGDgh",header:"header-DYJWq6",brandName:"brandName-Pw7R9V",minimizeBar:"minimizeBar-UMU3eL",suggest:"suggest-adzrqs",askMore:"askMore-AFIX_A",mask:"mask-u_bMNJ","mask-fadeIn":"mask-fadeIn-WG2Myo",maskFadeIn:"mask-fadeIn-WG2Myo",fadeIn:"fadeIn-ZdwpOI","mask-fadeOut":"mask-fadeOut-z3FVIr",maskFadeOut:"mask-fadeOut-z3FVIr",fadeOut:"fadeOut-_mYaTl"};function hp({hasEntry:e}){var t;const n=(0,g.B)(),i=(0,f.useRef)(null),o=(0,f.useRef)(null),s=(0,ha.P)((e=>e.sendMessage)),a=(0,ha.P)((e=>e.messages)),{searchList:r,addSearch:l,resetSearch:c,replaceSearch:d,isDeepSearchMode:u,setDeepSearchMode:h}=Ju((e=>({searchList:e.searchList,addSearch:e.addSearch,resetSearch:e.resetSearch,replaceSearch:e.replaceSearch,isDeepSearchMode:e.isDeepSearchMode,setDeepSearchMode:e.setDeepSearchMode}))),[m,p]=(0,f.useState)(""),[v,x]=(0,f.useState)(!1),{searchId:y}=r[r.length-1]||{},{id:b,isDone:w,suggests:C=[]}=a[y]||{},A=null===(t=(0,f.useContext)(cp))||void 0===t?void 0:t.engine,S=()=>{x(!1)};(0,f.useEffect)((()=>(window.addEventListener("scroll",S),()=>{window.removeEventListener("scroll",S)})),[]),(0,f.useEffect)((()=>{const e=am(A);e&&p(e)}),[]),(0,f.useEffect)((()=>{var e;u&&(null==i||null===(e=i.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"start",inline:"start"}))}),[u]),(0,f.useEffect)((()=>{u?Vu({search_id:y,message_id:b,search_from:"search_bar",show_from:"search_result_card"}):e&&Wu({show_from:"below_search_bar"})}),[u,e]),(0,f.useEffect)((()=>{w&&sn({prompt_cnt:C.length,from_search_id:y,show_from:"deep_search_mode",search_engine_name:"google"})}),[w]),(0,f.useEffect)((()=>{if(w)for(let e=0;e<C.length;e++)an({prompt_position:`${e+1}`,message_id:b,from_search_id:y,show_from:"deep_search_mode",search_engine_name:"google"})}),[w,C]);const I=e=>{const t=(0,No.wz)((0,J.TK)("uiLanguage"));return s({text:e,prompt:ml.EU.input_skill,answerWithSuggest:!0,current_page:"search_engine",scene:"search_engine",sec_scene:"deep_search_mode",input_skill:JSON.stringify({skill_id:"8",skill_type:8}),replyLang:t})},k=e=>{const t=I(e);return l({searchId:t,searchQuery:e}),setTimeout((()=>{var e;null===(e=o.current)||void 0===e||null===(e=e.lastElementChild)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"start",inline:"start"})}),0),setTimeout((()=>{x(!0)}),500),t},j=(e,t)=>{const n=I(e);d({searchId:n,searchQuery:e},t)};return(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsxs)("div",{className:up.entryContainer,style:{display:!u&&e?"flex":"none"},children:[(0,Le.jsx)(Ko.A,{size:"large",disable:!0,bransNameVisible:!1,children:n("flow_web_ext_search_summarytitle2",{brandName:(0,Se.L2)()})}),(0,Le.jsx)(ya.c,{type:"ai-primary",icon:(0,Le.jsx)(be.zSs,{}),size:"small",onClick:()=>{if(!r.length){const e=I(m);c({searchId:e,searchQuery:m})}h(!0),Gu({search_id:y,click_from:"below_search_bar"})},children:n("flow_web_ext_search_deepinsearch")})]}),(0,Le.jsxs)("div",{ref:i,className:up.deepSearchAssistantContainer,style:{borderWidth:w?"1px":"0",display:u?"block":"none"},"data-testid":"search-assistant-deep-container",children:[(0,Le.jsxs)("div",{className:up.header,style:{top:"bing"===(null==A?void 0:A.name)?0:"52px"},children:[(0,Le.jsx)(Ko.A,{size:"large",disable:!0,bransNameVisible:!1,children:(0,Le.jsx)("div",{className:up.brandName,children:n("flow_web_ext_search_deepinsearch")})}),(0,Le.jsxs)("div",{className:up.minimizeBar,onClick:()=>{h(!1),(({search_id:e})=>{(0,tn.z8)(_.Ur.collapseDeepSearchCard,{current_page:"search_engine",search_engine_name:"google",search_id:e})})({search_id:y})},"data-testid":"search-assistant-minimizeBtn",children:[(0,Le.jsx)(ze.jR,{}),(0,Le.jsx)("div",{children:n("flow_web_ext_search_deepinsearch_collapse")})]})]}),(0,Le.jsx)("div",{className:ie()(up.mask,{[up["mask-fadeIn"]]:v,[up["mask-fadeOut"]]:!v}),style:{top:"google"===(null==A?void 0:A.name)?"116px":"64px"}}),(0,Le.jsx)("div",{className:up.content,ref:o,children:r.map((({searchId:e,searchQuery:t},n)=>(0,Le.jsx)(lp,{searchId:e,searchQuery:t,index:n,onReplaceSearch:j},e)))}),w&&(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsx)(Rh,{fullMode:!0,className:up.suggest,suggestMessageListWithStatus:{isRegen:!1,loading:!1,suggests:C.filter((e=>e)),failed:!1},onClick:(e,t)=>{const n=k(e);Vu({search_id:n,search_from:"sp_click",from_search_id:y}),rn({click_position:`${t+1}`,search_id:n,click_from:"deep_search_mode",search_engine_name:"google"})}}),(0,Le.jsx)(Xm.Z,{className:up.askMore,placeholder:n("flow_web_ext_search_ask_more",{brand:(0,Se.L2)()}),onSubmit:e=>{const t=k(e);Vu({search_id:t,search_from:"enter_click",from_search_id:y}),(({from_search_id:e,search_id:t,scene:n})=>{(0,tn.z8)(_.Ur.clickInputBar,{from_search_id:e,search_id:t,scene:n})})({search_id:t,from_search_id:y,scene:"deep_search_mode"})}})]})]})]})}const mp=(0,f.createContext)(null);n(62325);const pp=({hasEntry:e})=>{var t,n;const i=(0,at.Uk)();(0,vc.A)(null===(t=document.getElementById(he.hs))||void 0===t?void 0:t.shadowRoot);const o=(0,dn.l)((e=>e.isShowSearch)),[s]=(0,v.Y)("searchDisabledAll"),[a]=(0,v.Y)("searchDisabledHosts"),r=a.includes(window.location.host),l=!s&&!r&&o,c=null===(n=(0,f.useContext)(cp))||void 0===n?void 0:n.engine,{marginLeft:d}=Qm(c);return(0,Le.jsx)(p.Yd.Provider,{value:ue.vF,children:(0,Le.jsx)(g.C,{t:i,children:(0,Le.jsx)("div",{id:"cici-inline-container-deep",className:"cici-ext-container",style:d?{marginLeft:`${d}px`}:{},children:l&&(0,Le.jsx)(hp,{hasEntry:e})})})})},gp=({hasDeepSearchEntry:e,enableWebAISearchCard:t})=>{var n,i;const o=(0,at.Uk)();(0,vc.A)(null===(n=document.querySelector(`[id*=${he.U6}]`))||void 0===n?void 0:n.shadowRoot);const s=(0,dn.l)((e=>e.isShowSearch)),[a]=(0,v.Y)("searchDisabledAll"),[r]=(0,v.Y)("searchDisabledHosts"),l=r.includes(window.location.host),[c,d]=(0,f.useState)((new Date).getTime()),u=!a&&!l&&s,h=null===(i=(0,f.useContext)(mp))||void 0===i?void 0:i.recorder;return(0,f.useEffect)((()=>{u?(d((new Date).getTime()),null==h||h.end("cici_search_engine_ux_rendered")):(({duration:e})=>{(0,tn.z8)(_.Ur.closeSearchAssistant,{duration:e})})({duration:(new Date).getTime()-c})}),[u]),(0,Le.jsx)(p.Yd.Provider,{value:ue.vF,children:(0,Le.jsx)(g.C,{t:o,children:(0,Le.jsx)("div",{id:"cici-inline-container",className:"cici-ext-container",children:u&&(0,Le.jsx)(rm,{hasDeepSearchEntry:e,enableWebAISearchCard:t})})})})},vp=()=>{var e,t;const n=(0,at.Uk)();(0,vc.A)(null===(e=document.querySelector(`[id*=${he.$9}]`))||void 0===e?void 0:e.shadowRoot);const i=null===(t=(0,f.useContext)(mp))||void 0===t?void 0:t.recorder,o=(0,dn.l)((e=>e.isShowVideo));return(0,f.useEffect)((()=>{o&&(null==i||i.end("cici_video_summary_ux_rendered"))}),[o]),(0,Le.jsx)(p.Yd.Provider,{value:ue.vF,children:(0,Le.jsx)(g.C,{t:n,children:(0,Le.jsx)("div",{id:"cici-inline-container",className:"cici-ext-container",children:o&&(0,Le.jsx)(eu,{})})})})},fp=function(){var e=(0,r.A)((function*(e){var t;const n=yield(e=>new Promise((t=>{const n=setInterval((()=>{let i=document.querySelector(e.sidebarContainerQuery);!i&&e.customAppend&&(i=e.customAppend()),i&&(window.clearInterval(n),t(i))}),500)})))(e);if(!n)return;const i=(0,en.Mz)(en.FM.deepSearchEntryMode,""),o=(0,en.Mz)(en.FM.enableWebAISearch,!1);let s=!1,a=!1;"searchCard"===i?s=!0:"singleEntry"===i&&(a=!0);const r=dp(location.href),l=(0,J.TK)("authInfo").isAuthenticated&&!!r&&!(null!=r&&null!==(t=r.disabled)&&void 0!==t&&t.call(r));((e,t)=>{var n;const{hasDeepSearchMode:i=!1,hasEntry:o=!1,enableWebAISearchCard:s=!1}=t,a=(0,fu.Ay)(location.href);if(!a||null!=a&&null!==(n=a.disabled)&&void 0!==n&&n.call(a))return;const r=u.m.getInstance().getHostId(),l=`${he.U6}${r}`;if(e.querySelector(`#${l}`))return;const c=document.createElement("div");c.id=l,c.dataset.searchHostId=u.m.getInstance().getHostId(),c.style.order="-99999",e.insertBefore(c,e.firstChild),(0,gt.Rm)("[Daniel] mount search-assistant at:",e,"before",c.firstChild);const d=Fl.Qz.create("cici_search_engine_ux_perf",!0),h=c.attachShadow({mode:"open"}),p=(0,m.createRoot)(h);(0,rt.NR)(h,he.QN).then((()=>{d.mark("load_search_engine_css"),p.render((0,Le.jsx)(mp.Provider,{value:{recorder:d},children:a&&(0,Le.jsx)(fu.mn.Provider,{value:{engine:a},children:(0,Le.jsx)(Xt,{element:c,children:(0,Le.jsx)(gp,{hasDeepSearchEntry:i&&o,enableWebAISearchCard:s})})})}))})),(0,u.A)((()=>{var e;null===(e=document.querySelector(`#${l}`))||void 0===e||e.remove(),p.unmount()}))})(n,{hasDeepSearchMode:l,enableWebAISearchCard:Boolean(o),hasEntry:s}),(e=>{const t=(0,Io.Ay)(location.href),n=(0,Io.jB)(null==t?void 0:t.name);if(!t||!n)return;const i=u.m.getInstance().getHostId(),o=`${he.$9}-${i}`;if(e.querySelector(`[id=${o}]`))return;const s=document.createElement("div");s.id=o,s.dataset.videoSearchHostId=u.m.getInstance().getHostId(),s.style.order="-99999",e.insertBefore(s,e.firstChild),(0,gt.Rm)("[Rowan] mount video-summary-assistant at:",e,"before",s.firstChild);const a=Fl.Qz.create("cici_video_summary_ux_perf",!0),r=s.attachShadow({mode:"open"}),l=(0,m.createRoot)(r);(0,rt.NR)(r,he.QN).then((()=>{a.mark("load_video_summary_page_css"),l.render((0,Le.jsx)(mp.Provider,{value:{recorder:a},children:t&&(0,Le.jsx)(Io.un.Provider,{value:{platform:t},children:(0,Le.jsx)(Xt,{element:s,children:(0,Le.jsx)(vp,{})})})}))})),(0,u.A)((()=>{var e;l.unmount(),null===(e=document.querySelector(`#${o}`))||void 0===e||e.remove()}))})(n),l&&(e=>{const t=dp(location.href);if(!t)return;const n=document.querySelector(t.containerQuery);if(!n)return;if(n.querySelector(`#${he.hs}`))return;const i=document.createElement("div");i.id=he.hs,i.dataset.searchHostId=u.m.getInstance().getHostId(),i.style.order="-99999",i.style.width="100%",n.insertBefore(i,n.firstChild),(0,gt.Rm)("[Daniel] mount deep-search-assistant at:",n,"before",i.firstChild);const o=i.attachShadow({mode:"open"}),s=(0,m.createRoot)(o);(0,rt.NR)(o,he.QN).then((()=>{s.render((0,Le.jsx)(cp.Provider,{value:{engine:t},children:(0,Le.jsx)(pp,{hasEntry:e})}))})),(0,u.A)((()=>{var e;null===(e=document.querySelector(`#${he.hs}`))||void 0===e||e.remove(),s.unmount()}))})(a)}));return function(t){return e.apply(this,arguments)}}(),_p=()=>{var e;const t=(0,at.Uk)();return(0,vc.A)(null===(e=document.querySelector(`[id*=${he.OD}]`))||void 0===e?void 0:e.shadowRoot),(0,Le.jsx)(p.Yd.Provider,{value:ue.vF,children:(0,Le.jsx)(g.C,{t,children:(0,Le.jsx)("div",{id:`cici-inline-container-${he.OD}`,className:"cici-ext-container",children:(0,Le.jsx)(Jm,{})})})})},xp=()=>{const e=(0,Mm.Ay)(location.href);if(!e)return;const t=(e=>{const t=u.m.getInstance().getHostId();if(void 0===t)return;const n=`${he.OD}-${t}`;if(document.querySelector(`[id=${n}]`))return;const i=document.createElement("div");if(i.id=n,i.dataset.arxivHostId=t,i.style.order="999",i.style.display="inline-block",e.prevNodeQuery){const t=document.querySelector(e.prevNodeQuery),n=null==t?void 0:t.parentElement;n&&(n.style.display="inline-flex",n.style.alignItems="center",n.appendChild(i))}else document.body.appendChild(i);const o=i.attachShadow({mode:"open"}),s=(0,m.createRoot)(o);return(0,rt.NR)(o,he.QN).then((()=>{s.render((0,Le.jsx)(Le.Fragment,{children:e&&(0,Le.jsx)(Mm.Er.Provider,{value:{platform:e},children:(0,Le.jsx)(_p,{})})}))})),()=>{s.unmount(),i.remove()}})(e);return()=>{null==t||t()}},yp=()=>{var e;const t=(0,at.Uk)();return(0,vc.A)(null===(e=document.querySelector(`[id*=${he.sp}]`))||void 0===e?void 0:e.shadowRoot),(0,Le.jsx)(p.Yd.Provider,{value:ue.vF,children:(0,Le.jsx)(g.C,{t,children:(0,Le.jsx)("div",{id:`cici-inline-container-${he.sp}`,className:"cici-ext-container",children:(0,Le.jsx)(jm,{})})})})},bp=e=>{var t;const n=u.m.getInstance().getHostId();if(void 0===n)return;const i=`${he.sp}-${n}`;if(document.querySelector(`[id=${i}]`))return;if(null===(t=e.checkPodcastDetail)||void 0===t||!t.call(e,location.href))return;const o=document.createElement("div");if(o.id=i,o.dataset.podcastHostId=n,o.style.order="-9999",!e.headerNodeQuery)return;const s=document.querySelector(e.headerNodeQuery),a=null==s?void 0:s.parentElement;a&&("applepodcast"===e.name?a.appendChild(o):null!=s&&s.nextSibling?a.insertBefore(o,null==s?void 0:s.nextSibling):a.appendChild(o));const r=o.attachShadow({mode:"open"}),l=(0,m.createRoot)(r);return(0,rt.NR)(r,he.QN).then((()=>{l.render((0,Le.jsx)(Le.Fragment,{children:e&&(0,Le.jsx)(km.s6.Provider,{value:{platform:e},children:(0,Le.jsx)(yp,{})})}))})),()=>{l.unmount(),o.remove()}};var wp=n(75328),Cp=n(95738),Ap=n(11646);const Sp={name:"open-cici-sidebar",handle:e=>{dn.l.getState().setIsShowSidebar(!0,null==e?void 0:e.enterSidebarMode)}};var Ip=n(65240),kp=n(11021);function jp(){var e;if(null===(e=window.location.host)||void 0===e||!e.endsWith(Un.Ud))return()=>{};const t=e=>{var t;if("web"===(null===(t=e.data.body)||void 0===t?void 0:t.originContext)){var n,i;const t=function(e){var t,n;(0,gt.Rm)("[zoei] login cs handleWebMessage",e);const{is_oversea:i}=(null===(t=e.data)||void 0===t?void 0:t.body)||{};if(!(0,lr.A)(i)||!1===i){switch(e.data.name){case"update-auth-info":(0,kp.c)({name:"update-auth-info",body:(0,a.A)((0,a.A)({},e.data.body),{},{reason:"login cs: web notify auth info updated"})});break;case"start-using":{const{isSidePanelMode:e}=dn.l.getState();e&&Sp.handle({enterSidebarMode:_.cz.onboarding},{});break}case"start-try-summarize":(0,kp.c)({name:"start-try-summarize",body:(0,a.A)({},e.data.body)});break;case"start-try-ask":Um({current_page:Fm.CHAT}),(0,Ip.RX)("\u4eba\u5de5\u667a\u80fd\u4f1a\u53d6\u4ee3\u4eba\u7c7b\u5417\uff1f",!0);break;case"start-try-discover-skill":(0,wa.I)({add_prompt:"true",settting_key:"toolbar-configuration"});break;case"call-background-method":if("is-on-toolbar"===e.data.body.method){const{promiseId:t}=e.data;(0,kp.c)("is-on-toolbar").then((e=>{const{isOnToolbar:n}=e.data;window.postMessage({name:"call-background-method-reply",isOnToolbar:n,promiseId:t})}))}break;case"open-web-ai-read":(0,Em.f)({pdfUrl:(null===(n=e.data)||void 0===n||null===(n=n.body)||void 0===n?void 0:n.pdfUrl)||"https://arxiv.org/pdf/1706.03762",fromSource:"from_extention_read_pdf_onboarding"});break;default:return!1}return!0}}(e);null===(n=e.ports[0])||void 0===n||null===(i=n.postMessage)||void 0===i||i.call(n,t)}};return window.addEventListener("message",t),(0,r.A)((function*(){try{var e;const t=yield(0,kp.c)("get-window-info");if(!t.success||!t.data)throw t.error;const n=null===(e=t.data.authInfo)||void 0===e?void 0:e.isAuthenticated;n!==("true"===localStorage.getItem("flow_web_has_login"))&&(0,kp.c)({name:"update-auth-info",body:{reason:"login cs: detect auth info not same"}}).catch((e=>{ue.vF.persist.info({eventName:"[LOGIN] - UPDATE_AUTH_INFO",meta:(0,a.A)({},e)})}))}catch(t){ue.vF.persist.info({eventName:"[LOGIN] - INIT",meta:(0,a.A)({},t)})}}))(),()=>{window.removeEventListener("message",t)}}const Ep="ciciai-with-right-side-chat-box",Tp="ciciai-with-left-side-chat-box";var Np=n(9639),Mp=n(20411),Rp=n(66032),Lp=n(72969);var Pp=n(20318),Bp=n(56422);const Dp={"cici-ext-container":"cici-ext-container-R6tlmp",ciciExtContainer:"cici-ext-container-R6tlmp","inactivelink-hover-animation":"inactivelink-hover-animation-IVB8K3",inactivelinkHoverAnimation:"inactivelink-hover-animation-IVB8K3","notactivelink-hover-animation":"notactivelink-hover-animation-JRcS0J",notactivelinkHoverAnimation:"notactivelink-hover-animation-JRcS0J","light-click-animation":"light-click-animation-cHlJpM",lightClickAnimation:"light-click-animation-cHlJpM","click-animation":"click-animation-zSRLso",clickAnimation:"click-animation-zSRLso","semi-animation-rotate":"semi-animation-rotate-Pb1WMI",semiAnimationRotate:"semi-animation-rotate-Pb1WMI","inactive-btn-hover-animation":"inactive-btn-hover-animation-ChQRaf",inactiveBtnHoverAnimation:"inactive-btn-hover-animation-ChQRaf","cici-ext-always-dark":"cici-ext-always-dark-e0NH3t",ciciExtAlwaysDark:"cici-ext-always-dark-e0NH3t","cici-ext-always-light":"cici-ext-always-light-QaRgiF",ciciExtAlwaysLight:"cici-ext-always-light-QaRgiF",ellipsis:"ellipsis-yU8vxe",container:"container-EHi_gj",header:"header-_BGIsL",left:"left-KcnQXz",draggable:"draggable-kLp2PR","close-btn":"close-btn-hADoYn",closeBtn:"close-btn-hADoYn",main:"main-mG2N4b",actions:"actions-yiy00z","action-btn":"action-btn-Q8mVce",actionBtn:"action-btn-Q8mVce",selected:"selected-KHLsMy","more-btn":"more-btn-mtf1AI",moreBtn:"more-btn-mtf1AI",input:"input-UEYnVw",text:"text-QEKPbd",output:"output-vt2imy","header-container":"header-container-jfozPy",headerContainer:"header-container-jfozPy",pad:"pad-TTK4CO",caption:"caption-RN84wj",translateServicePopover:"translateServicePopover-mNkMpW","stream-message-container":"stream-message-container-NDGCCQ",streamMessageContainer:"stream-message-container-NDGCCQ","llm-context-tip":"llm-context-tip-tEW0B1",llmContextTip:"llm-context-tip-tEW0B1",result:"result-Aj5YF_",operations:"operations-DAZHyl","continue-in-chat":"continue-in-chat-YDDLlF",continueInChat:"continue-in-chat-YDDLlF",right:"right-DhgCWf","operation-btn":"operation-btn-LsYdQO",operationBtn:"operation-btn-LsYdQO",prev:"prev-ACSjL9",next:"next-gAQstT",actionButton:"actionButton-h3aMjj",active:"active-VgYVkP",audioButton:"audioButton-SnEJdN",continueBtn:"continueBtn-W65oJX","operations-next":"operations-next-DshKuZ",operationsNext:"operations-next-DshKuZ","learn-more":"learn-more-jr1L_0",learnMore:"learn-more-jr1L_0",btn:"btn-A1sytI",dropdown:"dropdown-kJF1Mr","drop-item":"drop-item-iFBkm6",dropItem:"drop-item-iFBkm6","login-content":"login-content-wboNao",loginContent:"login-content-wboNao","login-btn":"login-btn-SRkx5R",loginBtn:"login-btn-SRkx5R","panel-wrapper":"panel-wrapper-EhSbKE",panelWrapper:"panel-wrapper-EhSbKE","icon-arrow-right":"icon-arrow-right-ojGboP",iconArrowRight:"icon-arrow-right-ojGboP","language-selector":"language-selector-gcO6os",languageSelector:"language-selector-gcO6os","language-options":"language-options-sGbzlT",languageOptions:"language-options-sGbzlT","language-wrapper":"language-wrapper-yyE_pK",languageWrapper:"language-wrapper-yyE_pK","writing-operations":"writing-operations-v1qhOA",writingOperations:"writing-operations-v1qhOA","icon-btn":"icon-btn-Vw1C1K",iconBtn:"icon-btn-Vw1C1K","disabled-caption":"disabled-caption-uAQqOr",disabledCaption:"disabled-caption-uAQqOr","activelink-hover-animation":"activelink-hover-animation-MRzecf",activelinkHoverAnimation:"activelink-hover-animation-MRzecf"},Fp=(0,f.forwardRef)(((e,t)=>{var n;const{className:i,tooltip:o,icon:s,children:r,tooltipOptions:l={},iconPosition:c,onClick:d,onPointerDown:u,testid:h}=e,m=null===(n=(0,f.useContext)(Ca.A))||void 0===n?void 0:n.getPopupContainer,p=(0,Le.jsx)(Be.$n,{"data-testid":h,ref:t,type:"secondary",theme:"borderless",icon:s,onClick:d,onPointerDownCapture:u,className:ie()(Dp.actionButton,i),iconPosition:c,children:r});return o?(0,Le.jsx)(Be.m_,(0,a.A)((0,a.A)({content:o,spacing:{y:10,x:0},getPopupContainer:e.getPopupContainer||m},l),{},{children:p})):p}));Fp.displayName="TooltipButton";var Up=n(28159);const Hp=e=>{if(e===ml.EU.translate){var t;let e;const{inputTextLang:n}=Np.t_.getState(),i=(0,J.TK)("transPreferConfig");return e=n?null===(t=i.langMap)||void 0===t?void 0:t[n]:void 0,e||(0,J.TK)("translateLanguage")}};function zp(e){return e&&(0,Up.A)(e)?e.replace(/^"""|"""$/gi,""):e}var Op=n(93215),qp=n(2248);function Vp(e){(0,qp.Im)()||null==e||e.dispatchEvent(new Event("input",{bubbles:!0}))}class $p{constructor(e){if((0,y.A)(this,"selectionEl",null),(0,y.A)(this,"containerEl",null),(0,y.A)(this,"range",void 0),(0,y.A)(this,"_canInsert",!1),this._canInsert=!1,e&&e.rangeCount>0){const t=e.getRangeAt(0);this.range=t.cloneRange();const n=t.startContainer.childNodes[t.startOffset]||t.startContainer;if(this.selectionEl=(0,le.A)(n,"tagName")?n:n.parentElement,!this.selectionEl)return;const i=(0,rt.QN)(this.selectionEl)?this.selectionEl:(0,rt.mn)(this.selectionEl);i&&(0,rt.ow)(i)&&(this.containerEl=i,this._canInsert=!0)}}insert(e,t=Tc.cD.replace_selection,n=""){if(!this.containerEl)return;const i=this.containerEl,o=document||"#document"===i.getRootNode().nodeName&&i.getRootNode();if((0,rt.Ku)(i)){const n=i.selectionEnd;if(t===Tc.cD.replace_selection)i.setRangeText(e);else if(null!==n){const t=i.value[n-1]||"";t&&!/[\n\r\t]/gi.test(t)&&(e=`${e}`),i.setRangeText(e,n,n,"end"),i.setSelectionRange(n,n+e.length)}i.focus()}else{if(i.focus(),this.range){const e=o.getSelection();null==e||e.removeAllRanges(),null==e||e.addRange(this.range)}t===Tc.cD.insert_below&&(i.textContent&&(e=`${e}`),n&&(e=`${n}${e}`)),t===Tc.cD.insert_below&&i.textContent&&(e=`${e}`),setTimeout((()=>(0,rt.Ig)(e,i)),0)}setTimeout((()=>Vp(i)),0)}select(e=0,t=0){const n=this.containerEl;if(n)if(n.focus(),(0,rt.Ku)(n))n.setSelectionRange(e,t||n.value.length,"forward");else{const e=new Range;e.selectNodeContents(n);const t=window.getSelection();null==t||t.removeAllRanges(),null==t||t.addRange(e),this.range=e.cloneRange()}}get canInsert(){return this._canInsert}}const Kp={baseInfo:Lp.Ws,selectionHelper:null},Wp=(0,f.createContext)(Kp),Gp=()=>(0,f.useContext)(Wp);function Zp(e){const t=(0,at.Uk)();return(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsx)(Be.$n,{type:"secondary",onClick:t=>{e.onClickButton(Tc.cD.insert_below,t)},className:Dp["icon-btn"],icon:(0,Le.jsx)(ze.H9,{className:Dp.icon}),"data-testid":"rewrite-insert-btn",children:(0,Le.jsx)("span",{className:ie()(Dp.caption),children:t("doc_editor_ai_skill_panel_insert")})}),(0,Le.jsx)(Be.$n,{type:"secondary",onClick:t=>{e.onClickButton(Tc.cD.replace_selection,t)},className:Dp["icon-btn"],icon:(0,Le.jsx)(ze.K2,{className:Dp.icon}),"data-testid":"rewrite-replace-btn",children:(0,Le.jsx)("span",{className:ie()(Dp.caption),children:t("doc_editor_ai_skill_panel_replace")})})]})}function Yp(e){const t=(0,at.Uk)(),{currentAction:n}=e;return(0,Le.jsx)(ya.c,{type:"quartary",icon:n===ml.EU.explain?(0,Le.jsx)(be.eKK,{}):(0,Le.jsx)(be.EGn,{}),size:"small",onClick:e.onClick,children:t(n===ml.EU.explain?"flow_web_ext_action_popup_search":"flow_web_ext_action_popup_continue")})}const Jp=e=>{const{currentAction:t,messageId:n,message:i,onClickWritingAction:o,style:s}=e,{selectionHelper:a,baseInfo:r}=Gp();return(0,f.useEffect)((()=>{(0,Op.ih)({button_name:Tc.cD.insert_below,show_from:_.Z5.selectAssistantResult}),(0,Op.ih)({button_name:Tc.cD.replace_selection,show_from:_.Z5.selectAssistantResult})}),[]),(0,Le.jsx)("div",{style:s,className:Dp["writing-operations"],onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},onMouseUp:e=>{e.preventDefault(),e.stopPropagation()},children:null!=a&&a.canInsert?(0,Le.jsx)(Zp,{onClickButton:(e,s)=>{return(l=e,e=>{e.preventDefault(),e.stopPropagation(),(0,Op.aX)({button_name:l,action_name:t,message_id:n});const s=zp(r.text);null==a||a.insert(i,l,s),null==o||o(l)})(s);var l}}):(0,Le.jsx)(Yp,{currentAction:t,onClick:e.onMainButtonClick})})};function Qp(e){const{testid:t,tooltip:n,successTooltip:i,successDelay:o=1e3,className:s,onCopyClick:a}=e,[r,l]=(0,f.useState)(!1);return(0,f.useEffect)((()=>{r&&setTimeout((()=>{l(!1)}),o)}),[r]),(0,Le.jsx)(Fp,{testid:t,className:s,tooltip:r?i:n,icon:r?(0,Le.jsx)(ze.w_,{}):(0,Le.jsx)(ze.jw,{}),onClick:()=>{r||!0===(null==a?void 0:a())&&l(!0)}})}const Xp=rr().bind(Dp),eg=(0,l.jco)(),tg=e=>{const t=(0,f.useRef)(null),{regenerateDisable:n,onCopy:i,onRegenerate:o}=e,s=(0,g.B)(),{currentAction:a}=(0,Np.t_)(),{CollectionIcon:r,onCollectionClick:l,collected:c}=_a({getCollectionParam:()=>{const e=a===ml.EU.translate;return{collectionType:e?mt.X.TranslateResult:mt.X.ExplainResult,collectFrom:e?pt.vP.highlight_result_card_translate:pt.vP.highlight_result_card_explain}}});(0,f.useEffect)((()=>{if((a===ml.EU.explain||a===ml.EU.translate)&&!eg&&(0,vt.ku)()){const e=a===ml.EU.translate;(0,pt.ae)(e?pt.vP.highlight_result_card_translate:pt.vP.highlight_result_card_explain,e?pt.p6.TranslateResult:pt.p6.ExplainResult)}}),[eg,a]);const d=(()=>{const[e,t]=(0,f.useState)(""),{actionMessages:n,currentAction:i,messageCursor:o,inputText:s}=(0,Np.t_)(),a=(0,f.useMemo)((()=>{var e,t;return null!==(t=(null!==(e=n[i])&&void 0!==e?e:[])[o])&&void 0!==t?t:""}),[n,o]),r=(0,ha.P)((e=>e.messages)),l=(0,f.useMemo)((()=>r[a]||{}),[r,a]);return(0,f.useEffect)((()=>{i===ml.EU.translate?t(s):t(l.text||"")}),[l]),e})();return(0,Le.jsxs)("div",{className:Xp("operations-next"),ref:t,children:[(0,Le.jsx)("div",{className:Xp("learn-more"),children:(0,Le.jsx)(Jp,{currentAction:a,message:e.message.text||"",messageId:e.message.id,onMainButtonClick:e.onMainButtonClick})}),(0,Le.jsxs)("div",{className:Xp("actions"),children:[(0,Le.jsx)(Na,{testid:"select-output-panel-listen-operation",text:d,className:Xp(Dp.actionButton,Dp.audioButton),style:{fontSize:16},getPopupContainer:()=>t.current}),(0,vt.ku)()&&(0,Le.jsx)(Fp,{testid:"select-output-panel-collect-operation",tooltip:s(c?"bookmarks_list_remove_hover":"flow_web_ext_action_bookmarks"),icon:(0,Le.jsx)(r,{}),onClick:l,getPopupContainer:()=>t.current}),(0,Le.jsx)(Qp,{testid:"select-output-panel-copy-operation",tooltip:s("flow_web_ext_copy","\u590d\u5236\u5185\u5bb9"),successTooltip:s("toast_copy_success","\u590d\u5236\u6210\u529f"),onCopyClick:i,className:Dp.headerBtn}),(0,Le.jsx)(Fp,{testid:"select-output-panel-rewrite-operation",tooltip:s(!0===n?"maximum_regenerate_reached":"regenerate_button_hover_text"),icon:(0,Le.jsx)(ze.eD,{}),onClick:()=>{!0!==n&&o()},getPopupContainer:()=>t.current})]})]})},ng="suggest-message-container-XdB13M",ig="suggest-message-OfZEb5",og=({suggestMessageListWithStatus:e,onClick:t,className:n})=>{const{failed:i,suggests:o=[]}=e||{};return i||0===o.length?null:(0,Le.jsx)("div",{className:ng,"data-testid":"suggest-message-container",children:o.map(((e,i)=>(0,Le.jsxs)("div",{className:ie()(ig,n),onClick:()=>t(e,i),children:[(0,Le.jsx)("span",{style:{marginRight:8},children:e}),(0,Le.jsx)(be.B94,{})]},i)))})};var sg=n(64903);const ag=function(){var e=(0,r.A)((function*(e){Gd.on.setState({floatingCardVisible:!1,summaryActionVisible:!1});const{convId:t,convType:n,mainBotId:i}=(0,Oh.IK)(),o={text:e,scene:kr.sJ.suggested_prompts,extraExt:{need_create_thread:n===bu.H.NewThread?"1":"0",browser_language:(0,No.wz)((0,J.TK)("uiLanguage"))},ctx:(0,Zd.Pe)(n,t,i)};yield(0,Zd.Bc)(n,o)}));return function(t){return e.apply(this,arguments)}}(),rg=()=>{var e,t;const{actionMessages:n,currentAction:i,messageCursor:o,setBoxVisible:s,contextText:l,search:c,regenerate:d,retry:u,inputText:h}=(0,Np.t_)(),m=(0,f.useRef)(h);m.current=h||m.current;const p=(0,f.useRef)(),g=(0,ha.P)((e=>e.messages)),x=null!==(e=n[i])&&void 0!==e?e:[],y=null!==(t=x[o])&&void 0!==t?t:"",{text:b="",body:w}=g[y]||{},[C]=(0,v.Y)("selectTranslateService"),A=()=>{var e;return!(null===(e=(0,J.TK)("authInfo"))||void 0===e||!e.isAuthenticated)||((0,Ce.DT)({trackMeta:{login_entrance:"highlight_result"}}),!1)},S=function(){var e=(0,r.A)((function*(){var e,t,n;let i=[null==w||null===(e=w.message)||void 0===e?void 0:e.reply_id].concat(x.map((e=>g[e])).map((e=>{var t;return null===(t=e.body)||void 0===t||null===(t=t.message)||void 0===t?void 0:t.message_id}))).filter(Boolean),o=null!==(t=null==w||null===(n=w.message)||void 0===n?void 0:n.message_id)&&void 0!==t?t:"0";var s,a,r,l;p.current&&(i=[null===(s=p.current)||void 0===s||null===(s=s.body)||void 0===s||null===(s=s.message)||void 0===s?void 0:s.reply_id,null===(a=p.current)||void 0===a||null===(a=a.body)||void 0===a||null===(a=a.message)||void 0===a?void 0:a.message_id].filter(Boolean),o=null!==(r=null===(l=p.current)||void 0===l||null===(l=l.body)||void 0===l||null===(l=l.message)||void 0===l?void 0:l.message_id)&&void 0!==r?r:"0");const c={messageIds:i,switchMessageId:o};yield(0,Zd.ci)(c)}));return function(){return e.apply(this,arguments)}}(),I=function(){var e=(0,r.A)((function*(){var e,t;A()&&((0,Op.oR)({message_id:null!==(e=null==w||null===(t=w.message)||void 0===t?void 0:t.message_id)&&void 0!==e?e:"0",skill_name:i}),s(!1),Gd.on.setState({floatingCardVisible:!1,summaryActionVisible:!1}),yield S(),dn.l.getState().setIsShowSidebar(!0,_.cz.selectAssistantResult))}));return function(){return e.apply(this,arguments)}}(),k=function(){var e=(0,r.A)((function*(e,t){var n;(0,Op.Rr)({message_id:null==w||null===(n=w.message)||void 0===n?void 0:n.message_id,click_position:`${t+1}`}),A()&&(s(!1),dn.l.getState().setIsShowSidebar(!0,_.cz.searchAssistant),yield(0,Yd.Z)(),yield S(),yield ag(e))}));return function(t,n){return e.apply(this,arguments)}}();return(0,f.useEffect)((()=>{p.current=void 0}),[i]),{syncToChatMessage:p,doSearch:e=>{const t=(null==e?void 0:e.language)||Hp(i);c((0,a.A)({enter_chat_method:"highlight_search_result_tool",scene:kr.sJ.highlight_search_result_tool,sec_scene:kr._o.highlight_search_result_ask,contextText:l,translateService:C,language:t,answerWithSuggest:i===ml.EU.explain},e))},handleAISearch:()=>{var e,t;A()&&((0,Op.Dp)({message_id:null!==(e=null==w||null===(t=w.message)||void 0===t?void 0:t.message_id)&&void 0!==e?e:"0"}),(0,Ip.RX)(m.current),s(!1))},handleContinueInChat:I,handleCopy:()=>{var e;let t=!1;return t=i===ml.EU.translate?es()((0,sg.YA)(b)):es()(b),(0,Op.iN)({message_id:null==w||null===(e=w.message)||void 0===e?void 0:e.message_id,skill_name:i}),t},handleRegenerate:()=>{var e,t;d({replyId:null==w||null===(e=w.message)||void 0===e?void 0:e.reply_id,enter_chat_method:"highlight_search_result_tool",scene:"highlight_search_result_tool",answerWithSuggest:i===ml.EU.explain}),(0,Op.VM)({message_id:null==w||null===(t=w.message)||void 0===t?void 0:t.message_id,skill_name:i})},handleRetry:()=>{var e,t;u({replyId:null==w||null===(e=w.message)||void 0===e?void 0:e.message_id,enter_chat_method:"highlight_search_result_tool",scene:"highlight_search_result_tool",answerWithSuggest:i===ml.EU.explain}),(0,Op.t7)({message_id:null==w||null===(t=w.message)||void 0===t?void 0:t.message_id,skill_name:i})},handleClickFollowUpQuestion:k}},lg=e=>{const{render:t}=e,{renderHeader:n,renderStreamMessage:i}=t;return(0,Le.jsxs)(Le.Fragment,{children:[n(),i({textFormatter:e=>zp(e.text)||""})]})},cg=e=>(0,Le.jsx)(lg,(0,a.A)({},e));var dg=n(80944),ug=n(3400),hg=n(51022),mg=n(61624),pg=n(39325);const gg=rr().bind({"cici-ext-container":"cici-ext-container-IYCEkb",ciciExtContainer:"cici-ext-container-IYCEkb","inactivelink-hover-animation":"inactivelink-hover-animation-a8Gq0G",inactivelinkHoverAnimation:"inactivelink-hover-animation-a8Gq0G","notactivelink-hover-animation":"notactivelink-hover-animation-fbsD3w",notactivelinkHoverAnimation:"notactivelink-hover-animation-fbsD3w","light-click-animation":"light-click-animation-JlAsqg",lightClickAnimation:"light-click-animation-JlAsqg","click-animation":"click-animation-MBAg5r",clickAnimation:"click-animation-MBAg5r","semi-animation-rotate":"semi-animation-rotate-CbK91s",semiAnimationRotate:"semi-animation-rotate-CbK91s","inactive-btn-hover-animation":"inactive-btn-hover-animation-nUPiTZ",inactiveBtnHoverAnimation:"inactive-btn-hover-animation-nUPiTZ","cici-ext-always-dark":"cici-ext-always-dark-Ha0zoa",ciciExtAlwaysDark:"cici-ext-always-dark-Ha0zoa","cici-ext-always-light":"cici-ext-always-light-BtPMDH",ciciExtAlwaysLight:"cici-ext-always-light-BtPMDH",ellipsis:"ellipsis-JLALe7",select:"select-COUz7N","option-container":"option-container-DBZEFh",optionContainer:"option-container-DBZEFh","language-local":"language-local-TeDsvm",languageLocal:"language-local-TeDsvm","language-setting":"language-setting-qzXXeo",languageSetting:"language-setting-qzXXeo","selected-option":"selected-option-by2wk3",selectedOption:"selected-option-by2wk3","activelink-hover-animation":"activelink-hover-animation-aHHsTw",activelinkHoverAnimation:"activelink-hover-animation-aHHsTw"}),vg=({testid:e,languageList:t,onLanguageChange:n,initialLanguage:i,getPopupContainer:o})=>{const s=t.length>0,a=(0,f.useMemo)((()=>{var e;const n=t.find((e=>e.language_code===i));return null!==(e=null==n?void 0:n.language_loc)&&void 0!==e?e:i}),[t,i]);return(0,Le.jsx)(Be.l6,{value:a,clickToHide:!0,style:{flex:"1"},onChange:n,getPopupContainer:o,dropdownClassName:gg("select"),suffix:(0,Le.jsx)(ze.R0,{style:{marginRight:6}}),showArrow:!1,disabled:!s,position:"bottomRight","data-testid":e,children:t.map((({language_loc:e,language_code:t,language:n})=>{const o=t===i;return(0,Le.jsx)(Be.l6.Option,{showTick:!1,value:t,children:(0,Le.jsxs)("div",{className:gg("option-container"),"data-lang-option":t,"data-testid":"language-option",children:[(0,Le.jsxs)("div",{children:[(0,Le.jsx)("div",{"data-testid":"language-local",className:gg("language-local",{"selected-option":o}),children:e}),t!==No.Aq&&(0,Le.jsx)("div",{className:gg("language-setting"),children:n})]}),(0,Le.jsx)("div",{children:o&&(0,Le.jsx)(ze.Tf,{})})]})},n+t)}))})},fg=rr().bind(Dp),_g=(0,l.jco)(),xg=()=>{const e=(0,g.B)(),[t,n]=(0,f.useState)(!0);(0,f.useEffect)((()=>{const e=()=>{(0,J.vE)("transPreferConfig",{tipShown:!0},!0)};return setTimeout((()=>{e(),n(!1)}),5e3),()=>e()}),[]);const i=(0,f.useRef)(null);return(0,Le.jsx)("div",{style:{width:" 100%",position:"absolute",left:0,top:0},ref:i,children:(0,Le.jsx)(Be.m_,{trigger:"custom",visible:t,getPopupContainer:()=>i.current,style:{fontSize:11},content:e("flow_web_ext_action_popup_translate_hover_preference"),children:(0,Le.jsx)("div",{style:{width:"100%"}})})})},yg=({handleTranslate:e,style:t})=>{var n;const{translateLanguage:i,setStorageLanguage:o}=(()=>{const[e,t]=(0,v.Y)("translateLanguage"),n=(0,Np.t_)((e=>e.inputTextLang)),[i]=(0,v.Y)("transPreferConfig"),[o,s]=(0,f.useMemo)((()=>{var o;return[(null===(o=i.langMap)||void 0===o?void 0:o[n||""])||e,e=>{t(e),n&&(0,J.vE)("transPreferConfig",{langMap:{[n]:e}},!0)}]}),[e,i,n]);return{translateLanguage:o,setStorageLanguage:s}})(),s=(0,Po.e)(),{inputText:a}=(0,Np.t_)(),r=(0,g.B)(),l=(0,f.useRef)(a),c=(0,f.useRef)(null),[d,u]=(0,f.useState)(!1),h=null===(n=(0,v.Y)("transPreferConfig")[0])||void 0===n?void 0:n.tipShown;return(0,Le.jsxs)("div",{className:fg("language-options"),style:t,ref:c,children:[(0,Le.jsx)("div",{className:fg("language-wrapper"),style:{flex:"1",fontSize:_g?"15px":"12px",height:_g?"34px":"28px"},children:r("flow_web_ext_action_popup_autodetect")}),(0,Le.jsx)(ze.hI,{className:fg("icon-arrow-right")}),(0,Le.jsxs)("div",{className:fg("language-selector",{pad:_g}),style:{flex:"1"},children:[d&&!h?(0,Le.jsx)(xg,{}):null,(0,Le.jsx)(vg,{testid:"translate-language-selector",languageList:s||[],initialLanguage:i,onLanguageChange:t=>{const n=`${t}`;(0,Mo.Su)({before_language_result:i,after_language_result:n,scene:Mo.jv.highlight_result_choose}),u(!0),o(n),e({text:l.current,language:n,enter_chat_method:"highlight_search_result_tool",scene:"highlight_search_result_tool",abortOptions:{reason:"switch_language",from:i,to:n}})},getPopupContainer:()=>null==c?void 0:c.current})]})]})},bg="wrapper-e9DSfj",wg="caption-D91XEB",Cg="examples-A7UA7z",Ag="example-RpplVd",Sg="sentence-QlzJFY",Ig="translation-a5q04G",kg=e=>{const{style:t,examples:n,loading:i}=e,o=(0,g.B)();return(0,Le.jsxs)("div",{className:bg,style:t,children:[(0,Le.jsx)("div",{className:wg,children:o("flow_web_ext_action_popup_translate_example")}),i&&(0,Le.jsx)("div",{className:"pt-10",children:(0,Le.jsx)(br.c,{})}),!i&&(0,Le.jsx)("div",{className:Cg,"data-flow-selectable":"true","data-testid":"select-output-panel-translate-example-container",children:n.map((({sentence:e,translation:t})=>(0,Le.jsxs)("div",{className:Ag,children:[(0,Le.jsx)("div",{className:Sg,children:e}),(0,Le.jsx)("div",{className:Ig,children:t})]},`${e}%%${t}`)))})]})},jg="wrapper-P0EoYL",Eg=({text:e,style:t})=>(0,Le.jsx)("div",{className:jg,style:t,children:e});var Tg=n(79279),Ng=n(32447);const Mg=e=>{const{action:t,ready:n,render:i,doSearch:o,range:s,contextText:r,syncToChatMessage:l,inputText:c,isDone:d}=e,[u,h]=(0,f.useState)(!1),[m,p]=(0,f.useState)(!1),[g,_]=(0,f.useState)([]),[x,y]=(0,f.useState)(!1),{renderHeader:b,renderStreamMessage:w,renderLLMContextTip:C}=i,[A,S]=(0,v.Y)("selectTranslateService"),I=(0,f.useRef)(null),k=(0,ug.qP)(c),j=e=>{if(l.current=void 0,s){const n=(0,sg.l$)(s),i=(null==e?void 0:e.language)||Hp(t);n&&(0,sg.Oi)({encodeText:n,lang:i,translateService:(null==e?void 0:e.translateService)||A,contextText:r}).then((e=>l.current=e))}};(0,Tg.H)((()=>{x&&(0,et.s)("choose_translate_service",{current_page:(0,pt.p$)()})}),[x]),(0,Tg.H)((()=>{(0,et.s)("choose_translate_service_result",{value:A,click_from:"highlight_translate",current_page:(0,pt.p$)()})}),[A]);const E=e=>{if(0!==(null==e?void 0:e.code))return;const{found:t,example_sentences:n}=e.data;h(t),_(n)},T=(e,t)=>{_([]);try{((e,t)=>{Ng.B.fetch({req:{url:`${Un.kD}/plugin/dict/word`,body:{content:e,language_target:t}}},{onOpen:()=>{p(!0)},onUpdate:e=>{const{body:t}=e;E(t)},onDone:e=>{const{body:t}=e;E(t),p(!1)},onError:()=>{p(!1),h(!1)},onAbort:()=>{p(!1),h(!1)}})})(e,t)}catch(n){_([])}},N=e=>{o((0,a.A)((0,a.A)({},e),{},{sec_scene:kr._o.highlight_search_result_translate})),j(e)},M=e=>{S(e),N({translateService:e}),y(!1)};(0,f.useEffect)((()=>{if(n){j();const e=Hp(t);e&&T(k,e)}}),[n]);const R=m?u:u&&(0,dg.A)(g)>0;return(0,Le.jsxs)("div",{ref:I,children:[b((0,Le.jsx)(Be.AM,{trigger:"custom",position:"bottomRight",visible:x,onClickOutSide:()=>y(!1),content:(0,Le.jsx)(hg.A,{selectedService:A,onSelectService:M,services:pg.E}),className:"rounded-[16px]",getPopupContainer:()=>I.current,children:(0,Le.jsx)("div",{onClick:()=>y(!x),children:(0,Le.jsx)(mg.A,{mode:"logo",translateService:A})})})),n&&(0,Le.jsx)(yg,{style:{marginTop:10},handleTranslate:e=>{const t=null==e?void 0:e.language;t&&T(k,t),N(e)}}),(0,Le.jsx)(Eg,{text:k,style:{marginTop:16}}),w({textFormatter:e=>{const{isDone:t}=e;let{text:n=""}=e;return t||(n=(0,ug.sh)(n)),(0,sg.q4)(n)}}),R&&(0,Le.jsx)(kg,{style:{marginTop:16},loading:m,examples:d?g:[]}),[we.c$.GPT,we.c$.DOUBAO].includes(A)&&C()]})},Rg=e=>{const{render:t,message:n}=e,{renderLLMContextTip:i}=t,{body:o,suggests:s=[],isDone:r}=n||{},l=(0,f.useRef)(0);return(0,f.useEffect)((()=>{var e;if(r&&s.length)return(0,Op.DM)({prompt_cnt:s.length,message_id:null==o||null===(e=o.message)||void 0===e?void 0:e.message_id}),()=>{l.current=0}}),[r]),(0,f.useEffect)((()=>{if(s.length){for(let t=l.current;t<s.length;t++){var e;(0,Op.T)({prompt_position:`${t+1}`,message_id:null==o||null===(e=o.message)||void 0===e?void 0:e.message_id})}l.current=s.length}}),[s]),(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsx)(lg,(0,a.A)({},e)),i()]})},Lg={[ml.EU.translate]:Mg,[ml.EU.explain]:Rg,[ml.EU.rewrite]:cg,[ml.EU.grammar]:cg,[ml.EU.adjust_skill]:cg},Pg=e=>(0,Le.jsx)("svg",(0,a.A)((0,a.A)({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 16 16"},e),{},{children:(0,Le.jsx)("path",{fill:"currentColor",d:"M8.1 13.76a5.4 5.4 0 0 1-2.19-.445 5.7 5.7 0 0 1-1.81-1.223 5.8 5.8 0 0 1-1.227-1.803 5.5 5.5 0 0 1-.44-2.195q0-1.162.44-2.184A5.9 5.9 0 0 1 4.095 4.1a5.7 5.7 0 0 1 1.81-1.222 5.4 5.4 0 0 1 2.189-.446q1.162 0 2.19.446 1.031.44 1.809 1.222.782.783 1.227 1.81.446 1.02.446 2.184 0 1.167-.446 2.195a5.82 5.82 0 0 1-3.031 3.026 5.4 5.4 0 0 1-2.19.445m0-1.244q.917 0 1.716-.342a4.5 4.5 0 0 0 1.413-.945 4.365 4.365 0 0 0 1.293-3.135q0-.919-.348-1.717a4.4 4.4 0 0 0-.95-1.413 4.37 4.37 0 0 0-3.13-1.293 4.35 4.35 0 0 0-1.722.342 4.5 4.5 0 0 0-1.408.951 4.372 4.372 0 0 0-1.282 3.13q0 .923.337 1.727a4.5 4.5 0 0 0 .95 1.408q.61.603 1.408.945a4.35 4.35 0 0 0 1.722.342m-.951-1.478a.425.425 0 0 1-.45-.44q-.002-.184.129-.31a.45.45 0 0 1 .32-.124h.625V8.056h-.527a.46.46 0 0 1-.32-.12.42.42 0 0 1-.13-.32q0-.186.13-.31a.45.45 0 0 1 .32-.125h1.027q.239 0 .364.157a.62.62 0 0 1 .125.408v2.418h.56q.19 0 .32.125.13.124.13.31a.425.425 0 0 1-.45.44zm.929-4.656a.74.74 0 0 1-.533-.217.73.73 0 0 1-.223-.532q0-.32.223-.538a.73.73 0 0 1 .533-.223q.315 0 .532.223a.73.73 0 0 1 .217.538.74.74 0 0 1-.217.532.72.72 0 0 1-.532.217",opacity:.8})})),Bg="output-Yv5fff",Dg="header-container-W750nM",Fg="caption-j8fz7d",Ug="stream-message-container-U2Nsam",Hg="llm-context-tip-tYpfwb",zg="result-flKBGi",Og=()=>{var e,t;const{actionMessages:n,currentAction:i,range:o,messageCursor:s,clearMessages:l,setBoxVisible:c,contextText:d,tone:u,checkAndSetInputLang:h,inputText:m}=(0,Np.t_)(),[p,_]=(0,f.useState)(!1),x=(0,g.B)(),y=(0,f.useRef)(m),b=y.current,w=(0,ha.P)((e=>e.messages)),C=null!==(e=n[i])&&void 0!==e?e:[],A=null!==(t=C[s])&&void 0!==t?t:"",{isDone:S,suggests:I=[]}=w[A]||{},[k]=(0,v.Y)("editingPopupActions"),[j]=(0,v.Y)("readingPopupActions"),{syncToChatMessage:E,doSearch:T,handleAISearch:N,handleContinueInChat:M,handleCopy:R,handleRegenerate:L,handleRetry:P,handleClickFollowUpQuestion:B}=rg(),D=(0,f.useMemo)((()=>{var e;const t=(0,Bp.A)([...k.actionList,...k.moreActionList,...j.actionList,...j.moreActionList],(e=>e.id===i)),n=(0,Pp.A)(ml.YN,(e=>e.id===i));return null!==(e=t[0])&&void 0!==e&&e.name?n||t[0].confId?x(t[0].name):t[0].name:""}),[i,k,j]);(0,f.useEffect)((()=>{m&&(y.current=m)}),[m]),(0,f.useEffect)((()=>{try{(0,r.A)((function*(){i===ml.EU.translate&&(yield h()),_(!0),T({sec_scene:`highlight_search_result_${i}`})}))()}catch(e){ue.vF.persist.error({eventName:"[SEARCH_CORE] - SEARCH",error:e})}return()=>{l()}}),[]);const F=Lg[i]||lg;const U={message:w[A],action:i,setBoxVisible:c,doSearch:T,ready:p,range:o,contextText:d,syncToChatMessage:E,inputText:b,isDone:Boolean(S),render:{renderHeader:(e=null)=>(0,Le.jsxs)("div",{className:Dg,children:[(0,Le.jsx)("div",{className:Fg,children:i===ml.EU.adjust_skill?null==u?void 0:u.show_name:D}),(0,Le.jsx)("div",{children:e})]}),renderStreamMessage:e=>{const{textFormatter:t,renderFollowupQuestions:n=!0}=e||{};return(0,Le.jsxs)("div",{"data-flow-selectable":"true",className:Ug,children:[(0,Le.jsx)(Sr,{className:zg,type:"selection",id:A,enableScroll:!0,onRetry:P,showShadow:!1,textFormatter:t,loadingStyle:"dot-flashing"}),n&&S&&(0,Le.jsx)(og,{suggestMessageListWithStatus:{suggests:I.filter((e=>e))},onClick:B})]})},renderLLMContextTip:()=>S?(0,Le.jsxs)("div",{className:Hg,style:{marginTop:12},children:[(0,Le.jsx)(Pg,{}),(0,Le.jsx)("span",{children:x("flow_web_ext_action_popup_translate_notice")})]}):null,renderSelectContentRef:e=>(0,Le.jsx)(Eg,{text:b,style:(0,a.A)((0,a.A)({},{marginTop:12}),null==e?void 0:e.style)})}};return(0,Le.jsxs)("div",{className:Bg,"data-testid":"select-box-container",children:[(0,Le.jsx)(F,(0,a.A)({},U)),S&&(0,Le.jsx)("div",{style:{marginTop:16},children:(0,Le.jsx)(tg,{message:w[A],regenerateDisable:C.length>=Un.ch,onMainButtonClick:()=>{i===ml.EU.explain?N():M()},onCopy:R,onRegenerate:L})})]})},qg=rr().bind(Dp),Vg=(0,l.jco)(),$g=()=>{const e=(0,g.B)(),t=(()=>{var e;const{actionMessages:t,currentAction:n,messageCursor:i}=(0,Np.t_)(),o=(0,ha.P)((e=>e.messages)),{isUnAuthorized:s}=o[(null===(e=t[n])||void 0===e?void 0:e[i])||""]||{};return(0,Dl.vh)((0,Dl.OB)(n),s)})(),n=(0,Le.jsxs)("div",{className:qg("login-content"),children:[(0,Le.jsxs)("div",{className:qg("text"),children:["\u{1f389} ",e("flow_web_ext_login_note")]}),(0,Le.jsx)(Be.$n,{theme:"solid",type:"primary",className:qg("login-btn"),onClick:()=>(0,Ce.DT)({trackMeta:{login_entrance:"highlight_result"}}),children:e("flow_web_ext_login")})]});return(0,Le.jsx)("div",{className:qg("container"),style:Vg?{gap:"10px"}:{},children:t?(0,Le.jsx)(Og,{}):n})};var Kg=n(65643);const Wg=e=>{var t;const n=null===(t=(0,f.useContext)(Ca.A))||void 0===t?void 0:t.getPopupContainer,i=(0,Np.t_)((e=>e.setBoxVisible)),[o]=(0,f.useState)(e.selectionData),{top:s,left:r,width:l,height:c,clientBottom:d}=o,u={top:`${s+window.scrollY+5}px`,left:`${r+window.scrollX}px`,height:`${c}px`,width:`${l}px`},h=l/2;r+h<=210&&(u.left=`${210-h+window.scrollX}px`),d<300&&(u.top=s+window.scrollY+5+d-300+"px");const m={position:"relative",width:420,boxSizing:"border-box"},p=(0,fc.A)((()=>{i(!1)})),g=(0,Le.jsx)("div",{ref:p,onMouseDown:e=>{if(!function(e){let t=e.target;for(;t&&t!==e.currentTarget;){if("true"===t.getAttribute("data-flow-selectable"))return!0;t=t.parentElement}return!1}(e))return e.preventDefault(),e.stopPropagation(),!1},children:(0,Le.jsx)($g,{})});return(0,Le.jsx)(Be.AM,{content:g,trigger:"custom",visible:!0,autoAdjustOverflow:!0,getPopupContainer:n,onVisibleChange:e=>{i(e)},style:(0,a.A)({},m),className:Kg.A["popover-container"],children:(0,Le.jsx)("span",{style:(0,a.A)({position:"absolute",pointerEvents:"none"},u)})})};var Gg=n(56642),Zg=n(91865),Yg=n(87220);const Jg={npaliedit:5,gameplugin:5,npjlgplayer3:5,npqplug:5,npqbrowserplugin:5,"np-mswmp":3,npcombrg:3},Qg=Object.keys(Jg);function Xg(){const{userAgent:e}=navigator;if(/360se|360ee|qihu|qihu360|qhbrowser/i.test(e))return!0;try{const t=!!window.webkitRequestFileSystem,n=/Chrome\/([\d.]+)/.exec(e);if(t&&n&&n[1]){let e=0;return Array.from(navigator.plugins).some((t=>{e+=function(e){const t=Qg.find((t=>e.indexOf(t)>=0));return t&&Jg[t]||0}(t.filename)})),e>6}}catch(t){}return!1}const ev=e=>{var t;const[n,i]=(0,Np.t_)((e=>[e.barVisible,e.barFakeHide]),Gg.x),o=null===(t=Gp().selectionHelper)||void 0===t?void 0:t.canInsert,{top:s,left:r,width:l,height:c}=e.selectionData,d=(0,qp.Im)()||(0,Zg.UP)()||Xg(),u=d?5:-5,h=d?"bottom":"top",m={top:`${s+window.scrollY+u}px`,left:`${r+window.scrollX}px`,height:`${c}px`,width:`${l}px`};(0,f.useEffect)((()=>{n&&(0,Op._B)()}),[n]);const[p]=(0,v.Y)("selectBarOnlyIcon"),[g]=(0,v.Y)("editingPopupActions"),[_]=(0,v.Y)("readingPopupActions"),x=(0,f.useMemo)((()=>[...[...ml.y3].map((e=>ml.YN[e])),...o?g.actionList:_.actionList]),[o,g,_]),y=(0,f.useMemo)((()=>o?g.moreActionList:_.moreActionList),[o,g,_]);return(0,Le.jsx)(Yg.t,{selectBarOnlyIcon:p,availableActionList:x,moreActionList:y,visible:n,position:h,isAliginLeft:!0,rePosKey:JSON.stringify(m),autoAdjustOverflow:!0,style:{visibility:i?"hidden":"visible"},children:(0,Le.jsx)("span",{style:(0,a.A)({position:"absolute",pointerEvents:"none"},m)})})},tv=function(){var e=(0,r.A)((function*(e=100){return yield new Promise((t=>setTimeout(t,e))),(()=>{var e,t;const{currentAction:n,actionMessages:i,messageCursor:o}=Np.t_.getState();return null!==(t=(null!==(e=i[n])&&void 0!==e?e:[])[o])&&void 0!==t?t:""})()}));return function(){return e.apply(this,arguments)}}();var nv=n(25740);const iv=()=>{const{barVisible:e,boxVisible:t,setBarVisible:n}=(0,Np.t_)(),i=function(){const[e,t]=(0,f.useState)(!1),{inputText:n}=(0,Np.t_)(),i=(0,dn.l)((e=>e.isShowQuick)),[o]=(0,v.Y)("quickDisabledHosts"),[s]=(0,v.Y)("quickDisabledAll"),a=null==o?void 0:o.includes(window.location.host);return(0,f.useEffect)((()=>{t(!!n&&(0,Lp.C3)([l.G2O]))}),[n]),!i||a||s||e}(),[o,s]=(0,f.useState)((new Date).getTime()),[c,d]=(0,f.useState)(!0),{baseInfo:u,isContextMenu:h}=Gp(),m=u.text,p=(0,f.useRef)(m);(0,f.useEffect)((()=>{const e=Boolean(m);n(e),p.current!==m&&(Gd.on.getState().setFloatingCardVisible(e),e&&Gd.on.getState().setSummaryActionVisible(!1),p.current=m)}),[m]);const g=function(){var e=(0,r.A)((function*(){const e=yield tv(),{currentAction:t}=Np.t_.getState(),n={button_name:t,message_id:e};if(t===ml.EU.translate){let e="Auto Detect";try{const t=yield(0,Se.od)(m);e=(0,nv.S)(t)||"Auto Detect"}catch(i){}return(0,a.A)({before_language:e,after_language:(0,J.TK)("translateLanguage")},n)}return n}));return function(){return e.apply(this,arguments)}}();return(0,f.useEffect)((()=>{t&&(d(!1),s((new Date).getTime()),g().then((e=>{(0,Op.x$)(e)}))),t||c||(0,Op.gy)({duration:(new Date).getTime()-o})}),[t]),t?(0,Le.jsx)(Wg,{selectionData:u}):!e||h||i?null:(0,Le.jsx)(ev,{selectionData:u})};var ov=n(43767);const sv=e=>(0,Le.jsxs)("svg",(0,a.A)((0,a.A)({xmlns:"http://www.w3.org/2000/svg",width:26,height:31,fill:"none",viewBox:"0 0 26 31"},e),{},{children:[(0,Le.jsxs)("g",{filter:"url(#mouse_svg__a)",children:[(0,Le.jsxs)("mask",{id:"mouse_svg__b",width:31.553,height:32.651,x:-7.203,y:-6.184,fill:"#000",maskUnits:"userSpaceOnUse",children:[(0,Le.jsx)("path",{fill:"#fff",d:"M-7.203-6.184H24.35v32.651H-7.203z"}),(0,Le.jsx)("path",{d:"m5.126 4.393 13.796 10.33-6.814 1.472-5.135 5.257z"})]}),(0,Le.jsx)("path",{fill:"#000",d:"m5.126 4.393 13.796 10.33-6.814 1.472-5.135 5.257z"}),(0,Le.jsx)("path",{fill:"#fff",d:"m5.126 4.393 1.198-1.601L2.642.035l.495 4.573zm13.796 10.33.423 1.954 4.287-.927-3.511-2.629zm-6.814 1.472-.422-1.954-.588.127-.42.43zm-5.135 5.257-1.988.216.456 4.214 2.963-3.032zM3.927 5.994l13.797 10.33 2.397-3.203L6.324 2.791zm14.572 6.773-6.813 1.474.845 3.91 6.814-1.474zm-7.821 2.03-5.135 5.258 2.86 2.795 5.136-5.257zm-1.716 6.44L7.114 4.177l-3.977.431 1.848 17.06z",mask:"url(#mouse_svg__b)"})]}),(0,Le.jsx)("defs",{children:(0,Le.jsxs)("filter",{id:"mouse_svg__a",width:25.311,height:30.169,x:.481,y:.035,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,Le.jsx)("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),(0,Le.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,Le.jsx)("feOffset",{dy:2.161}),(0,Le.jsx)("feGaussianBlur",{stdDeviation:1.08}),(0,Le.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,Le.jsx)("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.12 0"}),(0,Le.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_8224_23498"}),(0,Le.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_8224_23498",result:"shape"})]})})]})),av="summarizeOnboarding-bjgvPs",rv="card-VE1owl",lv="mouse-RYBJj5",cv="clickMe-_5_fCR",dv=({onClose:e})=>(0,Le.jsxs)("div",{className:av,children:[(0,Le.jsx)("div",{className:rv,children:(0,Le.jsx)(ov.A,{onSummarize:()=>{e()}})}),(0,Le.jsx)("div",{className:lv,children:(0,Le.jsx)(sv,{})}),(0,Le.jsx)("div",{className:cv,children:"Click here"})]});var uv=n(93196);const hv={"cici-ext-container":"cici-ext-container-tayrPu",ciciExtContainer:"cici-ext-container-tayrPu","inactivelink-hover-animation":"inactivelink-hover-animation-HRqUY6",inactivelinkHoverAnimation:"inactivelink-hover-animation-HRqUY6","notactivelink-hover-animation":"notactivelink-hover-animation-lomsAJ",notactivelinkHoverAnimation:"notactivelink-hover-animation-lomsAJ","light-click-animation":"light-click-animation-iZFe3U",lightClickAnimation:"light-click-animation-iZFe3U","click-animation":"click-animation-ahs_yg",clickAnimation:"click-animation-ahs_yg","semi-animation-rotate":"semi-animation-rotate-BL4TWA",semiAnimationRotate:"semi-animation-rotate-BL4TWA","inactive-btn-hover-animation":"inactive-btn-hover-animation-sxuohd",inactiveBtnHoverAnimation:"inactive-btn-hover-animation-sxuohd","cici-ext-always-dark":"cici-ext-always-dark-jf13oz",ciciExtAlwaysDark:"cici-ext-always-dark-jf13oz","cici-ext-always-light":"cici-ext-always-light-THiaY_",ciciExtAlwaysLight:"cici-ext-always-light-THiaY_",ellipsis:"ellipsis-U4IiL4",floatBtn:"floatBtn-CjYdnn",left:"left-XFEjgX",right:"right-EKGjLV",floatBtnWrapper:"floatBtnWrapper-D6516N",reverse:"reverse-ycUQf6",floatBtnList:"floatBtnList-iGgAce",floatBtnBrand:"floatBtnBrand-DnIPgk",show:"show-D28vkP",expand:"expand-uTJJDF",toolDivider:"toolDivider-BKJgFG",floatBtnPanelItem:"floatBtnPanelItem-efEC8W",toolContainer:"toolContainer-cfl5wc",tooltipContent:"tooltipContent-fNwI8X",text:"text-zqVVzW",shortcutText:"shortcutText-JG4XB8",floatBtnPanelItemBlock:"floatBtnPanelItemBlock-r06VPi",floatBtnPanelItemIcon:"floatBtnPanelItemIcon-l8mIbk",floatBtnPanelItemIconReverse:"floatBtnPanelItemIconReverse-T2KtUO",translateActiveIcon:"translateActiveIcon-xOVtGa",floatBtnPanelItemIconCollected:"floatBtnPanelItemIconCollected-zM3YDL",floatBtnPanelItemText:"floatBtnPanelItemText-GtXLVZ",floatBtnPanelItemTranslate:"floatBtnPanelItemTranslate-o3CGMp",floatBtnPanelItemLangSettingsIcon:"floatBtnPanelItemLangSettingsIcon-re_b2w",floatBtnPanelItemBlockWithSetting:"floatBtnPanelItemBlockWithSetting-IuDJ96",showLangSettingIcon:"showLangSettingIcon-CXn0JL",active:"active-wXvkas",showLangSettingIconReverse:"showLangSettingIconReverse-FnQPkq",floatBtnPanelLine:"floatBtnPanelLine-fGjRZ9",closeBtn:"closeBtn-MUUSAu",floatBtnClose:"floatBtnClose-f19uOF",floatBtnCloseIcon:"floatBtnCloseIcon-BIhnyV",floatBtnAvatar:"floatBtnAvatar-zS_g4L",float_btn_pad:"float_btn_pad-PTtRJh",floatBtnPad:"float_btn_pad-PTtRJh",float_btn_item_main:"float_btn_item_main-fqtDEM",floatBtnItemMain:"float_btn_item_main-fqtDEM",float_btn_item_main_icon:"float_btn_item_main_icon-rhepOY",floatBtnItemMainIcon:"float_btn_item_main_icon-rhepOY",float_btn_item_main_text:"float_btn_item_main_text-RdYjRN",floatBtnItemMainText:"float_btn_item_main_text-RdYjRN",float_btn_item_divider:"float_btn_item_divider-jP6dmI",floatBtnItemDivider:"float_btn_item_divider-jP6dmI",float_btn_item_setting:"float_btn_item_setting-jxDZ_f",floatBtnItemSetting:"float_btn_item_setting-jxDZ_f",highlight:"highlight-uNeLu1",hide:"hide-YZweor",shortcut:"shortcut-imnyIE","activelink-hover-animation":"activelink-hover-animation-EE8R_W",activelinkHoverAnimation:"activelink-hover-animation-EE8R_W"};var mv=n(51463),pv=n(41351);const gv=()=>{const e=(0,dn.l)((e=>e.setIsShowSidebar));return function(){var t=(0,r.A)((function*(t){try{var n;if((0,Ce.GT)(),(0,Dl.BB)({action:"web_summary",loginParams:{trackMeta:{login_entrance:"float_btn"}}}))return;(0,Dm.Ie)({button_name:_._h.summarizePage});const i=window.location.href;yield(0,mv.GA)();const o=(0,mv.CC)(),s=(0,No.wz)((0,J.TK)("uiLanguage"));e(!0,_.cz.clickSidebar);const a={title:null==o?void 0:o.title,url:i,content:null==o?void 0:o.textContent};Gd.on.getState().setFloatingCardVisible(!1),Gd.on.getState().setSummaryActionVisible(!1),yield(0,Yd.Z)();const{convId:r,convType:l,mainBotId:c}=(0,Oh.IK)(),d={text:i,extraExt:{origin:location.origin,browser_explain:JSON.stringify(a),llm_without_mem:"1",browser_language:s,flag_browser_plugin:"1",answer_with_suggest:"0",need_create_thread:l===bu.H.NewThread?"1":"0"},scene:kr.sJ.chat_action_bar,ctx:(0,Zd.Pe)(l,r,c)};ue.vF.persist.log({eventName:"summary_page_action",meta:{contentLength:null===(n=a.content)||void 0===n?void 0:n.length,from:"float-btn"}}),dn.l.getState().isSidePanelMode&&!pv._.isInSidePanel?Rp.IF.getState().type===dc.u9.pdf?(0,fm.cs)({name:"read-pdf",body:{url:i}}):(0,fm.cs)({name:"send-message-to-chat",body:{msg:d,chatType:l}}):Rp.IF.getState().type===dc.u9.pdf?(0,Hm.M)({url:i}):(Fl.Qz.create("cici_summary_page_action_perf",!0),(0,uv.C)(d,{chatType:l,sendMessageCallback:e=>{null==t||t((null==e?void 0:e[0].local_message_id)||"")}}))}catch(i){ue.vF.persist.error({eventName:"[FLOAT_BUTTON] - SUMMARIZE",error:i})}}));return function(e){return t.apply(this,arguments)}}()},vv=({btnListReverse:e,shortcutText:t})=>{const n=(0,g.B)(),i=gv();(0,f.useEffect)((()=>El.A.on("SUMMARIZE PAGE",El.x.PAGE,(()=>{i()}))),[i]);const o=(0,f.useRef)(null);return(0,Le.jsx)("div",{ref:o,className:hv.toolContainer,style:{margin:e?"6px 0 0 0":"0 0 6px 0"},children:(0,Le.jsx)(Be.m_,{content:(0,Le.jsxs)("div",{className:hv.tooltipContent,children:[(0,Le.jsx)("div",{className:hv.text,children:n("flow_web_ext_sidebar_summarize")}),(0,Le.jsx)("div",{className:hv.shortcutText,children:t})]}),position:"left",getPopupContainer:()=>o.current,children:(0,Le.jsx)("div",{className:hv.floatBtnPanelItemIcon,onClick:()=>{i()},"data-testid":"float-button-read-page",children:(0,Le.jsx)(be.oZ9,{})})})})},fv="onboarding-QNMbEE",_v=()=>{const[e,t]=(0,f.useState)(!0),n=(0,dn.l)((e=>e.setIsShowSidebar)),i=(0,dn.l)((e=>e.isSidePanelMode)),o=gv(),s=location.href===Xe.Z_,a=location.href===Xe.P9;if(a&&Um({current_page:Fm.ARTICLE_SUMMARIZE}),s&&Um({current_page:Fm.VIDEO_SUMMARIZE}),!e)return null;const r=()=>{(0,tn.z8)(_.Ur.clickChatFloatCard,{highlight_page:_.g6.webOther,button_name:ml.EU.read,module_name:Dm.S1.READ_PAGE,click_from:_.Z5.onboarding,current_page:Fm.ARTICLE_SUMMARIZE}),o(),history.pushState({},"",Xe.cT),t(!1)};return a?i?(r(),null):(n(!0,_.cz.onboarding),(0,Le.jsx)("div",{className:fv,children:(0,Le.jsx)(dv,{onClose:r})})):null};var xv=n(53719),yv=n(82914);let bv=function(e){return e.Input="input",e.Rich="rich",e}({});function wv(e,t,n){const i=e.split("."),o=t.split(".");let s=null!=n?n:Math.min(i.length,o.length);for(;s>0;){if(i.pop()!==o.pop())return!1;s--}return!0}function Cv(e){return e instanceof HTMLElement}function Av(e,t=1){let n=t-1,i=e.parentElement;for(;n>0&&i;)i=i.parentElement,n-=1;return i}function Sv(e,t){let n=e;for(;n;){if(t(n))return n;n=n.parentElement}}function Iv(e){const t=Sv(e,(e=>{var t,n;const i=null!==(t=null===(n=e.getAttribute("contenteditable"))||void 0===n?void 0:n.toLowerCase())&&void 0!==t?t:"false",o=e.tagName.toLowerCase(),s=e.getAttribute("data-language");return!["td","tr"].includes(o)&&"false"!==i&&!s&&!e.classList.contains("cm-content")}));if(t)return{type:bv.Rich,element:t};const n=Sv(e,(e=>(0,rt.QN)(e)&&(0,rt.ZP)()));return n?{type:bv.Input,element:n}:void 0}function kv(e,t){return!(e.start>t.end||e.end<t.start)}function jv(e,t){let n=e;for(;n;){if(t(n))return!0;n=n.parentElement}return!1}function Ev(e,t,n){const i=function(e,t,n){const i=document.createRange();return i.setStart(e,t),i.setEnd(e,n),i}(e,t,n),o=i.getClientRects();return i.detach(),o}function Tv(e,t){const n=[];for(const o of t){const e=(0,yv.A)(n);e&&e.top===o.top&&e.height===o.height&&e.right>=o.left?(e.right=o.right,e.width+=o.width):n.push(o.toJSON())}const i=e.getBoundingClientRect();return n.map((t=>{const n=t.top-i.top+e.scrollTop,o=t.left-i.left+e.scrollLeft,s=n+t.height,a=o+t.width,{width:r,height:l}=t;return{x:o,y:n,top:n,left:o,bottom:s,right:a,width:r,height:l}})).sort(((e,t)=>e.left-t.left))}let Nv=function(e){return e.baidu="baidu",e.google="google",e.bing="bing",e}({});function Mv(e){return e instanceof HTMLAnchorElement&&"a"===e.tagName.toLowerCase()&&""!==e.href&&"#"!==e.href}function Rv(e,t){const n=e.target;return t===Nv.bing?function(e){const t=Sv(e,(e=>{var t,n;return!(!Mv(e)||!(null!==(t=e.parentElement)&&void 0!==t&&t.classList.contains("rdtopattr")||null!==(n=e.parentElement)&&void 0!==n&&n.classList.contains("b_topTitle")))}));var n,i;if(t&&t instanceof HTMLAnchorElement)return null!==(n=t.parentElement)&&void 0!==n&&n.classList.contains("rdtopattr")?{alink:t.href,hoverEle:t,contentEle:(null===(i=t.parentElement.nextElementSibling)||void 0===i?void 0:i.querySelector("a"))||void 0}:{alink:t.href,hoverEle:t,contentEle:t};const o=Sv(e,(e=>{var t,n;return!(!Mv(e)||!(null!==(t=e.parentElement)&&void 0!==t&&t.classList.contains("b_tpcn")||"h2"===(null===(n=e.parentElement)||void 0===n?void 0:n.tagName.toLocaleLowerCase())))}));if(o&&o instanceof HTMLAnchorElement){var s;const e=o.href;let t;var a;return t=null!==(s=o.parentElement)&&void 0!==s&&s.classList.contains("b_tpcn")?(null===(a=o.parentElement.nextElementSibling)||void 0===a?void 0:a.querySelector("a"))||void 0:o.parentElement||void 0,{alink:e,hoverEle:o.parentElement||void 0,contentEle:t}}const r=Sv(e,(e=>!(!e.classList.contains("b_fpl_icon")&&!e.classList.contains("b_fpl_attr"))));var l;if(r&&r.closest("a"))return{alink:(null===(l=r.closest("a"))||void 0===l?void 0:l.href)||"",hoverEle:r.parentElement||void 0,contentEle:r.parentElement||void 0};const c=Sv(e,(e=>!!e.classList.contains("b_mainContent")));var d;if(null!=c&&c.querySelector("a"))return{alink:(null===(d=c.querySelector("a"))||void 0===d?void 0:d.href)||"",hoverEle:c,contentEle:c};const u=Sv(e,(e=>!!e.classList.contains("na_t_news_caption")));var h;if(u)return{alink:(null===(h=u.closest("a"))||void 0===h?void 0:h.href)||"",hoverEle:u,contentEle:u};const m=Sv(e,(e=>{var t,n;return!(!Mv(e)||!(null!==(t=e.parentElement)&&void 0!==t&&t.classList.contains("b_rc_gb_sub_title")||e.closest('[class="b_algoRCAggreFC"]')||null!==(n=e.parentElement)&&void 0!==n&&n.classList.contains("deeplink_title")))}));return m&&m instanceof HTMLAnchorElement?{alink:m.href,hoverEle:m,contentEle:m}:{alink:"",hoverEle:void 0,contentEle:void 0}}(n):t===Nv.google?function(e){const t=Sv(e,(e=>!!Mv(e)&&!!(e.querySelector("h3")||e.classList.contains("fl")||e.classList.contains("l")||e.querySelector('[aria-level="3"]')))),n=t;let i=t;if(t&&t instanceof HTMLAnchorElement){const e=t.querySelector("h3"),o=t.querySelector("span:first-child"),s=t.querySelector('[aria-level="3"]');return i=e||s||o||t,{alink:t.href,hoverEle:n,contentEle:i}}return{alink:"",hoverEle:void 0,contentEle:void 0}}(n):function(e){const t=Sv(e,(e=>!(!Mv(e)||e.closest('[id="content_right"]')||e.closest('[id="head"]')||e.closest('[id="s_tab"]')||e.closest('[class*="c-gap-top"]')||e.closest('[class*="c-abstract"]')||e.closest('[class*="result-molecule"]')||e.closest('[tpl="recommend_list"]')||e.closest('[class*="source"]')||e.closest('[class*="pc-container"]')||e.querySelector('[class*="single-card-more"]')||e.querySelector('[class*="image-wrapper"]')||e.classList.contains("op-mapcity-mapimg"))));return t&&t instanceof HTMLAnchorElement?{alink:t.href,hoverEle:t,contentEle:t}:{alink:"",hoverEle:void 0,contentEle:void 0}}(n)}const Lv="container-GL1AQQ",Pv="pop-reminder-M9LIqU",Bv="pop-content-i2_mf6",Dv="reminder-fx2_Gd",Fv="content-container-c_NTtc",Uv="close-icon-HqdLJ4",Hv="content-img-uyS7zW",zv="image-G5feq6",Ov="content-bottom-cxhbKf",qv="content-text-AChjAg",Vv="tool-W9hU1F",$v="left-wqzAXr",Kv="open-link-btn-USYuqd",Wv="right-Zoh_at",Gv="right-btn-i_81S_",Zv="copy-btn-p_EmNH",Yv="login-QwLRK1";let Jv;function Qv(){var e;const t=(0,g.B)(),n=null===(e=(0,ma.A)())||void 0===e?void 0:e.getPopupContainer,[i,o]=(0,f.useState)(!1),[s,r]=(0,f.useState)(!1),[l,c]=(0,f.useState)(""),d=(0,f.useRef)(),u=(0,f.useRef)(),[h,m]=(0,f.useState)(!1),p=(0,f.useRef)(!0),[x,y]=(0,f.useState)(!1),[b,w]=(0,f.useState)(2),[C,A]=(0,f.useState)(0),[S,I]=(0,f.useState)(0),[k,j]=(0,f.useState)(!1),E=(0,f.useRef)(null),[T,N]=(0,v.Y)("needOpenSideBar"),{setIsShowSidebar:M,setIsShowLinkPreview:R}=(0,dn.l)((e=>(0,xv.A)(e,["setIsShowSidebar","setIsShowLinkPreview"])),Gg.x),L=gv(),P=(0,ha.P)((e=>e.sendMessage)),B=(0,ha.P)((e=>e.messages)),D=(0,f.useRef)({link:"",msgId:"",imgUrl:"",textContent:""}),F=(0,f.useRef)({}),{isDone:U=!1,text:H="",isUnAuthorized:z=!1}=B[D.current.msgId]||{},{link:O,imgUrl:q,textContent:V}=D.current,[$,K]=(0,f.useState)(""!==q);(0,f.useEffect)((()=>{""!==q&&(K(!0),I(S+1))}),[q]);const W=(0,f.useMemo)((()=>{const e=function(e){return/^https:\/\/www.baidu.com\//.test(e)?Nv.baidu:/^https:\/\/www.google.com?(?:.\w+)?\/search\?/.test(e)?Nv.google:/^https:\/\/\w+.bing.com\/search\?/.test(e)?Nv.bing:""}(location.href);return e}),[]),{trackClickEvent:G}=function(e,t,n,i,o){return(0,f.useEffect)((()=>{t&&(n||(0,tn.z8)(_.Ur.linkPreviewEntryShow,{search_engine_name:e},!0,!1))}),[t,n]),(0,f.useEffect)((()=>{t&&n&&o&&(0,tn.z8)(_.Ur.linkPreviewResultShow,{search_engine_name:e,whether_has_pic:i?1:0},!1,!0)}),[t,n,i,o]),{trackClickEvent:t=>{(0,tn.z8)(_.Ur.linkPreviewResultClick,{search_engine_name:e,whether_has_pic:i?1:0,button_name:t},!1,!1)}}}(W,s,h,$,U);(0,f.useEffect)((()=>{T&&(L(),N(!1))}),[]),(0,f.useEffect)((()=>{if(1===b)return;const e=setInterval((()=>{w(b-1)}),1e3);return()=>clearInterval(e)}),[b]);const Z=(0,f.useCallback)((()=>{Jv=null,o(!1),c("")}),[]),Y=(0,fc.A)((()=>{Z()}));(0,f.useEffect)((()=>{const e=()=>{Z(),d.current&&d.current.removeEventListener("mouseleave",e)},t=t=>{if(""===W)return;if(!t.target)return;const{alink:n="",hoverEle:i,contentEle:s}=Rv(t,W);if(""!==n&&i&&s){o(!0),d.current=i,d.current.addEventListener("mouseleave",e),u.current=s,c(n),w(2);const t=F.current[n];t&&n===t.link&&""!==t.msgId?(m(!0),D.current=(0,a.A)({},t)):(m(!1),D.current={link:"",msgId:"",imgUrl:"",textContent:""})}};return document.addEventListener("mouseover",t),()=>{document.removeEventListener("mouseover",t),d.current&&d.current.removeEventListener("mouseleave",e)}}),[]),(0,f.useEffect)((()=>{let e;return i?r(!0):e=setTimeout((()=>{r(!1)}),100),()=>clearTimeout(e)}),[i]);const J=(e,t,n)=>{if(""===e)return;const i=P({scene:kr.sJ.link_preview,prompt:ml.EU.browser_plugin_info,browser_plugin_info:JSON.stringify({skill_name:"link_preview",url:e,content:t}),current_page:(0,tn.M5)(window.location.href)});D.current={link:e,msgId:i,imgUrl:n,textContent:t||""},F.current[e]=(0,a.A)({},D.current),F.current[e].textContent=""},Q=(0,f.useCallback)((e=>{const t=(0,fm.cs)({name:"get-page-content",body:{url:e}});Jv=t,t.then((n=>{var i,o;if(t!==Jv)return;const s=(new DOMParser).parseFromString(null===(i=n.data)||void 0===i?void 0:i.html,"text/html"),{textContent:a}=(0,mv.Tp)(s)||{},r=(null===(o=s.querySelector('meta[property="og:image"]'))||void 0===o?void 0:o.getAttribute("content"))||"";var l;void 0===a&&(0,gt.R8)(`[zx] parse page(${e}) text content failed, origin html(${null===(l=n.data)||void 0===l?void 0:l.html})`);J(e,a,r)}))}),[]);(0,f.useEffect)((()=>{if(!i||h||z)return;const e=setTimeout((()=>{""!==l&&Q(l)}),300),t=setTimeout((()=>{m(!0)}),2e3);return()=>{clearTimeout(e),clearTimeout(t)}}),[i,h,l,z]);const X=(0,f.useMemo)((()=>{if(!i||!u.current)return{};const e=function(e){const t=document.createRange();return t.selectNodeContents(e),t.getBoundingClientRect()}(u.current),t=window.innerHeight||document.documentElement.clientHeight,n=e.top<=t/2;p.current=n;const o=e.top+e.height/2-12;return A(C+1),{position:"absolute",left:e.left+e.width+window.scrollX,top:o+window.scrollY,width:"7px",height:"24px",backgroundColor:"transparent"}}),[i,u.current]),ee=()=>{G("open_link"),M(!0,_.cz.other),N(!0),window.open(O),Z()},te=()=>{G("copy"),j(!0),E.current&&clearTimeout(E.current),E.current=window.setTimeout((()=>{j(!1),E.current=null}),1e3),es()(H)},ne=(0,f.useCallback)((()=>{(0,Ce.DT)({trackMeta:{previous_page:(0,tn.M5)(location.href),login_entrance:"link_preview"}})}),[]),oe=t(k?"flow_web_ext_action_popup_copy":"message_long_press_copy"),se=k?be.eWz:be.fFY;return s?(0,Le.jsx)(Be.AM,{getPopupContainer:n,content:()=>(0,Le.jsxs)("div",{ref:Y,onMouseEnter:()=>{o(!0)},onMouseLeave:()=>{Z()},children:[!h&&(0,Le.jsxs)("div",{className:Dv,children:[(0,Le.jsx)("img",{width:16,height:16,src:(0,Se.Nf)()}),z?(0,Le.jsxs)("div",{children:[t("flow_web_ext_setting_search_preview_tips","\u767b\u5f55\u540e\u7ee7\u7eed\u603b\u7ed3")," ",(0,Le.jsx)("span",{className:Yv,onClick:ne,children:t("login_button")})]}):(0,Le.jsx)("div",{children:t("flow_web_ext_search_preview_loading",{brandName:(0,Se.L2)(),number:b})})]}),h&&(0,Le.jsxs)("div",{className:Fv,onMouseLeave:()=>y(!1),children:[(0,Le.jsx)(Ae.A,{className:Uv,show:x,disableKey:Tc.lf.linkPreview,optionPageSection:"search-engin-summary",onDisableOnceClick:()=>R(!1),setShow:y,cssStyle:{zIndex:100}}),$&&(0,Le.jsx)("div",{className:Hv,children:(0,Le.jsx)("img",{src:q,className:zv,referrerPolicy:"no-referrer",onError:()=>{K(!1)}},S)}),(0,Le.jsxs)("div",{className:Ov,children:[(0,Le.jsx)(Sr,{id:D.current.msgId,type:"mail",enableScroll:!0,className:qv,style:{maxHeight:$?"180px":"300px"},autoScrollToEnd:!1,onRetry:()=>{J(O,V,q)}}),U&&(0,Le.jsxs)("div",{className:Vv,children:[(0,Le.jsx)("div",{className:$v,children:(0,Le.jsx)(ya.c,{type:"quartary",icon:(0,Le.jsx)(be.Dkt,{}),size:"small",onClick:ee,className:Kv,children:t("flow_web_ext_search_preview_link","\u6253\u5f00\u94fe\u63a5")})}),(0,Le.jsx)("div",{className:Wv,children:(0,Le.jsx)(Fp,{tooltip:oe,icon:(0,Le.jsx)(se,{className:Zv}),onClick:te,className:Gv})})]})]})]})]}),visible:s,trigger:"custom",rePosKey:C,position:p.current?"rightTop":"rightBottom",className:ie()(Lv,"cici-ext-always-light","semi-always-light",{[Pv]:!h,[Bv]:h}),children:(0,Le.jsx)("span",{style:X})}):null}var Xv=n(25478);const ef=15,tf=5,nf=30,of=22,sf=5,af=2,rf=!1,lf=["BLOCKQUOTE"];function cf(e){if(Cv(e)){if(lf.includes(e.tagName))return NodeFilter.FILTER_REJECT;if(e instanceof HTMLButtonElement||"button"===e.getAttribute("role"))return NodeFilter.FILTER_REJECT;if("none"===getComputedStyle(e).display)return NodeFilter.FILTER_REJECT}if(e instanceof Text){if(!e.nodeValue||!e.parentElement)return NodeFilter.FILTER_REJECT;if(/^\s*\n\s*$/.test(e.nodeValue)&&!getComputedStyle(e.parentElement).whiteSpace.startsWith("pre"))return NodeFilter.FILTER_REJECT}return NodeFilter.FILTER_ACCEPT}const df=NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT;function*uf(e,t){var n,i;const o=null!==(n=null==t?void 0:t.isNewline)&&void 0!==n?n:mf,s=null!==(i=null==t?void 0:t.filter)&&void 0!==i?i:cf,a=document.createTreeWalker(e,df,s);let r=a.nextNode(),l=!1,c=!1;const d=[],u=e=>{const t=e.previousElementSibling,n=t?d.indexOf(t):-1;if(n>-1){return d.splice(n).some(o)}return!1};for(;r;){if(c=c||u(r),r instanceof Text){const e=c||l;c=!1,l=!1,yield{newline:e,node:r}}else r.childNodes.length>0&&d.push(r);l=l||o(r),r=a.nextNode()}}const hf=["block","flex","grid","flow-root","table","-webkit-box","-moz-box","-webkit-flex","-moz-flex","-ms-flexbox","list-item"];function mf(e){if(e instanceof HTMLElement){if("BR"===e.tagName)return!0;const t=getComputedStyle(e),[n=""]=t.display.split(" ");if(hf.includes(n))return!0}return!1}function pf(e){var t;if(!e.parentElement||!e.nodeValue)return"";let n=null===(t=e.nodeValue)||void 0===t?void 0:t.replace(/\u200b/g,"").replace(/\u00a0|\u2002|\u2003/g," ");return getComputedStyle(e.parentElement).whiteSpace.startsWith("pre")||(n=n.replace(/\n/g,"")),n}class gf extends sa.A{}class vf extends gf{constructor(e){var t,n;super(),t=this,(0,y.A)(this,"dom",void 0),(0,y.A)(this,"filter",void 0),(0,y.A)(this,"textNodes",void 0),(0,y.A)(this,"mutationObserver",void 0),(0,y.A)(this,"isComposition",!1),(0,y.A)(this,"handleCompositionStart",(()=>this.isComposition=!0)),(0,y.A)(this,"handleCompositionEnd",(()=>{this.isComposition=!1,this.handleChange()})),(0,y.A)(this,"bind",(()=>{this.dom.addEventListener("compositionstart",this.handleCompositionStart),this.dom.addEventListener("compositionend",this.handleCompositionEnd),this.mutationObserver=new MutationObserver(this.handleChange),this.mutationObserver.observe(this.dom,{subtree:!0,childList:!0,characterData:!0})})),(0,y.A)(this,"unbind",(()=>{var e;this.dom.removeEventListener("compositionstart",this.handleCompositionStart),this.dom.removeEventListener("compositionend",this.handleCompositionEnd),null===(e=this.mutationObserver)||void 0===e||e.disconnect(),this.mutationObserver=void 0})),(0,y.A)(this,"handleChange",(()=>{this.isComposition||(this.textNodes=this.extractTextNodes(),this.emit("contentChange",this.text))})),(0,y.A)(this,"splitContentTextRectIterator",(e=>{for(let t=this.textNodes.length-1;t>=0;t--){const n=this.textNodes[t].node,i=document.createRange();i.setStart(n,0),i.setEnd(n,n.length);const o=Array.from(i.getClientRects());for(let t=o.length-1;t>=0;t--)if(!1===e(o[t]))return}})),(0,y.A)(this,"getSelection",(()=>{const e=document.getSelection();if(!e||e.rangeCount<1)return;const t=e.getRangeAt(0);if(!this.dom.contains(t.commonAncestorContainer))return;let n,i,o=0;for(const s of this.textNodes){if(s.newline&&(o+=1),t.startContainer.contains(s.node)&&(n=o+t.startOffset),t.endContainer.contains(s.node)&&(i=o+t.endOffset),n&&i){const e=(0,yv.A)(t.getClientRects());return{collapsed:t.collapsed,start:n,end:i,rect:e,text:this.text.slice(n,i)}}o+=pf(s.node).length}})),(0,y.A)(this,"selectText",((e,t,n)=>{const i=window.getSelection(),o=new Range;return o.setStart(e,t),o.setEnd(e,n),null==i||i.removeAllRanges(),null==i||i.addRange(o),o})),(0,y.A)(this,"insertTextByRange",((e,t)=>{const n={bubbles:!0,cancelable:!0,inputType:"insertText",data:e};if(t&&"StaticRange"in window&&"getTargetRanges"in InputEvent.prototype)try{n.targetRanges=[new StaticRange(t)]}catch(o){}const i=new InputEvent("beforeinput",n);this.dom.dispatchEvent(i),document.execCommand("insertText",!1,e)})),(0,y.A)(this,"applyReplacement",function(){var e=(0,r.A)((function*(e,n,i,o){const s=t.selectText(e,n,i);yield(0,ht.uk)(),t.insertTextByRange(o,s)}));return function(t,n,i,o){return e.apply(this,arguments)}}()),(0,y.A)(this,"replace",function(){var e=(0,r.A)((function*(e,n,i){t.dom.focus();const o=t.getRelativeTextNodesByRange(e,n).map(((e,t)=>(0,a.A)((0,a.A)({},e),{},{replacement:0===t?i:""})));for(const s of o.reverse())yield t.applyReplacement(s.node,s.from,s.to,s.replacement);t.dom.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!1})),t.dom.dispatchEvent(new KeyboardEvent("keyup",{bubbles:!0,cancelable:!0,keyCode:17,which:17,charCode:0,location:1,key:"Control",code:"ControlLeft"})),yield(0,ht.uk)()}));return function(t,n,i){return e.apply(this,arguments)}}()),this.filter=wv(n=window.location.hostname,"notion.so")?e=>Cv(e)&&(e.classList.contains("notion-page-controls")||"true"===e.getAttribute("data-content-editable-void")||"14vh"===e.style.marginBottom)?NodeFilter.FILTER_REJECT:cf(e):wv(n,"mail.google.com",3)?e=>Cv(e)&&e.classList.contains("gmail_quote")?NodeFilter.FILTER_REJECT:cf(e):(0,qp.Im)()?e=>Cv(e)&&(e.classList.contains("code-block-container")||e.classList.contains("uneditable")||e.classList.contains("docx-code-block-container")||e.classList.contains("docx-diagram-block")||e.classList.contains("docx-chat_card-block")||e.classList.contains("doc-meta-entry-wrapper")||e.classList.contains("doc-info-wrapper")||e.classList.contains("scrollable-wrapper")||e.classList.contains("resizable-container")||e.classList.contains("ace-line")&&!e.isContentEditable)?NodeFilter.FILTER_REJECT:cf(e):wv(n,"outlook.live.com",3)?e=>{var t;return!Cv(e)||"divRplyFwdMsg"!==e.id&&"divRplyFwdMsg"!==(null===(t=e.previousElementSibling)||void 0===t?void 0:t.id)?cf(e):NodeFilter.FILTER_REJECT}:cf,this.dom=e,this.textNodes=this.extractTextNodes(),this.bind()}extractTextNodes(){let e=0;return[...uf(this.dom,{filter:this.filter})].map((t=>{const{node:n,newline:i}=t;i&&(e+=1);const o=pf(n),s=(0,a.A)((0,a.A)({},t),{},{text:o,offset:e});return e+=o.length,s}))}calcPureText(){let e="";for(const t of this.textNodes)t.newline&&(e+="\n"),e+=pf(t.node);return e}get text(){return this.calcPureText()}valid(e){if(jv(e,(e=>e instanceof HTMLAnchorElement))||function(e){return jv(e,(e=>e instanceof HTMLElement&&e.matches("code")))}(e))return!1;var t,n;if((0,qp.Im)()&&(null!==(t=Av(e,2))&&void 0!==t&&t.classList.contains("smart-correction-text")||null!==(n=Av(e,4))&&void 0!==n&&n.classList.contains("grammar-check")))return!1;return!0}getRevisionRect(e){const t=[],n=new Set,{textNodes:i}=this;e:for(const o of e){if(n.has(o.sentId))continue;let e=[],s=0;for(const t of i){const i=pf(t.node).length;t.newline&&(s+=1);if(kv(o,{start:s,end:s+i})){if(!this.valid(t.node)){n.add(o.sentId);continue e}const a=Math.max(o.start,s)-s,r=Math.min(o.end,s+i)-s;e.push(...Ev(t.node,a,r))}s+=i}e=e.filter((e=>e.width>0));const a=Tv(this.dom,e);a.length>0&&t.push({revision:o,rects:a})}return t.filter((e=>!n.has(e.revision.sentId)))}getRelativeTextNodesByRange(e,t){const n=[];for(const i of this.textNodes){const{text:o,node:s,offset:a}=i;kv({start:e,end:t-1},{start:a,end:a+o.length-1})&&n.push({from:Math.max(e,a)-a,to:Math.min(t,a+o.length)-a,node:s})}return n}insertText(e){this.insertTextByRange(e)}destroy(){this.removeAllListeners(),this.unbind()}}function ff(e){const t=parseFloat(e);return isNaN(t)?0:t}function _f(e){return(0,f.useMemo)((()=>e?function(e){const t={x:e.x,y:e.y,top:e.top,left:e.left,right:e.right,width:e.width,height:e.height+2,bottom:e.bottom+2};return{getBoundingClientRect:()=>(0,a.A)((0,a.A)({},t),{},{toJSON:()=>t})}}(e):null),[e])}function xf(e,t){document.body.contains(xf.dom)||document.body.append(xf.dom),xf.dom.removeAttribute("style");const n=getComputedStyle(e),i=function(e){const t=getComputedStyle(e),n=ff(t.width),i=ff(t.height),o=ff(t.paddingTop),s=ff(t.paddingRight),a=ff(t.paddingBottom),r=ff(t.paddingLeft),l=ff(t.borderTopWidth),c=ff(t.borderRightWidth),d=ff(t.borderBottomWidth),u=ff(t.borderLeftWidth);return"border-box"===t.boxSizing?{width:n-r-s-u-c,height:i-o-a-l-d,offsetLeft:r+u,offsetTop:o+l,offsetRight:s+c,offsetBottom:a+d}:{width:n,height:i,offsetLeft:0,offsetTop:0,offsetRight:0,offsetBottom:0}}(e);return xf.dom.style.top="0",xf.dom.style.left="0",xf.dom.style.position="fixed",xf.dom.style.pointerEvents="none",xf.dom.style.opacity="0",xf.dom.style.opacity="0",xf.dom.style.width=`${e.clientWidth}px`,xf.dom.style.boxSizing=n.boxSizing,xf.dom.style.padding=n.padding,xf.dom.style.border=n.border,xf.dom.style.fontSize=n.fontSize,xf.dom.style.fontFamily=n.fontFamily,xf.dom.style.fontStyle=n.fontStyle,xf.dom.style.fontWeight=n.fontWeight,xf.dom.style.lineHeight=n.lineHeight,xf.dom.style.letterSpacing=n.letterSpacing,xf.dom.style.textAlign=n.textAlign,t?(xf.dom.style.whiteSpace="nowrap",xf.dom.style.height=`${e.clientHeight}px`,xf.dom.style.lineHeight=`${i.height}px`):(xf.dom.style.whiteSpace=n.whiteSpace,xf.dom.style.wordBreak=n.wordBreak),xf.dom.textContent=e.value,xf.dom}xf.dom=document.createElement("div"),xf.dom.classList.add("fake-editor");class yf extends gf{constructor(e){var t;super(),t=this,(0,y.A)(this,"dom",void 0),(0,y.A)(this,"isComposition",!1),(0,y.A)(this,"handleCompositionStart",(()=>this.isComposition=!0)),(0,y.A)(this,"handleCompositionEnd",(()=>{this.isComposition=!1,this.handleChange()})),(0,y.A)(this,"bind",(()=>{this.dom.addEventListener("compositionstart",this.handleCompositionStart),this.dom.addEventListener("compositionend",this.handleCompositionEnd),this.dom.addEventListener("input",this.handleChange),this.dom.addEventListener("change",this.handleChange)})),(0,y.A)(this,"unbind",(()=>{this.dom.removeEventListener("compositionstart",this.handleCompositionStart),this.dom.removeEventListener("compositionend",this.handleCompositionEnd),this.dom.removeEventListener("input",this.handleChange),this.dom.removeEventListener("change",this.handleChange)})),(0,y.A)(this,"handleChange",(()=>{this.isComposition||this.emit("contentChange",this.text)})),(0,y.A)(this,"splitContentTextRectIterator",(e=>{const t=xf(this.dom,"INPUT"===this.dom.tagName).firstChild;if(!t)return[];const n=document.createRange();n.setStart(t,0),n.setEnd(t,t.length);const{top:i,left:o}=this.dom.getBoundingClientRect(),s=Array.from(n.getClientRects()).map((e=>({top:e.top+i,left:e.left+o,y:e.y+i,x:e.x+o,width:e.width,height:e.height,right:e.right+o,bottom:e.bottom+i})));for(let a=s.length-1;a>=0;a--)if(!1===e(s[a]))return})),(0,y.A)(this,"replace",function(){var e=(0,r.A)((function*(e,n,i){document.activeElement!==t.dom&&(t.dom.focus(),yield(0,ht.uk)()),t.dom.setSelectionRange(e,n,"forward"),document.execCommand("insertText",!1,i),yield(0,ht.uk)()}));return function(t,n,i){return e.apply(this,arguments)}}()),this.dom=e,this.bind()}get text(){return this.dom.value}getSelection(){const e=this.dom.selectionStart,t=this.dom.selectionEnd;if(!e||!t)return;const n=xf(this.dom,"INPUT"===this.dom.tagName).firstChild;if(!n)return;const i=document.createRange();i.setStart(n,e),i.setEnd(n,t);const o=(0,yv.A)(i.getClientRects());if(!o)return;const{top:s,left:a}=this.dom.getBoundingClientRect();return{start:e,end:t,rect:{top:s+o.top,left:a+o.left,y:s+o.y,x:a+o.x,width:o.width,height:o.height,right:o.right+a,bottom:o.bottom+s},collapsed:e===t,text:this.text.slice(e,t)}}getRevisionRect(e){const t=[],n=xf(this.dom,"INPUT"===this.dom.tagName),i=document.createRange(),o=n.firstChild;if(!o)return t;for(const a of e)try{i.setStart(o,a.start),i.setEnd(o,a.end);const e=[...i.getClientRects()];t.push({revision:a,rects:e})}catch(s){}return i.detach(),t}insertText(e,t){var n=this;return(0,r.A)((function*(){document.activeElement!==n.dom&&(n.dom.focus(),yield(0,ht.uk)()),!0===t&&n.dom.select(),document.execCommand("insertText",!1,e),yield(0,ht.uk)()}))()}destroy(){this.unbind(),this.removeAllListeners()}}const bf=new WeakMap;function wf(e){let t,n,i=null;if(e instanceof vf){i=function(e){var t;let n;const i=(null===(t=window.getSelection())||void 0===t?void 0:t.focusNode)||null;return n=!i||i instanceof HTMLElement?i:i.parentElement,function(e,t){let n=t;for(;n;){if(n===e)return!0;n=n.parentElement}return!1}(e,n)||(n=null),n}(e.dom)||e.dom;const o=function(e){if(e){if((0,qp.Im)()){const t=Sv(e,(e=>e.hasAttribute("data-block-type")||e.classList.contains("text-editor"))),n=Sv(e,(e=>e.classList.contains("ace-line")));if(!t)return;const i=Sv(e,(e=>e.classList.contains("bullet-list")||e.classList.contains("list"))),o=t.getBoundingClientRect();return{anchorPoint:new DOMPoint(o.x-(i?80:44),o.y),text:n?n.innerText:t.innerText,row:t}}if(/\bnotion\.so$/.test(location.hostname)){const t=Sv(e,(e=>e.classList.contains("notion-text-block")));if(!t)return;const n=t.getBoundingClientRect();return{anchorPoint:new DOMPoint(n.x-48,n.y),text:t.innerText,row:t}}}}(i);o&&(o.anchorPoint&&(t=o.anchorPoint),n=o.text,i=o.row)}if(!t){const n=e.dom.getBoundingClientRect(),i=window.scrollX+n.x+n.width-tf,o=window.scrollY+n.y+(n.height-nf)/2;t=new DOMPoint(i,o)}return void 0===n&&(n=e.text),n=n.replace(/^[\s]+|\s+$/gi,"").replace(/[\x00-\x1f\u200b]/g,""),{inputText:n,richElement:i,anchorPoint:t}}function Cf(e,t,n){try{const i=!(t.length>0)||(0,Xv.A)(t)(e),o=n.length>0&&(0,Xv.A)(n)(e);return i&&!o}catch(i){return!1}}function Af(e){return!(null==e||!e.offsetParent)}function Sf(){const[e,t]=(0,f.useState)(null),[n,i]=(0,f.useState)(!0),o=(0,f.useRef)(),[s,r]=(0,f.useState)(!0),l=(0,kl.A)("writing_assistant");return(0,f.useEffect)((()=>{const e=()=>{var e;const n=document.activeElement;if(!(n instanceof HTMLElement))return;const i=Iv(n);if(!i)return;if(!function(e,t){const{input_enabled_urls:n,input_disabled_urls:i,input_enabled_size:o,rich_enabled_urls:s,rich_disabled_urls:a,input_tag_disabled:r}=t;if(r&&"INPUT"===e.element.tagName)return!1;const l=location.href.replace(/^http?s:\/\//i,"");if(e.type===bv.Input){if(!Cf(l,n,i))return!1}else if(!Cf(l,s,a))return!1;return!(e.element.offsetWidth<o.width||e.element.offsetHeight<o.height)}(i,l))return void t(null);let s=bf.get(i.element);s||(s=i.type===bv.Rich?new vf(i.element):new yf(i.element),bf.set(i.element,s)),null===(e=o.current)||void 0===e||e.cancel(),r(Af(s.dom));const a=wf(s);t({editorType:i.type,editor:s,inputText:a.inputText,activeElement:a.richElement,point:a.anchorPoint})};e();const n=(0,Mi.A)(e,16);return document.addEventListener("focus",n,!0),document.addEventListener("click",n,!0),document.addEventListener("keydown",n,!0),()=>{document.removeEventListener("focus",n,!0),document.removeEventListener("keydown",n,!0),document.removeEventListener("click",n,!0)}}),[]),(0,f.useEffect)((()=>{const n=(0,Mi.A)((()=>{if(null!=e&&e.editor){const n=wf(e.editor);t((0,a.A)((0,a.A)({},e),{},{point:n.anchorPoint}))}i(!0)}),400),s=()=>{i(!1),n()},l=(0,Mi.A)((()=>{Af(null==e?void 0:e.editor.dom)||r(!1)}),200);o.current=l,window.addEventListener("scroll",s,!0),window.addEventListener("resize",s,!0),document.addEventListener("pointerdown",l,!0);let c=!0;const d=()=>{c&&(Af(null==e?void 0:e.editor.dom)||r(!1),c&&setTimeout(d,1e3))};return d(),()=>{var e;window.removeEventListener("scroll",s,!0),window.removeEventListener("resize",s,!0),document.removeEventListener("pointerdown",l,!0),null===(e=o.current)||void 0===e||e.cancel(),c=!1}}),[l,null==e?void 0:e.editor]),{visible:s&&n,inputState:e}}var If=n(49103),kf=n(12437),jf=n(81735);const Ef=(e,t)=>{(0,tn.z8)(_.Ur.writingSettingClick,(0,a.A)({button_name:e,click_from:kr.sJ.writing_assistant},t))},Tf=e=>{(0,tn.z8)(_.Ur.showMailEntryButton,{button_name:e,show_from:kr.sJ.writing_assistant})},Nf=e=>{(0,tn.z8)(_.Ur.clickMailEntryButton,{button_name:e,click_from:kr.sJ.writing_assistant})},Mf=e=>{(0,tn.z8)(_.Ur.writingSkilShow,{skill_id:2,skill_name:"writing_assistant",show_from:kr.sJ.writing_assistant,module_actionid:e})},Rf=(e,t)=>{(0,tn.z8)(_.Ur.writingSkillClick,{skill_id:2,skill_name:"writing_assistant",module_actionid:e,content_detail:t,click_from:kr.sJ.writing_assistant})},Lf=(e,t)=>{(0,tn.z8)(_.Ur.clickMailThreadResult,{button_name:e,click_from:kr.sJ.writing_assistant,module_actionid:t})};class Pf{constructor(e,t,n){(0,y.A)(this,"current_hostname",void 0),(0,y.A)(this,"hosts",void 0),(0,y.A)(this,"setter",void 0);const i=Array.isArray(t)?t:[];this.hosts=new Set(i),this.setter=n,this.current_hostname=e}hasHost(){return this.hosts.has(this.current_hostname)}addHost(){this.hosts.add(this.current_hostname),this.setter(Array.from(this.hosts))}removeHost(){this.hosts.delete(this.current_hostname),this.setter(Array.from(this.hosts))}toggleHost(){this.hosts.has(this.current_hostname)?this.hosts.delete(this.current_hostname):this.hosts.add(this.current_hostname),this.setter(Array.from(this.hosts))}disableHost(e){e?this.addHost():this.removeHost()}}function Bf(e){const t=Un.zs[e];if(!t)throw new Error("disabled host key missing");const[n,i]=(0,v.Y)(t.page);return new Pf(window.location.hostname,n,i)}const Df={inputAssistantDisabled:!1,revisionMap:new WeakMap,revisionVersion:0,dragPositionMap:new WeakMap,writingTemplatesActionId:Date.now().toString()},Ff=(0,ec.vt)()((0,Xl.eh)(((e,t)=>(0,a.A)((0,a.A)({},Df),{},{setInputAssistantDisabled:t=>e({inputAssistantDisabled:t}),updateEditorRevision(n,i){this.revisionMap.set(n,i),e({revisionVersion:t().revisionVersion+1})},removeEditorRevision(n){this.revisionMap.delete(n),e({revisionVersion:t().revisionVersion+1})},updateDragPosition(e,t){this.dragPositionMap.set(e,t)},refreshWritingTemplatesActionId(){e({writingTemplatesActionId:Date.now().toString()})}})))),Uf="settings-DMcHC8",Hf="switchItem-bDObRQ",zf="title-A_d39g",Of="selectItem-xGmpwl",qf="body-jMNbH3",Vf="item-BaRfKn",$f="active-ZMUuIN",Kf="left-DuHHSc",Wf="icon-ATBrm4",Gf="itemTitle-xZUfB5",Zf="itemSubTitle-cLmxN7",Yf="langOnly-wnIrWv",Jf="check-setting-item-jxcMcz";function Qf(e){return(0,Le.jsxs)("div",{className:Hf,children:[(0,Le.jsx)("div",{className:zf,children:e.title}),(0,Le.jsx)(Be.dO,{size:"small",checked:e.value,onChange:t=>e.onChange(t)})]})}function Xf(e){var t,n;const i=(0,jf.a)(),o=null==i||null===(t=i.compose)||void 0===t||null===(t=t.language)||void 0===t?void 0:t.filter((e=>["en","zh","cn"].includes(e.language_code||""))),s=(null==o||null===(n=o.find((e=>!0===e.is_default)))||void 0===n?void 0:n.language_code)||"",[a,r]=(0,v.Y)("inputAssistantLang");return(0,f.useEffect)((()=>{a||r(s)}),[a]),(0,Le.jsxs)("div",{className:ie()(Of,e.className),children:[(0,Le.jsx)("div",{className:zf,children:e.title}),(0,Le.jsx)(fr,{className:qf,children:null==o?void 0:o.map((e=>{const t=a===e.language_code;return(0,Le.jsxs)("div",{className:ie()({[Vf]:!0,[$f]:t}),"data-lang-option":e.language_code,onClick:()=>{r(e.language_code||""),Ef(_._h.writingLanguage,{language_setting:e.language_code})},children:[(0,Le.jsxs)("div",{className:Kf,children:[(0,Le.jsx)("div",{className:Gf,children:e.language_loc}),(0,Le.jsx)("div",{className:Zf,children:e.language})]}),t&&(0,Le.jsx)(ze.Tf,{className:Wf})]},e.language_code)}))})]})}const e_=(0,f.forwardRef)((function(e,t){const{showLangOnly:n=!1}=e,i=Bf(we.lf.inputAssistant),o=Bf(we.lf.grammar),s=Ff(),[a,r]=(0,f.useState)(0),l=()=>r(a+1),c=(0,f.useRef)({enableGrammar:!o.hasHost(),enableInputAssistant:!i.hasHost(),closeWritingTemp:!1}),d=c.current.enableInputAssistant||c.current.enableGrammar,u=(0,g.B)();(0,f.useEffect)((()=>()=>{const{closeWritingTemp:e,enableInputAssistant:t,enableGrammar:n}=c.current;s.setInputAssistantDisabled(e),Ef(_._h.hideUntilNext,{whether_hide:e?1:0}),i.disableHost(!t),Ef(_._h.closeWritingAssistant,{whether_close_writing_assistant:t?0:1}),o.disableHost(!n),Ef(_._h.closeGrammerCheck,{whether_close_grammar_check:n?0:1})}),[]);const{closeWritingTemp:h,enableInputAssistant:m,enableGrammar:p}=c.current;return(0,Le.jsxs)("div",{"data-testid":e["data-testid"],ref:t,className:Uf,children:[!n&&(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsx)(Qf,{title:u("flow_web_ext_writing_setting_switch"),value:d,onChange:e=>{c.current.enableGrammar=e,c.current.enableInputAssistant=e,l()}}),(0,Le.jsx)("div",{className:Jf,children:(0,Le.jsx)(Be.Sc,{checked:m,onChange:e=>{void 0!==e.target.checked&&(c.current.enableInputAssistant=e.target.checked,l())},children:u("flow_web_ext_writing_setting_writing")})}),(0,Le.jsx)("div",{className:Jf,children:(0,Le.jsx)(Be.Sc,{checked:p,onChange:e=>{void 0!==e.target.checked&&(c.current.enableGrammar=e.target.checked,l())},children:u("flow_web_ext_writing_setting_grammar")})}),(0,Le.jsx)(Qf,{title:u("flow_web_ext_sidebar_hide_1"),value:h,onChange:e=>{c.current.closeWritingTemp=e,l()}})]}),rf&&(0,Le.jsx)(Xf,{className:ie()({[Yf]:n}),title:u("flow_web_ext_writing_lang","\u56de\u590d\u8bed\u8a00")})]})})),t_={inputAssist:"inputAssist-_fVAzj",hasBg:"hasBg-y_Luk1",expand:"expand-bOxmVY",active:"active-qgigJz",promptEditor:"promptEditor-Rg1k7l",avatar:"avatar-JTSG4S",footer:"footer-IPbIFv",helpWrite:"helpWrite-Z_jSaZ",popover:"popover-sTjuQP",writePopover:"writePopover-fxZ6ia",header:"header-CDBQy1",headerBtn:"headerBtn-eBMIJA",moreBtns:"moreBtns-yGuX6p",backBtn:"backBtn-MiSuN8",back:"back-P1rTLq",spliter:"spliter-pManTA",headerTitle:"headerTitle-xfu1gd",headerTxt:"headerTxt-r78dw0","banner-wrapper":"banner-wrapper-HLihCs",bannerWrapper:"banner-wrapper-HLihCs",collapse:"collapse-Buj9Jt",messageBox:"messageBox-mRvZAm",message:"message-q6YYA1",banner:"banner-RTeYKx","carousel-row-wrapper":"carousel-row-wrapper-uclocB",carouselRowWrapper:"carousel-row-wrapper-uclocB",item:"item-KdhsII",selected:"selected-BuCP6w","item-title":"item-title-dch9y9",itemTitle:"item-title-dch9y9","bottom-bar-container":"bottom-bar-container-yPAVZt",bottomBarContainer:"bottom-bar-container-yPAVZt","rich-editor-wrapper":"rich-editor-wrapper-dpXavl",richEditorWrapper:"rich-editor-wrapper-dpXavl","flow-chat-editor":"flow-chat-editor-fLL66g",flowChatEditor:"flow-chat-editor-fLL66g","tools-box":"tools-box-zdE3p_",toolsBox:"tools-box-zdE3p_",revisionCount:"revisionCount-bq1jWH",messageFooter:"messageFooter-v0Gjco",messageBtns:"messageBtns-bcpuJA",btnLeft:"btnLeft-L2gplv",btn:"btn-z7sNqm",adjustTone:"adjustTone-Dxb0UZ",adjustToneImg:"adjustToneImg-QgQtFX"};var n_=n(25182);function i_(e){const{visible:t=!0}=e,n=(0,f.useRef)(null),i=(0,f.useRef)(null),[o,s]=(0,f.useState)(!1);return(0,n_.A)((()=>s(!1)),[i,n]),(0,f.useEffect)((()=>{t&&Tf(_._h.settings)}),[t]),(0,Le.jsx)(Be.AM,{className:t_.popover,style:{userSelect:"none"},getPopupContainer:e.getPopupContainer,onVisibleChange:e.onVisibleChange,trigger:"custom",visible:o,spacing:ef,position:"bottomLeft",content:(0,Le.jsx)(e_,{"data-testid":"writing-assistant-popover-settings",showLangOnly:e.showLangOnly,ref:i}),children:(0,Le.jsx)("span",{ref:n,style:{display:t?"block":"none"},children:(0,Le.jsx)(Fp,{testid:"writing-assistant-btn-settings",getPopupContainer:e.getPopupContainer,className:ie()(e.buttonClassName,{[t_.active]:o}),tooltip:e.title,tooltipOptions:{spacing:ef},icon:e.icon,onClick:()=>{s(!o),Nf(_._h.settings)}})})})}function o_(e){const t=(0,g.B)(),n=e.showCopy||rf;return(0,Le.jsxs)("div",{className:t_.header,children:[(0,Le.jsxs)("div",{className:t_.headerTitle,children:[e.hasBackIcon?(0,Le.jsx)(Fp,{onClick:e.onBackClick,className:ie()(t_.backBtn,t_.headerBtn),icon:(0,Le.jsx)(kf.B94,{className:t_.back})}):(0,Le.jsx)("img",{className:t_.avatar,src:(0,Se.Nf)()}),(0,Le.jsx)("div",{className:t_.headerTxt,children:e.title})]}),(0,Le.jsxs)("div",{className:t_.moreBtns,children:[e.showCopy&&(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsx)(Na,{text:e.text||"",className:t_.headerBtn,style:{fontSize:16,marginRight:2}}),(0,Le.jsx)(Qp,{testid:"writing-assistant-btn-copy",tooltip:t("flow_web_ext_copy","\u590d\u5236\u5185\u5bb9"),successTooltip:t("toast_copy_success","\u590d\u5236\u6210\u529f"),onCopyClick:e.onCopyClick,className:t_.headerBtn})]}),rf&&(0,Le.jsx)(i_,{showLangOnly:!0,buttonClassName:t_.headerBtn,getPopupContainer:e.getPopupContainer,icon:(0,Le.jsx)(ze.kK,{}),title:t("flow_web_ext_writing_lang","\u56de\u590d\u8bed\u8a00")})]}),n&&(0,Le.jsx)("span",{className:t_.spliter}),(0,Le.jsx)(Fp,{tooltip:t("flow_web_ext_close"),className:t_.headerBtn,onClick:e.onClose,icon:(0,Le.jsx)(kf.abE,{})})]})}var s_=n(22437);let a_=function(e){return e[e.Retry=0]="Retry",e[e.Regenerate=1]="Regenerate",e[e.ChangeTone=2]="ChangeTone",e[e.MakeShorter=3]="MakeShorter",e[e.MakeLonger=4]="MakeLonger",e}({});function r_(e){var t,n;const{t:i}=(0,s_.B)(),{onButtonClick:o=h.A,onConfirmClick:s=h.A,onMessageChange:a,getPopupContainer:r,messageId:l,writingConfig:c}=e,d=(null==c||null===(t=c.compose)||void 0===t?void 0:t.tone)||[],u=(null===(n=d.find((e=>e.is_default)))||void 0===n?void 0:n.value)||"",[m,p]=(0,f.useState)(u),[g,v]=(0,f.useState)(!1),{isDone:_,isError:x,isAborted:y,text:b=""}=(0,ha.P)((e=>e.messages[l]))||{},w=!!(b||x||_||y);return(0,f.useEffect)((()=>{null==a||a(!!_,b)}),[_,Math.round(b.length/20)]),(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsx)("div",{className:t_.messageBox,children:(0,Le.jsx)(Sr,{id:l,type:"mail",enableScroll:!0,className:t_.message,onRetry:()=>o(a_.Retry,m)})}),w&&(0,Le.jsx)("div",{className:t_.messageFooter,"data-testid":"writing-assistant-writing-footer",children:(0,Le.jsxs)("div",{className:t_.messageBtns,children:[(0,Le.jsxs)("div",{className:t_.btnLeft,children:[(0,Le.jsx)(ya.c,{"data-testid":"writing-assistant-btn-regenerate",className:t_.btn,size:"small",icon:(0,Le.jsx)(ze.eD,{}),type:"tertiary",onClick:()=>o(a_.Regenerate,m),children:i("regenerate_button_hover_text","\u91cd\u65b0\u751f\u6210")}),(0,Le.jsx)(Be.l6,{"data-testid":"writing-assistant-btn-changetone",className:ie()(t_.btn,t_.adjustTone),size:"small",prefix:(0,Le.jsx)(be.ebl,{}),getPopupContainer:r,value:m,arrowIcon:g?(0,Le.jsx)(be.sXP,{}):(0,Le.jsx)(be.HXh,{}),clickToHide:!0,onDropdownVisibleChange:e=>v(e),onChange:e=>{p(String(e)),o(a_.ChangeTone,e)},children:d.map((e=>(0,Le.jsx)(Be.l6.Option,{value:e.value,children:(0,Le.jsx)("span",{"data-tone-option":e.value,children:e.show_name})},e.value)))}),(0,Le.jsx)(ya.c,{"data-testid":"writing-assistant-btn-shorter",className:t_.btn,size:"small",icon:(0,Le.jsx)(be.Z87,{}),type:"tertiary",onClick:()=>o(a_.MakeShorter,m),children:i("cici_desktop_skill_make_shorter","\u7f29\u5199")}),(0,Le.jsx)(ya.c,{"data-testid":"writing-assistant-btn-longer",className:t_.btn,size:"small",icon:(0,Le.jsx)(be.UJs,{}),type:"tertiary",onClick:()=>o(a_.MakeLonger,m),children:i("cici_desktop_skill_make_longer","\u6269\u5199")})]}),(0,Le.jsx)("div",{className:t_.btnRight,children:(0,Le.jsx)(ya.c,{"data-testid":"writing-assistant-btn-confirm",size:"small",type:"primary",onPointerDown:e=>e.preventDefault(),onClick:()=>{b&&s(b)},children:"write"===e.type?"\u63d2\u5165":"\u5168\u90e8\u66ff\u6362"})})]})})]})}var l_=n(65117),c_=n(20633),d_=n(24005),u_=n(59177);const h_=["active","item","onClick"];function m_(e){const{active:t,item:n,onClick:i}=e,o=(0,so.A)(e,h_);return(0,Le.jsxs)("div",(0,a.A)((0,a.A)({},o),{},{className:ie()(t_.item,{[t_.selected]:t}),onClick:i,children:[(0,Le.jsx)(d_.Image,{wrapperClassName:t_["item-img"],src:n.background_url,imageOptions:{squareContainer:!0,objectFit:"contain",draggable:!1,width:100,height:130}},n.value),(0,Le.jsx)("div",{className:t_["item-title"],title:n.show_name,children:n.show_name})]}))}function p_(e){const{config:t}=e,[n,i]=(0,f.useState)();return null!=t&&t.template?(0,Le.jsx)(eh.F,{carouselRowClassName:t_["carousel-row-wrapper"],children:(null==t?void 0:t.template)&&t.template.map(((o,s)=>(0,Le.jsx)(m_,{"data-testid":`writing-assistant-template-${s}`,item:o,active:n===s,onClick:()=>{var a;if(s===n)return;i(s);const r=(0,u_.nP)(o.value||"",t.input_options);null===(a=e.onItemClick)||void 0===a||a.call(e,o,r)}},s)))}):(0,Le.jsx)(Be.tK,{})}function g_(e){const{editorValue:t,onEditorValueChange:n,writingConfig:i}=e,{t:o}=(0,s_.B)(),s=(0,l_.r$)(t?(0,If.fG)(null==t?void 0:t.data):"",!0);return(0,f.useEffect)((()=>{Ff.getState().refreshWritingTemplatesActionId(),Mf(Ff.getState().writingTemplatesActionId)}),[]),(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsx)("div",{"data-testid":"writing-assistant-template-container",className:ie()(t_.banner),children:(0,Le.jsx)(p_,{config:null==i?void 0:i.write,onItemClick:(e,t)=>{n(t),Rf(Ff.getState().writingTemplatesActionId,e.show_name||"")}})}),(0,Le.jsxs)("div",{className:t_.promptEditor,style:{userSelect:"auto"},children:[(0,Le.jsx)(c_.uX,{"data-testid":"writing-assistant-text-editor",value:t,style:{fontSize:14},dir:(0,l_.V8)()?s:"ltr",onChange:e=>n(e),placeholder:o("skill_writing_compose_input_placeholder")}),(0,Le.jsx)("div",{className:t_.footer,children:(0,Le.jsx)(ya.c,{"data-testid":"writing-assistant-editor-btn-write",type:"primary",size:"small",onPointerDown:e=>e.preventDefault(),onClick:()=>{e.onConfirm&&e.onConfirm(t)},disabled:(0,If.GI)(t),children:o("flow_web_ext_email_write","\u64b0\u5199")})})]})]})}var v_=n(95428);function f_(e){var t,n;const{visible:i=!0}=e,o=(0,jf.a)(),[s,a]=(0,f.useState)(!1),[r,l]=(0,f.useState)(""),[c,d]=(0,f.useState)({data:[]}),u=(0,f.useRef)(null),h=(0,f.useRef)(null),m=(0,f.useRef)(null==e||null===(t=e.getPopupContainer)||void 0===t?void 0:t.call(e)),p=(0,g.B)();(0,n_.A)((()=>{a(!1)}),[u,h,m]);const v=(0,f.useCallback)((e=>{const t=(0,If.fG)(e.data),n=(0,v_.q)({text:t});l(n)}),[l]),[x,y]=(0,f.useState)(0),b=(null===(n=(0,ha.P)((e=>e.messages[r]||{})))||void 0===n?void 0:n.text)||"";return(0,f.useEffect)((()=>{i&&Tf(_._h.write)}),[i]),(0,Le.jsx)(Be.AM,{style:{width:600},className:ie()(t_.popover,{[t_.writePopover]:!r}),trigger:"custom",spacing:ef,visible:s,getPopupContainer:e.getPopupContainer,onVisibleChange:e.onVisibleChange,rePosKey:x,position:"bottomLeft",content:(0,Le.jsxs)("div",{ref:u,"data-testid":"writing-assistant-popover-write",style:{userSelect:"none"},children:[(0,Le.jsx)(o_,{title:"\u5e2e\u6211\u5199",getPopupContainer:e.getPopupContainer,hasBackIcon:!!r,showCopy:!!r,onBackClick:()=>{l("")},onClose:()=>{a(!1)},onCopyClick:()=>{const e=Ff.getState().writingTemplatesActionId;return Lf(_._h.btnCopy,e),!!b&&es()(b)},text:b}),r?(0,Le.jsx)(r_,{type:"write",messageId:r,getPopupContainer:e.getPopupContainer,writingConfig:o,onMessageChange:()=>y(x+1),onButtonClick:(e,t)=>{if(e===a_.Regenerate||e===a_.Retry)v(c);else if(e===a_.MakeLonger){const e=ha.P.getState().messages[r],t=(0,v_.g)({text:e.text||"",template_type:"adjust",adjust:"\u6269\u5199"});l(t)}else if(e===a_.MakeShorter){const e=ha.P.getState().messages[r],t=(0,v_.g)({text:e.text||"",template_type:"adjust",adjust:"\u7f29\u5199"});l(t)}else if(e===a_.ChangeTone){const e=ha.P.getState().messages[r],n=(0,v_.g)({text:e.text||"",template_type:"tone",tone:t});l(n)}},onConfirmClick:t=>{var n;a(!1),null===(n=e.onWriteComplate)||void 0===n||n.call(e,t);const i=Ff.getState().writingTemplatesActionId;Lf(_._h.btnInsert,i)}}):(0,Le.jsx)(g_,{writingConfig:o,editorValue:c,onEditorValueChange:e=>d(e),onConfirm:e=>{v(e)}})]}),children:(0,Le.jsx)("span",{ref:h,style:{position:"relative",display:i?"block":"none"},children:(0,Le.jsx)(Fp,{testid:"writing-assistant-btn-write",className:ie()({[t_.active]:s}),tooltip:p("flow_web_ext_email_regenerate","\u5e2e\u6211\u5199"),onClick:()=>{a(!s),Nf(_._h.write)},icon:(0,Le.jsx)(kf.vlM,{}),tooltipOptions:{spacing:ef},getPopupContainer:e.getPopupContainer})})})}function __(e){var t,n;const i=(0,jf.a)(),[o,s]=(0,f.useState)(!1),[a,r]=(0,f.useState)(""),l=(0,f.useRef)(null),c=(0,f.useRef)(null),d=(0,f.useRef)(null==e||null===(t=e.getPopupContainer)||void 0===t?void 0:t.call(e)),u=(0,f.useRef)(),h=(0,g.B)(),{visible:m=!0}=e,p=(null===(n=(0,ha.P)((e=>e.messages[a]||{})))||void 0===n?void 0:n.text)||"";(0,n_.A)((()=>{s(!1)}),[l,c,d]);const v=e=>{a&&a!==e&&ha.P.getState().abortMessage(a,"regenerate"),r(e)},x=(0,f.useCallback)((()=>{if(e.inputText){var t;const n=(null==i||null===(t=i.compose)||void 0===t||null===(t=t.tone)||void 0===t||null===(t=t.find((e=>e.is_default)))||void 0===t?void 0:t.value)||"",o=(0,v_.g)({text:e.inputText||"",template_type:"tone",tone:n});v(o)}}),[e.inputText]);(0,f.useEffect)((()=>{o&&e.inputText&&u.current!==e.inputText&&(u.current=e.inputText,x())}),[e.inputText,o]);const[y,b]=(0,f.useState)(0);return(0,f.useEffect)((()=>{m&&(Tf(_._h.rewrite),Ff.getState().refreshWritingTemplatesActionId())}),[m]),(0,Le.jsx)(Be.AM,{style:{width:600,userSelect:"none"},className:t_.popover,trigger:"custom",spacing:ef,visible:o,getPopupContainer:e.getPopupContainer,onVisibleChange:e.onVisibleChange,rePosKey:y,position:"bottomLeft",content:(0,Le.jsxs)("div",{ref:l,"data-testid":"writing-assistant-popover-rewrite",children:[(0,Le.jsx)(o_,{title:"\u91cd\u5199",getPopupContainer:e.getPopupContainer,showCopy:!!a,onCopyClick:()=>{const e=Ff.getState().writingTemplatesActionId;return Lf(_._h.btnCopy,e),!!p&&es()(p)},onClose:()=>{s(!1)},text:p}),(0,Le.jsx)(r_,{type:"rewrite",messageId:a,getPopupContainer:e.getPopupContainer,writingConfig:i,onMessageChange:()=>b(y+1),onButtonClick:(e,t)=>{if(e===a_.Regenerate||e===a_.Retry)x();else if(e===a_.MakeLonger){const e=ha.P.getState().messages[a],t=(0,v_.g)({text:e.text||"",template_type:"adjust",adjust:"\u6269\u5199"});v(t)}else if(e===a_.MakeShorter){const e=ha.P.getState().messages[a],t=(0,v_.g)({text:e.text||"",template_type:"adjust",adjust:"\u7f29\u5199"});v(t)}else if(e===a_.ChangeTone){const e=ha.P.getState().messages[a],n=(0,v_.g)({text:e.text||"",template_type:"tone",tone:t});v(n)}},onConfirmClick:t=>{var n;s(!1),null===(n=e.onWriteComplate)||void 0===n||n.call(e,t);const i=Ff.getState().writingTemplatesActionId;Lf(_._h.btnReplace,i)}})]}),children:(0,Le.jsx)("span",{ref:c,style:{position:"relative",display:m?"block":"none"},children:(0,Le.jsx)(Fp,{testid:"writing-assistant-btn-rewrite",className:ie()({[t_.active]:o}),tooltip:h("flow_ext_rewrite","\u91cd\u5199"),tooltipOptions:{spacing:ef},onClick:()=>{s(!o),Nf(_._h.rewrite)},icon:(0,Le.jsx)(be.KHH,{}),getPopupContainer:e.getPopupContainer})})})}function x_(e){const{revisionState:t={count:0,loading:!1}}=e,[n,i]=(0,f.useState)(!1),o=(0,f.useRef)(null),s=(0,f.useRef)(new Map),a=(0,f.useRef)(),[r,l]=(0,f.useState)(!1),c=(0,f.useCallback)((()=>{a.current&&(clearTimeout(a.current),a.current=void 0)}),[a]);(0,n_.A)((()=>{r||i(!1)}),[o],[r]);const d=(0,f.useCallback)((()=>(0,ht.E8)()||o.current),[o]),{width:u,hasBg:h}=(0,f.useMemo)((()=>function(e,t,n){let i=1,o=!0;return e&&(i++,n.length>0&&i++),t>0&&(e?i++:(i=1,o=!1)),{width:i*of+(i-1)*af+(i<=1?0:sf+af),hasBg:o}}(n,t.count,e.inputText)),[n,t.count,e.inputText]),m=(e,t)=>{s.current.set(e,t);let n=!1;for(const i of s.current)if(i[1]){n=!0;break}i(n),l(n)};return(0,Le.jsx)("div",{"data-testid":"writing-assistant-container",className:t_.helpWrite,ref:o,onClick:e=>e.stopPropagation(),style:{userSelect:"none"},onMouseEnter:()=>{c(),m("enter",!0)},onMouseLeave:()=>{c(),a.current=setTimeout((()=>{m("enter",!1)}),500)},children:(0,Le.jsxs)("div",{className:ie()({[t_.inputAssist]:!0,[t_.expand]:n,[t_.hasBg]:h}),style:{width:u},children:[(0,Le.jsx)(i_,{visible:n,getPopupContainer:d,onVisibleChange:e=>m("settings",e),icon:(0,Le.jsx)(ze.TH,{}),title:"\u8bbe\u7f6e"}),(0,Le.jsx)("span",{className:t_.spliter}),(0,Le.jsx)(__,{visible:!!e.inputText,inputText:e.inputText,onWriteComplate:t=>{var n;return null===(n=e.onWirteComplate)||void 0===n?void 0:n.call(e,"replace",t)},onVisibleChange:e=>m("rewrite",e),getPopupContainer:d}),(0,Le.jsx)(f_,{onWriteComplate:t=>{var n;null===(n=e.onWirteComplate)||void 0===n||n.call(e,"insert",t)},getPopupContainer:d,onVisibleChange:e=>m("write",e)}),t.count>0&&(0,Le.jsx)(Fp,{tooltip:"\u4e00\u952e\u7ea0\u6b63\u8bed\u6cd5",icon:(0,Le.jsx)("div",{className:t_.revisionCount,children:t.count}),tooltipOptions:{spacing:ef},onClick:e.onRevisionClick,getPopupContainer:d})]})})}const y_=(e,[t,n])=>Math.min(Math.max(e,t),n),b_={prevent:!0,preventPointerDown:!0,direction:"both",maxDistance:{x:{max:1/0,min:-1/0},y:{max:1/0,min:-1/0}},setCSS:!0},w_=e=>{const t=(0,f.useMemo)((()=>(0,a.A)((0,a.A)({},b_),e)),[e]),n=(0,f.useRef)(null),i=(0,f.useRef)(null),o=(0,f.useRef)([0,0]),s=(0,f.useRef)([0,0]),r=(0,f.useRef)([0,0]),l=(0,f.useRef)(!1),[c,d]=(0,f.useState)([0,0]),u=(0,f.useCallback)(((e,n)=>{r.current=e,d(e),i.current&&t.setCSS&&(i.current.style.transition=n||"",i.current.style.transform=`translate3d(${e[0]}px, ${e[1]}px, 0)`)}),[t.setCSS]),h=(0,f.useCallback)((e=>{var i;if(e.button>0)return;const[a,c]=r.current;let[d,h]=r.current;l.current=!0,d=e.clientX-a,h=e.clientY-c,s.current=[e.clientX,e.clientY],o.current=[d,h],null===(i=t.onStart)||void 0===i||i.call(t,n,[d,h],u),t.preventPointerDown&&e.preventDefault()}),[t,u]),m=(0,f.useCallback)((e=>{var i,s,a,c,d,h,m,g,v,f;if(e.button>0&&(l.current=!1,p(e)),!l.current)return;null===(i=n.current)||void 0===i||i.setPointerCapture(e.pointerId),t.prevent&&e.preventDefault();const[_,x]=o.current;let[y,b]=r.current;y=e.clientX-_,b=e.clientY-x,y="vertical"===t.direction?0:y_(y,[null!==(s=null===(a=t.maxDistance)||void 0===a||null===(a=a.x)||void 0===a?void 0:a.min)&&void 0!==s?s:-1/0,null!==(c=null===(d=t.maxDistance)||void 0===d||null===(d=d.x)||void 0===d?void 0:d.max)&&void 0!==c?c:1/0]),b="horizontal"===t.direction?0:y_(b,[null!==(h=null===(m=t.maxDistance)||void 0===m||null===(m=m.y)||void 0===m?void 0:m.min)&&void 0!==h?h:-1/0,null!==(g=null===(v=t.maxDistance)||void 0===v||null===(v=v.y)||void 0===v?void 0:v.max)&&void 0!==g?g:1/0]),null===(f=t.onMove)||void 0===f||f.call(t,n,[y,b],u),u([y,b])}),[l,t,u]),p=(0,f.useCallback)((e=>{var i,o;const[a,c]=s.current,d=Math.abs(e.clientX-a),h=Math.abs(e.clientY-c);var m;d<=4&&h<=4&&(null===(m=t.onClickLike)||void 0===m||m.call(t));null===(i=n.current)||void 0===i||i.releasePointerCapture(e.pointerId),l.current=!1,null===(o=t.onEnd)||void 0===o||o.call(t,n,r.current,u)}),[t,u]);return(0,f.useEffect)((()=>{const e=n.current;return null==e||e.addEventListener("pointerdown",h),null==e||e.addEventListener("pointermove",m),null==e||e.addEventListener("pointerup",p),null==e||e.addEventListener("pointercancel",p),()=>{null==e||e.removeEventListener("pointerdown",h),null==e||e.removeEventListener("pointermove",m),null==e||e.removeEventListener("pointerup",p),null==e||e.removeEventListener("pointercancel",p)}}),[n,t,h,m,p]),{anchor:n,target:i,position:c,setPosition:u}};function C_(){const{inputAssistantDisabled:e,revisionMap:t,dragPositionMap:n}=Ff(),i=Bf(we.lf.inputAssistant),[o]=(0,v.Y)("InputAssistantDisabledAll"),{inputState:s,visible:a}=Sf(),{target:r,anchor:l,setPosition:c}=w_({prevent:!0,preventPointerDown:!0,onMove(e,t){null!=s&&s.editor&&Ff.getState().updateDragPosition(s.editor.dom,t)}});if((0,f.useEffect)((()=>{null!=s&&s.editor&&c(n.get(s.editor.dom)||[0,0])}),[null==s?void 0:s.editor]),null==s||!s.editor||e||o||i.hasHost())return null;const d=t.get(s.editor.dom);return(0,Le.jsx)("div",{style:{display:a?"block":"none",position:"absolute",left:s.point.x,top:s.point.y},ref:r,children:(0,Le.jsx)("div",{ref:l,children:(0,Le.jsx)(x_,{inputText:s.inputText,revisionState:{count:(null==d?void 0:d.count)||0,loading:(null==d?void 0:d.loading)||!1},onRevisionClick:()=>{null==d||d.env.replaceAll(),(0,et.s)("detect_grammar_error_click",{current_page:(0,tn.M5)(location.href)}),(0,Qe.dn)({click_from:"writing_assistant"})},onWirteComplate:(e,t)=>{if(s.editorType===bv.Rich){t=t.replace(/\s{2,}/gi,"\n");const n=s.activeElement;if(n){const i=window.getSelection(),o=document.createRange();"replace"===e?(o.setStartBefore(n),o.setEndAfter(n)):(o.setStartAfter(n),o.setEndAfter(n)),i&&(i.removeAllRanges(),i.addRange(o));const s=n.innerText;setTimeout((()=>{(0,rt.Ig)(t,n),Vp(n),setTimeout((()=>{n.innerText===s&&(n.innerText=t,null==i||i.removeAllRanges())}),0)}),0)}}else s.editor.insertText(t,"replace"===e)}})})})}var A_=n(76064);var S_=n(68058),I_=n(54188);const k_=({onClickOutside:e,placementLeft:t})=>{const n=(0,g.B)(),i=(0,fc.A)((()=>{null==e||e()}));return(0,Le.jsx)("div",{"data-testid":"page-translate-same-language-notice",ref:i,className:ie()(I_.A["language-notice-wrapper"],{[I_.A["placement-left"]]:t}),children:(0,Le.jsxs)("div",{className:I_.A["language-notice"],children:[(0,Le.jsx)(ze.Zx,{className:I_.A.icon}),(0,Le.jsx)("div",{className:I_.A.content,children:n("flow_web_ext_sidebar_translate_notify")})]})})};var j_=n(18587),E_=n(76708),T_=n(58027);function N_(e,t){return M_.apply(this,arguments)}function M_(){return M_=(0,r.A)((function*(e,t){if((0,Dl.BB)({action:"web_translatePage",loginParams:{trackMeta:{login_entrance:"float_btn"}}}))return;const{setShowLangNotice:n}=Mp.I.getState();(0,T_.Ip)({lang:e,translateService:(0,j_.w)(t)});e===(yield(0,E_.b)((0,E_.T)()))&&n(!0)})),M_.apply(this,arguments)}const R_=()=>{const{active:e}=(0,Mp.I)();return e?(0,Le.jsx)(be.xsk,{className:hv.translateActiveIcon}):(0,Le.jsx)(be.ZR1,{})},L_=e=>{const{btnListReverse:t,showLangSettings:n,showLangSettingIcon:i,shortcutText:o}=e,[s]=(0,v.Y)("translateLanguage"),[a]=(0,v.Y)("pageTranslateService"),{active:r,setActive:l,showLangNotice:c,setShowLangNotice:d}=(0,Mp.I)(),[u,h]=(0,f.useState)(!1),m=(0,g.B)(),{type:p}=(0,Rp.IF)(),[x]=(0,v.Y)("pageTranslateShowUnderline");(0,f.useEffect)((()=>{(0,T_.J7)(x)}),[x]);const y=(0,f.useRef)(null),b=(0,f.useMemo)((()=>!u),[u]);return(0,Le.jsxs)("div",{className:I_.A.wrapper,children:[(0,Le.jsx)("div",{className:ie()(hv.floatBtnPanelItemTranslate),onMouseEnter:()=>{h(p===dc.u9.pdf)},onMouseLeave:()=>{h(!1)},children:(0,Le.jsxs)("div",{className:ie()(hv.floatBtnPanelItemBlock,{[hv.floatBtnPanelItemBlockWithSetting]:n||i}),onClick:e=>{e.stopPropagation(),e.preventDefault(),p!==dc.u9.pdf&&((0,Ce.GT)(),r?(0,T_.g$)():N_(s,a),l(!r),(0,Dm.Ie)({button_name:_._h.translatePage,params:{translate_service:(0,J.TK)("pageTranslateService"),to_lang:(0,J.TK)("translateLanguage")}}))},"data-testid":"float-button-translate",children:[(0,Le.jsx)("div",{className:ie()("float-button-translate-setting",hv.floatBtnPanelItemLangSettingsIcon,hv.floatBtnPanelItemIcon,{[hv.showLangSettingIcon]:n||i},{[hv.active]:n},{[hv.showLangSettingIconReverse]:t}),onClick:t=>{t.stopPropagation(),t.preventDefault(),p!==dc.u9.pdf&&((0,Ce.GT)(),e.onClickSettings())},"data-testid":"float-button-translate-setting",style:{margin:t?"6px 0 0 0":"0 0 6px 0"},children:(0,Le.jsx)(be.fsR,{})}),(0,Le.jsx)("div",{ref:y,className:ie()(hv.floatBtnPanelItemIcon,{[hv.floatBtnPanelItemIconReverse]:t}),"data-testid":"float-button-translate-icon",children:(0,Le.jsx)(Be.m_,{content:(0,Le.jsxs)("div",{className:hv.tooltipContent,children:[(0,Le.jsx)("div",{className:hv.text,children:m(u?"flow_web_ext_sidebar_translate_notice_pdfsupport":r?"flow_web_ext_sidebar_translateoff":"flow_web_ext_sidebar_translate")}),b&&(0,Le.jsx)("div",{className:hv.shortcutText,children:o})]}),position:"left",getPopupContainer:()=>y.current,className:hv.tooltipContainer,children:(0,Le.jsx)("div",{style:{lineHeight:0},children:(0,Le.jsx)(R_,{})})})})]})}),c&&(0,Le.jsx)(k_,{placementLeft:t,onClickOutside:()=>d(!1)})]})},P_=e=>{const{active:t}=(0,Mp.I)(),[n]=(0,v.Y)("translateLanguage"),[i]=(0,v.Y)("pageTranslateService"),[o,s]=(0,v.Y)("autoTranslatePageHosts"),r={onSetAutoTranslate:e=>{const{href:t}=window.location,n=new URL(t).hostname;s(e?[...new Set([...o,n])]:(0,Bp.A)(o,(e=>e!==n)))}},l=(0,a.A)((0,a.A)({},r),e);return(0,Tg.H)((()=>{t&&N_(n,i)}),[n,i]),(0,Le.jsx)(S_.A,(0,a.A)({},l))},B_=()=>{const e=(0,g.B)(),t=Rm(),n=(0,f.useMemo)((()=>e(t?"flow_web_ext_sidebar_bookmarks_saved":"flow_web_ext_sidebar_bookmarks")),[e,t]),i=(0,f.useRef)(null);return(0,Le.jsx)("div",{className:hv.toolContainer,onClick:()=>{t?(0,Vt.PU)(t):(0,Vt.XQ)({collectionType:mt.X.Web,collectFrom:pt.vP.side_bar_popover})},"data-testid":"float-button-collect-page",ref:i,children:(0,Le.jsx)(Be.m_,{content:n,position:"left",getPopupContainer:()=>i.current,children:(0,Le.jsx)("div",{className:hv.floatBtnPanelItemBlock,children:t?(0,Le.jsx)(be.u06,{className:ie()(hv.floatBtnPanelItemIcon,hv.floatBtnPanelItemIconCollected)}):(0,Le.jsx)(be.Wur,{className:ie()(hv.floatBtnPanelItemIcon)})})})})};var D_=n(41829),F_=n(16526),U_=n(63634);const H_={dot:"dot-CShR0Q"};function z_(e){const{className:t,children:n}=e,i=(0,U_.A)();return null!=i&&i.version&&(i.version===i.dotVisibleVersion||i.version===i.cardVisibleVersion)||null==i||!i.data?null:(0,Le.jsxs)("div",{className:ie()(H_.badge,t),children:[n,(0,Le.jsx)("span",{className:H_.dot})]})}var O_=n(17373),q_=n(9380);const V_=e=>-e*window.innerHeight,$_={startX:0,startY:0,threshold:6,startT:0,start(e,t){this.startX=e,this.startY=t,(0,gt.Rm)("[Daniel] floatBtn pos",e,t),this.startT=Date.now()},isValid(e,t){const n=e-this.startX,i=t-this.startY;return Math.sqrt(n*n+i*i)>this.threshold&&Date.now()-this.startT>300}};function K_(e){const[t,n]=(0,v.Y)("sidebarButtonTop"),[i,o]=(0,f.useState)(!1),[s,a]=(0,f.useState)(!1),[r,l]=(0,f.useState)(!1),[c,d]=(0,f.useState)(!1),[u,h]=(0,f.useState)(!1),[m,p]=(0,f.useState)(!1),g=(0,dn.l)((e=>e.setIsShowSidebarBtn)),{shortcutKey:x}=(0,q_.Z)(F_.e.OpenSide),{shortcutKey:y}=(0,q_.Z)(F_.e.TranslatePage),{shortcutKey:b}=(0,q_.Z)(F_.e.ReadPage),{active:w}=(0,Mp.I)((e=>({active:e.active}))),C=s,A=w,S=C||A,I=490-window.innerHeight,k=42-window.innerHeight,{anchor:j,target:E,setPosition:T}=w_({direction:"both",onStart(e,t){const[n,i]=t;$_.start(n,i)},onMove(e,t){const[n,i]=t;$_.isValid(n,i)&&(o(!0),d(!1),l(!1),p(!1))},onEnd(e,t){const i=-t[1]/window.innerHeight;const s=y_(V_(i),[k,0]);n(i),T([0,s]),h(s<I),(0,A_.A)((()=>o(!1)))},maxDistance:{y:{min:k,max:0}},onClickLike:()=>{i||((0,Ce.GT)(),dn.l.getState().toggleShowSidebar(_.cz.clickSidebar),(0,D_.s)())}});(0,f.useEffect)((()=>{(0,Dm.oJ)()}),[]),(0,f.useEffect)((()=>{!i&&C&&((0,Dm.jv)(),(0,vt.ku)()&&(0,pt.ae)(pt.vP.side_bar_popover,pt.p6.web))}),[i,C]),(0,f.useLayoutEffect)((()=>{const e=y_(V_(t),[k,0]);T([0,e]),h(e<I)}),[k,t]);const N=!i&&S&&!r&&!c||c,M=function(e,t,n){const[i,o]=(0,f.useState)([]);return(0,f.useEffect)((()=>{let i;return n&&(o([e]),i=setTimeout((()=>o([e,t])),50)),()=>{clearTimeout(i),o([])}}),[n]),i}(hv.show,hv.expand,N),R=N?M:[],L=(0,f.useRef)(null);return(0,Le.jsx)("div",{ref:E,style:e.isSidebarShow?{[e.align]:Un.gH}:{},className:ie()(hv.floatBtn,{[hv.left]:"left"===e.align,[hv.right]:"right"===e.align}),children:(0,Le.jsxs)("div",{className:ie()(hv.floatBtnWrapper,{[hv.reverse]:u}),onMouseLeave:()=>a(!1),children:[!i&&c&&!r&&(0,Le.jsx)(P_,{onVisibleChange:(e,t)=>{var n;const i=null==t||null===(n=t.composedPath)||void 0===n?void 0:n.call(t);null!=i&&i.some((e=>{var t;return e===(null===(t=E.current)||void 0===t?void 0:t.querySelector(".float-button-translate-setting"))}))||d(e)},reverse:u}),!i&&(0,Le.jsxs)("div",{"data-role":"float-button-list",className:ie()(hv.floatBtnList,[...R]),style:{flexDirection:u?"column-reverse":"column"},children:[(0,Le.jsx)(L_,{btnListReverse:u,showLangSettingIcon:A,showLangSettings:c,onClickSettings:()=>{(0,Dm.Ie)({button_name:_._h.languageSettings}),d(!c)},shortcutText:(0,O_.o)(y)}),!C&&A?null:(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsx)(Be.cG,{className:hv.toolDivider}),(0,Le.jsx)(vv,{btnListReverse:u,shortcutText:(0,O_.o)(b)}),(0,vt.ku)()&&(0,Le.jsx)(B_,{})]})]}),(0,Le.jsxs)("div",{ref:L,"data-testid":"float-button-brand-entry",className:ie()(hv.floatBtnBrand,{[hv.expand]:!i&&S||r}),children:[(0,Le.jsx)(Ae.A,{className:ie()(hv.closeBtn,{[hv.closeBtnExpand]:!i&&S}),optionPageSection:"sidebar",position:u?"bottomRight":"topRight",disableKey:Tc.lf.chatAssistant,onDisableOnceClick:()=>g(!1),show:r,setShow:l,renderChildren:({onTriggerClick:e})=>(0,Le.jsx)(ze.gz,{className:hv.floatBtnCloseIcon,onClick:t=>{t.preventDefault(),t.stopPropagation(),r?l(!r):e(t)}})}),(0,Le.jsx)(Be.m_,{visible:m,className:hv.shortcut,content:(0,O_.o)(x),position:"left",getPopupContainer:()=>L.current,children:(0,Le.jsx)("img",{ref:j,src:(0,Se.Nf)(),className:hv.floatBtnAvatar,onMouseEnter:()=>{a(!0),p(!0)},onMouseLeave:()=>{p(!1)}})}),(0,Le.jsx)(z_,{})]})]})})}const W_="wrapper-Vi_cs1",G_=()=>{var e,t;const{actionMessages:n,currentAction:i,messageCursor:o,inputText:s}=(0,Np.t_)(),a=(0,ha.P)((e=>e.messages)),r=null!==(t=(null!==(e=n[i])&&void 0!==e?e:[])[o])&&void 0!==t?t:"",{text:l=""}=a[r]||{},{value:c}=(0,en.Tu)(en.FM.searchCardAutoSummary,!0),d=(0,f.useRef)(s),u=d.current;return(0,f.useEffect)((()=>{s&&(d.current=s)}),[s]),(0,zh.s)()?(0,Le.jsxs)("div",{className:W_,children:[(0,Le.jsx)("input",{type:"hidden","data-testid":"e2e-meta-runtime-state-input-text",value:u}),(0,Le.jsx)("input",{type:"hidden","data-testid":"e2e-meta-runtime-state-current-action",value:i}),(0,Le.jsx)("input",{type:"hidden","data-testid":"e2e-meta-runtime-state-search-card-auto-summary",value:c.toString()}),(0,Le.jsx)("textarea",{readOnly:!0,value:l,"data-testid":"e2e-meta-runtime-state-message"})]}):null};var Z_=n(30940);const Y_={select:Np.t_,layout:dn.l,global:Gd.on,page:Rp.IF,translate:Mp.I},J_={select:["barVisible","inputText","contextText","writeEnabled"],layout:["showTip","enterSidebarMode"],global:["floatingCardVisible","summaryActionVisible"],page:["title","url","favicon","type"],translate:["active","showOrigin"]},Q_={layout:["showTip","enterSidebarMode"],global:["floatingCardVisible","summaryActionVisible","chatPageReady"],select:[],page:[],translate:["active","showOrigin"]},X_=(()=>{const e={contentScript:[],sidePanel:[]};return{update:(t,n)=>{e[t]=[...e[t]].concat(n);e.contentScript.length&&(0,fm.cs)({name:"update-zustand-state",body:e.contentScript}).catch((e=>console.log(e))),e.sidePanel.length&&(0,fm.Iq)({name:"update-zustand-state",body:e.sidePanel}).catch((e=>console.log(e))),e.contentScript=[],e.sidePanel=[]}}})(),ex=(e,t,n,i={})=>{const o=("contentScript"===e?J_:Q_)[t].reduce(((e,o)=>(i&&n[o]===i[o]||e.push({key:o,data:n[o],storeKey:t}),e)),[]);o.length&&X_.update(e,o)},tx=()=>{ex("contentScript","select",Np.t_.getState()),ex("contentScript","layout",dn.l.getState()),ex("contentScript","global",Gd.on.getState()),ex("contentScript","page",Rp.IF.getState()),ex("contentScript","translate",Mp.I.getState())},nx=(e,t,n)=>e.subscribe(((i,o)=>{e.mutex||ex(n,t,i,o)}));var ix=n(13748),ox=n(43621);const sx=()=>{const[e,t]=(0,f.useState)(Kp);return(0,f.useEffect)((()=>{let e;const n=(n=!1)=>{if((0,rt.jg)(document.activeElement))return;const i=(0,Lp.GF)(),o=(0,Lp.yI)();if(!i||(0,Gg.x)(e,i)||!o)return;e=i;const s=new $p(window.getSelection());t({baseInfo:i,selectionHelper:s,isContextMenu:n}),Np.t_.setState({writeEnabled:s.canInsert,inputText:i.text,contextText:i.contextText,range:i.range,selectionBaseInfo:i,simpleSelectionBaseInfo:o})};let i=0;const o=()=>{clearTimeout(i),i=(0,A_.A)(n)},s=()=>{clearTimeout(i),i=(0,A_.A)((()=>n(!0)))},a=()=>n();return(0,qp.CN)()&&document.addEventListener("selectionchange",o),document.addEventListener("pointerup",o),window.addEventListener("keydown",o),window.addEventListener("keyup",o),window.addEventListener("resize",a),window.addEventListener("wheel",a),window.addEventListener("scroll",a),window.addEventListener("contextmenu",s),()=>{clearTimeout(i),document.removeEventListener("selectionchange",o),document.removeEventListener("pointerup",o),window.removeEventListener("resize",a),window.removeEventListener("wheel",a),window.removeEventListener("scroll",a),window.removeEventListener("keydown",o),window.removeEventListener("keyup",o),window.removeEventListener("contextmenu",s)}}),[]),e};var ax=n(59355);const rx=()=>{const[e]=(0,v.Y)("autoTranslatePageHosts"),{setActive:t,setShowLangNotice:n}=(0,Mp.I)(),i=(0,f.useMemo)((()=>{const t=new URL(window.location.href).hostname;return(0,ax.A)(e,t)}),[e]),o=function(){var e=(0,r.A)((function*(){try{const e=(0,J.TK)("translateLanguage"),i=(0,J.TK)("pageTranslateService");t(!0),(0,T_.Ip)({lang:e,translateService:(0,j_.w)(i)});e===(yield(0,E_.b)((0,E_.T)()))&&n(!0)}catch(e){}}));return function(){return e.apply(this,arguments)}}();(0,f.useEffect)((()=>{const{active:e}=Mp.I.getState();i&&!e&&o()}),[i])},lx={name:"chat-page-ready",handle:e=>{ni.A.emit("chat-page-ready",e),tx()}};var cx=n(51514);const dx={name:"locate-highlight-dom",handle:e=>{e&&(0,cx.p)(e)}},ux={name:"read-page-request",handle:function(){var e=(0,r.A)((function*(){return(0,mv.B9)()}));return function(){return e.apply(this,arguments)}}()},hx={name:"update-zustand-state",handle:(e=[])=>{(e=>{e.forEach((e=>{const{key:t,data:n,storeKey:i}=e;(0,gt.Rm)(`update state env.isInSidePanel=${pv._.isInSidePanel}\n       store=${i} key=${t} value=${n}`);const o=Y_[i];o&&o.getState()[t]!==n&&(o.mutex=!0,o.setState({[t]:n}),o.mutex=!1)}))})(e)}};var mx=n(25118);const px={name:"translate-page-request",handle:()=>(0,mx.TI)({isActive:!0})},gx={name:"auto-translate-page-request",handle:e=>(0,mx.sb)(e)},vx={name:"translate-show-origin-request",handle:()=>(0,mx.S_)()};let fx;const _x={name:"router-change",handle:e=>{const t=location.href;fx!==t&&(ni.A.emit("router-change",e),fx=t)}},xx={name:"reading-webpage-context",handle:e=>{ni.A.emit("show-reading-effect",e)}};const yx=({type:e})=>{"done"!==e&&"error"!==e&&"update"!==e||ni.A.emit("show-reading-effect",!1)};ni.A.on("im-message",yx);const bx={name:"im-message",handle:yx},wx="assistant-WownMw",Cx=()=>{const e=(0,dn.l)((e=>e.isShowSidebar)),[t]=(0,v.Y)("sidebarButtonPosition");return(0,Le.jsx)(Z_.A,{align:t,visible:e,scene:"sideBar"})},Ax=()=>{var e;(0,vc.A)(null===(e=document.getElementById("ciciai-assistant"))||void 0===e?void 0:e.shadowRoot);const t=(0,dn.l)((e=>e.isShowSidebar)),n=(0,dn.l)((e=>e.isShowSidebarBtn)),i=(0,dn.l)((e=>e.isSidePanelMode)),[s]=(0,v.Y)("sidebarButtonDisabledAll"),[a]=(0,v.Y)("sidebarButtonPosition"),[l]=(0,v.Y)("sidebarButtonDisabledHosts"),c=l.includes(window.location.host),[d,u]=(0,f.useState)("\u2325K"),h=(0,f.useRef)(null),m=(0,at.Uk)(),_=sx(),x=!function(){const e=(0,dn.l)((e=>e.isShowLinkPreview)),[t]=(0,v.Y)("linkPreviewDisabledHosts"),[n]=(0,v.Y)("linkPreviewDisabledAll"),i=null==t?void 0:t.includes(window.location.host),o=(0,kl.A)("link_preview").enabled,s=(0,qp.fv)();return!e||i||n||!o||s}();rx();const y=function(){var e=(0,r.A)((function*(){var e;const{data:t}=yield(0,kp.c)("init-shortcut"),n=null==t||null===(e=t.shortcuts)||void 0===e?void 0:e._execute_action;n&&u(n)}));return function(){return e.apply(this,arguments)}}();(0,f.useEffect)((()=>((0,kp.c)("csui-init").then((e=>{const{shortcuts:t}=(null==e?void 0:e.data)||{},n=null==t?void 0:t._execute_action;n&&u(n)})),window.addEventListener("focus",y),()=>window.removeEventListener("focus",y))),[]),(0,f.useEffect)((()=>{i||(t?(e=>{const t="left"===e?Tp:Ep,n="left"===e?"\nhtml {\n  position: relative !important;\n  min-height: 100vh !important;\n  padding-left: 420px !important\n}\n":"\nhtml {\n  width: calc(100% - 420px)  !important;\n  position: relative !important;\n  min-height: 100vh !important\n}\n";let i=document.getElementById(t);i?i.innerHTML=n:(i=document.createElement("style"),i.id=t,i.innerHTML=n,(0,ht.EY)(i))})("right"):(e=>{const t="left"===e?Tp:Ep,n=document.getElementById(t);n&&n.remove()})("right"))}),[t,i]),(0,f.useEffect)((()=>{if(!i||pv._.isInSidePanel)return;const e=(0,ix.c)(Object.values(o)),t=[nx(Np.t_,"select","contentScript"),nx(dn.l,"layout","contentScript"),nx(Gd.on,"global","contentScript"),nx(Mp.I,"translate","contentScript")];return()=>{e(),t.forEach((e=>e()))}}),[]),(0,f.useEffect)((()=>{const e=()=>{document.title!==Rp.IF.getState().title&&((0,gt.Rm)(`document update title from=${Rp.IF.getState().title} to=${document.title}`),Rp.IF.getState().setTitle(document.title))};try{const t=document.querySelector("title"),n=new MutationObserver((()=>{e()})),i={childList:!0};return n.observe(t,i),()=>{n.disconnect()}}catch(t){let n;const i=()=>{e(),n=setTimeout(i,300)};return i(),()=>{clearTimeout(n)}}}),[]);const b=!(s||c||!n||[Un.o8,Un.Ud].some((e=>location.host.endsWith(e)))&&(!location.pathname.startsWith(he.Cp)&&!location.pathname.startsWith("/ext/")));return(0,f.useEffect)((()=>{const e=()=>{const e=document.querySelector(`#${he.Yq}`);e&&(e.style.display=document.fullscreenElement?"none":"block")};return document.addEventListener("fullscreenchange",e),()=>{document.removeEventListener("fullscreenchange",e)}}),[]),(0,Le.jsx)(p.Yd.Provider,{value:ue.vF,children:(0,Le.jsx)(p.tH,{fallback:null,errorBoundaryName:"flow-ext-next",children:(0,Le.jsx)(Ca.A.Provider,{value:{getPopupContainer:()=>h.current||document.body},children:(0,Le.jsx)(Wp.Provider,{value:_,children:(0,Le.jsx)(g.C,{t:m,children:(0,Le.jsxs)("div",{onMouseDown:ox.N,className:ie()(wx,"cici-ext-always-light","semi-always-light"),children:[null,(0,Le.jsx)(iv,{}),(0,Le.jsx)(C_,{}),x&&(0,Le.jsx)(Qv,{}),b?(0,Le.jsx)(K_,{align:a,shortcut:d,isSidebarShow:t}):null,i?null:(0,Le.jsx)(Cx,{}),(0,Le.jsx)("div",{className:"cici-popup-container",ref:h}),(0,Le.jsx)(_v,{}),(0,Le.jsx)(G_,{})]})})})})})})},Sx=Ax;var Ix=n(76021);(0,Ix.A)((function(e){const t=function(e){const t=new WebSocket(e);return t.onopen=()=>{console.log("hmr socket open")},t.onclose=()=>{console.log("hmr socket close")},t.onerror=e=>{console.log("hmr socket error",e)},t}("ws://localhost:9001/webpack-hmr");t.onmessage=t=>{switch(JSON.parse(t.data).type){case"still-ok":case"ok":!function(e){console.log("hrm reload style"),(0,rt.f9)(e),(0,rt.NR)(e,he.QN).catch((e=>{console.log("\u70ed\u66f4\u65b0reloadStyleError(\u7b26\u5408\u9884\u671f,chrome\u4e0a\u4e0b\u6587\u4e22\u5931\u5bfc\u81f4)")}))}(e)}},u.m.getInstance().registerRecyclable((()=>null==t?void 0:t.close()))}));var kx=n(20979);function jx(){return(jx=(0,r.A)((function*(e){const t=(0,J.TK)("authInfo");return e?yield(0,kx.AT)({method:"POST",url:`${Un.kD}/plugin/prompt_skill/list_by_user`,data:{user_id:t.userId,frontend_source:1}}):yield(0,Gn.S6)({method:"POST",url:`${Un.kD}/plugin/prompt_skill/list_by_user`,data:{user_id:t.userId,frontend_source:1}})}))).apply(this,arguments)}const Ex=()=>{const e=[];return(0,vt.ku)()||e.push(ml.EU.collect),e},Tx=(e,t,n)=>{const i={actionList:[],moreActionList:[]},o=new Set,s=Ex();return e&&(e.selectbar.forEach((e=>{if(s.includes(e))return;const n=t.get(e);n&&(i.actionList.push(n),o.add(e))})),e.dropdown.forEach((e=>{if(s.includes(e))return;const n=t.get(e);n&&(i.moreActionList.push(n),o.add(e))}))),t.forEach(((e,t)=>{if(!o.has(t)&&!s.includes(t)){(n?ml.aX.includes(t):ml.AA.includes(t))?i.actionList.push(e):i.moreActionList.push(e)}})),i},Nx={readingPopupActions:{selectbar:ml.aX,dropdown:ml.Tz},editingPopupActions:{selectbar:ml.AA,dropdown:ml.Xt}},Mx=()=>{const e=Ex();(0,J.vE)("readingPopupActions",{actionList:(0,ml.Hh)(e),moreActionList:(0,ml.WN)(e)}),(0,J.vE)("editingPopupActions",{actionList:(0,ml.I8)(e),moreActionList:(0,ml.fS)(e)})};function Rx(){return Lx.apply(this,arguments)}function Lx(){return Lx=(0,r.A)((function*(e=!1){try{const t=(0,J.TK)("authInfo");if(!t.isAuthenticated||!t.userId)return void Mx();const n=yield function(e){return jx.apply(this,arguments)}(e);if(!n)return;const{user_setting:i,items:o}=n;if(!i||!o)return;const s=new Map([...(0,ml.Hh)(),...(0,ml.WN)()].map((e=>[e.id,e]))),a=new Map([...(0,ml.I8)(),...(0,ml.fS)()].map((e=>[e.id,e])));null==o||o.forEach((e=>{const{id:t,extra:n,title:i,prompt_template:o}=e,r=JSON.parse(n),{use_in:l="",icon:c="",displayMode:d,conf_id:u}=r||{},h={id:t,icon:c,name:i,prompt:o,displayMode:d,confId:u};"reading"===l?s.set(t,h):"editing"===l&&a.set(t,h)}));const{settings:r=""}=i,l=r?JSON.parse(r):Nx,c=Tx(l.readingPopupActions,s,!0),d=Tx(l.editingPopupActions,a,!1);c.actionList.length+c.moreActionList.length&&(0,J.vE)("readingPopupActions",c),d.actionList.length+d.moreActionList.length&&(0,J.vE)("editingPopupActions",d)}catch(t){(0,gt.z3)("initSelectBarSkillList err",t),ue.vF.persist.info({eventName:"getSelectBarSkillList",meta:(0,a.A)({},t)})}})),Lx.apply(this,arguments)}const Px=[Un.o8,Un.Ud];var Bx=n(3888),Dx=n(22290),Fx=n(81725),Ux=n.n(Fx),Hx=n(95081);const zx="wrapper-qH3fD2",Ox="mask-v8dwr4",qx="setting-popover-HXRy3h",Vx="spell-card-xCZkfq",$x="revision-type-PTC8JH",Kx="suggest-FdbK8z",Wx="setting-CE1uYq",Gx="ignore-Mq8qMp",Zx="setting-wrapper-cOQKNa",Yx="tip-ZTQTKU",Jx="host-UdPObE",Qx=e=>{const{allowGrammar:t,onAllowGrammarChange:n}=e,i=function(e){const t=e.split(".").slice(-2);if(t.length<=1)return t[0];const n=t[0],i=t[1];if(n.length>=13)return`${n.substring(0,5)}...${n.substring(n.length-5)}.${i}`;return`${n}.${i}`}(location.hostname);return(0,Le.jsxs)("div",{className:ie()(Zx,"row"),onMouseDownCapture:e=>{e.stopPropagation(),e.preventDefault()},children:[(0,Le.jsx)("div",{className:ie()("row-item",Yx),children:(0,Le.jsx)(xa.x,{i18nKey:"flow_web_ext_grammar_setting_onandoff",defaults:"Check grammar for <0>{{ website }}</0>",values:{website:i},components:[(0,Le.jsx)("span",{className:Jx})]})}),(0,Le.jsx)("div",{className:"row-auto",style:{marginLeft:8},children:(0,Le.jsx)(Be.Sc,{checked:t,onChange:e=>{var t;return null==n?void 0:n(null!==(t=e.target.checked)&&void 0!==t&&t)}})})]})},Xx=(0,f.createContext)(void 0),ey=Xx.Provider;function ty(){const e=(0,f.useContext)(Xx);if(!e)throw new Error("Revision Evn is undefined");return e}const ny=e=>(0,Le.jsx)("svg",(0,a.A)((0,a.A)({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),{},{children:(0,Le.jsx)("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.459 7.252c-.955 0-1.763-.63-2.031-1.496H2.615c-.322 0-.583-.282-.583-.63s.261-.63.583-.63h4.813a2.127 2.127 0 0 1 4.062 0h1.895c.322 0 .583.282.583.63s-.261.63-.583.63H11.49A2.13 2.13 0 0 1 9.46 7.252m0-1.063a1.063 1.063 0 1 1 0-2.126 1.063 1.063 0 0 1 0 2.126M6.541 13c.955 0 1.763-.63 2.031-1.496h4.813c.322 0 .583-.282.583-.63s-.261-.63-.583-.63H8.572a2.127 2.127 0 0 0-4.062 0H2.615c-.322 0-.583.282-.583.63s.261.63.583.63H4.51A2.13 2.13 0 0 0 6.54 13m0-1.063a1.063 1.063 0 1 0 0-2.126 1.063 1.063 0 0 0 0 2.126",clipRule:"evenodd"})})),iy=(0,f.forwardRef)(((e,t)=>{const{t:n}=(0,s_.B)(),i=ty(),{popupCardShadowContainer:o}=i,[s,a]=(0,f.useState)(!1),{style:r,replacement:l,onReplace:c,allowGrammar:d,onAllowGrammarChange:u,onIgnore:h}=e;(0,f.useEffect)((()=>{(0,et.s)("highlight_result_show",{button_name:"grammar"}),(0,Qe.dn)({click_from:"writing_assistant"})}),[]);return(0,Le.jsxs)("div",{className:zx,ref:t,style:r,children:[(0,Le.jsx)(Be.AM,{trigger:"custom",position:"rightTop",visible:s,spacing:0,className:qx,getPopupContainer:()=>{return(null==o||null===(e=o.shadowRoot)||void 0===e?void 0:e.querySelector(`.${zx}`))||document.body;var e},onClickOutSide:()=>a(!1),content:(0,Le.jsx)(Qx,{allowGrammar:d,onAllowGrammarChange:u}),showArrow:!1,children:(0,Le.jsx)("div",{className:Ox})}),(0,Le.jsxs)("div",{className:Vx,children:[(0,Le.jsxs)("div",{className:"row",children:[(0,Le.jsx)("div",{className:ie()("row-item",$x),children:n("flow_web_ext_grammar_title_note")}),(0,Le.jsx)("div",{className:ie()("row-auto",Wx),onMouseDownCapture:e=>{e.stopPropagation(),a(!s)},children:(0,Le.jsx)(ny,{})})]}),(0,Le.jsxs)("div",{className:"row",style:{marginTop:12},children:[(0,Le.jsx)("div",{className:ie()("row-item",Kx),onClick:e=>{e.stopPropagation(),e.preventDefault(),null==c||c(),(0,et.s)("highlight_result_click",{button_name:"grammer",click_result:"input"})},children:l}),(0,Le.jsx)("div",{className:ie()("row-item",Gx),style:{marginLeft:6},onClick:()=>{null==h||h(),(0,et.s)("highlight_result_click",{button_name:"grammer",click_result:"ignore"})},children:n("flow_web_ext_grammar_action_ignore")})]})]})]})})),oy=iy;var sy=n(20716);const ay=()=>{const e=ty(),t=Bf(we.lf.grammar),{clearRemoveActiveTimer:n,setActiveRevision:i}=function(){const e=(0,f.useRef)(void 0),t=ty(),n=t.store((e=>e.spellRevisions)),{setActiveRevision:i}=t.store.getState(),o=t.editor.dom,s=(n,o=!1)=>{window.clearTimeout(e.current),e.current=void 0;const s=t.store.getState().activeRevision;(0,sy.A)(s,n)||(o||n?i(n):e.current=window.setTimeout((()=>{i(void 0)}),300))};return(0,f.useEffect)((()=>{const e=()=>{s(void 0,!0)};return window.addEventListener("wheel",e),()=>{window.removeEventListener("wheel",e)}}),[]),(0,f.useEffect)((()=>{const e=(0,k.A)((e=>{const t=o.getBoundingClientRect(),i=e.clientX-(t.left-o.scrollLeft),a=e.clientY-(t.top-o.scrollTop);let r;e:for(const s of(0,Bx.A)(n))for(const e of s.rects)if(i>=e.left&&i<=e.right&&a>=e.top&&a<=e.bottom+2){const n=e.top+(t.top-o.scrollTop),i=e.left+(t.left-o.scrollLeft);r={id:s.revision.id,rect:{x:i,y:n,top:n,left:i,width:e.width,height:e.height,right:0,bottom:0}};break e}s(r)}),32),t=()=>{s(void 0)};return o.addEventListener("pointermove",e),o.addEventListener("pointerleave",t),()=>{o.removeEventListener("pointermove",e),o.removeEventListener("pointerleave",t)}}),[o,t,n]),{clearRemoveActiveTimer:()=>{window.clearTimeout(e.current),e.current=void 0,console.log("xxxxx","clearRemoveActiveTimer")},setActiveRevision:s}}(),{activeRevision:o,spellRevisions:s}=e.store((e=>({activeRevision:e.activeRevision,spellRevisions:e.spellRevisions}))),[r,l]=(0,f.useState)(null),c=_f(null==o?void 0:o.rect),{styles:d}=(0,Hx.E)(c,r,{placement:"bottom-start",strategy:"fixed"}),u=(0,f.useCallback)(n,[]),h=(0,f.useCallback)((()=>{i(void 0)}),[]);if((0,f.useEffect)((()=>(null==r||r.addEventListener("pointerenter",u),null==r||r.addEventListener("pointerleave",h),()=>{null==r||r.removeEventListener("pointerenter",u),null==r||r.removeEventListener("pointerleave",h)})),[r]),!o)return null;const m=s[o.id];if(!m)return null;const{revision:p}=m,g=!t.hasHost();return(0,Le.jsx)(oy,{allowGrammar:g,onAllowGrammarChange:e=>{t.disableHost(!e)},replacement:p.replacement,ref:l,style:(0,a.A)((0,a.A)({},d.popper),{},{zIndex:2147483647}),onReplace:()=>{e.store.getState().setActiveRevision(void 0),e.replace(p)},onIgnore:()=>{e.store.getState().setActiveRevision(void 0),e.ignore(p)}})};class ry{constructor(e){(0,y.A)(this,"dom",void 0),(0,y.A)(this,"shadowRoot",void 0),(0,y.A)(this,"root",void 0),(0,y.A)(this,"init",(()=>{const e=this.render();this.root.render(e),this.mount(this.dom)})),this.dom=document.createElement(e),this.shadowRoot=this.dom.attachShadow({mode:"open"});const t=document.createElement("div");t.classList.add("cici-ext-container");const n=document.createElement("div");n.classList.add("cici-ext-always-light","semi-always-light"),t.appendChild(n),this.shadowRoot.appendChild(t),this.root=(0,m.createRoot)(n),(0,rt.NR)(this.shadowRoot,he.QN).then((()=>{this.init()}))}destroy(){this.root.unmount(),this.dom.remove()}}class ly extends ry{constructor(e){super(he.aS),(0,y.A)(this,"env",void 0),this.env=e,this.env.popupCardShadowContainer=this.dom}mount(){document.documentElement.append(this.dom)}render(){return(0,Le.jsx)(ey,{value:this.env,children:(0,Le.jsx)(ay,{})})}}function cy(e,t){const n=new ResizeObserver(t),i=new MutationObserver(t);return window.addEventListener("resize",t),n.observe(e),i.observe(e,{attributes:!0,childList:!0,subtree:!0}),()=>{window.removeEventListener("resize",t),n.disconnect(),i.disconnect()}}const dy=e=>e+1;const uy="anchor-qw0rRl",hy="container-obHg0v",my="content-XrnZ0O",py="segment-QsUnSG",gy="active-eqi0bb",vy="diff-nTBpB8",fy=()=>{const e=ty(),t=(0,f.useRef)(null),n=(0,f.useRef)(null),i=(0,f.useRef)(null);!function(e,t,n){const i=ty(),[o,s]=(0,f.useReducer)(dy,0),a=i.editor.dom;(0,f.useEffect)((()=>{const i=e.current,o=t.current,r=n.current;if(!i||!o||!r)throw new Error("can not find elements");const l=(0,k.A)((()=>{const e=getComputedStyle(a);if("fixed"===e.position)return i.style.position="fixed",i.style.top=e.top,void(i.style.left=e.left);let t=0,n=0;const l=i.style.transform.match(/\-?\d+(\.\d+)?(?=px)/g);l&&(t=Number(l[0]),n=Number(l[1]));const c=a.getBoundingClientRect(),d=i.getBoundingClientRect();t+=c.left-d.left,n+=c.top-d.top,i.style.transform=`translate3d(${t}px, ${n}px, 0)`,"sticky"===e.position&&(i.style.position="sticky","auto"!==e.top&&(i.style.top=parseInt(e.top,10)-n+"px"),"auto"!==e.bottom&&(i.style.bottom=parseInt(e.bottom,10)-n+"px")),o.style.width=`${a.offsetWidth}px`,o.style.height=`${a.offsetHeight}px`,r.style.width=`${a.scrollWidth+a.clientLeft}px`,r.style.height=`${a.scrollHeight+a.clientTop}px`,r.style.transform=`translate3d(${-a.scrollLeft}px, ${-a.scrollTop}px, 0)`,s()}),100),c=cy(a,l);return()=>{c(),l.cancel()}}),[e,t,n,a]),(0,f.useEffect)((()=>{const e=n.current;if(!e)throw new Error("can not find elements");const t=()=>{e.style.transform=`translate3d(${-a.scrollLeft}px, ${-a.scrollTop}px, 0)`};return a.addEventListener("scroll",t),()=>{a.removeEventListener("scroll",t)}}),[n,a])}(t,n,i);const{activeRevision:o,spellRevisions:s,fetching:a}=e.store((e=>({spellRevisions:e.spellRevisions,fetching:e.fetching,activeRevision:e.activeRevision,showSuccessIfNeeded:e.showSuccessIfNeeded}))),r=(0,Bx.A)(s),l=r.length,c=l>0;return(0,f.useEffect)((()=>{l&&((0,et.s)("detect_grammar_error_show",{current_page:(0,tn.M5)(location.href)}),(0,Qe.M7)({show_from:"writing_assistant",current_page:(0,tn.M5)(location.href)}))}),[c]),(0,f.useEffect)((()=>{Ff.getState().updateEditorRevision(e.editor.dom,{count:r.length,loading:a,env:e})}),[s]),(0,f.useEffect)((()=>()=>{Ff.getState().removeEditorRevision(e.editor.dom)}),[]),(0,Le.jsx)("div",{className:uy,ref:t,"data-host":window.location.hostname,children:(0,Le.jsx)("div",{className:hy,ref:n,children:(0,Le.jsx)("div",{className:my,ref:i,children:r.flatMap((e=>e.rects.map(((t,n)=>(0,Le.jsx)("div",{className:ie()(py,vy,{[gy]:e.revision.id===(null==o?void 0:o.id)}),style:{top:t.top,left:t.left,width:t.width,height:t.height}},`${e.revision.id}-${n}`)))))})})})};class _y extends ry{constructor(e){super(he.GW),(0,y.A)(this,"env",void 0),this.dom.style.zIndex="2",this.env=e,this.env.highlighterShadowContainer=this.dom}mount(){this.env.editor.dom.after(this.dom)}render(){return(0,Le.jsx)(ey,{value:this.env,children:(0,Le.jsx)(fy,{})})}}var xy=n(45400),yy=n(66489),by=n(58114),wy=n(19730),Cy=n(7021);const Ay=[/\b[ap]\.m\.$/i,/\b\w\.$/,/\b\d+\.$/];function Sy(e){return(0,Cy.lD)(e).filter((e=>"Sentence"===e.type)).flatMap((e=>(0,le.A)(e,"children",[]))).filter((e=>"Str"===e.type||"Punctuation"===e.type)).reduce((function(t,n){const i=t[t.length-1];if(i){if(!e.slice(i.end,n.range[0]).includes("\n")){if("Punctuation"===n.type||(o=i.raw,Ay.some((e=>e.test(o)))))return i.raw=e.slice(i.start,n.range[1]),i.end=n.range[1],t}}var o;return t.push({raw:n.raw,start:n.range[0],end:n.range[1]}),t}),[])}function Iy(e,t=!1){return n=>(n.start=e.transformPosition(n.start),n.end=e.transformPosition(n.end,t),n)}const ky=new Set;function jy(e,t){return`${e} -> ${t}`}class Ey extends sa.A{constructor(...e){super(...e),(0,y.A)(this,"sentCounter",0),(0,y.A)(this,"prevText",""),(0,y.A)(this,"spellRevisions",Object.create(null)),(0,y.A)(this,"sentences",Object.create(null)),(0,y.A)(this,"pendingSentences",[]),(0,y.A)(this,"isApplying",!1)}createSent(e){this.sentCounter+=1;const t=this.sentCounter;return this.sentences[t]=(0,a.A)({id:t},e),t}update(e,t,n={keepRevs:!1}){(0,wy.A)(this.spellRevisions,Iy(t,!0)),(0,wy.A)(this.sentences,Iy(t,!1));const i=(0,Dx.A)(Sy(e),"start"),o=(0,by.A)(this.sentences,"start"),s=new Set,a=[];return new Set([...Object.keys(i),...Object.keys(o)]).forEach((e=>{const t=i[e],n=o[e];if(t&&n){const e=n.filter((e=>!(0,yy.A)(e,t)));if(e.forEach((e=>{delete this.sentences[e.id],a.push({start:e.start,end:e.end})})),e.length===n.length){const e=this.createSent(t);s.add(e)}}else if(t){const e=this.createSent(t);s.add(e)}else n&&n.forEach((e=>{delete this.sentences[e.id],a.push({start:e.start,end:e.end})}))})),n.keepRevs||this.removeRevisionByRanges(a),[...s].map((e=>this.sentences[e]))}removeRevisionByRanges(e){(0,wy.A)(this.spellRevisions,((t,n)=>{e.some((e=>kv(t,e)))&&delete this.spellRevisions[n]})),this.emit("revisionChange",this.spellRevisions)}removeRevision(e){delete this.spellRevisions[e],this.emit("revisionChange",this.spellRevisions)}clearRevision(){this.spellRevisions={},this.emit("revisionChange",this.spellRevisions)}getOffsetSortedRevisions(){return Object.values(this.spellRevisions).sort(((e,t)=>e.start-t.start))}ignore(e){var t,n;t=e.raw,n=e.replacement,ky.add(jy(t,n)),this.removeRevision(e.id),this.emit("revisionChange",this.spellRevisions)}updateRevisionOffsetAfterApply(e){const{start:t,end:n,replacement:i}=e,o=this.getOffsetSortedRevisions();(0,wy.A)(o,(e=>{if(e.start<n)return;const o=i.length-(n-t);e.start+=o,e.end+=o})),this.emit("revisionChange",this.spellRevisions)}createRevisions(e){e.forEach((e=>{var t;const{sent_id:n}=e,i=this.sentences[n];i&&(null===(t=e.revision_units)||void 0===t||t.forEach((t=>{var o;null===(o=t.span_list)||void 0===o||o.forEach((o=>{const s=i.raw.slice(o.org_start_idx,o.org_end_idx),a=e.replacement.slice(o.edt_start_idx,o.edt_end_idx);if(!s||!a)return;if(((e,t)=>ky.has(jy(e,t)))(s,a))return;const r=(0,xy.A)(),{label_id:l}=t,c=i.start+o.org_start_idx,d=i.start+o.org_end_idx;this.spellRevisions[r]={id:r,labelId:l,sentId:n,type:"diff",raw:s,replacement:a,start:c,end:d}}))})))})),this.emit("revisionChange",this.spellRevisions)}destroy(){this.removeAllListeners(),this.spellRevisions={},this.sentences={},this.pendingSentences=[]}}class Ty extends sa.A{constructor(...e){var t;super(...e),t=this,(0,y.A)(this,"queue",[]),(0,y.A)(this,"isRequesting",!1),(0,y.A)(this,"doRequest",(0,r.A)((function*(){if(!t.isRequesting&&0===t.queue.length)return void t.emit("finish");if(t.isRequesting)return;const e=t.queue.slice(0,10);t.queue=t.queue.slice(10),t.isRequesting=!0,t.emit("fetching");try{const n=yield(0,me.Y_)(e);t.emit("update",n.items)}catch(n){}t.isRequesting=!1,t.doRequest()}))),(0,y.A)(this,"request",((e,t)=>{this.queue=[...this.queue,...e],this.removeInvalidSentence(t),this.doRequest()}))}removeInvalidSentence(e){this.queue=this.queue.filter((t=>e.includes(t.id)))}destroy(){this.queue=[],this.removeAllListeners()}}const Ny={spellRevisions:{},fetching:!1,showSuccessIfNeeded:!1},My=e=>(0,a.A)((0,a.A)({},Ny),{},{setSpellRevisions:t=>{e((()=>({spellRevisions:t})))},setActiveRevision:t=>{e((()=>({activeRevision:t})))},setFetching:t=>{e((()=>({fetching:t})))},setShowSuccessIfNeeded:t=>{e((()=>({showSuccessIfNeeded:t})))}});class Ry{constructor(e,t){var n=this;(0,y.A)(this,"editor",void 0),(0,y.A)(this,"model",void 0),(0,y.A)(this,"store",void 0),(0,y.A)(this,"highlighterShadowContainer",void 0),(0,y.A)(this,"popupCardShadowContainer",void 0),(0,y.A)(this,"showSuccessTimer",null),(0,y.A)(this,"clearShowSuccessTimer",(()=>{this.showSuccessTimer&&(window.clearTimeout(this.showSuccessTimer),this.showSuccessTimer=null)})),(0,y.A)(this,"showSuccess",(()=>{this.store.getState().setShowSuccessIfNeeded(!0),this.clearShowSuccessTimer(),this.showSuccessTimer=window.setTimeout((()=>{this.store.getState().setShowSuccessIfNeeded(!1),this.showSuccessTimer=null}),1500)})),(0,y.A)(this,"ignore",(e=>{this.model.ignore(e)})),(0,y.A)(this,"replace",function(){var e=(0,r.A)((function*(e){n.model.isApplying=!0,yield n.editor.replace(e.start,e.end,e.replacement),n.model.removeRevision(e.id),n.model.isApplying=!1,n.showSuccess()}));return function(t){return e.apply(this,arguments)}}()),(0,y.A)(this,"replaceAll",(0,r.A)((function*(){n.model.isApplying=!0;const e=n.model.getOffsetSortedRevisions().reverse();for(const t of e)yield n.editor.replace(t.start,t.end,t.replacement);n.model.clearRevision(),n.model.isApplying=!1,n.showSuccess()}))),this.editor=e,this.model=t,this.store=(0,ec.vt)()((0,Xl.eh)(My))}setRevisionStore(e){this.store.getState().setSpellRevisions(e.spellRevisions)}getRevisionState(){return this.store.getState()}getEditor(){return this.editor.dom}destroy(){this.store.destroy(),this.highlighterShadowContainer=void 0,this.popupCardShadowContainer=void 0,this.clearShowSuccessTimer()}}class Ly extends sa.A{constructor(e){super(),(0,y.A)(this,"editor",void 0),(0,y.A)(this,"model",void 0),(0,y.A)(this,"env",void 0),(0,y.A)(this,"fetcher",void 0),(0,y.A)(this,"highlightRenderer",void 0),(0,y.A)(this,"popupCardRenderer",void 0),(0,y.A)(this,"disconnectObserveEditorLayout",void 0),(0,y.A)(this,"cacheNewSentences",[]),(0,y.A)(this,"bind",(()=>{this.disconnectObserveEditorLayout=cy(this.editor.dom,this.updateRevisionsRectsState),this.editor.addListener("contentChange",this.handleEditorContentChange),this.model.addListener("revisionChange",this.updateRevisionsRectsState),this.fetcher.addListener("update",this.handleRevisionFetchResp),this.fetcher.addListener("fetching",this.handleFetching),this.fetcher.addListener("finish",this.handleFetchFinish)})),(0,y.A)(this,"unbind",(()=>{var e;null===(e=this.disconnectObserveEditorLayout)||void 0===e||e.call(this),this.editor.removeListener("contentChange",this.handleEditorContentChange),this.model.removeListener("revisionChange",this.updateRevisionsRectsState),this.fetcher.removeListener("update",this.handleRevisionFetchResp),this.fetcher.removeListener("fetching",this.handleFetching),this.fetcher.removeListener("finish",this.handleFetchFinish)})),(0,y.A)(this,"handleRevisionFetchResp",(e=>{this.model.createRevisions(e)})),(0,y.A)(this,"handleFetching",(()=>{this.env.store.getState().setFetching(!0)})),(0,y.A)(this,"handleFetchFinish",(()=>{this.env.store.getState().setFetching(!1)})),(0,y.A)(this,"updateRevisionsRectsState",(()=>{const e=this.editor.getRevisionRect((0,Bx.A)(this.model.spellRevisions));this.env.setRevisionStore({spellRevisions:(0,Dx.A)(e,(e=>e.revision.id))})})),(0,y.A)(this,"handleEditorContentChange",(()=>{const{text:e}=this.editor,t=(new(Ux())).insert(this.model.prevText).diff((new(Ux())).insert(e));if(0===t.ops.length)return;this.model.prevText=e;const n=this.model.update(e,t,{keepRevs:this.model.isApplying});this.cacheNewSentences.push(...n),this.model.isApplying||this.debounceDoRevision()})),(0,y.A)(this,"filterRequestSentences",(e=>e.filter((e=>e.raw.length<2e3)))),(0,y.A)(this,"doRevision",(()=>{const e=Object.keys(this.model.sentences).map(Number);this.fetcher.request(this.filterRequestSentences(this.cacheNewSentences),e),this.cacheNewSentences=[]})),(0,y.A)(this,"debounceDoRevision",(0,Mi.A)(this.doRevision,1500));const{editorType:t,element:n}=e;this.editor=this.createEditor(t,n),this.model=new Ey,this.env=new Ry(this.editor,this.model),this.fetcher=new Ty,this.highlightRenderer=new _y(this.env),this.popupCardRenderer=new ly(this.env),this.bind(),this.handleEditorContentChange()}createEditor(e,t){return e===bv.Input?new yf(t):new vf(t)}destroy(){this.cacheNewSentences=[],this.unbind(),this.env.destroy(),this.editor.destroy(),this.model.destroy(),this.fetcher.destroy(),this.highlightRenderer.destroy(),this.popupCardRenderer.destroy()}}const Py=new class{constructor(){var e=this;(0,y.A)(this,"inited",!1),(0,y.A)(this,"controllerPool",new Map),(0,y.A)(this,"editorRemoveObservers",[]),(0,y.A)(this,"unbindAppStorageConfigChange",void 0),(0,y.A)(this,"bindAppStorageConfigChange",(()=>(de.A.watch({disableGlobalGrammar:this.handleAppStorageConfigChange,disableGrammarHosts:this.handleAppStorageConfigChange}),()=>{de.A.unwatch({disableGlobalGrammar:this.handleAppStorageConfigChange,disableGrammarHosts:this.handleAppStorageConfigChange})}))),(0,y.A)(this,"handleAppStorageConfigChange",(0,r.A)((function*(){yield(0,ht.uk)(500),e.isDisabledGrammar()?e.reset():e.init()}))),(0,y.A)(this,"isDisabledGrammar",(()=>{const e=(0,J.TK)("disableGlobalGrammar"),t=(0,J.TK)("disableGrammarHosts");return!!(e||t.includes(window.location.hostname)||(0,qp.Im)())})),(0,y.A)(this,"bind",(()=>{document.addEventListener("focus",this.handleFocus,!0)})),(0,y.A)(this,"unbind",(()=>{document.removeEventListener("focus",this.handleFocus,!0)})),(0,y.A)(this,"handleFocus",(e=>{const{target:t}=e;t instanceof HTMLElement&&this.activeEditor(t)})),(0,y.A)(this,"observeEditorElementRemove",(e=>{if(!e.parentElement)return;const t=new MutationObserver((n=>{for(const i of n)if(i.removedNodes)for(const n of i.removedNodes)if(n===e){const n=this.controllerPool.get(e);return null==n||n.destroy(),this.controllerPool.delete(e),void t.disconnect()}}));return t.observe(e.parentElement,{childList:!0}),t})),(0,y.A)(this,"addController",((e,t)=>{let n=this.controllerPool.get(e);if(!n){n=new Ly({element:e,editorType:t}),this.controllerPool.set(e,n);const i=this.observeEditorElementRemove(e);i&&this.editorRemoveObservers.push(i)}})),(0,y.A)(this,"activeEditor",(e=>{if(!(e instanceof HTMLElement))return!1;if(!this.isValid(e))return!1;const t=Iv(e);if(!t)return!1;const{type:n,element:i}=t;return this.addController(i,n),!0})),(0,y.A)(this,"isValid",(e=>!!function(e){var t;const{hostname:n}=window.location;return!(Px.some((e=>wv(n,e)))||wv(n,"outlook.live.com",3)&&e.classList.contains("EditorClass")||e.classList.contains("mm-editor")&&null!==(t=Av(e))&&void 0!==t&&t.classList.contains("minder-editor-container")||e instanceof HTMLInputElement||e.matches('[data-testid="chat_input_input"]'))}(e))),this.bindAppStorageConfigChange()}init(){this.isDisabledGrammar()||this.inited||(this.inited=!0,this.activeEditor(document.activeElement),this.bind())}reset(){this.inited=!1,this.unbind(),this.editorRemoveObservers.forEach((e=>e.disconnect())),this.editorRemoveObservers=[],this.controllerPool.forEach((e=>e.destroy())),this.controllerPool.clear()}destroy(){var e;this.reset(),null===(e=this.unbindAppStorageConfigChange)||void 0===e||e.call(this)}},By=function(){var e=(0,r.A)((function*(){var e,t;const n=yield(0,fm.cs)("check-and-update-ttwid");null!=n&&n.success&&null!==(e=n.data)&&void 0!==e&&e.success&&null!==(t=n.data)&&void 0!==t&&t.updated&&(yield(0,J.pu)({}))}));return function(){return e.apply(this,arguments)}}();let Dy=!1;function Fy(){return(Fy=(0,r.A)((function*(){var e,t;if(Dy)return!0;Dy=!0,yield By();const n=yield(0,fm.cs)("is-side-panel-enabled"),i=!!(0,zh.s)()||Boolean(null==n||null===(e=n.data)||void 0===e?void 0:e.enabled),o=yield(0,fm.cs)("tab-info");Gd.on.getState().setTabInfo({tabId:null==o||null===(t=o.data)||void 0===t?void 0:t.tabId}),dn.l.getState().setIsSidePanelMode(i),(0,fm.cs)({name:"update-auth-info",body:{reason:"cs: load start"}}),yield Promise.all([(0,J.lv)()])}))).apply(this,arguments)}const Uy=(0,Ix.A)((()=>{(0,J.TK)("installReason")&&((0,et.s)("extension_install_success",{reason:(0,J.TK)("installReason")}),(0,J.vE)("installReason",""))}));var Hy=n(70548),zy=n(1921);const Oy={name:"close-cici-sidebar",handle:()=>{dn.l.getState().setIsShowSidebar(!1,_.cz.other)}},qy=function(){var e=(0,r.A)((function*(e){const{setIsShowSidebar:t}=dn.l.getState();try{var n;if((0,Dl.BB)({action:"web_summary",loginParams:{trackMeta:{login_entrance:"float_btn"}}}))return;const i=window.location.href,o=yield(0,mv.B9)(),s=(0,No.wz)((0,J.TK)("uiLanguage"));t(!0,_.cz.other);const a={title:null==o?void 0:o.title,url:i,content:null==o?void 0:o.textContent};Gd.on.getState().setFloatingCardVisible(!1),Gd.on.getState().setSummaryActionVisible(!1),yield(0,Yd.Z)();const{convId:r,convType:l,mainBotId:c}=(0,Oh.IK)(),d={text:i,extraExt:{origin:location.origin,browser_explain:JSON.stringify(a),llm_without_mem:"1",browser_language:s,flag_browser_plugin:"1",answer_with_suggest:"0",need_create_thread:l===bu.H.NewThread?"1":"0"},scene:kr.sJ.chat_action_bar,ctx:(0,Zd.Pe)(l,r,c)};ue.vF.persist.log({eventName:"summary_page_action",meta:{contentLength:null===(n=a.content)||void 0===n?void 0:n.length,from:"context-menu"}}),dn.l.getState().isSidePanelMode&&!pv._.isInSidePanel?Rp.IF.getState().type===dc.u9.pdf?(0,fm.cs)({name:"read-pdf",body:{url:i}}):(0,fm.cs)({name:"send-message-to-chat",body:{msg:d,chatType:l}}):Rp.IF.getState().type===dc.u9.pdf?(0,Hm.M)({url:i}):(Fl.Qz.create("cici_summary_page_action_perf",!0),(0,uv.C)(d,{chatType:l,sendMessageCallback:t=>{null==e||e((null==t?void 0:t[0].local_message_id)||"")}}))}catch(i){ue.vF.persist.error({eventName:"[Context Menu] - SUMMARIZE",error:i})}}));return function(t){return e.apply(this,arguments)}}(),Vy={name:"content-menu-click",handle:e=>{const{actionKey:t,selectionText:n=""}=e||{};if(t)if("collect_page"===t)(0,Vt.XQ)({collectFrom:pt.vP.collect_this_page,collectionType:mt.X.Web}),(0,et.s)("right_click_function_click",{button_name:"collect_this_page",current_page:(0,pt.p$)()}),(0,Qe.dn)({current_page:(0,pt.p$)(),click_from:"right_click_function_click"});else if("page-summarize"===t)qy(),(0,et.s)("right_click_function_click",{button_name:"summarize_this_page",current_page:(0,pt.p$)()}),(0,Qe.dn)({current_page:(0,pt.p$)(),click_from:"right_click_function_click"});else if("page-translate"===t)(0,mx.TI)({isActive:!0}),(0,et.s)("right_click_function_click",{button_name:"translate_this_page",current_page:(0,pt.p$)(),translate_service:(0,J.TK)("pageTranslateService"),to_lang:(0,J.TK)("translateLanguage")}),(0,Qe.dn)({current_page:(0,pt.p$)(),click_from:"right_click_function_click"});else{const{inputText:e,selectionBaseInfo:i}=Np.t_.getState(),o=!e||Rp.IF.getState().type===dc.u9.pdf||!(e=>{const{top:t,left:n,width:i,height:o,clientBottom:s}=e;return[t,n,i,o,s].every((e=>null!=e&&!isNaN(e)))})(i);if(o&&n){const e=(0,a.A)((0,a.A)({},Lp.Ws),{},{text:n,contextText:n,anchorOffset:0});Np.t_.setState({inputText:n,selectionBaseInfo:e,simpleSelectionBaseInfo:e})}(0,Ip.qZ)(t,_.Z5.context_menu,o)}}},$y={name:"tab-activated",handle:e=>{Gd.on.getState().setTabInfo({tabId:e.tabId}),tx()}},Ky={name:"toggle-cici-sidebar",handle:()=>{dn.l.getState().toggleShowSidebar(_.cz.other)}};var Wy=n(83718);const Gy=()=>{const e=(0,ix.c)(Object.values(s));return()=>{e(),ix.F.destroy()}};var Zy=n(46694),Yy=n(7685),Jy=n.n(Yy);const Qy=e=>{const t=(e=>{const t="macos"===Jy().getParser(navigator.userAgent).getOSName(!0);let n="";return e.ctrlKey&&(n+=`${O_.vK.Ctrl}+`),e.metaKey&&(n+=`${t?O_.vK.Command:O_.vK.Windows}+`),e.altKey&&(n+=`${t?O_.vK.Option:O_.vK.Alt}+`),e.shiftKey&&(n+=`${O_.vK.Shift}+`),n+=(0,O_.Lj)(e.code),n})(e),n=(0,J.gv)(),i=Object.entries(n).find((([e,n])=>{if(n.key.toLocaleLowerCase()===t.toLocaleLowerCase())return!0}));if(i)switch(i[0]){case F_.e.OpenSide:""!==Np.t_.getState().inputText?(0,Ip.qZ)(ml.EU.ask,_.Z5.shortcut):dn.l.getState().toggleShowSidebar(_.cz.other),e.preventDefault();break;case F_.e.TranslatePage:Xy(),e.preventDefault();break;case F_.e.ReadPage:eb(),e.preventDefault()}};const Xy=()=>{const{active:e}=Mp.I.getState();(0,Dl.BB)({action:"web_translatePage",loginParams:{trackMeta:{login_entrance:"float_btn"}}})||(pv._.isInSidePanel?(0,fm.cs)("translate-page-request"):(0,mx.TI)({isActive:!e}))},eb=function(){var e=(0,r.A)((function*(){const{setIsShowSidebar:e}=dn.l.getState();try{var t;if((0,Ce.GT)(),(0,Dl.BB)({action:"web_summary",loginParams:{trackMeta:{login_entrance:"float_btn"}}}))return;const n=window.location.href;yield(0,mv.GA)();const i=(0,mv.CC)(),o=(0,No.wz)((0,J.TK)("uiLanguage"));e(!0,_.cz.clickSidebar);const s={title:null==i?void 0:i.title,url:n,content:null==i?void 0:i.textContent};Gd.on.getState().setFloatingCardVisible(!1),Gd.on.getState().setSummaryActionVisible(!1),yield(0,Yd.Z)();const{convId:a,convType:r,mainBotId:l}=(0,Oh.IK)(),c={text:n,extraExt:{origin:location.origin,browser_explain:JSON.stringify(s),llm_without_mem:"1",browser_language:o,flag_browser_plugin:"1",answer_with_suggest:"0",need_create_thread:r===bu.H.NewThread?"1":"0"},scene:kr.sJ.chat_action_bar,ctx:(0,Zd.Pe)(r,a,l)};ue.vF.persist.log({eventName:"summary_page_action",meta:{contentLength:null===(t=s.content)||void 0===t?void 0:t.length,from:"shortcut"}}),dn.l.getState().isSidePanelMode&&!pv._.isInSidePanel?Rp.IF.getState().type===dc.u9.pdf?(0,fm.cs)({name:"read-pdf",body:{url:n}}):(0,fm.cs)({name:"send-message-to-chat",body:{msg:c,chatType:r}}):Rp.IF.getState().type===dc.u9.pdf?(0,Hm.M)({url:n}):(Fl.Qz.create("cici_summary_page_action_perf",!0),(0,uv.C)(c,{chatType:r}))}catch(n){ue.vF.persist.error({eventName:"shortcut_summarize_page",error:n})}}));return function(){return e.apply(this,arguments)}}();let tb;const nb=e=>{const{shadowContainer:t,shadowHost:n,shadowRoot:i}=(0,rt.VT)(he.ly);return(e=>{u.m.getInstance().init(),tb=u.m.getInstance().getHostId(),e.dataset.hostId=tb})(n),(0,rt.YB)(n),e.mark("load_css_start"),(0,rt.NR)(i,he.QN).then((()=>{e.mark("load_css_end"),(0,rt.XX)(t,Sx),e.mark("component_mounted"),setTimeout((()=>{document.querySelector("#Cici-ai-assistant")||e.mark("component_mounted_error"),e.end("component_mounted_end")}),500)})),i},ib=()=>{if((0,l.Ny)())return;const e=[];e.push((()=>{var e;const t=(0,fu.Ay)(location.href);if(!t)return null;let n=null===(e=t.watchRouteChange)||void 0===e?void 0:e.call(t,(()=>{fp(t)}));return fp(t),()=>{var e;null===(e=n)||void 0===e||e(),n=void 0}})()),e.push((()=>{const e=(e,t,n)=>{const{setVideoId:i,setVideoTitle:o,setVideoPartId:s}=cn.e.getState();i(e||""),o(t||""),s(n||"0");const a=(0,Io.Ay)(location.href);fp(a)},t=t=>{var n;const i=null==t||null===(n=t.detail)||void 0===n||null===(n=n.response)||void 0===n||null===(n=n.playerResponse)||void 0===n?void 0:n.videoDetails;e(null==i?void 0:i.videoId,null==i?void 0:i.title)},n=()=>{if(!(0,Io.jB)("bilibili"))return;const{videoId:t,title:n,partId:i}=(0,un.OX)();e(t,n,i)};let i,o;(()=>{const t=(0,Io.Ay)(location.href);if((0,Io.jB)(null==t?void 0:t.name)){let s="",a="";var n;if("youtube"===(null==t?void 0:t.name))s=(0,un.Wd)(t),a=null===(n=document)||void 0===n?void 0:n.title,e(s,a);else if("bilibili"===(null==t?void 0:t.name)){var o;i=null===(o=t.pageIsReady)||void 0===o?void 0:o.call(t,(()=>{const{videoId:t,title:n,partId:i}=(0,un.OX)();s=t,a=n,e(s,a,i)}))}}})();const s=(0,Io.Ay)(location.href);var a;return(0,Io.jB)("bilibili")&&(o=null==s||null===(a=s.onUrlChange)||void 0===a?void 0:a.call(s,n)),window.addEventListener("yt-navigate-finish",t),()=>{var e,n;window.removeEventListener("yt-navigate-finish",t),null===(e=o)||void 0===e||e(),null===(n=i)||void 0===n||n()}})()),e.push(void 0),e.push(xp()),e.push((()=>{if(!(0,vt.ku)())return()=>"";const e=Qt();return()=>{null==e||e()}})()),e.push((()=>{var e;const t=(0,km.Ay)(location.href);if(!t)return;let n;const i=null===(e=t.watchRouteChange)||void 0===e?void 0:e.call(t,(()=>{var e;null===(e=n)||void 0===e||e(),n=bp(t)}));return n=bp(t),()=>{var e;null==i||i(),null===(e=n)||void 0===e||e()}})()),e.push((()=>{let e=[];const t=(0,J.tl)("search_addons");return e=[t.feed_card_show?dt():h.A],()=>{e.forEach((e=>null==e?void 0:e()))}})()),u.m.getInstance().registerRecyclables(e)},ob=function(){var e=(0,r.A)((function*(){try{var e;(0,u.A)((()=>{const e=[jp(),Gy()];return()=>{e.forEach((e=>e()))}})()),(0,Hy.Ao)();const t=Fl.Qz.create("cici_assistant_startup_perf",!0);yield function(){return Fy.apply(this,arguments)}(),c.j.init({httpClient:Gn.sY,getCommonHeaders:Zy.Ql,getCommonParams:Zy.wH,baseURL:Lm.i4}),yield en.Ay.initTea(),yield(0,at.LE)(),yield(0,zy.S)(),yield Rx();const n=nb(t);if(null===(e=(0,Hy.Gl)())||void 0===e||e.startResourceMonitor(n),ib(),window.addEventListener("keydown",Qy),(0,u.A)((()=>window.removeEventListener("keydown",Qy))),(0,Ap.TbE)().ctx={chatConfigService:(0,Cp.u)((()=>{var e;return{appId:Number(Un.sZ),userId:(0,J.Fc)().userId,loginSource:"flow-ext",createUploader:e=>new wp.G((0,a.A)((0,a.A)({},e),{},{useDirectUpload:!0})),isGuest:!(null!==(e=(0,J.Fc)())&&void 0!==e&&e.isAuthenticated)}}))},Py.init(),(0,u.A)((()=>Py.reset())),Uy(),-1!==location.origin.indexOf("www.baidu.com")){const e=new MutationObserver((function(e){for(const i of e)for(const e of i.removedNodes){var n;(null==e||null===(n=e.dataset)||void 0===n?void 0:n.hostId)===tb&&nb(t)}}));e.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),(0,u.A)((()=>null==e?void 0:e.disconnect()))}0,tx()}catch(t){console.error(t),ue.vF.persist.info({eventName:"[CSUI] - BOOTSTRAP",meta:(0,a.A)({},t)})}}));return function(){return e.apply(this,arguments)}}();try{null===(sb=document)||void 0===sb||null===(sb=sb.querySelectorAll(`#${he.Yq}`))||void 0===sb||sb.forEach((e=>{var t;e&&e instanceof HTMLElement&&void 0===(null==e||null===(t=e.dataset)||void 0===t?void 0:t.hostId)&&(-1!==location.origin.indexOf("www.baidu.com")?(e.id=`${e.id}-depressed`,e.style.display="none"):e.remove())})),null===(ab=document)||void 0===ab||null===(ab=ab.querySelectorAll(`#${he.hs}`))||void 0===ab||ab.forEach((e=>{var t;e instanceof HTMLElement&&void 0===(null==e||null===(t=e.dataset)||void 0===t?void 0:t.fullSearchHostId)&&(e.id=`${e.id}-depressed`,e.style.display="none")})),null===(rb=document)||void 0===rb||null===(rb=rb.querySelectorAll(`#${he.U6}`))||void 0===rb||rb.forEach((e=>{var t;e instanceof HTMLElement&&void 0===(null==e||null===(t=e.dataset)||void 0===t?void 0:t.searchHostId)&&(e.id=`${e.id}-depressed`,e.style.display="none")})),null===(lb=document)||void 0===lb||null===(lb=lb.querySelectorAll(`#${he.$9}`))||void 0===lb||lb.forEach((e=>{var t;e instanceof HTMLElement&&void 0===(null==e||null===(t=e.dataset)||void 0===t?void 0:t.videoSearchHostId)&&(e.id=`${e.id}-depressed`,e.style.display="none")})),null===(cb=document.querySelectorAll(`[id*=${he.AJ}]`))||void 0===cb||cb.forEach((e=>{var t;e instanceof HTMLElement&&void 0===(null==e||null===(t=e.dataset)||void 0===t?void 0:t.mailHostId)&&(e.id=`${e.id}-depressed`,e.style.display="none")}))}catch(db){console.error("\u8001\u7248\u672c\u63d2\u4ef6\u8d44\u6e90\u91ca\u653e\u5f02\u5e38",db)}var sb,ab,rb,lb,cb;ob().finally((()=>{(0,u.A)((()=>{var e;console.log("lcj--\x3e destory....",tb),void 0!==tb&&(null===(e=document)||void 0===e||null===(e=e.querySelector(`[data-host-id="${tb}"]`))||void 0===e||e.remove(),tb=void 0)})),(0,u.A)(J.LR),(0,u.A)((()=>{const e=d.Pv.getSocketAdapter();e&&(e.drop(),e.client=void 0)}))}))},48474:(e,t,n)=>{n.d(t,{$8:()=>c,Ch:()=>i,J7:()=>u,JP:()=>r,Mx:()=>o,NU:()=>d,Nt:()=>m,SB:()=>a,Sf:()=>s,nC:()=>p,pK:()=>h,rA:()=>g,x_:()=>l});const i="__Cici_translate_similar_text_content__",o="__Cici_translate_origin_node__",s="__Cici_translate_translated_inject_node__",a="__Cici_translate_need_wrapper__",r="lle-page-translate-retry",l="__Cici_translate_loading__",c="__Cici_translate_clamp_unset__",d="__Cici_translate_global_wrapper__",u="__Cici_translated_text_show_underline__",h="__Cici_translate_hide_origin_content_wrapper__",m="__Cici__translate__",p="__Cici_translate_Safari__",g="__Cici__video_highlight__"},58027:(e,t,n)=>{n.d(t,{Ip:()=>x,J7:()=>C,S2:()=>b,g$:()=>w,pz:()=>y});var i=n(14065),o=n(10633),s=n(59355),a=n(56422),r=n(57717),l=n(20411),c=n(49323),d=n(76482),u=n(76708),h=n(85777),m=n(65969),p=n(18587),g=n(66032),v=n(71905),f=n(9584);const _=new class{constructor(){var e=this;(0,o.A)(this,"translator",void 0),(0,o.A)(this,"prepareForMessageFromExtension",(()=>{r.A.on(c.$5,r.x.PAGE,(e=>{r.A.emit(c.Rx,r.x.PAGE,e)})),r.A.on(c.$x,r.x.PAGE,(e=>{e?this.translatePage():this.clearTranslate()})),r.A.on(c.FK,r.x.PAGE,(()=>{const{active:e}=l.I.getState();return r.A.emit(c.vb,r.x.PAGE,e),e})),r.A.on(c.oo,r.x.PAGE,(()=>{const e=g.IF.getState().url,t=new URL(e).hostname,n=(0,v.TK)("autoTranslatePageHosts"),i=(0,s.A)(n,t);r.A.emit(c.OH,r.x.PAGE,i)})),r.A.on(c.NZ,r.x.PAGE,(e=>{this.toggleCurrentPageAutoTranslate(e)})),r.A.on(c._m,r.x.PAGE,(()=>{const{showOrigin:e}=l.I.getState();r.A.emit(c.Yf,r.x.PAGE,e)})),r.A.on(c.bz,r.x.PAGE,(e=>{this.toggleShowOriginalContent(e)})),r.A.on(c.Qh,r.x.PAGE,(e=>{this.setTargetLangCode(e)}))})),(0,o.A)(this,"setTargetLangCode",(e=>{(0,(0,f.Y)("translateLanguage")[1])(e),d.A.set("translateLanguage",e);const{active:t}=l.I.getState();t&&this.translatePage()})),(0,o.A)(this,"toggleShowOriginalContent",(e=>{const{setShowOrigin:t}=l.I.getState();e?this.showOriginContent():this.hideOriginContent(),t(e)})),(0,o.A)(this,"toggleCurrentPageAutoTranslate",function(){var e=(0,i.A)((function*(e){const t=new URL(window.location.href).hostname,n=yield d.A.get("autoTranslatePageHosts"),i=e=>{d.A.set("autoTranslatePageHosts",e)};i(e?[...new Set([...n,t])]:(0,a.A)(n,(e=>e!==t)))}));return function(t){return e.apply(this,arguments)}}()),(0,o.A)(this,"translatePage",(0,i.A)((function*(){const t=yield d.A.get("translateLanguage"),n=yield d.A.get("pageTranslateService"),{setShowLangNotice:i,setActive:o}=l.I.getState();o(!0),e.pageTranslate({lang:t,translateService:(0,p.w)(n)});t===(yield(0,u.b)((0,u.T)()))&&i(!0)}))),(0,o.A)(this,"pageTranslate",(e=>{r.A.emit(c.P9,r.x.PAGE,!0);const{lang:t,translateService:n}=e;this.translator.start(t,n)})),(0,o.A)(this,"showOriginContent",(()=>{this.translator.showOriginContent()})),(0,o.A)(this,"translatedTextShowUnderline",(e=>{this.translator.translatedTextShowUnderline(e)})),(0,o.A)(this,"hideOriginContent",(()=>{this.translator.hideOriginContent()})),(0,o.A)(this,"clearTranslate",(()=>{const{setActive:e}=l.I.getState();r.A.emit(c.P9,r.x.PAGE,!1),this.translator.clearTranslate(),e(!1)}));const t=(0,m.sC)(),n=(0,m.c5)(),_=(0,m.qO)();this.translator=new h.r({strategyFilters:{traverse:t,paragraph:n,paragraphChild:_},onlyNeedIncludeSelectors:m.B2}),this.prepareForMessageFromExtension()}},{pageTranslate:x,showOriginContent:y,hideOriginContent:b,clearTranslate:w,translatedTextShowUnderline:C}=_},89369:(e,t,n)=>{n.d(t,{BB:()=>v,OB:()=>p,vh:()=>f});var i=n(44557),o=n(11855),s=n(41967),a=n(98028),r=n(71905),l=n(99824),c=n(43423),d=n(30065),u=n(9584),h=n(30457);const m="onboardingActionRecord",p=(e,t="web")=>{switch(e){case l.EU.ask:return`${t}_ask`;case l.EU.mail:return`${t}_gmail`;default:return`${t}_${e}`}},g=e=>{const{action:t}=e;if(t){if(!a.bc.includes(t))return!0;const n=(({action:e,update:t,record:n})=>{if(a.fW.includes(e)){var i;let o=Number((null===(i=n||(0,r.TK)(m))||void 0===i||null===(i=i[e])||void 0===i?void 0:i.count)||0);return t&&(o++,(0,c.Rm)(`action ${e} used count: ${o}`),(0,r.vE)(m,{[e]:{count:o}},!0)),o}{const t=new Error(`action [${e}] not found in predefined keys`);d.vF.persist.error({eventName:"[Onboarding Action] not found action",error:t}),(0,c.z3)(t)}})((0,i.A)((0,i.A)({},e),{},{action:t}));if((0,s.A)(n)&&n<=a.C9[t])return!0}return!1},v=e=>{const{action:t,triggerLogin:n=!0,loginParams:i}=e,o=(0,r.TK)("authInfo");if(!(null!=o&&o.isAuthenticated||g({action:t,update:!0})))return n&&(0,h.DT)(i),!0},f=(e,t)=>{var n;const i=null===(n=(0,u.Y)("authInfo")[0])||void 0===n?void 0:n.isAuthenticated,s=(0,u.Y)(m)[0],a=(0,o.useMemo)((()=>!i&&g({action:e,record:s,update:!1})),[s,e,i]);return i||!t&&a}},27675:(e,t,n)=>{n.d(t,{Bc:()=>x,Pe:()=>b,ci:()=>f});var i=n(14065),o=n(60258),s=n(11646),a=n(93196),r=n(29581),l=n(51242),c=n(60822),d=n(37524),u=n(71905),h=n(11021),m=n(30065),p=n(41351),g=n(17753);function v(){return(v=(0,i.A)((function*(e){var t;yield(0,h.c)({name:"clear-http-cache",body:["message/list","samantha/feed"]});const n=yield r.pU.getState().fetchUpdateConversationInfo(e);yield s.ozw.getState().initMessageList({conversationId:e,messageCursor:Number(null==n?void 0:n.message_cursor),messageIndex:Number(null==n?void 0:n.message_index),range:{start:Number(null==n?void 0:n.message_cursor),end:Number(null==n?void 0:n.message_index)},isGuest:!(null!==(t=(0,u.Fc)())&&void 0!==t&&t.isAuthenticated)})}))).apply(this,arguments)}function f(e){return _.apply(this,arguments)}function _(){return _=(0,i.A)((function*({messageIds:e=[],switchMessageId:t="0"}){const n=yield(0,d.$D)();if(void 0!==n){try{yield(0,g.U8)({conversationId:n,messageIds:e,switchMessageId:t})}catch(i){m.vF.persist.error({message:"push record error",error:i})}c.l.getState().isSidePanelMode&&!p._.isInSidePanel?(0,h.c)({name:"continue-in-chat",body:{conversationId:n}}):function(e){v.apply(this,arguments)}(n)}})),_.apply(this,arguments)}function x(e,t){return y.apply(this,arguments)}function y(){return(y=(0,i.A)((function*(e,t){c.l.getState().isSidePanelMode&&!p._.isInSidePanel?yield(0,h.c)({name:"send-message-to-chat",body:{msg:t,chatType:e}}):(0,a.C)(t,{chatType:e})}))).apply(this,arguments)}function b(e,t,n){const i=e===l.H.NewThread;return{botId:n,conversationId:i?void 0:t,localConversationId:i?t:void 0,conversationType:i?o.Cr.CocoWebSub:void 0}}},46043:(e,t,n)=>{n.d(t,{B4:()=>P,CE:()=>x,Lv:()=>b,N0:()=>U,NK:()=>R,Qx:()=>C,VT:()=>H,Yb:()=>N,aZ:()=>S,gP:()=>f,rV:()=>D,s6:()=>k,y6:()=>E});var i=n(44557),o=n(14065),s=n(16604),a=n(46745),r=n(28920),l=n(89739),c=n(71905),d=n(39275),u=n(58735),h=n(89207);const m=new Map;function p(e){var t;return{id:-1,tags:[],language:null!==(t=(0,s.wz)((0,c.TK)("uiLanguage")))&&void 0!==t?t:navigator.language,collection_type:e,source_url:location.href}}function g(e){return v.apply(this,arguments)}function v(){return(v=(0,o.A)((function*(e){const t=yield(0,h.S6)({method:"POST",url:`${l.kD}/collection/create`,data:e});if(t instanceof Error)throw t;return t}))).apply(this,arguments)}function f(e){return _.apply(this,arguments)}function _(){return(_=(0,o.A)((function*(e){const t={collection:(0,i.A)((0,i.A)({},p(a.e.TextFragment)),{},{text_fragment:{ctx_text:e.contextText,selection_text:e.selectionText,anchor_offset:e.anchorOffset}})};return yield g(t)}))).apply(this,arguments)}function x(e,t){return y.apply(this,arguments)}function y(){return(y=(0,o.A)((function*(e,t){const n={collection:(0,i.A)((0,i.A)({},p(a.e.TranslateResult)),{},{summary:t.translatedText,summary_msg_id_str:e,translate_result:{selection_text:t.selectionText,translate_language:t.translate_lang}})};return yield g(n)}))).apply(this,arguments)}function b(e,t){return w.apply(this,arguments)}function w(){return(w=(0,o.A)((function*(e,t){const n={collection:(0,i.A)((0,i.A)({},p(a.e.ExplainResult)),{},{summary:t.explainedText,summary_msg_id_str:e,explain_result:{selection_text:t.selectionText}})};return yield g(n)}))).apply(this,arguments)}function C(e,t){return A.apply(this,arguments)}function A(){return(A=(0,o.A)((function*(e,t){const n={collection:(0,i.A)((0,i.A)({},p(a.e.SearchResult)),{},{summary:t.generatedText,summary_msg_id_str:e,search_result:{search_text:t.searchText}})};return yield g(n)}))).apply(this,arguments)}function S(e,t,n){return I.apply(this,arguments)}function I(){return(I=(0,o.A)((function*(e,t,n){const o={collection:(0,i.A)((0,i.A)({},p(a.e.Web)),{},{fingerprint:t,web:{text_content:e.text_content,html_content:e.html_content,title:e.title,dir:e.dir,description:e.description,cover_image_url:e.cover_image_url,snapshot_img_key:e.snapshot_img_key}})};if(n&&(o.collection.source_url=n),!t)return yield g(o);const s=m.get(t);if(s)return s;const r=new Promise(((e,t)=>g(o).then(e).catch(t))).finally((()=>m.delete(t)));return m.set(t,r),r}))).apply(this,arguments)}function k(e){return j.apply(this,arguments)}function j(){return(j=(0,o.A)((function*(e){const t={collection:(0,i.A)((0,i.A)({},p(a.e.Pdf)),{},{fingerprint:yield(0,r.K)(a.e.Pdf),pdf:e})};return yield g(t)}))).apply(this,arguments)}function E(e,t){return T.apply(this,arguments)}function T(){return(T=(0,o.A)((function*(e,t){const n={collection:(0,i.A)((0,i.A)({},p(a.e.SocialWebCard)),{},{social_web_card:e})};return t&&(n.collection.source_url=t),yield g(n)}))).apply(this,arguments)}function N(e,t,n,i){return M.apply(this,arguments)}function M(){return(M=(0,o.A)((function*(e,t,n,o){n.highlights_message_id=n.highlights_message_id||void 0,n.timeline_msg_id_str=n.timeline_msg_id_str||void 0;const s=yield(0,r.K)(a.e.VideoSummary),l={collection:(0,i.A)((0,i.A)({},p(a.e.VideoSummary)),{},{fingerprint:s,summary:e,memos:o,summary_msg_id_str:t,video_summary:n})},c=m.get(s);if(c)return c;const d=new Promise(((e,t)=>g(l).then(e).catch(t))).finally((()=>m.delete(s)));return m.set(s,d),d}))).apply(this,arguments)}function R(e){return L.apply(this,arguments)}function L(){return(L=(0,o.A)((function*(e){const t=yield(0,h.S6)({method:"GET",url:`${l.kD}/collection/fingerprint/get/${e}`});if(!(t instanceof Error))return null==t?void 0:t.id}))).apply(this,arguments)}function P(){return B.apply(this,arguments)}function B(){return(B=(0,o.A)((function*(){return R(yield(0,r.K)(a.e.VideoSummary))}))).apply(this,arguments)}function D(e){return F.apply(this,arguments)}function F(){return(F=(0,o.A)((function*(e){return!((yield(0,h.S6)({method:"POST",url:`${l.kD}/collection/delete`,data:{id:`${e}`}}))instanceof Error)}))).apply(this,arguments)}function U(e=!0){return new Promise(((t,n)=>{const i=document.querySelector(`#${u.Yq}`),{display:o}=(null==i?void 0:i.style)||{};let s;e&&i&&(i.style.display="none",s=setTimeout((()=>{i.style.display=o,s=void 0}),2e3)),setTimeout((()=>{(0,d.cs)("capture-visible-tab").then((n=>{t(n.data),e&&i&&(i.style.display=o),void 0!==s&&clearTimeout(s)})).catch((e=>{void 0!==s&&clearTimeout(s),n(e)}))}),100)}))}function H(e){return z.apply(this,arguments)}function z(){return(z=(0,o.A)((function*(e){const t=yield(0,h.S6)({method:"GET",url:`${l.kD}/collection/get/${e}`});if(t instanceof Error)throw t;return t}))).apply(this,arguments)}},32572:(e,t,n)=>{n.d(t,{g:()=>r});var i=n(22910),o=n(89739),s=n(46694),a=n(89207);const r=(0,i.n)({httpClient:a.sY,getCommonParams:s.wH,baseURL:o.C1})},26903:(e,t,n)=>{n.d(t,{I:()=>a});var i=n(30457),o=n(71905),s=n(39275);const a=e=>{(0,o.TK)("authInfo").isAuthenticated?(0,s.cs)({name:"open-options-page",body:e}):(0,i.DT)()}},89137:(e,t,n)=>{n.d(t,{Gq:()=>v,Ie:()=>u,Jg:()=>h,R_:()=>p,S1:()=>l,eR:()=>g,j$:()=>f,jv:()=>d,mu:()=>m,oJ:()=>c});var i=n(44557),o=n(61540),s=n(54483),a=n(41650),r=n(99301);let l=function(e){return e.NORMAL="normal",e.READ_PAGE="read_this_page",e}({});const c=()=>{(0,o.z8)(s.Ur.showChatAssistant,{})},d=()=>{(0,o.z8)(s.Ur.showChatAssistantPopover,{})},u=({button_name:e,params:t})=>{(0,o.z8)(s.Ur.clickChatAssistantPopover,(0,i.A)({button_name:e,current_page:(0,a.p$)(),click_from:s.Z5.chatAssistantPopover},t))},h=({button_name:e})=>{(0,o.z8)(s.Ur.showChatAssistantPopoverSettings,{button_name:e})},m=({button_name:e,value:t})=>{(0,o.z8)(s.Ur.clickChatAssistantPopoverSettings,{value:t?"1":"0",button_name:e,click_from:s.Z5.chatAssistantPopoverSettings})},p=({button_name:e})=>{(0,o.z8)(s.Ur.showChatHeaderBtn,{current_page:r.$2.chat,button_name:e})},g=({button_name:e})=>{(0,o.z8)(s.Ur.clickChatHeaderBtn,{current_page:r.$2.chat,button_name:e})},v=({highlight_page_url:e,module_name:t})=>{(0,o.z8)(s.Ur.showChatFloatCard,{highlight_page:(0,o.M5)(e),module_name:t})},f=({highlight_page_url:e,module_name:t,button_name:n})=>{(0,o.z8)(s.Ur.clickChatFloatCard,{highlight_page:(0,o.M5)(e),module_name:t,button_name:n})}},41650:(e,t,n)=>{n.d(t,{QH:()=>g,ae:()=>u,mL:()=>m,o2:()=>h,p$:()=>d,p6:()=>l,vP:()=>r});var i=n(61540),o=n(54483),s=n(31525),a=n(21642);let r=function(e){return e.arxiv_view_pdf="arxiv_view_pdf",e.chrome_pdf_viewer="chrome_pdf_viewer",e.side_bar_popover="side_bar_popover",e.search_result_card="search_result_card",e.video_page_summarize="video_page_summarize",e.highlight_result_card_translate="highlight_result_card_translate",e.highlight_result_card_explain="highlight_result_card_explain",e.highlight_function_bar="highlight_function_bar",e.right_click="right_click",e.collect_this_page="collect_this_page",e.webimage_collect="webimage_collect",e.video_memo_save="video_memo_save",e}({}),l=function(e){return e.videosummary="videosummary",e.searchresult="searchresult",e.textfragment="textfragment",e.TranslateResult="TranslateResult",e.ExplainResult="ExplainResult",e.web="web",e.pdf="pdf",e}({});function c(e=location.hostname){return e}function d(){let e=(0,i.M5)(location.href);return e.startsWith("search_engine_")&&(e="search_engine"),e}function u(e,t){(0,i.z8)(o.Ur.collectionButtonShow,{show_from:e,current_page:d(),collect_type:t,collect_from_site:c()})}function h(e,t){(0,i.z8)(o.Ur.collectionButtonClickSave,{click_from:e,collect_type:t,current_page:d(),collect_from_site:c()})}function m(e,t,n,s){(0,i.z8)(o.Ur.collectionButtonClickSaveStatus,{click_from:e,current_page:d(),collect_from_site:c(),success:t,collect_type:n,collect_id:s})}function p(){if(!(0,a.ku)())return;const e=window.getSelection();(null==e?void 0:e.toString().trim())?u(r.right_click,l.textfragment):u(r.collect_this_page,l.web)}function g(){document.addEventListener("contextmenu",p),(0,s.A)((()=>{document.removeEventListener("contextmenu",p)}))}},75787:(e,t,n)=>{n.d(t,{Kp:()=>h,Zl:()=>d,ct:()=>u,hc:()=>m});var i=n(44557),o=n(33451),s=n(61540),a=n(54483);const r=["message_id","click_from","skill_name"],l=["message_id","click_from","skill_name"],c=["message_id","click_from","skill_name"],d=({message_id:e,click_from:t,skill_name:n})=>{(0,s.z8)(a.Ur.regenerate,{message_id:e,button_name:a.Ur.regenerate,click_from:t,skill_name:n})},u=e=>{let{message_id:t,click_from:n,skill_name:l}=e,c=(0,o.A)(e,r);(0,s.z8)(a.Ur.copy,(0,i.A)({message_id:t,button_name:a.Ur.copy,click_from:n,skill_name:l},c))},h=e=>{let{message_id:t,click_from:n,skill_name:r}=e,c=(0,o.A)(e,l);(0,s.z8)(a.Ur.continueInChat,(0,i.A)({message_id:t,button_name:a.Ur.continueInChat,click_from:n,skill_name:r},c))},m=e=>{let{message_id:t,click_from:n,skill_name:r}=e,l=(0,o.A)(e,c);(0,s.z8)(a.Ur.retry,(0,i.A)({message_id:t,button_name:a.Ur.retry,click_from:n,skill_name:r},l))}},8050:(e,t,n)=>{n.d(t,{M7:()=>c,dn:()=>u,gR:()=>d,zl:()=>h});var i=n(54483),o=n(48544),s=n(36729),a=n(305),r=n(30065);const l=e=>e&&e!==i.g6.webOther?e:window.location.host,c=e=>{var t;null===(t=o.Ay.Tea)||void 0===t||t.event(i.Ur.viewDAU,{current_page:l(null==e?void 0:e.current_page),show_from:null==e?void 0:e.show_from})},d=(e,t)=>e===i.Ur.enterPage&&(null==t?void 0:t.current_page)===i.g6.chat?(t.show_from="enter_page_chat",void c(t)):e===i.Ur.showMailEntryButton||e===i.Ur.writingSkilShow?(t.show_from=t.show_from||e,void c(t)):e===i.Ur.showSelectAssistantMenu||e===i.Ur.showSearchAssistant||e===i.Ur.showVideoAssistant||e===i.Ur.showChatAssistant||e===i.Ur.collectionButtonShow?(t.show_from=e,void c(t)):e===i.Ur.linkPreviewEntryShow||e===i.Ur.linkPreviewResultShow?(t.show_from=i.Z5.searchResultPreview,void c(t)):void 0,u=e=>{var t;null===(t=o.Ay.Tea)||void 0===t||t.event(i.Ur.activeDAU,{current_page:l(null==e?void 0:e.current_page),button_name:null==e?void 0:e.button_name,click_from:null==e?void 0:e.click_from})},h=(e,t)=>e!==i.Ur.copy&&e!==i.Ur.regenerate&&e!==i.Ur.continueInChat&&e!==i.Ur.retry||(null==t?void 0:t.click_from)!==i.Z5.selectAssistantResult?(null==t?void 0:t.click_from)===i.Z5.deepSearchMode||e===i.Ur.searchResultCardClick||e===i.Ur.clickDeepSearchBtn?(t.click_from=i.Z5.searchAssistant,void u(t)):t.click_from!==a.sJ.writing_assistant?e===i.Ur.copy||e===i.Ur.regenerate||e===i.Ur.continueInChat||e===i.Ur.retry||e===i.Ur.clickSearchAssistantSuggest?(null===t.click_from&&r.vF.persist.log({eventName:"NULL_CLICK_FROM_EVENT",meta:{event_name:e,params:t}}),void u(t)):e===i.Ur.clickSelectAssistantMenuBtn||e===i.Ur.clickSelectAssistantResultBtn?(t.click_from=i.Z5.selectAssistantMenu,void u(t)):e!==i.Ur.clickVideoAssistantSummarizeBtn||t.click_from!==s.K.IMMERSION_BTN&&t.click_from!==s.K.UPPER_RIGHT&&t.click_from!==s.K.ONBOARDING?e===i.Ur.clickVideoImmersionGuideTips||e===i.Ur.clickVideoImmersionGuideIcon||e===i.Ur.immersionTimeLine?(t.click_from=i.Z5.videoAssistant,void u(t)):e===i.Ur.clickChatAssistantPopoverSettings||e===i.Ur.clickChatAssistantPopover&&((null==t?void 0:t.button_name)===i._h.translatePage||(null==t?void 0:t.button_name)===i._h.summarizePage||(null==t?void 0:t.button_name)===i._h.languageSettings)?(t.click_from=i.Z5.chatAssistantPopover,void u(t)):e===i.Ur.sendMessage&&(null==t?void 0:t.current_page)===i.g6.chat?(t.click_from=i.Z5.sendMessageInChat,void u(t)):e===i.Ur.clickMailEntryButton?(t.click_from=i.Z5.mailEntryButton,void u(t)):e===i.Ur.collectionButtonClickSave?(t.click_from=i.Z5.collect,void u(t)):e===i.Ur.linkPreviewEntryShow||e===i.Ur.linkPreviewResultShow?(t.click_from=i.Z5.searchResultPreview,void u(t)):void 0:(t.click_from=i.Z5.videoAssistant,void u(t)):void u(t):(t.click_from=i.Z5.selectAssistantMenu,void u(t))},54483:(e,t,n)=>{n.d(t,{Ld:()=>r,Ur:()=>l,Yd:()=>s,Z5:()=>o,_h:()=>a,cz:()=>c,g6:()=>i});let i=function(e){return e.setting="setting",e.landing="landing",e.welcome="extension_welcome",e.login="login",e.uninstall="uninstall",e.extensionOther="extension_other",e.baidu="search_engine_baidu",e.google="search_engine_google",e.bing="search_engine_bing",e.toutiao="search_engine_toutiao",e.youtube="youtube",e.bilibili="bilibili",e.chat="chat",e.chatgpt="chatgpt",e.mail="mail_page",e.xiaoyuzhou="xiaoyuzhou",e.apple="apple",e.webOther="web_otherpage",e}({}),o=function(e){return e.onboarding="onboarding",e.selectAssistantMenu="highlight_function_bar",e.selectAssistantMoreMenu="highlight_function_bar_dropdown",e.selectAssistantResult="highlight_result_card",e.searchAssistant="search_result_card",e.videoAssistant="video_page_summarize",e.chatAssistantPopover="sidebar_action_popover",e.chatAssistantPopoverSettings="sidebar_action_popover_settings",e.sendMessageInChat="send_message_in_chat",e.mailCreate="mail_create",e.mailUpdate="mail_update",e.mailEntryButton="mail_entry_button",e.mailPositive="mail_positive",e.mailNegative="mail_negative",e.mailNeedMore="mail_need_more",e.arxiv="arxiv",e.pdf="pdf",e.context_menu="context_menu",e.shortcut="shortcut",e.inputText="input_text",e.collect="collect",e.searchResultPreview="search_result_preview",e.deepSearchMode="deep_search_mode",e}({}),s=function(e){return e.setting="setting",e.addASkill="add_a_skill",e.discoverSkill="discover_skill",e}({}),a=function(e){return e.insert="insert_below",e.replace="replace_selection",e.suggest="suggest",e.share="share",e.summarizeVideo="summarize_video",e.immersionGuideTips="immersion_guide_tips",e.immersionGuideIcon="immersion_guide_icon",e.summarizePodcast="summarize_podcast",e.translatePage="translate_this_page",e.summarizePage="summarize_this_page",e.languageSettings="language_settings",e.displayOriginalText="display_original_text",e.alwaysTranslatePage="always_translate_this_page",e.viewInWeb="view_in_web",e.settings="settings",e.historyChats="history_chats",e.collection="collection",e.allConversation="all_conversation",e.understandContext="understand_context",e.download="download",e.updateLog="update_log",e.highlightSelectionBar="highlight_selection_bar",e.fold="fold",e.expand="expand",e.expanded="expanded",e.collapsed="collapsed",e.regeneration="regeneration",e.formalize="formalize",e.elaborate="elaborate",e.shorten="shorten",e.write="help_me_write",e.rewrite="rewrite",e.changeReplyLang="change_reply_lang",e.hideUntilNext="hide_until_next",e.closeWritingAssistant="close_writing_assistant",e.closeGrammerCheck="close_grammar_check",e.writingLanguage="language_setting",e.btnCopy="copy",e.btnInsert="insert",e.btnReplace="replace",e.dismiss="dismiss",e.understandContextOn="understand_context_on",e.understandContextOff="understand_context_off",e}({}),r=function(e){return e.search="search_related_suggested_prompt",e.select_explain="explain_related_suggested_prompt",e}({}),l=function(e){return e.copy="copy",e.regenerate="click_regenerate",e.continueInChat="continue_in_chat",e.retry="retry",e.enterPage="enter_page",e.generationFailure="generation_failure",e.share="share",e.viewDAU="view_dau",e.activeDAU="active_dau",e.sendMessage="send_message",e.showSelectAssistantMenu="highlight_function_bar_show",e.showSelectAssistantBtn="highlight_function_bar_function_show",e.clickSelectAssistantMenuBtn="highlight_function_bar_click",e.showSelectAssistantResult="highlight_result_show",e.clickSelectAssistantResultBtn="highlight_result_action",e.closeSelectAssistantResult="highlight_result_close",e.showChatAssistant="side_bar_entrance_show",e.showChatAssistantPopover="show_side_bar_popover",e.clickChatAssistantPopover="click_side_bar_popover",e.showChatAssistantPopoverSettings="show_side_bar_settings_popover_button",e.clickChatAssistantPopoverSettings="click_side_bar_settings_popover_button",e.showChatHeaderBtn="show_chat_header_button",e.clickChatHeaderBtn="click_chat_header_button",e.showChatFloatCard="highlight_action_module_sidebarshow",e.clickChatFloatCard="highlight_action_module_sidebarclick",e.showSearchAssistant="search_result_card_show",e.searchResultCardClick="search_result_card_click",e.showSearchAssistantSuggest="show_suggested_prompt",e.showSearchAssistantSuggestQuestion="show_suggested_prompt_single_question",e.clickSearchAssistantSuggest="click_suggested_prompt",e.closeSearchAssistant="search_result_card_disappear",e.showDeepSearchAssistant="search_summarize_result_show",e.showSources="sources_show",e.clickSources="sources_click",e.collapseDeepSearchCard="search_card_collapse",e.showDeepSearchBtn="deep_search_button_show",e.clickDeepSearchBtn="deep_search_button_click",e.showVideoAssistant="video_summarize_module_show",e.clickVideoAssistantSummarizeBtn="video_summarize_module_click",e.showVideoAssistantSummarizeResult="video_summarize_result_show",e.clickVideoAssistantSummarizeResult="video_summarize_result_click",e.showVideoAssistantHighlightsTimeline="highlights_timeline_singleshow",e.clickVideoAssistantHighlightsTimeline="highlights_timeline_singleclick",e.clickVideoImmersion="video_immersion_click",e.showVideoImmersion="video_immersion_show",e.immersionTimeLine="immersion_timeline",e.showVideoImmersionGuideTips="video_immersion_guide_tips_show",e.clickVideoImmersionGuideTips="video_immersion_guide_tips_click",e.showVideoImmersionGuideIcon="video_immersion_guide_icon_show",e.clickVideoImmersionGuideIcon="video_immersion_guide_icon_click",e.clickPodcastAssistantSummarizeBtn="podcast_summarize_module_click",e.showMailEntryButton="mail_entry_button_show",e.clickMailEntryButton="mail_entry_button_click",e.clickInputBar="input_bar_click",e.showMailThreadResult="mail_thread_result_show",e.clickMailThreadResult="mail_thread_result_click",e.insertMailThreadResult="mail_thread_result_insert",e.closeMailThreadResult="mail_thread_result_close",e.quickReplyButtonShow="ai_reply_button_show",e.hoverQuickReplyButton="hover_ai_reply_button",e.showPdfAssistant="pdf_read_show",e.clickReadPdfBtn="pdf_read_click",e.showDisableMenu="disable_menu_show",e.clickDisableMenu="confirm_close_function",e.chooseLanguage="choose_language_result",e.newSkillAdd="new_skill_add",e.skillEditClick="skill_edit_click",e.skillEditDelete="skill_edit_delete",e.skillPopupSave="skill_popup_save",e.skillPopupIconClick="skill_popup_icon_click",e.skillPopupCancel="skill_popup_cancel",e.skillPopupClose="skill_popup_close",e.exampleClick="example_click",e.examplePopupClose="example_popup_close",e.collectionButtonShow="collection_button_show",e.collectionButtonClickSave="collection_button_click_save",e.collectionButtonClickSaveStatus="collection_button_click_save_status",e.writingSettingClick="mail_entry_setting_click",e.writingSkilShow="skill_module_show",e.writingSkillClick="click_suggested_content",e.linkPreviewEntryShow="search_result_preview_icon_show",e.linkPreviewResultShow="search_result_preview_result_show",e.linkPreviewResultClick="search_result_preview_result_click",e.doubaoDownloadPopupShow="doubao_download_popup_show",e.doubaoDownloadPopupClick="doubao_download_popup_click",e.takeNoteShow="take_note_show",e.takeNotePadShow="take_note_pad_show",e.takeNotePadClick="take_note_pad_click",e.takeNoteBtnClick="video_tool_bar_take_note_click",e.takeNoteStatus="take_note_pad_click_status",e}({}),c=function(e){return e.clickSidebar="click_side_bar",e.selectAssistantMenu="highlight_function_bar",e.selectAssistantResult="highlight_result_card",e.searchAssistant="search_result_card",e.videoAssistant="video_page_summarize",e.onboarding="onboarding",e.chatHeader="chat_header",e.disableMenu="close_function",e.other="other",e.default="default",e}({})},93215:(e,t,n)=>{n.d(t,{Bp:()=>d,DM:()=>y,Dp:()=>_,Rr:()=>x,T:()=>b,VM:()=>m,_B:()=>l,aX:()=>v,gy:()=>f,iN:()=>h,ih:()=>c,oR:()=>p,t7:()=>g,x$:()=>u});var i=n(44557),o=n(61540),s=n(54483),a=n(75787),r=n(71905);const l=()=>{(0,o.z8)(s.Ur.showSelectAssistantMenu,{})},c=({button_name:e,show_from:t})=>{(0,o.z8)(s.Ur.showSelectAssistantBtn,{button_name:e,show_from:t})},d=({button_name:e,click_from:t=s.Z5.selectAssistantMenu})=>{(0,o.z8)(s.Ur.clickSelectAssistantMenuBtn,{button_name:e,click_from:t})},u=({before_language:e,after_language:t,button_name:n,message_id:i})=>{(0,o.z8)(s.Ur.showSelectAssistantResult,{before_language:e,after_language:t,button_name:n,message_id:i})},h=({message_id:e,skill_name:t})=>{(0,a.ct)({message_id:e,click_from:s.Z5.selectAssistantResult,skill_name:t})},m=({message_id:e,skill_name:t})=>{(0,a.Zl)({message_id:e,click_from:s.Z5.selectAssistantResult,skill_name:t})},p=({message_id:e,skill_name:t})=>{(0,a.Kp)({message_id:e,click_from:s.Z5.selectAssistantResult,skill_name:t})},g=({message_id:e,skill_name:t})=>{(0,a.hc)({message_id:e,click_from:s.Z5.selectAssistantResult,skill_name:t})},v=({button_name:e,action_name:t,message_id:n})=>{(0,o.z8)(s.Ur.clickSelectAssistantResultBtn,{button_name:e,action_name:t,message_id:n,click_from:s.Z5.selectAssistantResult})},f=e=>{(0,o.z8)(s.Ur.closeSelectAssistantResult,e)},_=({message_id:e})=>{(0,o.z8)(s.Ur.clickSelectAssistantResultBtn,{message_id:e,click_from:s.Z5.selectAssistantResult,action_name:"ask",button_name:"ai_search"})},x=e=>{const{assistantBotId:t}=(0,r.ue)();(0,o.z8)(s.Ur.clickSearchAssistantSuggest,(0,i.A)({bot_id:t,current_page:s.g6.webOther,suggested_type:s.Ld.select_explain,click_from:s.Z5.selectAssistantMenu,button_name:s._h.suggest},e))},y=e=>{const{assistantBotId:t}=(0,r.ue)();(0,o.z8)(s.Ur.showSearchAssistantSuggest,(0,i.A)((0,i.A)({bot_id:t},e),{},{current_page:s.g6.webOther,suggested_type:s.Ld.select_explain}))},b=e=>{const{assistantBotId:t}=(0,r.ue)();(0,o.z8)(s.Ur.showSearchAssistantSuggestQuestion,(0,i.A)((0,i.A)({bot_id:t},e),{},{current_page:s.g6.webOther,suggested_type:s.Ld.select_explain}))}},26263:(e,t,n)=>{n.d(t,{Bq:()=>m,Su:()=>g,jk:()=>p,jv:()=>d});var i=n(16604),o=n(61540),s=n(54483),a=n(99301);let r=function(e){return e.selectAssistant="highlight_result",e.searchAssistant="search_result_card",e.chatAssistant="side_bar_entrance",e.youtubeAssistant="youtube_summarize",e.searchAddons="search-addons",e.linkPreview="link-preview",e}({}),l=function(e){return e.page="disable_page",e.global="disable_all",e.temp="hide_till_next_time",e}({}),c=function(e){return e.drop_down_box="drop_down_box",e}({}),d=function(e){return e.translate_this_page="translate_this_page",e.highlight_result_choose="highlight_result_choose",e.youtube_page_summary="youtube_page_summary",e.settings="settings",e.mail="gmail",e}({});const u=e=>{let t="";switch(e){case a.lf.chatAssistant:t=r.chatAssistant;break;case a.lf.searchAssistant:t=r.searchAssistant;break;case a.lf.selectAssistant:t=r.selectAssistant;break;case a.lf.searchAddons:t=r.searchAddons;break;case a.lf.linkPreview:t=r.linkPreview}return t},h=e=>{let t="";switch(e){case a.iI.temp:t=l.temp;break;case a.iI.page:t=l.page;break;case a.iI.global:t=l.global}return t},m=e=>{(0,o.z8)(s.Ur.showDisableMenu,{enter_method:u(e)})},p=(e,t)=>{(0,o.z8)(s.Ur.clickDisableMenu,{enter_method:u(t),button_name:h(e)})},g=({before_language_result:e,after_language_result:t,scene:n})=>{(0,o.z8)(s.Ur.chooseLanguage,{choose_way:c.drop_down_box,before_language_result:(0,i.wz)(e),after_language_result:(0,i.wz)(t),scene:n})}},99301:(e,t,n)=>{n.d(t,{$2:()=>s,c$:()=>r,cD:()=>a,iI:()=>o,lf:()=>i,th:()=>l});let i=function(e){return e.chatAssistant="sidebarButton",e.searchAssistant="search",e.selectAssistant="quick",e.grammar="grammar",e.inputAssistant="input",e.searchAddons="search-addons",e.videoSummary="videoSummary",e.videoSubtitle="videoSubtitle",e.podcastSummary="podcastSummary",e.linkPreview="linkPreview",e.sidebarFloatCard="sidebarFloatCard",e}({}),o=function(e){return e.temp="temp",e.page="page",e.global="global",e}({}),s=function(e){return e.youtube="youtube",e.chat="chat",e}({}),a=function(e){return e.insert_below="insert_below",e.replace_selection="replace_selection",e}({}),r=function(e){return e.HUOSHAN="huoshan",e.DOUBAO="doubao",e.GPT="gpt",e.GOOGLE="google",e.MICROSOFT="microsoft",e.DEEPL="deepl",e}({}),l=function(e){return e.HUOSHAN="0",e.LLM="1",e.GOOGLE="2",e.MICROSOFT="3",e}({})},9462:(e,t,n)=>{n.d(t,{c$:()=>o.c$,iI:()=>o.iI,lG:()=>i.l,lf:()=>o.lf,th:()=>o.th});var i=n(16897),o=n(99301)},53717:(e,t,n)=>{n.d(t,{E8:()=>s,EY:()=>a,uk:()=>o});var i=n(58735);function o(e=0){return new Promise((t=>setTimeout(t,e)))}function s(){var e;return(null===(e=document.querySelector(i.ly))||void 0===e||null===(e=e.shadowRoot)||void 0===e?void 0:e.querySelector(".cici-popup-container"))||document.body}function a(e){if(!document.head){const e=document.createElement("head");document.documentElement.appendChild(e)}document.head.appendChild(e)}},89739:(e,t,n)=>{n.d(t,{C1:()=>r,FI:()=>o,Jk:()=>h,Ud:()=>g,Vl:()=>m,_E:()=>f,ch:()=>c,eG:()=>v,gH:()=>l,kD:()=>u,lx:()=>d,nD:()=>a,o8:()=>p,sZ:()=>s,zs:()=>_});var i=n(99301);const o="www.doubao.com",s="586864",a="production",r="https://www.doubao.com",l=420,c=10,d="web",u=`https://${o}/samantha`,h=`https://${o}/alice`,m=`https://${o}/chat/collection`,p="ciciai.com",g="doubao.com",v="release_version",f=[{name:"flow_web_ext_sidebar_hide_1",key:i.iI.temp,id:1},{name:"flow_web_ext_sidebar_hide_2",key:i.iI.page,id:2},{name:"flow_web_ext_sidebar_hide_3",key:i.iI.global,id:3}],_={[i.lf.sidebarFloatCard]:{global:"chatFloatCardDisableAll",page:"chatFloatCardDisableHosts"},[i.lf.videoSubtitle]:{global:"videoSubtitleDisableAll",page:"videoSubtitleDisableHosts"},[i.lf.videoSummary]:{global:"videoSummaryDisableAll",page:"videoSummaryDisableHosts"},[i.lf.podcastSummary]:{global:"podcastSummaryDisableAll",page:"podcastSummaryDisableHosts"},[i.lf.chatAssistant]:{global:"sidebarButtonDisabledAll",page:"sidebarButtonDisabledHosts"},[i.lf.searchAssistant]:{global:"searchDisabledAll",page:"searchDisabledHosts"},[i.lf.selectAssistant]:{global:"quickDisabledAll",page:"quickDisabledHosts"},[i.lf.grammar]:{global:"disableGlobalGrammar",page:"disableGrammarHosts"},[i.lf.inputAssistant]:{global:"InputAssistantDisabledAll",page:"InputAssistantDisabledHosts"},[i.lf.searchAddons]:{global:"disableSearchAddonsGlobal",page:"disableSearchAddonsHosts"},[i.lf.linkPreview]:{global:"linkPreviewDisabledAll",page:"linkPreviewDisabledHosts"}}},57650:(e,t,n)=>{n.d(t,{SM:()=>a,V$:()=>r,d:()=>s,u9:()=>o});var i=n(34350);let o=function(e){return e.web="web",e.pdf="pdf",e}({});const s=()=>{const e=document.body.firstElementChild;return{type:"EMBED"===(null==e?void 0:e.nodeName)&&"application/pdf"===(null==e?void 0:e.type)?o.pdf:o.web,url:window.location.href,title:document.title,favicon:(0,i.p2)(window.location.host,window.location.protocol)}},a=(e,t)=>{let n=e.classList.toString();const i=new MutationObserver((i=>{for(const o of i)if("class"===o.attributeName){const i=e.classList.toString();if(i!==n){t(i),n=i;break}}}));return i.observe(e,{attributes:!0}),i},r=(e,t)=>{const n=new MutationObserver(t);return n.observe(e,{attributes:!0}),n}},59292:(e,t,n)=>{n.d(t,{r:()=>a});var i=n(11646),o=n(67697),s=n(4580);function a(e,t="image"){return(0,s.ab)(),new Promise(((n,s)=>{try{const a=i.ozw.getState(),{local_key:r}=a.preprocessFile(e,t);let l;i.ozw.subscribe((e=>e.preprocessTaskMap[r]),(e=>{l&&clearTimeout(l),l=setTimeout((()=>{const e=new Error("collect_tos_process_file_faild");o.vF.persist.error({eventName:"tos process file faild",error:e}),s(e)}),1e4),null!=e&&e.failed?s(new Error("upload file faild")):null!=e&&e.key&&n(e.key)}))}catch(a){console.error("upload image failed",a),s(a)}}))}},4601:(e,t,n)=>{n.d(t,{CU:()=>d,Vv:()=>l,hm:()=>u,n_:()=>r});var i=n(14065),o=n(39275);function s(e){(0,o.cs)({name:"remove-fetch-cross-header",body:e})}let a;function r(e){return new Promise(((t,n)=>{const i=()=>{a=e,(0,o.cs)({name:"add-fetch-cross-header",body:e}).then((({data:i})=>{try{o=i,fetch(e).then((e=>{if(!e.ok)throw new Error("Network response was not ok");e.blob().then((n=>t({blob:n,type:e.headers.get("Content-Type")||"image/jpg"}))).catch(n)})).catch(n).finally((()=>{s(o)}))}catch(a){s(i),n(a)}var o})).catch(n).finally((()=>{a=void 0}))},r=()=>{a?setTimeout((()=>r()),50):i()};r()}))}function l(e,t){const{compressImage:n=!0,maxWidth:i=600,maxHeight:o=600,qulity:s}=t||{};return new Promise(((t,a)=>{r(e).then((({blob:e,type:r})=>{n?function(e,t,n,i="image/jpeg",o){return new Promise(((s,a)=>{const r=new FileReader;r.onload=e=>{var r;const l=new Image;l.onload=()=>{const e=document.createElement("canvas"),r=e.getContext("2d"),d=Math.min(t/l.width,n/l.height);e.width=l.width*d,e.height=l.height*d,null==r||r.drawImage(l,0,0,e.width,e.height),e.toBlob((e=>e&&c(e).then(s).catch(a)),i,o)},l.onerror=a,l.src=(null===(r=e.target)||void 0===r?void 0:r.result)||""},r.onerror=a,r.readAsDataURL(e)}))}(e,i,o,r,s).then(t).catch(a):c(e).then(t).catch(a)})).catch(a)}))}function c(e){return new Promise(((t,n)=>{const i=new FileReader;i.onload=function(e){var n;t((null===(n=e.target)||void 0===n?void 0:n.result)||"")},i.onerror=function(e){n(e)},i.readAsDataURL(e)}))}function d(e){return new Promise(((t,n)=>{try{var i;const n=null===(i=e.getClientRects())||void 0===i?void 0:i[0],o=document.createElement("canvas"),s=o.getContext("2d");o.width=n.width,o.height=n.height,null==s||s.drawImage(e,0,0,n.width,n.height),o.toBlob(t,"image/jpeg",1)}catch(o){n(o)}}))}const u=function(){var e=(0,i.A)((function*(e){const t=yield(0,o.cs)({name:"tos-get-file-url",body:e});return t.success?t.data:{}}));return function(t){return e.apply(this,arguments)}}()},95585:()=>{window.Prism=window.Prism||{},window.Prism.manual=!0},64903:(e,t,n)=>{n.d(t,{q4:()=>_,YA:()=>x,l$:()=>f,Oi:()=>y});var i=n(3400),o=n(5687),s=n(89380),a=n(43714),r=n.n(a),l=n(56411),c=n(81379);function d(e,t=[]){const n=(0,s.A)(e);let i="";for(const o of n){if((0,c.DC)(o))continue;if(!(o instanceof HTMLElement)){i+=o.textContent||"";continue}const e=o.tagName.toLowerCase();if(l.A2.includes(e)){const n=l.hT[e],s={};for(const{key:e,getter:t}of(null==n?void 0:n.attrs)||[]){const n=t?t(o):o.getAttribute(e);n&&(s[e]=n)}t.push({tag:e,originContent:(0,c.UU)(o.textContent||""),attrs:s});const a=t.length-1,{output:r}=d(Array.from(o.childNodes),t);i+=`<b${a}>${r}</b${a}>`;continue}const{output:n}=d(Array.from(o.childNodes),t);i+=n}return{output:(0,c.UU)(i),metaInfo:t}}const u=(e,t=[])=>((0,o.A)(t,((t,n)=>{const{tag:i,originContent:o}=t;if(!l.Jy.includes(i))return;const s=new RegExp(`<\\s*[bB]\\s*${n}\\s*>([\\s\\S]*?)<\\s*/\\s*[bB]\\s*${n}\\s*>`),a=`<b0>${o}</b0>`;e=e.replace(s,a)})),e=(0,i.qP)(e)),h=(e,t=[])=>{(0,o.A)(t,((t,n)=>{const{tag:i,originContent:o}=t,s=new RegExp(`<\\s*[bB]\\s*${n}\\s*>([\\s\\S]*?)<\\s*/\\s*[bB]\\s*${n}\\s*>`),{openTag:a,closeTag:r}=function(e){const{tag:t,attrs:n={}}=e;let i="";for(const[o,s]of Object.entries(n))i+=` ${o}="${s}"`;return["li","ol"].includes(t)?{openTag:`<ul><${t}${i}>`,closeTag:`</${t}></ul>`}:"code"===t?{openTag:"`",closeTag:"`"}:{openTag:`<${t}${i}>`,closeTag:`</${t}>`}}(t),c=l.Jy.includes(i)?`${a}${o}${r}`:`${a}$1${r}`;e=e.replace(s,c)})),e=(e=(0,i.qP)(e)).replaceAll(/\n/g,"<br />");try{return r()(e)}catch(n){return e}};var m=n(22198),p=n(36332),g=n(99824);let v;function f(e){if(e.commonAncestorContainer instanceof Element){(0,m.M)(e.commonAncestorContainer);const t=e.cloneContents(),n=(0,m.u)(Array.from(t.childNodes));v=[];return n.map((e=>d(e,v))).map((e=>e.output)).join("\n")}v=void 0}function _(e){return h(e,v||[])}function x(e){return u(e,v||[])}function y(e){const{encodeText:t,lang:n,translateService:o,contextText:s}=e,a=(0,i.qP)(t);return new Promise((e=>{(0,p._)({text:a,prompt:g.EU.translate,language:n,answerWithSuggest:!1,translateService:o,contextText:s,trackEvent:!1},{onDone(t,n){e(n)}})}))}},3400:(e,t,n)=>{function i(e){const t=e.getAttribute("data-cici-select-uid");if(t){const e=document.querySelector(`[data-cici-select-uid="${t}"]`);if(e)return getComputedStyle(e)}}function o(e){return e.replaceAll(/<\s*\/?\s*[bB]\s*\d+\s*>/g,"")}function s(e){return e.replace(/<\s*\/?\s*[bB]?\s*\d*\s*$/,"")}n.d(t,{D6:()=>i,qP:()=>o,sh:()=>s})},72969:(e,t,n)=>{n.d(t,{GF:()=>A,yI:()=>S,Ws:()=>w,C3:()=>I});var i=n(44557),o=n(29068),s=n(43423);const a=["SCRIPT","STYLE","LINK","IMG","VIDEO","FIGURE","svg"],r=(()=>{let e=null;return()=>(e=e||new TextEncoder,e)})(),l=(e,t)=>r().encode(e).length>t,c=(e="")=>e.replace(/\s+/g," "),d=(e,t,n)=>{let i=e;const o="prev"===t?"previousSibling":"nextSibling";for(;i&&!i[o];)if(i=i.parentNode,null!=n&&n(i))return null;return i?i[o]:null},u=(e,t,n,i,o)=>{if(n>=50||e===t)return!1;let s=e;const r="prev"===i?"lastChild":"firstChild",l="prev"===i?"previousSibling":"nextSibling";for(;s;){let e="";for(;s&&m(s);){const t=h(s);t.replace(/\s+/g,"")&&(e="prev"===i?t+e:e+t),s=s[l]}if(e&&o(e))return!0;if(s){if(!a.some((e=>s.nodeName===e))&&s.childNodes.length){let e=s;for(;e[r];)e=e[r];const t=u(e,s,n+1,i,o);if(t)return t}s=s[l]}}if(e.parentNode!==t){const s=d(e.parentNode,i,(e=>e===t));if(s)return u(s,t,n+1,i,o)}return!1};function h(e){return e.nodeType===Node.TEXT_NODE?e.nodeValue||"":e.nodeType===Node.ELEMENT_NODE&&e.innerText||""}function m(e){if(!e)return!1;switch(e.nodeType){case Node.TEXT_NODE:case Node.COMMENT_NODE:case Node.CDATA_SECTION_NODE:return!0;case Node.ELEMENT_NODE:switch(e.tagName){case"A":case"ABBR":case"B":case"BDI":case"BDO":case"BR":case"CITE":case"CODE":case"DATA":case"DFN":case"EM":case"I":case"KBD":case"MARK":case"Q":case"RP":case"RT":case"RTC":case"RUBY":case"S":case"SAMP":case"SMALL":case"SPAN":case"STRONG":case"SUB":case"SUP":case"TIME":case"U":case"VAR":case"WBR":return!0;default:return!1}}return!1}function p(e,t=800){const n={contextText:"",selectedText:"",start:"",end:""};try{if(!e||e.rangeCount<=0)return n;const i=e.toString();if(!i.trim())return n;const o=e.getRangeAt(0);if(!o)return n;const s=function(e,t){let n=e.startContainer,i="";switch(n.nodeType){case Node.TEXT_NODE:{const{textContent:t}=n;t&&(i=t.slice(0,e.startOffset));break}case Node.COMMENT_NODE:case Node.CDATA_SECTION_NODE:break;default:n=n.childNodes[e.startOffset]}const o=d(n,"prev");return o&&u(o,document.body,0,"prev",(e=>{const n=c(e);return i=`${n}\n${i}`,l(i,t)})),i}(o,t/2).trimStart(),a=function(e,t){let n=e.endContainer,i="";switch(n.nodeType){case Node.TEXT_NODE:{const{textContent:t}=n;t&&(i=t.slice(e.endOffset));break}case Node.COMMENT_NODE:case Node.CDATA_SECTION_NODE:break;default:n=n.childNodes[e.endOffset-1]}const o=d(n,"next");return o&&u(o,document.body,0,"next",(e=>{const n=c(e);return i=`${i}\n${n}`,l(i,t)})),i}(o,t/2).trimEnd();return{contextText:s+i+a,selectedText:i,start:s,end:a}}catch(i){return(0,s.z3)("[selection] context text error: ",i),n}}var g=n(10633);const v=["width","height","max-width","max-height","min-width","min-height","padding-top","padding-bottom","padding-left","padding-right","border","box-sizing","line-height","text-indent","text-align","font-size","font-family","font-weight","font-style","font-variant","letter-spacing","white-space","word-spacing","word-wrap","word-break","position","overflow"],f=class{getStyles(e,t=v){const n=window.getComputedStyle(e),i={};return t.map((t=>{const o=function(e,t=["-","_"]){let n=[],i=0,o=new Set(t);for(;i<e.length;)o.has(e[i])?(n.push(e[i+1].toUpperCase()),i++):n.push(e[i]),i++;return n.join("")}(t),s=n.getPropertyValue(t);if(["width","height"].includes(t)&&"auto"===s){const t=e.getBoundingClientRect();i[o]=`${t[o]}px`}else["max-width","max-height","min-width","min-height"].includes(t)?i[o]=this.convertPercentToPx(e,t,s):i[o]=s})),i}getStyle(e,t){return window.getComputedStyle(e).getPropertyValue(t)}getCssText(e,t=v){const n=window.getComputedStyle(e);return t.map((t=>{const i=n.getPropertyValue(t);if(["width","height"].includes(t)&&"auto"===i){return`${t}: ${e.getBoundingClientRect()[t]}px`}return["max-width","max-height","min-width","min-height"].includes(t)?`${t}: ${this.convertPercentToPx(e,t,i)}`:`${t}: ${i}`})).join(";")}getFontStyles(e){const t=window.getComputedStyle(e);return{fontFamily:t.getPropertyValue("font-family"),fontSize:parseFloat(t.getPropertyValue("font-size")),fontWeight:parseFloat(t.getPropertyValue("font-weight")),lineHeight:parseFloat(t.getPropertyValue("line-height"))}}getContentBox(e){return{width:e.scrollWidth,height:e.scrollHeight}}getScrollbarWidth(e){const t=window.getComputedStyle(e),n=parseFloat(t.getPropertyValue("border-left-width"))||0,i=parseFloat(t.getPropertyValue("border-right-width"))||0;return e.offsetWidth-e.clientWidth-n-i}convertPercentToPx(e,t,n){if(!n.includes("%"))return n;const i=parseFloat(n)/100,o=e.parentElement;if(!o)return"none";let s=window.getComputedStyle(o),a=parseFloat(s.getPropertyValue("width")),r=parseFloat(s.getPropertyValue("height")),l=s.getPropertyValue("box-sizing"),c=parseFloat(s.getPropertyValue("border-width")),d=parseFloat(s.getPropertyValue("padding-left")),u=parseFloat(s.getPropertyValue("padding-right")),h=parseFloat(s.getPropertyValue("padding-top")),m=parseFloat(s.getPropertyValue("padding-bottom")),p=a,g=r;return"border-box"===l&&(p=a-d-u-2*c,g=r-h-m-2*c),t.includes("height")?g*i+"px":p*i+"px"}},_=class{constructor(){if((0,g.A)(this,"nodeId","-aichat-mirrorTextNode"),(0,g.A)(this,"mirrorTextNode",void 0),(0,g.A)(this,"domMeasurement",new f),(0,g.A)(this,"mirrorContainer",void 0),!document)throw new Error("TextareaMeasurement can only be run under DOM environment");this.initMirrorTextarea()}measureText(e,t,n){const i=this.domMeasurement.getStyle(e,"display"),o=this.domMeasurement.getCssText(e);return this.mirrorTextNode.style.cssText=o,"inline"===i&&(this.mirrorTextNode.style.textAlign="initial"),this.mirrorTextNode.innerHTML=t.split("").map((e=>`<span>${e}</span>`)).join(""),this.doMeasureText({element:e,display:i,text:t,index:n})}loadElement(e,t){let n=this.domMeasurement.getStyle(e,"display"),i=parseFloat(this.domMeasurement.getStyle(e,"width"))-this.domMeasurement.getScrollbarWidth(e),o=this.domMeasurement.getCssText(e);return o+=`; height: auto; max-height: none; width: ${i}px; overflow: hidden;`,"inline"===n&&(o+="; text-align: initial"),this.mirrorTextNode.style.cssText=o,this.mirrorTextNode.innerHTML=t.split("").map((e=>`<span>${e}</span>`)).join(""),{measureText:i=>this.doMeasureText({element:e,display:n,text:t,index:i})}}destroy(){this.mirrorContainer.remove()}doMeasureText(e){const{element:t,display:n,index:i,text:o}=e;if(i<0||i>o.length-1)throw new Error(`char indexing(index: ${i})overflowed, allowed range:0 - ${o.length-1}`);let s=this.mirrorTextNode.querySelector(`span:nth-child(${i+1})`),{offsetLeft:a,offsetTop:r,offsetHeight:l,offsetWidth:c}=s,d=0;if("inline"===n){const e=this.mirrorTextNode.querySelector("span:nth-child(1)");e&&(d=e.offsetTop)}let u=r,h=a;if("\n"===o[i]&&i===o.length-1){u+=parseFloat(this.domMeasurement.getStyle(t,"line-height")),h=0}return{left:h,right:h+c,top:u,bottom:u+l,width:c,height:l,deviation:d}}initMirrorTextarea(){const e=document.createElement("div");this.mirrorContainer=e,e.setAttribute("contenteditable","false"),e.id=this.nodeId,e.style.position="absolute",e.style.width="0px",e.style.height="0px",e.style.overflow="hidden",document.body.appendChild(e);const t=e.shadowRoot||e.attachShadow({mode:"open"});if(!this.mirrorTextNode){const e=document.createElement("div");e.className="mirror-text-container",t.appendChild(e),this.mirrorTextNode=e,this.mirrorTextNode.style.display="block"}}},x=new class{getSelectionRect(e){if(!e.collapsed){const t=e.getBoundingClientRect();if(0!==t.width||0!==t.height)return t}const t=e.startContainer;if(t instanceof HTMLElement){const n=t.childNodes[e.startOffset];if(n&&this.isBasicInput(n)){const e=this.getSelectionRectForBasicInputV2(n);return e.left=Math.round(e.left),e.right=Math.round(e.right),e.top=Math.round(e.top),e.bottom=Math.round(e.bottom),e.width=Math.round(e.width),e.height=Math.round(e.height),e}}return null}getSelectedText(e){if(e.commonAncestorContainer.nodeType===Node.TEXT_NODE){const t=r(e.commonAncestorContainer.parentElement);return t.selectable?a(t.whiteSpaceType,e.commonAncestorContainer.textContent.slice(e.startOffset,e.endOffset).trim()):""}if(e.startContainer instanceof HTMLElement){const t=e.startContainer.childNodes[e.startOffset];if(t&&this.isBasicInput(t)){if(!r(t).selectable)return"";const{selectionStart:e,selectionEnd:n}=t;return t.value.slice(e,n).trim()}}let t,n=[],i=!1,o=!1,s=(t,l)=>{t.nodeType===Node.TEXT_NODE?function(t,s){function r(e){return a(s.whiteSpaceType,e)}t===e.startContainer&&(i=!0),i&&t.nodeType===Node.TEXT_NODE&&s.selectable&&(t===e.startContainer&&t===e.endContainer?n.push({content:r(t.textContent.slice(e.startOffset,e.endOffset))}):t===e.startContainer?n.push({content:r(t.textContent.slice(e.startOffset))}):t===e.endContainer?n.push({content:r(t.textContent.slice(0,e.endOffset))}):n.push({content:r(t.textContent)})),t===e.endContainer&&(o=!0)}(t,l):t.nodeType===Node.ELEMENT_NODE&&function(t){if(t===e.startContainer&&(i=!0),t===e.endContainer)return void(o=!0);const a=r(t);a.selectable&&n.push({content:" "});for(const e of t.childNodes)if(s(e,a),o)break;a.selectable&&(function(e,t){return"BR"===e.tagName||!t.display.startsWith("inline")}(t,a.style)?n.push({content:"\n"}):n.push({content:" "}))}(t)};return t=e.commonAncestorContainer instanceof HTMLElement?r(e.commonAncestorContainer):r(e.commonAncestorContainer.parentElement),s(e.commonAncestorContainer,t),n.map((e=>e.content)).join("").trim().split("\n").map((e=>e.trim())).join("\n").replace(/\n\n+/g,"\n\n").replace(/  +/g," ");function a(e,t){return"normal"===e?t.split("\n").map((e=>e.trim())).join(""):"keepNewLine"===e?t.split("\n").map((e=>e.trim())).join("\n"):t}function r(e){const t=getComputedStyle(e);if("SCRIPT"===e.tagName||"STYLE"===e.tagName||"none"===t.userSelect||"0"===t.opacity||"none"===t.display||"hidden"===t.visibility)return{style:t,selectable:!1,whiteSpaceType:"normal"};let n;return n="pre-line"===t.whiteSpace?"keepNewLine":t.whiteSpace.startsWith("pre")||"break-spaces"===t.whiteSpace?"keepNewLineAndSpace":"normal",{style:t,selectable:!0,whiteSpaceType:n}}}isBasicInput(e){return e instanceof HTMLTextAreaElement||e instanceof HTMLInputElement}getSelectionRectForBasicInputV2(e){const t=e.getBoundingClientRect(),n=e.selectionStart,i=e.selectionEnd-1,o=e.scrollTop,s=e.value,a=new _,{measureText:r}=a.loadElement(e,e.value),l=r(n),c=r(i);if(l.top===c.top)return a.destroy(),{left:t.left+l.left,right:t.left+c.left,top:t.top+l.top-o,bottom:t.top+c.bottom,width:c.left-l.left,height:c.bottom-l.top};let d="",u="",h=n,m=n;for(let _=n;_<=i;_++){const e=s[_];"\n"===e||_===i?(u.length>d.length&&(d=u,h=m),u="",m=_+1):u+=e}const p=r(h),g=r(h+d.length);if(p.top!==g.top)return a.destroy(),{left:t.left,right:t.right,top:t.top+l.top-o,bottom:t.top+c.bottom,width:t.width,height:c.bottom-l.top};const v=Math.min(l.left,c.left,p.left,g.left),f=Math.max(l.left,c.left,p.left,g.left);return a.destroy(),{left:t.left+v,right:t.left+f,top:t.top+l.top-o,bottom:t.top+c.bottom,width:f-v,height:c.bottom-l.top}}};var y=n(58735);const b={top:NaN,left:NaN,bottom:NaN,right:NaN,height:NaN,width:NaN,clientBottom:NaN},w=(0,i.A)({text:"",contextText:"",range:null},b),C=e=>{if(!e)return b;if(e.rangeCount<1)return b;const t=e.getRangeAt(0),n=x.getSelectionRect(t),i=t.getBoundingClientRect();if(!n)return null;const o=window.innerHeight-i.bottom,{top:s,left:a,bottom:r,right:l,width:c,height:d}=n;return{top:s,left:a,bottom:r,right:l,width:c,height:d,clientBottom:o}},A=e=>{var t;let n=null,o="",s=b;if(!window.getSelection)return;n=window.getSelection();let a=!1;var r,l,c;null!==(t=n)&&void 0!==t&&null!==(t=t.anchorNode)&&void 0!==t&&t.childNodes&&(a=!(null===(r=Array.prototype.slice.call(null===(c=n)||void 0===c||null===(c=c.anchorNode)||void 0===c?void 0:c.childNodes))||void 0===r||null===(l=r.filter)||void 0===l||!l.call(r,(e=>e.id===y.Yq)).length));o=n?n.toString():"";let d=null;if(n&&n.rangeCount>0&&(d=n.getRangeAt(0).cloneRange()),"close"===e&&!o&&a)return w;if(a)return;if(""!==o.trim()){if(s=C(n),!s)return w;const{contextText:e,selectedText:t,start:o}=p(n);return(0,i.A)({text:t,contextText:e,range:d,anchorOffset:o.length},s)}return w},S=e=>{var t;let n=null,s="",a="",r=b;if(!window.getSelection)return;n=window.getSelection();let l=!1;var c,d,u;null!==(t=n)&&void 0!==t&&null!==(t=t.anchorNode)&&void 0!==t&&t.childNodes&&(l=!(null===(c=Array.prototype.slice.call(null===(u=n)||void 0===u||null===(u=u.anchorNode)||void 0===u?void 0:u.childNodes))||void 0===c||null===(d=c.filter)||void 0===d||!d.call(c,(e=>e.id===y.Yq)).length));if(s=n?n.toString():"","close"===e&&!s&&l)return w;if(l)return;let h=null;n&&n.rangeCount>0&&(h=n.getRangeAt(0).cloneRange()),a=(0,o.Fd)(n);if(""!==s.trim()){var m;if(r=C(n),!r)return w;const e=a.indexOf(s);return(0,i.A)({text:s,anchorOffset:Math.max((null===(m=n)||void 0===m?void 0:m.anchorOffset)||0,e),contextText:a,range:h},r)}return w},I=(e=[])=>{var t;const n=window.getSelection();let i=null==n||null===(t=n.anchorNode)||void 0===t?void 0:t.parentElement;if(i)for(;i;){if(e.some((e=>{var t;return null===(t=i)||void 0===t||null===(t=t.className)||void 0===t?void 0:t.includes(e)})))return!0;i=i.parentElement}return!1}},38855:(e,t,n)=>{n.d(t,{$Z:()=>m,H2:()=>l,ID:()=>r,id:()=>d,o6:()=>h,pQ:()=>u,tY:()=>c});var i=n(44557),o=n(89739),s=n(7323),a=n(71905);function r(e,t={}){return`${e}?${Object.keys(t).reduce(((e,n)=>e=`${e}&${n}=${t[n]}`),"").replace(/^&/,"")}`}function l(e,t={},n){const{isEnableDebug:s,webEnv:l}=(0,a.MI)(),c=(0,i.A)({from:"ext",extId:encodeURIComponent(chrome.runtime.id)},t);return n&&!c.extra&&(c.extra=btoa(JSON.stringify(n))),s&&l&&(c["x-flow-env"]=l),r(`https://${o.FI}${e}`,c)}function c(){const{hostname:e}=window.location;return!!e.startsWith("youtube.com")||e.indexOf(".youtube.com")>0}function d(){const{hostname:e}=window.location;return!!e.startsWith("bilibili.com")||e.indexOf(".bilibili.com")>0}function u(){return c()?"youtube":d()?"bilibili":""}function h(){var e;return null===(e=location.hash)||void 0===e?void 0:e.startsWith(s.RB)}function m(){var e;return null===(e=location.hash)||void 0===e?void 0:e.startsWith(s.pi)}},93207:(e,t,n)=>{n.d(t,{ID:()=>w,jP:()=>g,KH:()=>p,Az:()=>o.Az,c8:()=>I.c,uV:()=>o.uV,gk:()=>m,I0:()=>h,ju:()=>N,CC:()=>E,tE:()=>S,kk:()=>f.kk,fr:()=>f.fr,YV:()=>f.YV,QP:()=>f.QP,JG:()=>f.JG,Bu:()=>f.Bu,vm:()=>v.v,p8:()=>k.p});var i=n(64295),o=n(15841),s=n(44557),a=n(48485),r=n(92431),l=n(98502),c=n(67697),d=n(35841),u=n(99964);const h=(e,t)=>{var n;const i=u.ozw.getState().regenerateMessageMap[e];if(!i){const n=(0,c.XB)({eventName:t});return u.ozw.setState((0,l.jM)((i=>(i.regenerateMessageMap[e]={messageMap:{},reportEvents:{[t]:n}},i)))),n}if(null==i||null===(n=i.reportEvents)||void 0===n||!n[t]){const n=(0,c.XB)({eventName:t});return u.ozw.setState((0,l.jM)((o=>(o.regenerateMessageMap[e].reportEvents=(0,s.A)((0,s.A)({},i.reportEvents),{},{[t]:n}),o)))),n}return i.reportEvents[t]},m=e=>({setRegenMessageInActive:({messageId:t})=>{const{draftMessageMap:{[t]:n},draftRegenerateMessageMap:{messageMap:{[t]:i}={}}={},draftRegenerateMessageMap:o}=e;{var a;const e=null!=i?i:(0,r.A)(n);null==i||null===(a=i.ext)||void 0===a||delete a.regen_active,(null==e?void 0:e.ext)&&(e.ext.regen="1"),o.messageMap=(0,s.A)((0,s.A)({},o.messageMap),{},{[t]:e})}n.ext&&(n.ext.regen="1"),(0,u.Jij)(n)||(n.status=d.q7.InVisible)},setRegenMessageActive:t=>{const{messageId:n}=t,{draftMessageMap:i,draftRegenerateMessageMap:{messageMap:{[n]:o}={}}}=e;o&&(i[n]=(0,s.A)((0,s.A)({},i[n]),(0,r.A)(o)),o.ext&&(o.ext.regen_active="1"))}}),p=(e,t)=>{if(!e||!t.reply_id)return!1;const n=t.reply_id,i=u.ozw.getState(),o=i.messageLinkMap[e],s=(0,u.A4i)({messageMap:i.messageMap[e],localMessageMap:i.localMessageMap[e]}),r=(0,u.rUA)({messageLinks:o,replyId:n,getMessage:s});if(1===(null==r?void 0:r.length))return!0;return(0,a.A)(r,(e=>{const t=s(e);return t&&(0,u.oQq)(t)}))},g=(e,t)=>{var n;if(!e||!t.messageId)return!1;const i=u.ozw.getState(),o=i.messageMap[e][null==t?void 0:t.messageId],s=null!==(n=null==o?void 0:o.reply_id)&&void 0!==n?n:"",a=i.messageMap[e][s];return(Boolean((0,u.UGb)(o))||(0,u.aN2)(a))&&(0,u.pu_)(o)};var v=n(37278),f=(n(13832),n(71135)),_=n(3888),x=n(61577),y=n(28171),b=n(67366);function w(e){const t=u.ozw.getState(),{getCommonSocketParams:n,getCommonHttpParams:i,getCommonHttpHeaders:o,reportEvent:s,config:a,socketClient:r,fetchStream:l,featureConfig:c}=e;try{var d;const e=()=>{var e;null===(e=x.Pv.getSocketAdapter())||void 0===e||null===(e=e.client)||void 0===e||e.removeEventListener(x.QV.open,m)},h=setTimeout((()=>{var n;null!==(n=t.socketStatus)&&void 0!==n&&n.connected?(s.addDurationPoint("ws"),s.success()):(s.error({reason:"ws_failed"}),(0,y.SR)().error("ws_failed")),e()}),5e3),m=()=>{s.addDurationPoint("ws"),s.addDurationPoint("success"),s.success(),e(),clearTimeout(h)},p=new x.xo,g=new x.d9,v=new x.mH;p.init({socketConfig:{launchConfig:a,socketClient:r,getSocketParams:n,consoleSocketPacket:null==c?void 0:c.consoleSocketPacket}}),g.init({httpChunkConfig:{poolSize:3,retryAttempt:5,getCommonHttpParams:i,getCommonHttpHeaders:o,fetchStream:l.client,baseURL:l.baseURL,binaryType:null==c?void 0:c.binaryType,consoleIncrementMessagePacket:null==c?void 0:c.consoleIncrementMessagePacket}}),v.init({httpConfig:a}),(0,b.Ns)({store:u.ozw,adaptor:p}),(0,b.Ns)({store:u.ozw,adaptor:g}),(0,b.Ns)({store:u.ozw,adaptor:v}),x.Pv.registerHttp(v),x.Pv.registerHttpChunk(g),x.Pv.registerSocket(p),null===(d=p.client)||void 0===d||d.addEventListener(x.QV.open,m),g.resumeChunkTask((0,x.Pe)((0,_.A)(x.Rq.getState().chunkTaskMap)))}catch(h){throw(0,b.Cf)(),h}}var C=n(14065),A=n(69232);const S=function(){var e=(0,C.A)((function*(){try{var e,t,n,i;const o=yield A.j.apiService.message.CheckMessageSendRateLimit();u.ozw.getState().updateRateLimitConfig({limitExpired:null!==(e=o.data)&&void 0!==e&&e.limit_time?Date.now()+1e3*(null===(t=o.data)||void 0===t?void 0:t.limit_time):void 0,limitTips:(null===(n=o.data)||void 0===n?void 0:n.limit_tips)||"",isLimited:!(null===(i=o.data)||void 0===i||!i.is_limit)})}catch(o){o instanceof Error&&c.vF.persist.error({message:"get rate limit failed",error:o})}}));return function(){return e.apply(this,arguments)}}();var I=n(60305),k=n(47445),j=(n(67322),n(30728));function E(e){return T.apply(this,arguments)}function T(){return(T=(0,C.A)((function*(e){const t=yield(0,j.y)(e);yield(0,i.O)((0,s.A)({conversationList:t},e))}))).apply(this,arguments)}function N(e,t){const n=u.ozw.getState(),i=n.messageLinkMap[e];if(!i)return[];const o=i.slice(Math.max(0,i.length-t)),s=(0,u.A4i)((0,u.tvN)(n,e));return o.map(s).filter(Boolean)}},44591:(e,t,n)=>{n.d(t,{Oq:()=>x,XG:()=>g,_M:()=>h,dD:()=>p,j_:()=>f,k2:()=>m,tW:()=>v,vN:()=>_});var i=n(44557),o=n(64283),s=n(86167),a=n(53854),r=n(30025),l=n(29581),c=n(27970),d=n(81793),u=n(2814);function h(e,t){const{limit_time:n,limit_tips:i}=t.ext||{};e.updateRateLimitConfig({isLimited:!0,limitExpired:Date.now()+1e3*Number(n)||0,limitTips:i})}function m(e,t){u.B.emit("guest.reachLimit",{conversation_id:t.conversation_id});const{conversation_id:n,local_message_id:i}=t;n&&i&&e.updateMessageList({conversationId:n,immerUpdate:(...e)=>{const[t]=e;(0,r.k)(t,{isLocalMessage:!0,messageId:i}),(0,r.hT)(t)}})}function p(e,t){l.pU.getState().setGuestReachCreateThreadLimit(!0),u.B.emit("guest.reachThreadLimitError");const{conversation_id:n,local_message_id:i}=t;n&&i&&e.updateMessageList({conversationId:n,immerUpdate:(...e)=>{const[t]=e;(0,r.k)(t,{isLocalMessage:!0,messageId:i}),(0,r.hT)(t)}})}function g(e,t){var n;if(!t.conversation_id)return;const i=d.gO.get("chatBotService");if((null==t||null===(n=t.ext)||void 0===n?void 0:n.has_err)===String(o.t.BOT_REVIEWING)){const e=(0,c.Xc)(l.pU.getState(),t.conversation_id);null==i||i.updateBot({id:e,disabled:!0})}else l.pU.getState().fetchUpdateConversationInfo(t.conversation_id)}function v(e,t){const{conversation_id:n,reply_id:i,message_id:o}=t;n&&i&&o&&(0,r.k)(e,{isLocalMessage:!1,messageId:i})}function f(e,t){if(!t.conversation_id)return void s.g.emit(s.P.CONVERSATION_INVALID);const{removeConversationFromLinks:n,removeConversationFromMap:i}=l.pU.getState();n({conversationId:t.conversation_id}),i({conversationId:t.conversation_id}),s.g.emit(s.P.CONVERSATION_INVALID)}function _(e){var t;s.g.emit(s.P.USER_BANNED,null==e||null===(t=e.ext)||void 0===t?void 0:t.err_msg)}function x(e,t){const{conversation_id:n,local_message_id:o}=t;n&&o?e.updateMessageList({conversationId:n,immerUpdate:(...e)=>{const[n]=e,s=n.draftLocalMessageMap[o];s.local=(0,i.A)((0,i.A)({},s.local),{},{status:a.FQ.SafetyError,failed:!0}),s.ext=(0,i.A)((0,i.A)({},s.ext),t.ext),(0,r.hT)(n)}}):console.error("Unexpected: handleImageSafetyError no conversation_id or no local_message_id.")}},40611:(e,t,n)=>{n.d(t,{Dj:()=>h,Gm:()=>_,O2:()=>m,TU:()=>p,dk:()=>v,eT:()=>g,uX:()=>f});var i=n(44557),o=n(3888),s=n(37814),a=n(20177),r=n(70593),l=n(67697),c=n(92882),d=n(53854),u=n(40257);function h(e,t){var n,i;return(null===(n=e.localInfo)||void 0===n?void 0:n.from)!==d.aU.HttpChunk&&(null===(i=t.localInfo)||void 0===i?void 0:i.from)===d.aU.HttpChunk}function m(e,{conversationId:t,replyId:n}){const i=(0,s.A)(e.localMessageMap[t],(e=>(null==e?void 0:e.reply_id)===n));return(0,o.A)(i)}function p(e,{conversationId:t,localMessageId:n}){var i;return null===(i=e.localMessageMap[t])||void 0===i?void 0:i[n]}function g(e){var t;const{conversationType:n,isRegenerate:o,immerUpdateMessage:s,newLocalMessageId:a,conversationId:r,replyId:d,sectionId:h,scene:m,message:p={},timeout:g=0,regenHead:v,localMessageStatus:f,createdFrom:_}=e,[x]=s,y={conversation_id:r,message_id:d,is_regenerate:o,conversation_type:n,scene:m};"ack"===_&&x.draftLocalMessageMap[a]?x.draftMessageReportEventMap[a]=(0,i.A)((0,i.A)({},x.draftMessageReportEventMap[a]),{},{receive_message:(0,l.XB)({eventName:"receive_message",meta:y})}):(x.draftLocalMessageMap[a]=(0,c.xf)({prevMessageId:o?null===(t=(0,c.WZ)(x.draftMessageLinks,(e=>e.regen_head===v&&!e.isLocalMessage)))||void 0===t?void 0:t.messageId:d,localMessageStatus:f,message:(0,i.A)((0,i.A)({},p),{},{conversation_id:r,section_id:h,local_message_id:a,reply_id:d}),failedExpired:Date.now()+(1e3*Number(g)||u.dc),messageLinks:x.draftMessageLinks,isRegenerate:o}),"send-message"!==_&&"replace_temporary_message"!==_&&(x.draftMessageReportEventMap[a]=(0,i.A)((0,i.A)({},x.draftMessageReportEventMap[a]),Object.fromEntries(["receive_message","receive_message_package","receive_total_messages"].map((e=>[e,(0,l.XB)({eventName:e,meta:y})]))))))}function v(e){const{isRegenerate:t,immerUpdateMessage:n,newLocalMessageId:o,regenHead:s,messageKey:r}=e,[l]=n,c=(0,a.A)(l.draftMessageLinks,(e=>e.messageId===o));if(c)c.regen_head=s;else{const e=(0,i.A)({isLocalMessage:!0,messageId:o},r?{messageKey:r}:{});t&&(e.regen_head=s),l.draftMessageLinks.push(e)}}function f(e){const{immerUpdateMessage:t,newLocalMessageId:n,isSearchMessage:o=!1}=e,[s]=t,a=(0,r.A)(s.draftMessageLinks,(e=>e.messageId===n));a&&o&&(s.draftMessageLinks[a]=(0,i.A)((0,i.A)({},s.draftMessageLinks[a]),{},{messageKey:"search_".concat(n)}))}const _=(e,t)=>{var n;return(null===(n=e.userOgfQuota)||void 0===n?void 0:n.nextMessageUseOgf)?(0,i.A)((0,i.A)({},t),{},{llm_model_type:"2"}):t}},27635:(e,t,n)=>{n.d(t,{ZU:()=>K,hJ:()=>w,LM:()=>N,j5:()=>L,Rk:()=>x,ic:()=>R,V5:()=>D,UQ:()=>A,Wy:()=>M,qr:()=>P,JX:()=>y,uj:()=>_,AG:()=>b,KR:()=>$,a1:()=>Z,MH:()=>Y,kA:()=>k,tb:()=>I,on:()=>B,Pm:()=>W,P9:()=>C,ku:()=>V,zQ:()=>G});var i=n(99964),o=n(56642),s=n(69853),a=n(44557),r=n(49392),l=n(72372),c=n(58367),d=n(52216),u=n(11855),h=n(84013),m=n(37156),p=n(29581),g=n(40257);const v=(0,s.B)(((e,t)=>e.messageLinkMap[t]||[])),f=(0,s.B)(((e,t)=>e.messageListStatusMap[t]||{})),_=(0,s.B)(((e,t)=>{const n=f.raw(e,t),i=v.raw(e,t),o=f.raw(e,g.i9),s=v.raw(e,g.i9),a=(0,m.VN)(p.pU.getState(),t);return(null==a?void 0:a.conversation_type)===c.Cr.Coco&&0===i.length?{status:o,messageLinks:s,resolveConversationId:g.i9}:{status:n,messageLinks:i,resolveConversationId:t}})),x=(e,t)=>{const{updateMessageFeedback:n}=i.ozw.getState(),{liked:o,disliked:s,detail:c,remoteFeedbackType:m,localFeedbackType:p}=(0,i.ozw)((n=>{var i,o;const{feedback:s}=null!==(i=(0,h.Tc)(e,{isLocalMessage:!1,messageId:t},n))&&void 0!==i?i:{},r=null===(o=n.messageFeedbackMap[e])||void 0===o?void 0:o[t],c=(0,l.A)((0,a.A)({},r),{feedback_type:s});return{liked:c.feedback_type===d.MW.Like,disliked:c.feedback_type===d.MW.Unlike,detail:c,remoteFeedbackType:s,localFeedbackType:null==r?void 0:r.feedback_type}}));return(0,u.useEffect)((()=>{(0,r.A)(m)||p===m||n({conversationId:e,messageId:t,detail:{feedback_type:m},onlyLocal:!0})}),[m]),{liked:o,disliked:s,detail:c}},y=((0,s.B)(((e,t)=>e.messageMap[t]||{})),(0,s.B)(((e,t)=>e.localMessageMap[t]||{})),(0,s.B)(((e,t,n)=>{var i;if(!n)return;return null===(i=(n.isLocalMessage?e.localMessageMap:e.messageMap)[t])||void 0===i?void 0:i[n.messageId]}))),b=(0,s.B)(((e,t,n)=>{const o=(0,i.A4i)((0,i.tvN)(e,t)),s=[];for(const i of n){const e=o(i);e&&s.push(e)}return s})),w=((0,s.B)(((e,t,n)=>{var i;return n?null===(i=e.localMessageMap[t])||void 0===i?void 0:i[n]:void 0})),(0,s.B)(((e,t,n)=>{var o,s,r;const{regenerateMessageMap:{[t]:l},messageLinkMap:{[t]:c},messageMap:{[t]:d}}=e,u=(0,i.tP$)(e,t,n),h=(()=>{if(null!=u&&u.reply_id&&(0,i.oQq)(u))return(0,i.Jij)(u)?(0,i.rUA)({messageLinks:c,replyId:u.reply_id,getMessage:(0,i.A4i)({localMessageMap:e.localMessageMap[t],messageMap:e.messageMap[t]})}):n.regen_head?null==c?void 0:c.filter((e=>e.regen_head===n.regen_head||e.messageId===n.regen_head)).map((e=>(0,a.A)((0,a.A)({},e),{},{regen_head:e.regen_head||e.messageId}))):void 0})(),m=null===(o=[n,...null!=h?h:[]].map((e=>e.messageId in d?d[e.messageId]:null)).find((e=>null==e?void 0:e.reply_id)))||void 0===o?void 0:o.reply_id;return{activeRegenerateMessage:null!=h&&h.length?null==l||null===(s=l.messageMap)||void 0===s?void 0:s[n.messageId]:void 0,regenerateActiveIndex:null==h?void 0:h.findIndex((({messageId:e})=>e===n.messageId)),isRegenerateHead:Boolean(n.regen_head&&n.messageId),isRegenerateTail:Boolean(n.regen_head&&(null==h||null===(r=h[h.length-1])||void 0===r?void 0:r.messageId)===n.messageId),regenerateMessageLinks:h,replyFromMessage:m&&d[m]||void 0}}))),C=(0,s.B)(((e,t,n)=>{const i=e.suggestMessageMap[t];return(null==i?void 0:i.replyId)===n?i:void 0})),A=e=>(0,p.pU)((t=>t.lastSectionIdMap[e]),o.x);(0,s.B)(((e,t)=>e.lastMessageMap[t])),(0,s.B)(((e,t)=>(e.messageLinkMap[t]||[]).filter((e=>e.isLocalMessage)).map((e=>(0,h.Tc)(null!=t?t:"",e))).some((e=>!(0,i.oSs)(e)))));var S=n(67697);const I=({sendMessage:e,messageLink:t,conversationId:n})=>()=>{const i=(0,S.XB)({eventName:"retry_send_message",meta:{conversation_id:n,message_id:null==t?void 0:t.messageId,is_local_message:null==t?void 0:t.isLocalMessage}});try{e({scene:"resend",resend:{messageLink:t}}),i.successIfIdle(3e3)}catch(o){i.error({reason:"send message happen error, retry failed"})}},k=({sendMessage:e,messageLink:t,conversationId:n})=>()=>{const i=(0,h.Tc)(n,t),o=(0,S.XB)({eventName:"retry_receive_message",meta:{conversation_id:n,reply_id:null==i?void 0:i.reply_id,message_id:null==i?void 0:i.message_id}}),{reply_id:s}=i||{};if(!s)return void o.error({reason:"reply_id is null, retry failed"});const a={isLocalMessage:!1,messageId:s},r=(0,h.Tc)(n,a);try{e({replace:{messageLink:a},scene:"resend"}),o.successIfIdle(3e3)}catch(l){o.error({reason:"send message happen error, retry failed",error:l,meta:{content_type:null==r?void 0:r.content_type,is_local_message:null==a?void 0:a.isLocalMessage}})}};var j=n(3888),E=n(90321),T=n(70119);n(47519);const N=e=>(0,p.pU)((t=>(0,m.VN)(t,e)),o.x),M=e=>(0,p.pU)((t=>(0,m.Gl)(t,e)),o.x),R=e=>(0,i.ozw)((t=>{if((0,E.A)(t.messageMap,e)){const n=t.messageMap[e];return!!(0,j.A)(n).every((e=>(0,i.RRO)(e)))}return!0}),o.x),L=e=>{const{setActiveConversation:t}=p.pU.getState();(0,u.useEffect)((()=>{t(e)}),[e])},P=()=>(0,p.pU)(m.mV,o.x),B=()=>(0,p.pU)((e=>e.samanthaBot)),D=(e,t)=>{var n;const i=null!==(n=N(e))&&void 0!==n?n:{};return(0,T.gm)(i,t)};var F=n(14065),U=n(33451),H=n(69232),z=n(81793);const O=["getUploadAuthToken"],q=e=>{let{getUploadAuthToken:t}=e,n=(0,U.A)(e,O);const i=(0,u.useRef)();return(0,F.A)((function*(){if(!i.current||(()=>{if(!i.current)return!0;const{auth:{expired_time:e,current_time:t}={}}=i.current;return!e||!t||new Date(e).getTime()<new Date(t).getTime()})()){const{data:e={}}=yield t(n);i.current=e}return i.current}))},V=({data_type:e})=>{const t=q({scene:"bot_chat",data_type:e,getUploadAuthToken:H.j.apiService.resource.GetUploadAuthToken.bind(H.j.apiService)});return{getUploader:function(){var n=(0,F.A)((function*(){var n;const i=yield t(),o=z.gO.get("chatConfigService");if(!o)return;return yield o.createUploader((0,a.A)((0,a.A)({},"image"===e?{imageConfig:i}:{fileConfig:i}),{},{userId:null!==(n=o.userId)&&void 0!==n?n:"",appId:o.appId}))}));return function(){return n.apply(this,arguments)}}()}},$=e=>{var t;const[n,o]=(0,u.useState)(null===(t=i.ozw.persist)||void 0===t?void 0:t.hasHydrated);return(0,u.useEffect)((()=>{const t=i.ozw.persist.onHydrate((()=>o(!1))),n=i.ozw.persist.onFinishHydration((()=>{o(!0),null==e||e()}));return o(i.ozw.persist.hasHydrated()),i.ozw.persist.hasHydrated()&&(null==e||e()),()=>{t(),n()}}),[]),n},K=()=>i.ozw.persist.hasHydrated()?Promise.resolve():new Promise((e=>{i.ozw.persist.onFinishHydration((()=>{e()}))})),W=()=>(0,i.ozw)((e=>{var t;return null===(t=e.userInfo)||void 0===t?void 0:t.secUserId})),G=()=>(0,i.ozw)((e=>{var t;return null===(t=e.userInfo)||void 0===t?void 0:t.userNickName})),Z=()=>(0,i.ozw)((e=>e.userOgfQuota),o.x),Y=()=>(0,i.ozw)((e=>e.userOgf),o.x)},67376:(e,t,n)=>{n.d(t,{Aj:()=>o.A,BF:()=>r.BF,EM:()=>s.EM,FQ:()=>r.FQ,I6:()=>a.I,WR:()=>r.WR,aU:()=>r.aU,hT:()=>i.hT,k:()=>i.k,pl:()=>l.p,u1:()=>s.u1});var i=n(30025),o=n(80882),s=n(8803),a=n(82300),r=n(17458),l=n(27463)},92395:(e,t,n)=>{n.d(t,{YJ:()=>d,Zw:()=>h,bR:()=>o,mf:()=>u,qQ:()=>l,qo:()=>r,tP:()=>a,vW:()=>c});var i=n(92882);const o=(e,t)=>{const n=e.messageLinkMap[t]?s(e,t,e.messageLinkMap[t]):void 0;return{lastAvailableMessage:n?a(e,t,n):void 0,lastAvailableMessageLink:n}},s=(e,t,n)=>{for(let o=n.length-1;o>=0;o--){const s=n[o],r=n[o-1],l=a(e,t,s),c=a(e,t,r);if((0,i.i8)(l)&&(0,i.i8)(c))return(0,i.hd)(l)?r:s;if((0,i.$4)(l))return s}},a=(e,t,n)=>(0,i.A4)((0,i.tv)(e,t))(n),r=(e,t)=>{const{message:n}=l(e,t,e.messageLinkMap[t],(({messageLink:e})=>e.isLocalMessage&&!!e.messageId));return n&&(0,i.xX)(n)?n:void 0},l=(e,t,n,o)=>{const s=(0,i.A4)((0,i.tv)(e,t)),a=(0,i.WZ)(n||[],(e=>o({messageLink:e,getMessage:()=>s(e)})));return{messageLink:a,message:a?s(a):void 0}},c=(e,{conversationId:t,replyId:n})=>{const o=(0,i.ci)({messageLinks:e.messageLinkMap[t],replyId:n,getMessage:(0,i.A4)((0,i.tv)(e,t))});return o?a(e,t,o):void 0},d=(e,t,n)=>{var i;return(null===(i=e.localMessageMap[t])||void 0===i?void 0:i[n])||{}},u=(e,t)=>e.preprocessTaskMap[t].key,h=(e,t,n)=>{const i=e.messageMap[t],o=i[n];if(!o)return[];const s=!o.reply_id||"0"===o.reply_id?n:o.reply_id,a=i[null!=s?s:""],r=Object.keys(i).filter((e=>{var t;return(null===(t=i[e])||void 0===t?void 0:t.reply_id)===s})).map((e=>Number(i[e].index)));return[...a?[Number(a.index)]:[],...r]}},17411:(e,t,n)=>{n.d(t,{k:()=>l});var i=n(21511),o=n(76779),s=n(16350),a=n(45498),r=n(40257);const l=(0,a.vt)()(((e,t)=>({scene:void 0,isSelectMode:!1,messageIndexList:[],preShareId:"",preMessageIndexList:[],enterSelectMode:({scene:n,data:i,conversationMessageIndex:s})=>{var a,r;t().isSelectMode&&n===t().scene||e({scene:n,isSelectMode:!0,messageIndexList:Number(s)>0?(0,o.A)(1,Number(s)+1):[],preShareId:null!==(a=null==i?void 0:i.share_id)&&void 0!==a?a:"",preMessageIndexList:2===(null==i?void 0:i.share_status)&&null!==(r=null==i?void 0:i.message_index_list)&&void 0!==r?r:[]})},exitSelectMode:()=>{t().isSelectMode&&e({scene:void 0,isSelectMode:!1,messageIndexList:[],preShareId:"",preMessageIndexList:[]})},toggleMessage:(n,o)=>{const a=t().messageIndexList,l=a.includes(n),[c,...d]=o;if(l)return!(n===c)&&d.filter((e=>a.includes(e))).length>1?void e({messageIndexList:(0,s.A)(a,n)}):void e({messageIndexList:(0,s.A)(a,...o)});a.length>=r.fV||(a.length+o.length>r.fV?e({messageIndexList:[...a,n].sort()}):e({messageIndexList:(0,i.A)([...a,...o]).sort()}))},selectAll:t=>{e({messageIndexList:(0,o.A)(1,t+1)})},deselectAll:()=>{e({messageIndexList:[]})},getIsSelectAllChecked:e=>t().messageIndexList.length>=e})))},11631:(e,t,n)=>{n.d(t,{k:()=>i});let i=function(e){return e.Share="Share",e.Collection="Collection",e}({})},26334:(e,t,n)=>{n.d(t,{A4:()=>d,AC:()=>v,Kj:()=>l,Ww:()=>g,i0:()=>p,kI:()=>m,rJ:()=>h,tv:()=>c,uT:()=>r,um:()=>u});var i=n(28159),o=n(35841),s=n(776),a=n(17458);const r=({messageLinks:e,getMessage:t,range:n})=>{var i;const o=Number(null===(i=t(e[0]))||void 0===i?void 0:i.index)||0;return{hasMore:o>n.start,lastCursor:o,loading:!1}},l=({messageLinks:e,getMessage:t,size:n})=>{if(Array.isArray(e)&&e.length>0){var i;const o=Number(null===(i=t(e[0]))||void 0===i?void 0:i.index)||0,s=e.length>=n;return{hasMore:o>1&&s,lastCursor:o,loading:!1}}return{hasMore:!1,lastCursor:0,loading:!1}},c=(e,t)=>({messageMap:e.messageMap[t],localMessageMap:e.localMessageMap[t],messageLinks:e.messageLinkMap[t],messageListStatus:e.messageListStatusMap[t]}),d=e=>t=>{var n,i;if(!t)return;const{isLocalMessage:o,messageId:s}=t;return o?null===(n=e.localMessageMap)||void 0===n?void 0:n[s]:null===(i=e.messageMap)||void 0===i?void 0:i[s]},u=e=>`replyTo${e}`,h=e=>e?(0,s.Ji)(e)?"pic":(0,s.ze)(e)?"video":(0,s.dz)(e)?"music":(0,s.ml)(e)?"file":(0,s._n)(e)?"search_card":(0,s.TQ)(e)?"lyrics_to_song_lyric":(0,s.lT)(e)||(0,s.A9)(e)?"lyrics_to_song_music":"text":"text",m=e=>{if(e&&(0,s.pu)(e)){const{text:t}=e.contentObj||{};return(0,i.A)(t)?t.length:0}return 0},p=e=>{if(e&&(0,s.pu)(e)){const{text:t}=e.contentObj||{};return(0,i.A)(t)&&t.includes("coco://sendMessage")?1:0}return 0};function g(e){const{ConnectionType:t}=o;return e.next_connection_type===t.WebSocket?a.aU.Socket:e.next_connection_type===t.HttpChunk?a.aU.HttpChunk:null===(n=e.localInfo)||void 0===n?void 0:n.from;var n}function v(e){var t,n,i,o,s,a,r;return{conversation_id:e.conversation_id,message_id:e.message_id,from:null===(t=e.localInfo)||void 0===t?void 0:t.from,local_message_id:null==e?void 0:e.local_message_id,is_regenerate:"local"in e&&(null==e||null===(n=e.local)||void 0===n?void 0:n.isRegenerate),has_err:null==e||null===(i=e.ext)||void 0===i?void 0:i.has_err,log_id:null===(o=e.localInfo)||void 0===o?void 0:o.logId,inner_log_id:null==e||null===(s=e.ext)||void 0===s?void 0:s.log_id,trace_id:null===(a=e.localInfo)||void 0===a?void 0:a.traceId,retried:null==e||null===(r=e.localInfo)||void 0===r?void 0:r.retried,next_connection_type:null==e?void 0:e.next_connection_type}}},19767:(e,t,n)=>{n.d(t,{D6:()=>l,P5:()=>r,YF:()=>c,oM:()=>a});var i=n(28159),o=n(2633),s=n(776);const a=e=>{if(e&&(0,s.pu)(e)){var t,n;if((0,i.A)(null==e||null===(t=e.contentObj)||void 0===t?void 0:t.text))return null==e||null===(n=e.contentObj)||void 0===n?void 0:n.text;if((0,i.A)(e.tts_content)&&e.tts_content&&!(0,s.RR)(e))return e.tts_content}},r=(e,t,n)=>{if(!e)return;const r=a(e);return(0,i.A)(r)?r:(0,s.HN)(e)||(0,s.Ji)(e)?void 0:t?(0,o.A)(null==e?void 0:e.contentObj)?`${n} message.content\uff1a${null==e?void 0:e.content}`:`${n} message.content\uff1a\n\n\`\`\`json\n${JSON.stringify(null==e?void 0:e.contentObj,void 0,2)}\n\`\`\`\n\n`:n},l=e=>{const t=null==e?void 0:e.match(/\[(\S*?)\](?=\(coco:\/\/sendMessage)/g);return null!=t&&t.length?t.map((e=>e.split(/[\[\]]/).join(""))):[]},c=e=>{var t;return(0,s.TQ)(e)&&(null==e||null===(t=e.contentObj)||void 0===t?void 0:t.text)||""}},29084:(e,t,n)=>{n.d(t,{EO:()=>i.E,z9:()=>s});var i=n(21711),o=(n(75741),n(14065));n(69232),n(99964),n(67697);function s(){return a.apply(this,arguments)}function a(){return(a=(0,o.A)((function*(){}))).apply(this,arguments)}},65007:(e,t,n)=>{n.d(t,{d:()=>d});var i=n(10633),o=n(60588),s=n(72077),a=n(79223),r=n(44509),l=n(33379),c=n(40316);class d extends o.A{constructor(){super(),(0,i.A)(this,"_workerMap",new Map),(0,i.A)(this,"_poolSize",1),(0,i.A)(this,"_queue",[]),(0,i.A)(this,"_maxRetryAttempt",3),(0,i.A)(this,"_hasInitiated",!1),(0,i.A)(this,"_fetchStream",void 0),(0,i.A)(this,"_baseURL",void 0),(0,i.A)(this,"_binaryType","pb"),(0,i.A)(this,"_getCommonHttpParams",void 0),(0,i.A)(this,"_getCommonHttpHeaders",void 0),(0,i.A)(this,"_consoleIncrementMessagePacket",!1),(0,i.A)(this,"from",c.a.HttpChunk),this._handleEvent=this._handleEvent.bind(this),this._handleFinish=this._handleFinish.bind(this),this._handleClean=this._handleClean.bind(this),this._handleUpdateTask=this._handleUpdateTask.bind(this)}_initWorker(){const e=new s.O({maxRetryAttempts:this._maxRetryAttempt,fetchStream:this._fetchStream,getCommonHttpParams:this._getCommonHttpParams,getCommonHttpHeaders:this._getCommonHttpHeaders,baseURL:this._baseURL,binaryType:this._binaryType,consoleIncrementMessagePacket:this._consoleIncrementMessagePacket});return e.on("event",this._handleEvent),e.on("finish",this._handleFinish),e.on("clean",this._handleClean),e.on("update_task",this._handleUpdateTask),this._workerMap.set(e.id,e),e}_handleUpdateTask(e,t){var n;null===l.Rq||void 0===l.Rq||null===(n=l.Rq.getState())||void 0===n||n.updateChunkTask(e,t)}_handleClean(e){var t;null===l.Rq||void 0===l.Rq||null===(t=l.Rq.getState())||void 0===t||t.removeChunkTask(e)}_handleFinish(e){const t=this._workerMap.get(e);if((null==t?void 0:t.status)===a.T.idle){const e=this._queue.pop();e&&(null==t||t.startTask(e))}}_handleEvent(e){(0,r.g)({event:e,adaptor:this})}_checkMessageInWorking(e){for(const t of this._workerMap.values())if(t.replyId===e)return!0;for(const t of this._queue)if(t.replyId===e)return!0;return!1}init(e){var t,n,i,o,s,a,r,l;this._hasInitiated||(this._poolSize=(null===(t=e.httpChunkConfig)||void 0===t?void 0:t.poolSize)||1,this._maxRetryAttempt=(null===(n=e.httpChunkConfig)||void 0===n?void 0:n.retryAttempt)||3,this._getCommonHttpParams=null===(i=e.httpChunkConfig)||void 0===i?void 0:i.getCommonHttpParams,this._getCommonHttpHeaders=null===(o=e.httpChunkConfig)||void 0===o?void 0:o.getCommonHttpHeaders,this._fetchStream=null===(s=e.httpChunkConfig)||void 0===s?void 0:s.fetchStream,this._baseURL=null===(a=e.httpChunkConfig)||void 0===a?void 0:a.baseURL,this._binaryType=(null===(r=e.httpChunkConfig)||void 0===r?void 0:r.binaryType)||"pb",this._consoleIncrementMessagePacket=(null===(l=e.httpChunkConfig)||void 0===l?void 0:l.consoleIncrementMessagePacket)||!1,this._hasInitiated=!0)}resumeChunkTask(e){e.forEach((e=>{const{replyId:t}=e;t&&!this._checkMessageInWorking(t)&&e&&this._pullMessage(e)}))}pullMessage(e){var t;const{reply_id:n}=e;if(!n||this._checkMessageInWorking(n))return;const i=null===l.Rq||void 0===l.Rq||null===(t=l.Rq.getState())||void 0===t?void 0:t.createChunkTask(n,e);i&&this._pullMessage(i)}_pullMessage(e){for(const t of this._workerMap.values())if(t.status===a.T.idle)return void t.startTask(e);if(this._workerMap.size<this._poolSize){this._initWorker().startTask(e)}else this._queue.push(e)}abortMessage({replyId:e}){const t=this._queue.findIndex((t=>t.replyId===e));if(~t)return this._queue.splice(t,1),void this._handleClean(e);for(const n of this._workerMap.values())n.replyId===e&&n.abort()}drop(){this._hasInitiated=!1}}},32894:(e,t,n)=>{n.d(t,{m:()=>x});var i=n(44557),o=n(10633),s=n(53719),a=n(37462),r=n(60588),l=n(67697),c=n(44644),d=n(64080),u=n(69232),h=n(35841),m=n(3896),p=n(44509),g=n(40257),v=n(31021),f=n(21328),_=n(40316);class x extends r.A{constructor(){super(),(0,o.A)(this,"from",_.a.HttpLongPolling),(0,o.A)(this,"_config",void 0),(0,o.A)(this,"_pullMessageTasks",{}),(0,o.A)(this,"_hasInitiated",!1),this._handleEvent=this._handleEvent.bind(this)}_handleEvent(e,t){if(e.event_type===d.B.Message&&e.message){const n=(0,f.H)(e.message,{from:this.from,retried:!0,logId:t});e.message=n}if(e.event_type===d.B.Message&&e.message_list){const n=e.message_list.map(((e,n,i)=>(0,f.H)(e,{from:this.from,retried:!0,logId:t,messageListCount:i.length,inMessageListPos:n})));e.message_list=n}(0,p.g)({event:e,adaptor:this})}init(e){this._hasInitiated||(this._config=null==e?void 0:e.httpConfig,this._hasInitiated=!0)}sendMessage(e){var t;if(e.length<=0)return;const n=1===e.length?{message:e[0]}:{message_list:e},o=(0,i.A)((0,i.A)({},n),{},{event_type:d.B.Message});u.j.apiService.message.MessageReplay({payload:m.K.enc((new TextEncoder).encode((0,c.e4x)(o)))},{overrideParams:{aid:null===(t=this._config)||void 0===t?void 0:t.ws_app_id},overrideConfig:{timeout:g.Sf}}).then((e=>{if(!e.payload)throw new Error("Invalid ack message");const t=m.K.dec(e.payload);this._handleEvent((0,c.OlY)(c.Asr.read(t,0,t.byteLength)),(0,v.n)(e))})).catch((e=>{l.vF.info(`get ack message failed: ${e.message}`)}))}_fetchMessage(e){u.j.apiService.message.GetMessageReply({message_id:e.reply_id||e.message_id,conversation_id:e.conversation_id},{overrideConfig:{timeout:g.EB}}).then((t=>{var n;if(this._pullMessage(e,g.MV),null===(n=t.data)||void 0===n||null===(n=n.message_list)||void 0===n||!n.length)throw new Error("message_list is empty");const o=t.data.message_list.filter((e=>!(0,f.yU)(e)));o.sort(((e,t)=>(Number(e.index)||0)-(Number(t.index)||0))),o.forEach((e=>{var n,o;(this._handleEvent({message:e,event_type:d.B.Message},(0,v.n)(t)),null!=e&&null!==(n=e.ext)&&void 0!==n&&n.sp)&&this._handleEvent({message:(0,i.A)((0,i.A)({},(0,s.A)(e,["conversation_id","section_id","message_id","reply_id","message_type"])),{},{content_type:h.cM.Suggest,content:(0,c.e4x)({suggest:(0,c.OlY)(null==e||null===(o=e.ext)||void 0===o?void 0:o.sp)||""}),ext:{},meta_infos:[]}),event_type:d.B.Message},(0,v.n)(t))}))})).catch((t=>{this._pullMessage(e,g.MV),l.vF.info(`get message reply failed: ${t.message}`)}))}_pullMessage(e,t){var n;const{reply_id:i}=e;if(!i||"0"===i)return void l.vF.info("reply_id is empty, skip pull message");if(!this._pullMessageTasks[i])return void l.vF.info("task is empty, skip pull message");if(Date.now()-this._pullMessageTasks[i].expired>0)return;null===(n=this._pullMessageTasks[i])||void 0===n||n.clear();const o=setTimeout((()=>{this._fetchMessage(e)}),t),s=()=>{clearTimeout(o)};this._pullMessageTasks[i].clear=s,this._pullMessageTasks[i].finish=()=>{s(),delete this._pullMessageTasks[i]}}pullMessage(e,t){const{reply_id:n}=e;n&&"0"!==n&&(this._pullMessageTasks[n]?this._pullMessageTasks[n].clear():this._pullMessageTasks[n]={reply_id:n,finish:a.A,clear:a.A,expired:Date.now()+g.dc},this._pullMessage(e,t))}abortMessage(e){var t;null===(t=this._pullMessageTasks[e.replyId])||void 0===t||t.finish()}drop(){this._hasInitiated=!1}}},15681:(e,t,n)=>{n.d(t,{x:()=>u});var i=n(44557),o=n(10633),s=n(60588),a=n(44644),r=n(64080),l=n(21328),c=n(44509),d=n(40316);class u extends s.A{constructor(){super(),(0,o.A)(this,"client",void 0),(0,o.A)(this,"from",d.a.Socket),(0,o.A)(this,"_hasInitiated",!1),this._handleEvent=this._handleEvent.bind(this)}_handleEvent({event:e,traceId:t}){if(e.event_type===r.B.Message&&e.message){const n=(0,l.H)(e.message,{from:this.from,traceId:t});e.message=n}if(e.event_type===r.B.Message&&e.message_list){const n=e.message_list.map(((e,n,i)=>(0,l.H)(e,{from:this.from,traceId:t,messageListCount:i.length,inMessageListPos:n})));e.message_list=n}(0,c.g)({event:e,adaptor:this})}_onSocketChange(e){this.emit("socket_change",e)}_onRefreshSocketConfig(){return new Promise((e=>{this.emit("refresh_socket_config"),this.once("on_refresh_socket_config",(t=>{e(t)}))}))}init(e){if(this._hasInitiated)return;const{socketConfig:t}=e;if(!t)throw new Error("Invalid socket config, socket config is required");const{socketClient:n,launchConfig:i,getSocketParams:o,consoleSocketPacket:s}=t;this.client=n,this.client.init({onSocketStatusChange:this._onSocketChange.bind(this),config:i,onMessage:this._handleEvent,refreshSocketConfig:this._onRefreshSocketConfig.bind(this),getSocketParams:o,consoleSocketPacket:s||!1}),this._hasInitiated=!0}sendMessage(e){var t;if(e.length<=0)return;const n=1===e.length?{message:e[0]}:{message_list:e};null===(t=this.client)||void 0===t||t.send((0,a.e4x)((0,i.A)((0,i.A)({},n),{},{event_type:r.B.Message})))}drop(){var e;this._hasInitiated=!1,null===(e=this.client)||void 0===e||e.drop()}}},91743:(e,t,n)=>{n.d(t,{Pe:()=>o.P,up:()=>i.up});var i=n(72083),o=(n(73492),n(98116),n(70574))},63623:(e,t,n)=>{n.d(t,{i:()=>i});const i=(e,t)=>{const n=Number(e),i=Math.floor(n/3600),o=Math.floor(n%3600/60),s=Math.floor(n%3600%60),a=o<10?`0${o}`:o,r=s<10?`0${s}`:s;return 0!==i||t?`${i<10?`0${i}`:i}:${a}:${r}`:`${a}:${r}`}},45208:(e,t,n)=>{n.d(t,{U:()=>s,Y:()=>o});var i=n(11855);const o=(0,i.createContext)(null);function s(e){const{allowNull:t=!1}=e||{},n=(0,i.useContext)(o);if(!t&&!n)throw new Error("expect logger in LoggerContext but not found");return n}},24724:(e,t,n)=>{n.r(t),n.d(t,{MathJaxTex:()=>C,default:()=>A});var i=n(11855),o=n(24489),s=n.n(o),a=n(86843),r=n(1862),l=n(56912),c=n(60669),d=n(51128),u=n(68767),h=n(29019),m=n.n(h),p=n(48300),g=n(79254),v=n(63159);let f,_=e=>e;const x=(0,u.liteAdaptor)();(0,d.J)(x);const y=new c.TeX({packages:[...l.B.sort().join(", ").split(/\s*,\s*/),"physics","mhchem"],macros:{equalparallel:"{\\lower{2.6pt}{\\arrowvert\\hspace{-4.2pt}\\arrowvert}\\above{-2pt}\\raise{7.5pt}{=}}",number:["{#1}",1],unit:["{#1}",1],div:"{\xf7}"}}),b=new a.SVG({fontCache:"none"}),w=r.mathjax.document("",{InputJax:y,OutputJax:b}),C=({tex:e,mode:t,className:n,style:o})=>{const a=(0,i.useMemo)((()=>{var t;const n=s().replace(e,s()(String.raw(f||(f=_`[^\P{C}\n\t]+`)),"ug"),""),i=w.convert(n,{display:!0,em:16,ex:8,containerWidth:1280});return x.outerHTML(null==i||null===(t=i.children)||void 0===t?void 0:t[0])}),[e]);return(0,p.F)(a).includes("data-mjx-error")?(0,v.jsx)("span",{className:m()(g.A["math-error"],n),style:o,children:e}):(0,v.jsx)("span",{className:m()("math-inline",n),style:o,dangerouslySetInnerHTML:{__html:(0,p.F)(a)}})},A=C},85908:(e,t,n)=>{n.r(t),n.d(t,{PrismCodeBlockHighlighter:()=>c,default:()=>d});n(11855);var i=n(29019),o=n.n(i),s=n(33505),a=n(73571),r=n(48300),l=(n(29017),n(63159));const c=({code:e,language:t="",className:n,style:i})=>{const c=(0,s.W)(e,t);return(0,l.jsx)("pre",{className:o()(t&&`language-${t}`,a.A["light-scrollbar"],n),style:i,children:(0,l.jsx)("code",{dangerouslySetInnerHTML:{__html:(0,r.F)(c)}})})},d=c},12437:(e,t,n)=>{n.d(t,{B94:()=>sm,Dkt:()=>hd,GOG:()=>lh,GpS:()=>Cd,HXh:()=>Mh,RNZ:()=>mm,abE:()=>wh,bed:()=>qr,ebl:()=>Wc,k4K:()=>Fl,lUW:()=>um,nK3:()=>Sv,sPs:()=>_l,sXP:()=>Ih,sxB:()=>th,vWE:()=>Yr,vlM:()=>Wr,wJ:()=>Vr});n(11855);var i=n(80157),o=n(20763),s=n(17652),a=n(32434),r=n(70061),l=n(27252),c=n(72414),d=n(27569),u=n(73694),h=n(21930),m=n(44397),p=n(76229),g=n(34814),v=n(39957),f=n(30107),_=n(69526),x=n(85890),y=n(29140),b=n(12071),w=n(20972),C=n(74995),A=n(10426),S=n(34400),I=n(62039),k=n(5485),j=n(95137),E=n(29214),T=n(63775),N=n(348),M=n(90192),R=n(47856),L=n(18369),P=n(84095),B=n(4899),D=n(60435),F=n(82876),U=n(18997),H=n(26124),z=n(73236),O=n(1049),q=n(78055),V=n(41808),$=n(69141),K=n(86185),W=n(87740),G=n(59577),Z=n(2324),Y=n(15750),J=n(60281),Q=n(91043),X=n(15621),ee=n(44165),te=n(74802),ne=n(70102),ie=n(93023),oe=n(89596),se=n(94395),ae=n(52208),re=n(40183),le=n(89888),ce=n(25749),de=n(23021),ue=n(34394),he=n(72589),me=n(31018),pe=n(80395),ge=n(54742),ve=n(54277),fe=n(91221),_e=n(94494),xe=n(93317),ye=n(81600),be=n(76617),we=n(87287),Ce=n(40466),Ae=n(81595),Se=n(66959),Ie=n(42921),ke=n(39372),je=n(71406),Ee=n(49804),Te=n(72213),Ne=n(35574),Me=n(42886),Re=n(8132),Le=n(86766),Pe=n(60526),Be=n(76151),De=n(94177),Fe=n(39185),Ue=n(9871),He=n(3961),ze=n(6474),Oe=n(73156),qe=n(53532),Ve=n(2776),$e=n(41945),Ke=n(68533),We=n(31551),Ge=n(82705),Ze=n(41261),Ye=n(15790),Je=n(27146),Qe=n(89486),Xe=n(7610),et=n(20754),tt=n(23656),nt=n(19644),it=n(43051),ot=n(22588),st=n(40389),at=n(68152),rt=n(26072),lt=n(54876),ct=n(97959),dt=n(93659),ut=n(10977),ht=n(95543),mt=n(72692),pt=n(7559),gt=n(99313),vt=n(32718),ft=n(96474),_t=n(99656),xt=n(64052),yt=n(11256),bt=n(96689),wt=n(90354),Ct=n(12505),At=n(57255),St=n(34595),It=n(35373),kt=n(79467),jt=n(95771),Et=n(16955),Tt=n(17559),Nt=n(89777),Mt=n(76856),Rt=n(30758),Lt=n(39591),Pt=n(26266),Bt=n(37759),Dt=n(37544),Ft=n(30136),Ut=n(42661),Ht=n(74711),zt=n(6714),Ot=n(51374),qt=n(75485),Vt=n(81938),$t=n(96548),Kt=n(25998),Wt=n(41747),Gt=n(43014),Zt=n(19389),Yt=n(58625),Jt=n(4927),Qt=n(42591),Xt=n(8021),en=n(89966),tn=n(12589),nn=n(43890),on=n(87529),sn=n(79511),an=n(71418),rn=n(162),ln=n(62584),cn=n(17998),dn=n(80317),un=n(39716),hn=n(3334),mn=n(52886),pn=n(92269),gn=n(38686),vn=n(69609),fn=n(22120),_n=n(2277),xn=n(77372),yn=n(55245),bn=n(43149),wn=n(70524),Cn=n(67215),An=n(13146),Sn=n(27744),In=n(42855),kn=n(42074),jn=n(25288),En=n(1724),Tn=n(44701),Nn=n(12781),Mn=n(18721),Rn=n(43194),Ln=n(12565),Pn=n(73464),Bn=n(64373),Dn=n(91815),Fn=n(89729),Un=n(14766),Hn=n(19282),zn=n(17279),On=n(25934),qn=n(43740),Vn=n(66546),$n=n(16836),Kn=n(95347),Wn=n(3767),Gn=n(55403),Zn=n(79303),Yn=n(9746),Jn=n(34451),Qn=n(85229),Xn=n(40827),ei=n(10064),ti=n(15957),ni=n(96735),ii=n(9122),oi=n(70005),si=n(25076),ai=n(96583),ri=n(72550),li=n(16667),ci=n(9352),di=n(37360),ui=n(17805),hi=n(53583),mi=n(10611),pi=n(20345),gi=n(54625),vi=n(45747),fi=n(66187),_i=n(61289),xi=n(23619),yi=n(39361),bi=n(39007),wi=n(57293),Ci=n(44927),Ai=n(4647),Si=n(12034),Ii=n(80681),ki=n(60033),ji=n(60574),Ei=n(74477),Ti=n(57570),Ni=n(54300),Mi=n(11970),Ri=n(22435),Li=n(29602),Pi=n(14524),Bi=n(40295),Di=n(911),Fi=n(83401),Ui=n(40947),Hi=n(88039),zi=n(65290),Oi=n(97024),qi=n(97972),Vi=n(9759),$i=n(69463),Ki=n(45712),Wi=n(34452),Gi=n(36527),Zi=n(16362),Yi=n(4261),Ji=n(21019),Qi=n(86824),Xi=n(25058),eo=n(69043),to=n(82772),no=n(29521),io=n(34169),oo=n(43788),so=n(88038),ao=n(22514),ro=n(23457),lo=n(58487),co=n(92179),uo=n(32847),ho=n(84342),mo=n(2098),po=n(25409),go=n(85888),vo=n(81552),fo=n(53264),_o=n(21260),xo=n(42402),yo=n(12998),bo=n(58301),wo=n(67898),Co=n(34245),Ao=n(73522),So=n(68422),Io=n(73290),ko=n(46422),jo=n(87388),Eo=n(13356),To=n(38094),No=n(70301),Mo=n(18311),Ro=n(60360),Lo=n(58592),Po=n(91844),Bo=n(54299),Do=n(58309),Fo=n(61159),Uo=n(26328),Ho=n(57658),zo=n(32297),Oo=n(84522),qo=n(18205),Vo=n(78841),$o=n(32238),Ko=n(12433),Wo=n(88441),Go=n(2142),Zo=n(22856),Yo=n(72725),Jo=n(39364),Qo=n(98088),Xo=n(69775),es=n(60765),ts=n(26856),ns=n(62629),is=n(2080),os=n(78782),ss=n(754),as=n(42254),rs=n(58400),ls=n(90381),cs=n(42391),ds=n(87475),us=n(4871),hs=n(43249),ms=n(77532),ps=n(59864),gs=n(40791),vs=n(22803),fs=n(7921),_s=n(41028),xs=n(98431),ys=n(16505),bs=n(6246),ws=n(9631),Cs=n(12573),As=n(81019),Ss=n(94277),Is=n(78323),ks=n(12971),js=n(47199),Es=n(26127),Ts=n(26637),Ns=n(12938),Ms=n(86131),Rs=n(2263),Ls=n(94687),Ps=n(65837),Bs=n(78883),Ds=n(98699),Fs=n(75354),Us=n(20080),Hs=n(56137),zs=n(97327),Os=n(96981),qs=n(35618),Vs=n(52412),$s=n(8124),Ks=n(71386),Ws=n(55650),Gs=n(775),Zs=n(37224),Ys=n(75138),Js=n(23997),Qs=n(82545),Xs=n(95292),ea=n(78408),ta=n(48529),na=n(48629),ia=n(77678),oa=n(23311),sa=n(57445),aa=n(45456),ra=n(68791),la=n(10020),ca=n(347),da=n(81980),ua=n(62760),ha=n(59023),ma=n(71519),pa=n(7729),ga=n(8725),va=n(42238),fa=n(90741),_a=n(88689),xa=n(83117),ya=n(35959),ba=n(81637),wa=n(93684),Ca=n(99161),Aa=n(61706),Sa=n(63539),Ia=n(85866),ka=n(30283),ja=n(29119),Ea=n(53794),Ta=n(62872),Na=n(45145),Ma=n(34267),Ra=n(46784),La=n(98195),Pa=n(96222),Ba=n(42305),Da=n(6835),Fa=n(8366),Ua=n(84853),Ha=n(36856),za=n(32109),Oa=n(76107),qa=n(56678),Va=n(50660),$a=n(24425),Ka=n(95917),Wa=n(25201),Ga=n(30526),Za=n(46805),Ya=n(4053),Ja=n(35054),Qa=n(36160),Xa=n(41506),er=n(22500),tr=n(22174),nr=n(46575),ir=n(54251),or=n(8824),sr=n(24519),ar=n(25376),rr=n(46655),lr=n(92905),cr=n(72531),dr=n(41297),ur=n(61131),hr=n(59258),mr=n(89130),pr=n(67065),gr=n(78186),vr=n(58636),fr=n(56757),_r=n(62287),xr=n(51236),yr=n(47143),br=n(86587),wr=n(21521),Cr=n(68380),Ar=n(81114),Sr=n(73757),Ir=n(19969),kr=n(62504),jr=n(56435),Er=n(7265),Tr=n(96421),Nr=n(27281),Mr=n(51758),Rr=n(84306),Lr=n(67022),Pr=n(36636),Br=n(7333),Dr=n(43481),Fr=n(93626),Ur=n(30968),Hr=n(35069),zr=n(23253),Or=n(63159);const qr=(0,i.a)((0,Or.jsx)(o.h,{})),Vr=(0,i.a)((0,Or.jsx)(s.h,{})),$r=(0,i.a)((0,Or.jsx)(a.h,{})),Kr=(0,i.a)((0,Or.jsx)(r.h,{})),Wr=(0,i.a)((0,Or.jsx)(l.h,{})),Gr=(0,i.a)((0,Or.jsx)(c.h,{})),Zr=(0,i.a)((0,Or.jsx)(d.h,{})),Yr=(0,i.a)((0,Or.jsx)(u.h,{})),Jr=(0,i.a)((0,Or.jsx)(h.h,{})),Qr=(0,i.a)((0,Or.jsx)(m.h,{})),Xr=(0,i.a)((0,Or.jsx)(p.h,{})),el=(0,i.a)((0,Or.jsx)(g.h,{})),tl=(0,i.a)((0,Or.jsx)(v.h,{})),nl=(0,i.a)((0,Or.jsx)(f.h,{})),il=(0,i.a)((0,Or.jsx)(_.h,{})),ol=(0,i.a)((0,Or.jsx)(x.h,{})),sl=(0,i.a)((0,Or.jsx)(y.h,{})),al=(0,i.a)((0,Or.jsx)(b.h,{})),rl=(0,i.a)((0,Or.jsx)(w.h,{})),ll=(0,i.a)((0,Or.jsx)(C.h,{})),cl=(0,i.a)((0,Or.jsx)(A.h,{})),dl=(0,i.a)((0,Or.jsx)(S.h,{})),ul=(0,i.a)((0,Or.jsx)(I.h,{})),hl=(0,i.a)((0,Or.jsx)(k.h,{})),ml=(0,i.a)((0,Or.jsx)(j.h,{})),pl=(0,i.a)((0,Or.jsx)(E.h,{})),gl=(0,i.a)((0,Or.jsx)(T.h,{})),vl=(0,i.a)((0,Or.jsx)(N.h,{})),fl=(0,i.a)((0,Or.jsx)(M.h,{})),_l=(0,i.a)((0,Or.jsx)(R.h,{})),xl=(0,i.a)((0,Or.jsx)(L.h,{})),yl=(0,i.a)((0,Or.jsx)(P.h,{})),bl=(0,i.a)((0,Or.jsx)(B.h,{})),wl=(0,i.a)((0,Or.jsx)(D.h,{})),Cl=(0,i.a)((0,Or.jsx)(F.h,{})),Al=(0,i.a)((0,Or.jsx)(U.h,{})),Sl=(0,i.a)((0,Or.jsx)(H.h,{})),Il=(0,i.a)((0,Or.jsx)(z.h,{})),kl=(0,i.a)((0,Or.jsx)(O.h,{})),jl=(0,i.a)((0,Or.jsx)(q.h,{})),El=(0,i.a)((0,Or.jsx)(V.h,{})),Tl=(0,i.a)((0,Or.jsx)($.h,{})),Nl=(0,i.a)((0,Or.jsx)(K.h,{})),Ml=(0,i.a)((0,Or.jsx)(W.h,{})),Rl=(0,i.a)((0,Or.jsx)(G.h,{})),Ll=(0,i.a)((0,Or.jsx)(Z.h,{})),Pl=(0,i.a)((0,Or.jsx)(Y.h,{})),Bl=(0,i.a)((0,Or.jsx)(J.h,{})),Dl=(0,i.a)((0,Or.jsx)(Q.h,{})),Fl=(0,i.a)((0,Or.jsx)(X.h,{})),Ul=(0,i.a)((0,Or.jsx)(ee.h,{})),Hl=(0,i.a)((0,Or.jsx)(te.h,{})),zl=(0,i.a)((0,Or.jsx)(ne.h,{})),Ol=(0,i.a)((0,Or.jsx)(ie.h,{})),ql=(0,i.a)((0,Or.jsx)(oe.h,{})),Vl=(0,i.a)((0,Or.jsx)(se.h,{})),$l=(0,i.a)((0,Or.jsx)(ae.h,{})),Kl=(0,i.a)((0,Or.jsx)(re.h,{})),Wl=(0,i.a)((0,Or.jsx)(le.h,{})),Gl=(0,i.a)((0,Or.jsx)(ce.h,{})),Zl=(0,i.a)((0,Or.jsx)(de.h,{})),Yl=(0,i.a)((0,Or.jsx)(ue.h,{})),Jl=(0,i.a)((0,Or.jsx)(he.h,{})),Ql=(0,i.a)((0,Or.jsx)(me.h,{})),Xl=(0,i.a)((0,Or.jsx)(pe.h,{})),ec=(0,i.a)((0,Or.jsx)(ge.h,{})),tc=(0,i.a)((0,Or.jsx)(ve.h,{})),nc=(0,i.a)((0,Or.jsx)(fe.h,{})),ic=(0,i.a)((0,Or.jsx)(_e.h,{})),oc=(0,i.a)((0,Or.jsx)(xe.h,{})),sc=(0,i.a)((0,Or.jsx)(ye.h,{})),ac=(0,i.a)((0,Or.jsx)(be.h,{})),rc=(0,i.a)((0,Or.jsx)(we.h,{})),lc=(0,i.a)((0,Or.jsx)(Ce.h,{})),cc=(0,i.a)((0,Or.jsx)(Ae.h,{})),dc=(0,i.a)((0,Or.jsx)(Se.h,{})),uc=(0,i.a)((0,Or.jsx)(Ie.h,{})),hc=(0,i.a)((0,Or.jsx)(ke.h,{})),mc=(0,i.a)((0,Or.jsx)(je.h,{})),pc=(0,i.a)((0,Or.jsx)(Ee.h,{})),gc=(0,i.a)((0,Or.jsx)(Te.h,{})),vc=(0,i.a)((0,Or.jsx)(Ne.h,{})),fc=(0,i.a)((0,Or.jsx)(Me.h,{})),_c=(0,i.a)((0,Or.jsx)(Re.h,{})),xc=(0,i.a)((0,Or.jsx)(Le.h,{})),yc=(0,i.a)((0,Or.jsx)(Pe.h,{})),bc=(0,i.a)((0,Or.jsx)(Be.h,{})),wc=(0,i.a)((0,Or.jsx)(De.h,{})),Cc=(0,i.a)((0,Or.jsx)(Fe.h,{})),Ac=(0,i.a)((0,Or.jsx)(Ue.h,{})),Sc=(0,i.a)((0,Or.jsx)(He.h,{})),Ic=(0,i.a)((0,Or.jsx)(ze.h,{})),kc=(0,i.a)((0,Or.jsx)(Oe.h,{})),jc=(0,i.a)((0,Or.jsx)(qe.h,{})),Ec=(0,i.a)((0,Or.jsx)(Ve.h,{})),Tc=(0,i.a)((0,Or.jsx)($e.h,{})),Nc=(0,i.a)((0,Or.jsx)(Ke.h,{})),Mc=(0,i.a)((0,Or.jsx)(We.h,{})),Rc=(0,i.a)((0,Or.jsx)(Ge.h,{})),Lc=(0,i.a)((0,Or.jsx)(Ze.h,{})),Pc=(0,i.a)((0,Or.jsx)(Ye.h,{})),Bc=(0,i.a)((0,Or.jsx)(Je.h,{})),Dc=(0,i.a)((0,Or.jsx)(Qe.h,{})),Fc=(0,i.a)((0,Or.jsx)(Xe.h,{})),Uc=(0,i.a)((0,Or.jsx)(et.h,{})),Hc=(0,i.a)((0,Or.jsx)(tt.h,{})),zc=(0,i.a)((0,Or.jsx)(nt.h,{})),Oc=(0,i.a)((0,Or.jsx)(it.h,{})),qc=(0,i.a)((0,Or.jsx)(ot.h,{})),Vc=(0,i.a)((0,Or.jsx)(st.h,{})),$c=(0,i.a)((0,Or.jsx)(at.h,{})),Kc=(0,i.a)((0,Or.jsx)(rt.h,{})),Wc=(0,i.a)((0,Or.jsx)(lt.h,{})),Gc=(0,i.a)((0,Or.jsx)(ct.h,{})),Zc=(0,i.a)((0,Or.jsx)(dt.h,{})),Yc=(0,i.a)((0,Or.jsx)(ut.h,{})),Jc=(0,i.a)((0,Or.jsx)(ht.h,{})),Qc=(0,i.a)((0,Or.jsx)(mt.h,{})),Xc=(0,i.a)((0,Or.jsx)(pt.h,{})),ed=(0,i.a)((0,Or.jsx)(gt.h,{})),td=(0,i.a)((0,Or.jsx)(vt.h,{})),nd=(0,i.a)((0,Or.jsx)(ft.h,{})),id=(0,i.a)((0,Or.jsx)(_t.h,{})),od=(0,i.a)((0,Or.jsx)(xt.h,{})),sd=(0,i.a)((0,Or.jsx)(yt.h,{})),ad=(0,i.a)((0,Or.jsx)(bt.h,{})),rd=(0,i.a)((0,Or.jsx)(wt.h,{})),ld=(0,i.a)((0,Or.jsx)(Ct.h,{})),cd=(0,i.a)((0,Or.jsx)(At.h,{})),dd=(0,i.a)((0,Or.jsx)(St.h,{})),ud=(0,i.a)((0,Or.jsx)(It.h,{})),hd=(0,i.a)((0,Or.jsx)(kt.h,{})),md=(0,i.a)((0,Or.jsx)(jt.h,{})),pd=(0,i.a)((0,Or.jsx)(Et.h,{})),gd=(0,i.a)((0,Or.jsx)(Tt.h,{})),vd=(0,i.a)((0,Or.jsx)(Nt.h,{})),fd=(0,i.a)((0,Or.jsx)(Mt.h,{})),_d=(0,i.a)((0,Or.jsx)(Rt.h,{})),xd=(0,i.a)((0,Or.jsx)(Lt.h,{})),yd=(0,i.a)((0,Or.jsx)(Pt.h,{})),bd=(0,i.a)((0,Or.jsx)(Bt.h,{})),wd=(0,i.a)((0,Or.jsx)(Dt.h,{})),Cd=(0,i.a)((0,Or.jsx)(Ft.h,{})),Ad=(0,i.a)((0,Or.jsx)(Ut.h,{})),Sd=(0,i.a)((0,Or.jsx)(Ht.h,{})),Id=(0,i.a)((0,Or.jsx)(zt.h,{})),kd=(0,i.a)((0,Or.jsx)(Ot.h,{})),jd=(0,i.a)((0,Or.jsx)(qt.h,{})),Ed=(0,i.a)((0,Or.jsx)(Vt.h,{})),Td=(0,i.a)((0,Or.jsx)($t.h,{})),Nd=(0,i.a)((0,Or.jsx)(Kt.h,{})),Md=(0,i.a)((0,Or.jsx)(Wt.h,{})),Rd=(0,i.a)((0,Or.jsx)(Gt.h,{})),Ld=(0,i.a)((0,Or.jsx)(Zt.h,{})),Pd=(0,i.a)((0,Or.jsx)(Yt.h,{})),Bd=(0,i.a)((0,Or.jsx)(Jt.h,{})),Dd=(0,i.a)((0,Or.jsx)(Qt.h,{})),Fd=(0,i.a)((0,Or.jsx)(Xt.h,{})),Ud=(0,i.a)((0,Or.jsx)(en.h,{})),Hd=(0,i.a)((0,Or.jsx)(tn.h,{})),zd=(0,i.a)((0,Or.jsx)(nn.h,{})),Od=(0,i.a)((0,Or.jsx)(on.h,{})),qd=(0,i.a)((0,Or.jsx)(sn.h,{})),Vd=(0,i.a)((0,Or.jsx)(an.h,{})),$d=(0,i.a)((0,Or.jsx)(rn.h,{})),Kd=(0,i.a)((0,Or.jsx)(ln.h,{})),Wd=(0,i.a)((0,Or.jsx)(cn.h,{})),Gd=(0,i.a)((0,Or.jsx)(dn.h,{})),Zd=(0,i.a)((0,Or.jsx)(un.h,{})),Yd=(0,i.a)((0,Or.jsx)(hn.h,{})),Jd=(0,i.a)((0,Or.jsx)(mn.h,{})),Qd=(0,i.a)((0,Or.jsx)(pn.h,{})),Xd=(0,i.a)((0,Or.jsx)(gn.h,{})),eu=(0,i.a)((0,Or.jsx)(vn.h,{})),tu=(0,i.a)((0,Or.jsx)(fn.h,{})),nu=(0,i.a)((0,Or.jsx)(_n.h,{})),iu=(0,i.a)((0,Or.jsx)(xn.h,{})),ou=(0,i.a)((0,Or.jsx)(yn.h,{})),su=(0,i.a)((0,Or.jsx)(bn.h,{})),au=(0,i.a)((0,Or.jsx)(wn.h,{})),ru=(0,i.a)((0,Or.jsx)(Cn.h,{})),lu=(0,i.a)((0,Or.jsx)(An.h,{})),cu=(0,i.a)((0,Or.jsx)(Sn.h,{})),du=(0,i.a)((0,Or.jsx)(In.h,{})),uu=(0,i.a)((0,Or.jsx)(kn.h,{})),hu=(0,i.a)((0,Or.jsx)(jn.h,{})),mu=(0,i.a)((0,Or.jsx)(En.h,{})),pu=(0,i.a)((0,Or.jsx)(Tn.h,{})),gu=(0,i.a)((0,Or.jsx)(Nn.h,{})),vu=(0,i.a)((0,Or.jsx)(Mn.h,{})),fu=(0,i.a)((0,Or.jsx)(Rn.h,{})),_u=(0,i.a)((0,Or.jsx)(Ln.h,{})),xu=(0,i.a)((0,Or.jsx)(Pn.h,{})),yu=(0,i.a)((0,Or.jsx)(Bn.h,{})),bu=(0,i.a)((0,Or.jsx)(Dn.h,{})),wu=(0,i.a)((0,Or.jsx)(Fn.h,{})),Cu=(0,i.a)((0,Or.jsx)(Un.h,{})),Au=(0,i.a)((0,Or.jsx)(Hn.h,{})),Su=(0,i.a)((0,Or.jsx)(zn.h,{})),Iu=(0,i.a)((0,Or.jsx)(On.h,{})),ku=(0,i.a)((0,Or.jsx)(qn.h,{})),ju=(0,i.a)((0,Or.jsx)(Vn.h,{})),Eu=(0,i.a)((0,Or.jsx)($n.h,{})),Tu=(0,i.a)((0,Or.jsx)(Kn.h,{})),Nu=(0,i.a)((0,Or.jsx)(Wn.h,{})),Mu=(0,i.a)((0,Or.jsx)(Gn.h,{})),Ru=(0,i.a)((0,Or.jsx)(Zn.h,{})),Lu=(0,i.a)((0,Or.jsx)(Yn.h,{})),Pu=(0,i.a)((0,Or.jsx)(Jn.h,{})),Bu=(0,i.a)((0,Or.jsx)(Qn.h,{})),Du=(0,i.a)((0,Or.jsx)(Xn.h,{})),Fu=(0,i.a)((0,Or.jsx)(ei.h,{})),Uu=(0,i.a)((0,Or.jsx)(ti.h,{})),Hu=(0,i.a)((0,Or.jsx)(ni.h,{})),zu=(0,i.a)((0,Or.jsx)(ii.h,{})),Ou=(0,i.a)((0,Or.jsx)(oi.h,{})),qu=(0,i.a)((0,Or.jsx)(si.h,{})),Vu=(0,i.a)((0,Or.jsx)(ai.h,{})),$u=(0,i.a)((0,Or.jsx)(ri.h,{})),Ku=(0,i.a)((0,Or.jsx)(li.h,{})),Wu=(0,i.a)((0,Or.jsx)(ci.h,{})),Gu=(0,i.a)((0,Or.jsx)(di.h,{})),Zu=(0,i.a)((0,Or.jsx)(ui.h,{})),Yu=(0,i.a)((0,Or.jsx)(hi.h,{})),Ju=(0,i.a)((0,Or.jsx)(mi.h,{})),Qu=(0,i.a)((0,Or.jsx)(pi.h,{})),Xu=(0,i.a)((0,Or.jsx)(gi.h,{})),eh=(0,i.a)((0,Or.jsx)(vi.h,{})),th=(0,i.a)((0,Or.jsx)(fi.h,{})),nh=(0,i.a)((0,Or.jsx)(_i.h,{})),ih=(0,i.a)((0,Or.jsx)(xi.h,{})),oh=(0,i.a)((0,Or.jsx)(yi.h,{})),sh=(0,i.a)((0,Or.jsx)(bi.h,{})),ah=(0,i.a)((0,Or.jsx)(wi.h,{})),rh=(0,i.a)((0,Or.jsx)(Ci.h,{})),lh=(0,i.a)((0,Or.jsx)(Ai.h,{})),ch=(0,i.a)((0,Or.jsx)(Si.h,{})),dh=(0,i.a)((0,Or.jsx)(Ii.h,{})),uh=(0,i.a)((0,Or.jsx)(ki.h,{})),hh=(0,i.a)((0,Or.jsx)(ji.h,{})),mh=(0,i.a)((0,Or.jsx)(Ei.h,{})),ph=(0,i.a)((0,Or.jsx)(Ti.h,{})),gh=(0,i.a)((0,Or.jsx)(Ni.h,{})),vh=(0,i.a)((0,Or.jsx)(Mi.h,{})),fh=(0,i.a)((0,Or.jsx)(Ri.h,{})),_h=(0,i.a)((0,Or.jsx)(Li.h,{})),xh=(0,i.a)((0,Or.jsx)(Pi.h,{})),yh=(0,i.a)((0,Or.jsx)(Bi.h,{})),bh=(0,i.a)((0,Or.jsx)(Di.h,{})),wh=(0,i.a)((0,Or.jsx)(Fi.h,{})),Ch=(0,i.a)((0,Or.jsx)(Ui.h,{})),Ah=(0,i.a)((0,Or.jsx)(Hi.h,{})),Sh=(0,i.a)((0,Or.jsx)(zi.h,{})),Ih=(0,i.a)((0,Or.jsx)(Oi.h,{})),kh=(0,i.a)((0,Or.jsx)(qi.h,{})),jh=(0,i.a)((0,Or.jsx)(Vi.h,{})),Eh=(0,i.a)((0,Or.jsx)($i.h,{})),Th=(0,i.a)((0,Or.jsx)(Ki.h,{})),Nh=(0,i.a)((0,Or.jsx)(Wi.h,{})),Mh=(0,i.a)((0,Or.jsx)(Gi.h,{})),Rh=(0,i.a)((0,Or.jsx)(Zi.h,{})),Lh=(0,i.a)((0,Or.jsx)(Yi.h,{})),Ph=(0,i.a)((0,Or.jsx)(Ji.h,{})),Bh=(0,i.a)((0,Or.jsx)(Qi.h,{})),Dh=(0,i.a)((0,Or.jsx)(Xi.h,{})),Fh=(0,i.a)((0,Or.jsx)(eo.h,{})),Uh=(0,i.a)((0,Or.jsx)(to.h,{})),Hh=(0,i.a)((0,Or.jsx)(no.h,{})),zh=(0,i.a)((0,Or.jsx)(io.h,{})),Oh=(0,i.a)((0,Or.jsx)(oo.h,{})),qh=(0,i.a)((0,Or.jsx)(so.h,{})),Vh=(0,i.a)((0,Or.jsx)(ao.h,{})),$h=(0,i.a)((0,Or.jsx)(ro.h,{})),Kh=(0,i.a)((0,Or.jsx)(lo.h,{})),Wh=(0,i.a)((0,Or.jsx)(co.h,{})),Gh=(0,i.a)((0,Or.jsx)(uo.h,{})),Zh=(0,i.a)((0,Or.jsx)(ho.h,{})),Yh=(0,i.a)((0,Or.jsx)(mo.h,{})),Jh=(0,i.a)((0,Or.jsx)(po.h,{})),Qh=(0,i.a)((0,Or.jsx)(go.h,{})),Xh=(0,i.a)((0,Or.jsx)(vo.h,{})),em=(0,i.a)((0,Or.jsx)(fo.h,{})),tm=(0,i.a)((0,Or.jsx)(_o.h,{})),nm=(0,i.a)((0,Or.jsx)(xo.h,{})),im=(0,i.a)((0,Or.jsx)(yo.h,{})),om=(0,i.a)((0,Or.jsx)(bo.h,{})),sm=(0,i.a)((0,Or.jsx)(wo.h,{})),am=(0,i.a)((0,Or.jsx)(Co.h,{})),rm=(0,i.a)((0,Or.jsx)(Ao.h,{})),lm=(0,i.a)((0,Or.jsx)(So.h,{})),cm=(0,i.a)((0,Or.jsx)(Io.h,{})),dm=(0,i.a)((0,Or.jsx)(ko.h,{})),um=(0,i.a)((0,Or.jsx)(jo.h,{})),hm=(0,i.a)((0,Or.jsx)(Eo.h,{})),mm=(0,i.a)((0,Or.jsx)(To.h,{})),pm=(0,i.a)((0,Or.jsx)(No.h,{})),gm=(0,i.a)((0,Or.jsx)(Mo.h,{})),vm=(0,i.a)((0,Or.jsx)(Ro.h,{})),fm=(0,i.a)((0,Or.jsx)(Lo.h,{})),_m=(0,i.a)((0,Or.jsx)(Po.h,{})),xm=(0,i.a)((0,Or.jsx)(Bo.h,{})),ym=(0,i.a)((0,Or.jsx)(Do.h,{})),bm=(0,i.a)((0,Or.jsx)(Fo.h,{})),wm=(0,i.a)((0,Or.jsx)(Uo.h,{})),Cm=(0,i.a)((0,Or.jsx)(Ho.h,{})),Am=(0,i.a)((0,Or.jsx)(zo.h,{})),Sm=(0,i.a)((0,Or.jsx)(Oo.h,{})),Im=(0,i.a)((0,Or.jsx)(qo.h,{})),km=(0,i.a)((0,Or.jsx)(Vo.h,{})),jm=(0,i.a)((0,Or.jsx)($o.h,{})),Em=(0,i.a)((0,Or.jsx)(Ko.h,{})),Tm=(0,i.a)((0,Or.jsx)(Wo.h,{})),Nm=(0,i.a)((0,Or.jsx)(Go.h,{})),Mm=(0,i.a)((0,Or.jsx)(Zo.h,{})),Rm=(0,i.a)((0,Or.jsx)(Yo.h,{})),Lm=(0,i.a)((0,Or.jsx)(Jo.h,{})),Pm=(0,i.a)((0,Or.jsx)(Qo.h,{})),Bm=(0,i.a)((0,Or.jsx)(Xo.h,{})),Dm=(0,i.a)((0,Or.jsx)(es.h,{})),Fm=(0,i.a)((0,Or.jsx)(ts.h,{})),Um=(0,i.a)((0,Or.jsx)(ns.h,{})),Hm=(0,i.a)((0,Or.jsx)(is.h,{})),zm=(0,i.a)((0,Or.jsx)(os.h,{})),Om=(0,i.a)((0,Or.jsx)(ss.h,{})),qm=(0,i.a)((0,Or.jsx)(as.h,{})),Vm=(0,i.a)((0,Or.jsx)(rs.h,{})),$m=(0,i.a)((0,Or.jsx)(ls.h,{})),Km=(0,i.a)((0,Or.jsx)(cs.h,{})),Wm=(0,i.a)((0,Or.jsx)(ds.h,{})),Gm=(0,i.a)((0,Or.jsx)(us.h,{})),Zm=(0,i.a)((0,Or.jsx)(hs.h,{})),Ym=(0,i.a)((0,Or.jsx)(ms.h,{})),Jm=(0,i.a)((0,Or.jsx)(ps.h,{})),Qm=(0,i.a)((0,Or.jsx)(gs.h,{})),Xm=(0,i.a)((0,Or.jsx)(vs.h,{})),ep=(0,i.a)((0,Or.jsx)(fs.h,{})),tp=(0,i.a)((0,Or.jsx)(_s.h,{})),np=(0,i.a)((0,Or.jsx)(xs.h,{})),ip=(0,i.a)((0,Or.jsx)(ys.h,{})),op=(0,i.a)((0,Or.jsx)(bs.h,{})),sp=(0,i.a)((0,Or.jsx)(ws.h,{})),ap=(0,i.a)((0,Or.jsx)(Cs.h,{})),rp=(0,i.a)((0,Or.jsx)(As.h,{})),lp=(0,i.a)((0,Or.jsx)(Ss.h,{})),cp=(0,i.a)((0,Or.jsx)(Is.h,{})),dp=(0,i.a)((0,Or.jsx)(ks.h,{})),up=(0,i.a)((0,Or.jsx)(js.h,{})),hp=(0,i.a)((0,Or.jsx)(Es.h,{})),mp=(0,i.a)((0,Or.jsx)(Ts.h,{})),pp=(0,i.a)((0,Or.jsx)(Ns.h,{})),gp=(0,i.a)((0,Or.jsx)(Ms.h,{})),vp=(0,i.a)((0,Or.jsx)(Rs.h,{})),fp=(0,i.a)((0,Or.jsx)(Ls.h,{})),_p=(0,i.a)((0,Or.jsx)(Ps.h,{})),xp=(0,i.a)((0,Or.jsx)(Bs.h,{})),yp=(0,i.a)((0,Or.jsx)(Ds.h,{})),bp=(0,i.a)((0,Or.jsx)(Fs.h,{})),wp=(0,i.a)((0,Or.jsx)(Us.h,{})),Cp=(0,i.a)((0,Or.jsx)(Hs.h,{})),Ap=(0,i.a)((0,Or.jsx)(zs.h,{})),Sp=(0,i.a)((0,Or.jsx)(Os.h,{})),Ip=(0,i.a)((0,Or.jsx)(qs.h,{})),kp=(0,i.a)((0,Or.jsx)(Vs.h,{})),jp=(0,i.a)((0,Or.jsx)($s.h,{})),Ep=(0,i.a)((0,Or.jsx)(Ks.h,{})),Tp=(0,i.a)((0,Or.jsx)(Ws.h,{})),Np=(0,i.a)((0,Or.jsx)(Gs.h,{})),Mp=(0,i.a)((0,Or.jsx)(Zs.h,{})),Rp=(0,i.a)((0,Or.jsx)(Ys.h,{})),Lp=(0,i.a)((0,Or.jsx)(Js.h,{})),Pp=(0,i.a)((0,Or.jsx)(Qs.h,{})),Bp=(0,i.a)((0,Or.jsx)(Xs.h,{})),Dp=(0,i.a)((0,Or.jsx)(ea.h,{})),Fp=(0,i.a)((0,Or.jsx)(ta.h,{})),Up=(0,i.a)((0,Or.jsx)(na.h,{})),Hp=(0,i.a)((0,Or.jsx)(ia.h,{})),zp=(0,i.a)((0,Or.jsx)(oa.h,{})),Op=(0,i.a)((0,Or.jsx)(sa.h,{})),qp=(0,i.a)((0,Or.jsx)(aa.h,{})),Vp=(0,i.a)((0,Or.jsx)(ra.h,{})),$p=(0,i.a)((0,Or.jsx)(la.h,{})),Kp=(0,i.a)((0,Or.jsx)(ca.h,{})),Wp=(0,i.a)((0,Or.jsx)(da.h,{})),Gp=(0,i.a)((0,Or.jsx)(ua.h,{})),Zp=(0,i.a)((0,Or.jsx)(ha.h,{})),Yp=(0,i.a)((0,Or.jsx)(ma.h,{})),Jp=(0,i.a)((0,Or.jsx)(pa.h,{})),Qp=(0,i.a)((0,Or.jsx)(ga.h,{})),Xp=(0,i.a)((0,Or.jsx)(va.h,{})),eg=(0,i.a)((0,Or.jsx)(fa.h,{})),tg=(0,i.a)((0,Or.jsx)(_a.h,{})),ng=(0,i.a)((0,Or.jsx)(xa.h,{})),ig=(0,i.a)((0,Or.jsx)(ya.h,{})),og=(0,i.a)((0,Or.jsx)(ba.h,{})),sg=(0,i.a)((0,Or.jsx)(wa.h,{})),ag=(0,i.a)((0,Or.jsx)(Ca.h,{})),rg=(0,i.a)((0,Or.jsx)(Aa.h,{})),lg=(0,i.a)((0,Or.jsx)(Sa.h,{})),cg=(0,i.a)((0,Or.jsx)(Ia.h,{})),dg=(0,i.a)((0,Or.jsx)(ka.h,{})),ug=(0,i.a)((0,Or.jsx)(ja.h,{})),hg=(0,i.a)((0,Or.jsx)(Ea.h,{})),mg=(0,i.a)((0,Or.jsx)(Ta.h,{})),pg=(0,i.a)((0,Or.jsx)(Na.h,{})),gg=(0,i.a)((0,Or.jsx)(Ma.h,{})),vg=(0,i.a)((0,Or.jsx)(Ra.h,{})),fg=(0,i.a)((0,Or.jsx)(La.h,{})),_g=(0,i.a)((0,Or.jsx)(Pa.h,{})),xg=(0,i.a)((0,Or.jsx)(Ba.h,{})),yg=(0,i.a)((0,Or.jsx)(Da.h,{})),bg=(0,i.a)((0,Or.jsx)(Fa.h,{})),wg=(0,i.a)((0,Or.jsx)(Ua.h,{})),Cg=(0,i.a)((0,Or.jsx)(Ha.h,{})),Ag=(0,i.a)((0,Or.jsx)(za.h,{})),Sg=(0,i.a)((0,Or.jsx)(Oa.h,{})),Ig=(0,i.a)((0,Or.jsx)(qa.h,{})),kg=(0,i.a)((0,Or.jsx)(Va.h,{})),jg=(0,i.a)((0,Or.jsx)($a.h,{})),Eg=(0,i.a)((0,Or.jsx)(Ka.h,{})),Tg=(0,i.a)((0,Or.jsx)(Wa.h,{})),Ng=(0,i.a)((0,Or.jsx)(Ga.h,{})),Mg=(0,i.a)((0,Or.jsx)(Za.h,{})),Rg=(0,i.a)((0,Or.jsx)(Ya.h,{})),Lg=(0,i.a)((0,Or.jsx)(Ja.h,{})),Pg=(0,i.a)((0,Or.jsx)(Qa.h,{})),Bg=(0,i.a)((0,Or.jsx)(Xa.h,{})),Dg=(0,i.a)((0,Or.jsx)(er.h,{})),Fg=(0,i.a)((0,Or.jsx)(tr.h,{})),Ug=(0,i.a)((0,Or.jsx)(nr.h,{})),Hg=(0,i.a)((0,Or.jsx)(ir.h,{})),zg=(0,i.a)((0,Or.jsx)(or.h,{})),Og=(0,i.a)((0,Or.jsx)(sr.h,{})),qg=(0,i.a)((0,Or.jsx)(ar.h,{})),Vg=(0,i.a)((0,Or.jsx)(rr.h,{})),$g=(0,i.a)((0,Or.jsx)(lr.h,{})),Kg=(0,i.a)((0,Or.jsx)(cr.h,{})),Wg=(0,i.a)((0,Or.jsx)(dr.h,{})),Gg=(0,i.a)((0,Or.jsx)(ur.h,{})),Zg=(0,i.a)((0,Or.jsx)(hr.h,{})),Yg=(0,i.a)((0,Or.jsx)(mr.h,{})),Jg=(0,i.a)((0,Or.jsx)(pr.h,{})),Qg=(0,i.a)((0,Or.jsx)(gr.h,{})),Xg=(0,i.a)((0,Or.jsx)(vr.h,{})),ev=(0,i.a)((0,Or.jsx)(fr.h,{})),tv=(0,i.a)((0,Or.jsx)(_r.h,{})),nv=(0,i.a)((0,Or.jsx)(xr.h,{})),iv=(0,i.a)((0,Or.jsx)(yr.h,{})),ov=(0,i.a)((0,Or.jsx)(br.h,{})),sv=(0,i.a)((0,Or.jsx)(wr.h,{})),av=(0,i.a)((0,Or.jsx)(Cr.h,{})),rv=(0,i.a)((0,Or.jsx)(Ar.h,{})),lv=(0,i.a)((0,Or.jsx)(Sr.h,{})),cv=(0,i.a)((0,Or.jsx)(Ir.h,{})),dv=(0,i.a)((0,Or.jsx)(kr.h,{})),uv=(0,i.a)((0,Or.jsx)(jr.h,{})),hv=(0,i.a)((0,Or.jsx)(Er.h,{})),mv=(0,i.a)((0,Or.jsx)(Tr.h,{})),pv=(0,i.a)((0,Or.jsx)(Nr.h,{})),gv=(0,i.a)((0,Or.jsx)(Mr.h,{})),vv=(0,i.a)((0,Or.jsx)(Rr.h,{})),fv=(0,i.a)((0,Or.jsx)(Lr.h,{})),_v=(0,i.a)((0,Or.jsx)(Pr.h,{})),xv=(0,i.a)((0,Or.jsx)(Br.h,{})),yv=(0,i.a)((0,Or.jsx)(Dr.h,{})),bv=(0,i.a)((0,Or.jsx)(Fr.h,{})),wv=(0,i.a)((0,Or.jsx)(Ur.h,{})),Cv=(0,i.a)((0,Or.jsx)(Hr.h,{})),Av=(0,i.a)((0,Or.jsx)(zr.h,{})),Sv={IcZoomOutIcon:qr,IcZoomInIcon:Vr,IcZoomFitIcon:$r,IcXIcon:Kr,IcWriteIcon:Wr,IcWindowsIcon:Gr,IcWeiboIcon:Zr,IcWebsiteIcon:Yr,IcWebpaegFillIcon:Jr,IcWarningSmallIcon:Qr,IcWarningLargeIcon:Xr,IcVoiceStopIcon:el,IcVoiceFillIcon:tl,IcVoiceIcon:nl,IcUpscaleIcon:il,IcUploadImageIcon:ol,IcUploadIcon:sl,IcUpdateAlertIcon:al,IcUpdateIcon:rl,IcUnsplashIcon:ll,IcUnfavoriteIcon:cl,IcTrendingIcon:dl,IcTrashIcon:ul,IcTranslateOnIcon:hl,IcTranslateOffIcon:ml,IcTipIcon:pl,IcTimeListIcon:gl,IcTimeIcon:vl,IcThumbsUpFillIcon:fl,IcThumbsUpIcon:_l,IcThumbsDownFillIcon:xl,IcThumbsDownIcon:yl,IcTerminalIcon:bl,IcSunIcon:wl,IcSummarizeWebpaegFillIcon:Cl,IcSummarizeIcon:Al,IcSuccessSmallIcon:Sl,IcSuccessLargeIcon:Il,IcStopFillIcon:kl,IcStopIcon:jl,IcStandardIcon:El,IcSpreadsheetTextFillIcon:Tl,IcSplitIcon:Nl,IcSpecialWriteIcon:Ml,IcSpacingShortIcon:Rl,IcSpacingHeightIcon:Ll,IcSnowIcon:Pl,IcSkillsFillExplorationIcon:Bl,IcSkillsFillIcon:Dl,IcSkillsIcon:Fl,IcSkillAddedIcon:Ul,IcSkillAddIcon:Hl,IcSiderbarExpendIcon:zl,IcSiderbarCollapseIcon:Ol,IcSiderIcon:ql,IcShrinkScreenIcon:Vl,IcShareIcon:$l,IcShakeIcon:Kl,IcSettingsIcon:Wl,IcSettingPluginIcon:Gl,IcSelectdPenIcon:Zl,IcSelectdEraseIcon:Yl,IcSearchSmartIcon:Jl,IcSearchPlusIcon:Ql,IcSearchIcon:Xl,IcScreenShotIcon:ec,IcRewriteIcon:tc,IcReturnIcon:nc,IcReplaceSelectionIcon:ic,IcRegenerateIcon:oc,IcReadSparkleIcon:sc,IcReadFillIcon:ac,IcReadIcon:rc,IcRatio916Icon:lc,IcRatio43Icon:cc,IcRatio34Icon:dc,IcRatio23Icon:uc,IcRatio11Icon:hc,IcRatio169Icon:mc,IcRatioIcon:pc,IcQuote2Icon:gc,IcQuote1Icon:vc,IcProfessionalIcon:fc,IcPosterIcon:_c,IcPositionIcon:xc,IcPlusCircleFillIcon:yc,IcPlusIcon:bc,IcPluginsIcon:wc,IcPlaySmallIcon:Cc,IcPlayFillIcon:Ac,IcPlayIcon:Sc,IcPinSlashIcon:Ic,IcPinFillIcon:kc,IcPinIcon:jc,IcPhotoDownIcon:Ec,IcPhotoIcon:Tc,IcPhoneIcon:Nc,IcPenSparkleIcon:Mc,IcPdfTextFillIcon:Rc,IcPaperclipIcon:Lc,IcNotificationFillIcon:Pc,IcNotificationIcon:Bc,IcNotesIcon:Dc,IcNoteIcon:Fc,IcNewThreadIcon:Uc,IcNewChatSolidIcon:Hc,IcNewChatIcon:zc,IcMusicSparkleIcon:Oc,IcMusicIcon:qc,IcMoreErticalIcon:Vc,IcMoreIcon:$c,IcMoonIcon:Kc,IcModifyToneIcon:Wc,IcModifySummarizeIcon:Gc,IcModifyShorterIcon:Zc,IcModifyMediumIcon:Yc,IcModifyLongerIcon:Jc,IcMinusCircleFillIcon:Qc,IcMindmapIcon:Xc,IcMicroIcon:ed,IcMenuIcon:td,IcMediumIcon:nd,IcMassageIcon:id,IcMarkSolidIcon:od,IcMarkIcon:sd,IcMainChatIcon:ad,IcMailIcon:rd,IcLyricsFillIcon:ld,IcLyricsIcon:cd,IcLoveIcon:dd,IcLoadingIcon:ud,IcLinkExternalIcon:hd,IcLinkAddIcon:md,IcLinkIcon:pd,IcLeafIcon:gd,IcLanguageIcon:vd,IcJikeIcon:fd,IcInsertBelowIcon:_d,IcInfoIcon:xd,IcImmersionModeIcon:yd,IcImageSubjectIcon:bd,IcImageStyleFillIcon:wd,IcImageStyleIcon:Cd,IcImageSparkleIcon:Ad,IcImagePromptIcon:Sd,IcImageFaceIcon:Id,IcImageAddIcon:kd,IcHuoshanIcon:jd,IcHomeIcon:Ed,IcHighlighterIcon:Td,IcHelpIcon:Nd,IcGridIcon:Md,IcGithubIcon:Rd,IcGameIcon:Ld,IcFullSpeakSlashIcon:Pd,IcFullSpeakIcon:Bd,IcFullScreenIcon:Dd,IcFreshIcon:Fd,IcForwardIcon:Ud,IcFlagIcon:Hd,IcFixGrammarIcon:zd,IcFiletypeZipIcon:Od,IcFiletypeWhiteXlsxIcon:qd,IcFiletypeWhiteTxtAndOthersIcon:Vd,IcFiletypeWhitePptxIcon:$d,IcFiletypeWhitePdfIcon:Kd,IcFiletypeWhiteLinkIcon:Wd,IcFiletypeWhiteImageIcon:Gd,IcFiletypeWhiteDocIcon:Zd,IcFiletypeWhiteCsvIcon:Yd,IcFiletypeSkillsiconWriteForMeIcon:Jd,IcFiletypeSkillsiconWebSearchIcon:Qd,IcFiletypeSkillsiconTranslatorIcon:Xd,IcFiletypeSkillsiconSummarizeWebpageIcon:eu,IcFiletypeSkillsiconPdfReaderIcon:tu,IcFiletypeSkillsiconMusicIcon:nu,IcFiletypeSkillsiconImageGenerationIcon:iu,IcFiletypeOutlinePdfIcon:ou,IcFiletypeGreyXlsxIcon:su,IcFiletypeGreyTxtAndOthersIcon:au,IcFiletypeGreyPptxIcon:ru,IcFiletypeGreyPdfIcon:lu,IcFiletypeGreyLinkIcon:cu,IcFiletypeGreyImageIcon:du,IcFiletypeGreyDocIcon:uu,IcFiletypeGreyCsvIcon:hu,IcFiletypeColorfulXlsxIcon:mu,IcFiletypeColorfulTxtAndOthersIcon:pu,IcFiletypeColorfulPptxIcon:gu,IcFiletypeColorfulPdfIcon:vu,IcFiletypeColorfulLyricIcon:fu,IcFiletypeColorfulLinkIcon:_u,IcFiletypeColorfulImageIcon:xu,IcFiletypeColorfulDocIcon:yu,IcFiletypeColorfulCsvIcon:bu,IcFiletypeIcon:wu,IcFeedbackSuccessIcon:Cu,IcFavoriteDoneIcon:Au,IcFavoriteIcon:Su,IcEyeIcon:Iu,IcExtractTextIcon:ku,IcExtractIcon:ju,IcExplainIcon:Eu,IcExpandIcon:Tu,IcExitIcon:Nu,IcErrorSmallIcon:Mu,IcErrorLargeIcon:Ru,IcEditUnderlineIcon:Lu,IcEditTextIcon:Pu,IcEditTablegridIcon:Bu,IcEditStrikethroughIcon:Du,IcEditRightIcon:Fu,IcEditReferenceIcon:Uu,IcEditOrdeListIcon:Hu,IcEditItalicIcon:zu,IcEditH3Icon:Ou,IcEditH2Icon:qu,IcEditH1Icon:Vu,IcEditDownIcon:$u,IcEditDisordeListIcon:Ku,IcEditCodetextIcon:Wu,IcEditCodeblockIcon:Gu,IcEditCodeIcon:Zu,IcEditBoldIcon:Yu,IcEditIcon:Ju,IcDragIcon:Qu,IcDownloadAppExtensionIcon:Xu,IcDownloadAppIcon:eh,IcDownloadIcon:th,IcDoneWithCircleIcon:nh,IcDoneIcon:ih,IcDocTextFillIcon:oh,IcDocTextIcon:sh,IcDocOutputIcon:ah,IcDocAddIcon:rh,IcDocIcon:lh,IcDiscoverIcon:ch,IcDelineateWordsIcon:dh,IcDeletIcon:uh,IcCropSparkleIcon:hh,IcCropIcon:mh,IcCoreIcon:ph,IcCopyIcon:gh,IcControlIcon:vh,IcCollectionIcon:fh,IcCollapseIcon:_h,IcCodeIcon:xh,IcCloudyIcon:yh,IcCloseWithCircleIcon:bh,IcCloseIcon:wh,IcClientDragIcon:Ch,IcChevronUpSmallsizeIcon:Ah,IcChevronUpIcChevronUpSmallsizeIcon:Sh,IcChevronUpIcon:Ih,IcChevronRight2Icon:kh,IcChevronRightIcon:jh,IcChevronLeft2Icon:Eh,IcChevronLeftIcon:Th,IcChevronDownSmallsizeIcon:Nh,IcChevronDownIcon:Mh,IcChevronCompactUpIcon:Rh,IcChevronCompactDownIcon:Lh,IcChevron1UpIcon:Ph,IcChevron1DownIcon:Bh,IcCheckmarkFillIcon:Dh,IcCheckWithCircleIcon:Fh,IcChatRoundIcon:Uh,IcChatIcon:Hh,IcCcIcon:zh,IcCasualIcon:Oh,IcCameraFillIcon:qh,IcCameraIcon:Vh,IcBusinessIcon:$h,IcBrushSizeSmallIcon:Kh,IcBrushSizeLargeIcon:Wh,IcBrowserExtensionIcon:Gh,IcBoxIcon:Zh,IcBotIcon:Yh,IcBookChatIcon:Jh,IcBookIcon:Qh,IcBilingualSubtitlesIcon:Xh,IcBellIcon:em,IcArrowUprightIcon:tm,IcArrowUpIcon:nm,IcArrowLeftIcon:im,IcArrowDownIcon:om,IcArrowIcon:sm,IcAppleIcon:am,IcAllThreadsFillIcon:rm,IcAllThreadsIcon:lm,IcAdjustRatioIcon:cm,IcAddBotIcon:dm,IcAddIcon:um,IcAcademicCiteIcon:hm,IcAcademicIcon:mm,IcAaIcon:pm,ZoomOutIcon:gm,ZoomInIcon:vm,WindowsIcon:fm,WhiteBackIcon:_m,WavingHandIcon:xm,VideoPlayIcon:ym,VideoPlaySmallIcon:bm,VectorIcon:wm,ValidatingIcon:Cm,ValidateSuccessIcon:Am,UploadImageIcon:Sm,UploadFileIcon:Im,UploadFileDropIcon:km,UnpinnedConversationIcon:jm,UnderscoreIcon:Em,TranslateIcon:Tm,TickIcon:Nm,ThreadActionIcon:Mm,TerminalIcon:Rm,TemplateStarIcon:Lm,SummarizeIcon:Pm,SuggestPromptsIcon:Bm,SkillHeaderCloseIcon:Dm,ShorterIcon:Fm,ShortcutWindowsIcon:Um,ShortcutIcon:Hm,ShareIcon:zm,SettingsIcon:Om,SettingErrorIcon:qm,SettingEditIcon:Vm,SettingDiscordLinkIcon:$m,SettingBlockIcon:Km,SettingAboutIcon:Wm,SettingAboutModalIcon:Gm,SearchIcon:Zm,SearchWebIcon:Ym,SearchActionIcon:Jm,SearchActionCurColorIcon:Qm,RightArrowIcon:Xm,RightSideShareIcon:ep,RightSideSettingIcon:tp,RewriteIcon:np,ReportSuccessIcon:ip,RemoveSettingIcon:op,RemoveConversationIcon:sp,RegenerateSwitchDownIcon:ap,RegenerateLeftIcon:rp,QuickAccessIcon:lp,PwaIcon:cp,ProfileSettingIcon:dp,PlusWithoutCircleIcon:up,PinnedIcon:hp,PinnedConversationIcon:mp,PinConversationIcon:pp,PenSparkleIcon:gp,PdfIcon:vp,OkIcon:fp,NowLighteningIcon:_p,NickNameSettingIcon:xp,NewConversationIcon:yp,MoreIcon:bp,MoreAutoColorIcon:wp,MoreActionIcon:Cp,ModelSettingIcon:Ap,ModalInfoIcon:Sp,MicIcon:Ip,MessageFailedIcon:kp,MenuIcon:jp,MacIcon:Ep,LongerIcon:Tp,LogoutIcon:Np,LoginIcon:Mp,LoadingInThinkingIcon:Rp,LinkIcon:Lp,LauncherIcon:Pp,LanguageSettingIcon:Bp,LanguageChangeIcon:Dp,InfoIcon:Fp,ImageSelectIcon:Up,ImageAddIcon:Hp,IconMusicPlayIcon:zp,IconMusicPauseIcon:Op,IconMusicDefaultIcon:qp,IconAttachmentOutlinedIcon:Vp,IconRefreshIcon:$p,HistoryTimeIcon:Kp,GrammarIcon:Wp,ForbiddenIcon:Gp,FlowerLoadingIcon:Zp,FeedbackEmailIcon:Yp,FavoriteIcon:Jp,ExtensionDownloadIcon:Qp,ExplainIcon:Xp,ExpandArrowIcon:eg,ErrorIcon:tg,EnterIcon:ng,EmptyLineIcon:ig,EditIcon:og,EditMessageButtonIcon:sg,EditConversationNameIcon:ag,EditConversationNameSettingIcon:rg,DownloadArrowIcon:lg,DownloadWithArrowIcon:cg,DownloadUnreadPcIcon:dg,DownloadNormalIcon:ug,DotIcon:hg,DeleteIcon:mg,DeleteOutlineIcon:pg,DeleteFileIcon:gg,DeleteCircleOutlineIcon:vg,DefaultIndexIcon:fg,DebugIcon:_g,CustomAnswerActionModalCloseIcon:xg,CursorIcon:yg,CopyIcon:bg,CommonBtnIcon:wg,CommonBtnActiveIcon:Cg,CloseLoginIcon:Ag,CloseIcon:Sg,CloseSvgIcon:Ig,CloseCurColorIcon:kg,ClockArrowIcon:jg,ClientSplitIcon:Eg,ClientSkillAddedIcon:Tg,ClientSkillAddIcon:Ng,ClientDragIcon:Mg,ClientDoneWithCircleIcon:Rg,ClientCheckmarkFillIcon:Lg,ClientSettingExtensionSettingIcon:Pg,ClientSettingClientBrowserIcon:Bg,ClearConversationIcon:Dg,ClearContextIcon:Fg,ChromeIcon:Ug,CheckIcon:Hg,ChatlistDotsIcon:zg,ChatlistBotIcon:Og,ChatListBannerLoadingIcon:qg,ChatListBannerIcon:Vg,ChatHeaderSideIcon:$g,ChatHeaderSideCountIcon:Kg,ChatHeaderSamanthaIcon:Wg,ChatHeaderSamanthaCountIcon:Gg,ChangeToneIcon:Zg,CellPhoneIcon:Yg,BrowserExtensionIcon:Jg,BotHotIcon:Qg,BotDiscoverIcon:Xg,BlueMoreIcon:ev,BlueMagicIcon:tv,BlockIcon:nv,BlackLightningIcon:iv,ArrowUpCircleIcon:ov,ArrowRightIcon:sv,ArrowRightWidth14Icon:av,ArrowLeftIcon:rv,ArrowLeftWidth14Icon:lv,ArrowDownIcon:cv,ArrowDown2Icon:dv,AppleIcon:uv,AppleLogoIcon:hv,AppDownloadIcon:mv,AnswerVideoIcon:pv,AndroidIcon:gv,AlertTriangleIcon:vv,AlbumIcon:fv,AiIcon:_v,AiGenerateIcon:xv,AiGenerateWhiteIcon:yv,AddIcon:bv,AddAvatarIcon:wv,AccountSettingIcon:Cv,AboutUsIcon:Av}},30435:(e,t,n)=>{n.d(t,{$GU:()=>zt,ADv:()=>bt,Aos:()=>mt,B94:()=>pt,BFg:()=>Mt,DC3:()=>ye,DaB:()=>Se,Dkt:()=>he,DqC:()=>$,EGn:()=>dt,EWR:()=>fe,EwG:()=>T,FC_:()=>ie,FDz:()=>Ne,FXq:()=>q,FrO:()=>we,G2z:()=>$e,GeG:()=>nn,Gq1:()=>se,H6p:()=>E,HXh:()=>rt,IDX:()=>nt,IJR:()=>Ot,IVD:()=>_t,In9:()=>b,InS:()=>de,JjB:()=>Tt,K4:()=>Ve,KHH:()=>D,KkG:()=>g,Km5:()=>Jt,KsF:()=>R,LLW:()=>Lt,Lc8:()=>tt,LoD:()=>yt,Lpv:()=>z,Mjn:()=>Rt,Npf:()=>Q,NwD:()=>ce,O3Z:()=>St,OPx:()=>Ae,Oez:()=>Ue,P3c:()=>X,PTM:()=>ve,PoW:()=>Be,QAj:()=>Me,QL3:()=>gt,QVi:()=>qe,RLl:()=>Nt,RNZ:()=>xt,RuR:()=>ee,SZ3:()=>Ut,T6T:()=>wt,TDm:()=>S,TNb:()=>p,TdU:()=>Yt,TgH:()=>Qe,U5z:()=>be,UJs:()=>j,UNM:()=>Le,UwS:()=>ct,WGN:()=>V,WmB:()=>jt,WsO:()=>Ge,Wur:()=>ze,X4:()=>oe,XgB:()=>ke,XgE:()=>Ht,XpJ:()=>Gt,YHd:()=>It,YaG:()=>Fe,Ydz:()=>Zt,Z1u:()=>Qt,Z87:()=>k,ZKw:()=>L,ZR1:()=>f,ZZJ:()=>_,_4N:()=>Pe,_H0:()=>F,_qM:()=>Dt,_wR:()=>De,abE:()=>it,aoI:()=>u,aqb:()=>I,bed:()=>c,bo3:()=>A,d0m:()=>M,d0t:()=>ht,d7y:()=>$t,dTV:()=>ut,eKK:()=>B,eWz:()=>Ze,ebI:()=>lt,ebl:()=>te,eqn:()=>tn,fFY:()=>Xe,fkI:()=>le,fsR:()=>et,fvB:()=>re,gXP:()=>me,ifA:()=>Xt,iwq:()=>m,j0V:()=>Vt,jI:()=>J,jOS:()=>kt,k3s:()=>Re,k4K:()=>N,kJf:()=>Ct,kcO:()=>K,lNg:()=>Ee,lSc:()=>x,lUW:()=>ft,lkE:()=>w,mFg:()=>Ke,mT5:()=>At,nOb:()=>G,npH:()=>Ce,o40:()=>Je,oBA:()=>ge,oZ9:()=>U,pCk:()=>Kt,pnb:()=>Wt,qDU:()=>ae,qO4:()=>vt,qjL:()=>W,r6k:()=>Bt,r9y:()=>Ft,rN9:()=>xe,rQU:()=>st,sBK:()=>ue,sPs:()=>y,sTf:()=>pe,sXP:()=>ot,saN:()=>Z,st6:()=>C,svv:()=>H,sxB:()=>We,tjx:()=>Et,u06:()=>He,uGY:()=>at,v9Y:()=>ne,vPz:()=>Ie,vVw:()=>en,vZE:()=>Pt,vek:()=>_e,vlM:()=>h,wJ:()=>d,wve:()=>je,x43:()=>Oe,xP8:()=>O,xdu:()=>Y,xsk:()=>v,xyy:()=>qt,ywS:()=>Ye,z18:()=>Te,zSs:()=>P});var i=n(44557),o=n(83632),s=n(94790),a=n(11855),r=n(63159);const l=a.lazy((()=>Promise.resolve().then(n.bind(n,36490)).catch((e=>(console.error("IconByKey lazy error:",e),{default:()=>null}))))),c=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcZoomOutIcon"},t))})},d=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcZoomInIcon"},t))})},u=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcZoomFitIcon"},t))})},h=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcWriteIcon"},t))})},m=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcUploadImageIcon"},t))})},p=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcUploadIcon"},t))})},g=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcTrashIcon"},t))})},v=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcTranslateOnIcon"},t))})},f=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcTranslateOffIcon"},t))})},_=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcTipIcon"},t))})},x=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcThumbsUpFillIcon"},t))})},y=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcThumbsUpIcon"},t))})},b=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcThumbsDownFillIcon"},t))})},w=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcThumbsDownIcon"},t))})},C=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcSunIcon"},t))})},A=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcSummarizeWebpaegFillIcon"},t))})},S=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcStopFillIcon"},t))})},I=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcStopIcon"},t))})},k=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcSpacingShortIcon"},t))})},j=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcSpacingHeightIcon"},t))})},E=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcSnowIcon"},t))})},T=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcSkillsFillExplorationIcon"},t))})},N=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcSkillsIcon"},t))})},M=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcShareIcon"},t))})},R=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcShakeIcon"},t))})},L=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcSettingsIcon"},t))})},P=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcSearchSmartIcon"},t))})},B=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcSearchIcon"},t))})},D=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcRewriteIcon"},t))})},F=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcRegenerateIcon"},t))})},U=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcReadSparkleIcon"},t))})},H=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcReadIcon"},t))})},z=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcRatioIcon"},t))})},O=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcQuote1Icon"},t))})},q=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcPositionIcon"},t))})},V=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcPlusIcon"},t))})},$=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcPlayFillIcon"},t))})},K=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcPlayIcon"},t))})},W=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcPhotoIcon"},t))})},G=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcPenSparkleIcon"},t))})},Z=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcPaperclipIcon"},t))})},Y=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcNotificationIcon"},t))})},J=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcNotesIcon"},t))})},Q=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcMusicSparkleIcon"},t))})},X=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcMoreIcon"},t))})},ee=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcMoonIcon"},t))})},te=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcModifyToneIcon"},t))})},ne=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcModifyShorterIcon"},t))})},ie=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcModifyMediumIcon"},t))})},oe=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcModifyLongerIcon"},t))})},se=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcMindmapIcon"},t))})},ae=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcMicroIcon"},t))})},re=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcMassageIcon"},t))})},le=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcMailIcon"},t))})},ce=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcLyricsFillIcon"},t))})},de=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcLyricsIcon"},t))})},ue=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcLoveIcon"},t))})},he=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcLinkExternalIcon"},t))})},me=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcLinkIcon"},t))})},pe=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcLeafIcon"},t))})},ge=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcInfoIcon"},t))})},ve=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcImageSparkleIcon"},t))})},fe=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeWhiteXlsxIcon"},t))})},_e=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeWhiteTxtAndOthersIcon"},t))})},xe=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeWhitePptxIcon"},t))})},ye=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeWhitePdfIcon"},t))})},be=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeWhiteImageIcon"},t))})},we=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeWhiteDocIcon"},t))})},Ce=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeWhiteCsvIcon"},t))})},Ae=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeGreyXlsxIcon"},t))})},Se=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeGreyTxtAndOthersIcon"},t))})},Ie=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeGreyPptxIcon"},t))})},ke=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeGreyPdfIcon"},t))})},je=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeGreyImageIcon"},t))})},Ee=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeGreyDocIcon"},t))})},Te=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeGreyCsvIcon"},t))})},Ne=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeColorfulXlsxIcon"},t))})},Me=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeColorfulTxtAndOthersIcon"},t))})},Re=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeColorfulPptxIcon"},t))})},Le=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeColorfulPdfIcon"},t))})},Pe=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeColorfulLinkIcon"},t))})},Be=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeColorfulImageIcon"},t))})},De=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeColorfulDocIcon"},t))})},Fe=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFiletypeColorfulCsvIcon"},t))})},Ue=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFeedbackSuccessIcon"},t))})},He=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFavoriteDoneIcon"},t))})},ze=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcFavoriteIcon"},t))})},Oe=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcExplainIcon"},t))})},qe=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcExpandIcon"},t))})},Ve=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcEditDisordeListIcon"},t))})},$e=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcEditIcon"},t))})},Ke=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcDragIcon"},t))})},We=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcDownloadIcon"},t))})},Ge=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcDoneWithCircleIcon"},t))})},Ze=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcDoneIcon"},t))})},Ye=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcDelineateWordsIcon"},t))})},Je=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcDeletIcon"},t))})},Qe=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcCoreIcon"},t))})},Xe=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcCopyIcon"},t))})},et=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcControlIcon"},t))})},tt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcCollapseIcon"},t))})},nt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcCloudyIcon"},t))})},it=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcCloseIcon"},t))})},ot=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcChevronUpIcon"},t))})},st=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcChevronRightIcon"},t))})},at=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcChevronLeftIcon"},t))})},rt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcChevronDownIcon"},t))})},lt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcChevron1DownIcon"},t))})},ct=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcCheckWithCircleIcon"},t))})},dt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcChatIcon"},t))})},ut=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcCameraIcon"},t))})},ht=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcBookIcon"},t))})},mt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcArrowUpIcon"},t))})},pt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcArrowIcon"},t))})},gt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcAllThreadsIcon"},t))})},vt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcAdjustRatioIcon"},t))})},ft=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcAddIcon"},t))})},_t=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcAcademicCiteIcon"},t))})},xt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IcAcademicIcon"},t))})},yt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"ZoomOutIcon"},t))})},bt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"ZoomInIcon"},t))})},wt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"VideoPlayIcon"},t))})},Ct=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"UploadImageIcon"},t))})},At=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"UploadFileDropIcon"},t))})},St=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"TemplateStarIcon"},t))})},It=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"SkillHeaderCloseIcon"},t))})},kt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"ShorterIcon"},t))})},jt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"SearchWebIcon"},t))})},Et=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"RightArrowIcon"},t))})},Tt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"ReportSuccessIcon"},t))})},Nt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"RegenerateLeftIcon"},t))})},Mt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"NewConversationIcon"},t))})},Rt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"MessageFailedIcon"},t))})},Lt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"LongerIcon"},t))})},Pt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"LoadingInThinkingIcon"},t))})},Bt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"ImageSelectIcon"},t))})},Dt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"ImageAddIcon"},t))})},Ft=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IconMusicDefaultIcon"},t))})},Ut=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"IconRefreshIcon"},t))})},Ht=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"FlowerLoadingIcon"},t))})},zt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"ExpandArrowIcon"},t))})},Ot=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"ErrorIcon"},t))})},qt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"EditMessageButtonIcon"},t))})},Vt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"DownloadWithArrowIcon"},t))})},$t=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"DeleteIcon"},t))})},Kt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"DeleteFileIcon"},t))})},Wt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"DefaultIndexIcon"},t))})},Gt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"DebugIcon"},t))})},Zt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"CustomAnswerActionModalCloseIcon"},t))})},Yt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"CopyIcon"},t))})},Jt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"ChangeToneIcon"},t))})},Qt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"BlackLightningIcon"},t))})},Xt=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"ArrowUpCircleIcon"},t))})},en=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"ArrowDown2Icon"},t))})},tn=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"AlertTriangleIcon"},t))})},nn=e=>{let t=(0,s.A)({},((0,o.A)(e),e));return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(l,(0,i.A)({iconKey:"AddAvatarIcon"},t))})}},20633:(e,t,n)=>{n.d(t,{Ay:()=>u,uX:()=>d});var i=n(44557),o=n(33451),s=n(11855),a=n(49103),r=n(81157),l=n(63159);const c=["initialValue","value","onChange"],d=(0,s.forwardRef)((function(e,t){let{initialValue:n,value:d=n,onChange:u}=e,h=(0,o.A)(e,c);const m=(0,s.useRef)(null);return(0,s.useImperativeHandle)(t,(()=>({focus:e=>{var t;null===(t=m.current)||void 0===t||t.focus(e)},blur:()=>{var e;null===(e=m.current)||void 0===e||e.blur()},setValue:({data:e})=>{var t;null===(t=m.current)||void 0===t||t.setValue((0,a.e8)(e))},selectAll:()=>{var e;null===(e=m.current)||void 0===e||e.selectAll()}})),[]),(0,l.jsx)(r.kD,(0,i.A)((0,i.A)({},h),{},{ref:m,value:d&&(0,a.e8)(d.data),onChange:u&&(e=>null==u?void 0:u({data:(0,a.EL)(e)}))}))})),u=d},49103:(e,t,n)=>{n.d(t,{EL:()=>l,GI:()=>u,Pg:()=>r,e8:()=>c,fG:()=>d,kE:()=>s,zS:()=>a});var i=n(18316),o=n(92734);const s=e=>e.type===i.b.Select,a=e=>e.type===i.b.Text,r=e=>e.type===i.b.Placeholder,l=e=>e.map(((t,n)=>{if((0,o.vq)(t)){if((0,o.je)(t)){const{children:o}=t;return l(o).concat(n===e.length-1?[]:[{type:i.b.Text,text:"\n"}])}if((0,o.KI)(t)){const{children:e,placeholder:n,key:s,clickable:a}=t;return{type:i.b.Placeholder,placeholder:n,text:(0,o.Ae)(e),key:s,clickable:a}}if((0,o.q6)(t)){const{value:e,options:n,title:o,key:s}=t;return{type:i.b.Select,title:o,key:s,optionList:n,value:e}}}const{text:s}=t;return{type:i.b.Text,text:s}})).flat(),c=e=>{if(!e.length)return[{type:"paragraph",children:[{text:""}]}];const t=[{type:"paragraph",children:[]}];for(const n of e)if(n.type===i.b.Text&&"\n"===n.text)t.push({type:"paragraph",children:[]});else if(r(n)){const{text:e,placeholder:i,key:o,clickable:s}=n;t[t.length-1].children.push({type:"labeled_input",children:[{text:e}],placeholder:i,key:o,clickable:s})}else if(s(n)){const{optionList:e,value:i,title:o,key:s}=n;t[t.length-1].children.push({type:"labeled_select",title:o,key:s,options:e,value:i,children:[{text:""}]})}else if(a(n)){const{text:e}=n;t[t.length-1].children.push({text:e})}return t},d=(e,t={})=>{const{stringifyItem:n}=t;return e.map((e=>{return r(e)?e.text||e.placeholder:s(e)?null!==(t=null==n?void 0:n(e))&&void 0!==t?t:e.value:a(e)?e.text:void 0;var t})).join("")},u=e=>0===d(e.data).length},4133:(e,t,n)=>{n.d(t,{G:()=>i});const i="flow-ext-disable-select-bar"},46939:(e,t,n)=>{n.d(t,{L:()=>s});var i=n(11855);const o="click";function s(e,t,n=o,s){const a=(0,i.useRef)(),r=(0,i.useCallback)((n=>{var i;const o=("function"==typeof e?e():e)||a.current;!o||o.contains(n.target)||null!==(i=n.composedPath)&&void 0!==i&&i.call(n).includes(o)||t(n)}),[a.current,t,e]);return(0,i.useEffect)((()=>(document.addEventListener(n,r,s),()=>{document.removeEventListener(n,r,s)})),[n,s,r]),a}},93261:(e,t,n)=>{n.d(t,{V:()=>o});var i=n(11855);const o=(e,t)=>{const n=(0,i.useRef)(e);return t(e,n.current)||(n.current=e),n.current}},6:(e,t,n)=>{n.d(t,{k:()=>s});var i=n(11855),o=n(20716);const s=(e,t=o.A)=>{const n=(0,i.useRef)(e),s=t(n.current,e);return(0,i.useEffect)((()=>{s||(n.current=e)})),s?n.current:e}},92399:(e,t,n)=>{n.d(t,{K:()=>o});var i=n(11855);const o=e=>{const t=(0,i.useRef)(e);return t.current=t.current||e,t.current}},27798:(e,t,n)=>{n.d(t,{m:()=>r});var i=n(33451),o=n(11855);const s=["ref"],a=(e,t,n)=>e>=t&&e<=n,r=e=>{let{ref:t}=e,n=(0,i.A)(e,s);const[r,l]=(0,o.useState)(!1);return(0,o.useLayoutEffect)((()=>{null!=t&&t.current&&((e,t={})=>{const{top:n,left:i,bottom:o,right:s}=e.getBoundingClientRect(),{topOffset:r=0,bottomOffset:l=0,leftOffset:c=0,rightOffset:d=0}=t,u=window.innerWidth||document.documentElement.clientWidth,h=window.innerHeight||document.documentElement.clientHeight;return(a(n,-r,h+l)||a(o,-r,h+l)||n<-r&&o>h+l)&&(a(i,-c,u+d)||a(s,-c,u+d)||i<-c&&s>u+d)})(t.current,n)&&l(!0)}),[]),{ref:t,inView:r}}},33277:(e,t,n)=>{n.d(t,{Ay:()=>a,Qf:()=>s});var i=n(11855);const o={media:"",matches:!1,onchange:()=>{},addListener:()=>{},removeListener:()=>{},addEventListener:()=>{},removeEventListener:()=>{},dispatchEvent:()=>!0},s=(e,t=!1)=>{const[n,s]=(0,i.useState)(t),a=function(e){return"string"==typeof e?e:Object.entries(e).map((([e,t])=>{const n=e.replace(/[A-Z]/g,(e=>`-${e.toLowerCase()}`)).toLowerCase();let i=t;return"boolean"==typeof i?i?n:`not ${n}`:("number"==typeof i&&/[height|width]$/.test(n)&&(i=`${i}px`),`(${n}: ${i})`)})).join(" and ")}(e);return(0,i.useEffect)((()=>{let e=!0;const t="undefined"==typeof window?o:window.matchMedia(a),n=()=>{e&&s(Boolean(t.matches))};return t.addListener(n),s(t.matches),()=>{e=!1,t.removeListener(n)}}),[a]),n},a=s},11776:(e,t,n)=>{n.d(t,{w:()=>l});var i=n(49392),o=n(9388),s=n(11855),a=n(37517),r=n(97785);"undefined"==typeof window||window.ResizeObserver||(window.ResizeObserver=r.tb);const l=(e={})=>{const{ref:t,onlyBothNilIsFirstScreen:n=!0,onResize:r}=e,l=(0,s.useRef)(null),c=null!=t?t:l,[d,u]=(0,s.useState)(),[h,m]=(0,s.useState)();(0,s.useLayoutEffect)((()=>{p()}),[]),(0,s.useLayoutEffect)((()=>{(0,i.A)(d)||(0,i.A)(h)||null==r||r({width:d,height:h})}),[d,h]);const p=()=>{if(c.current){const{width:e,height:t}=c.current.getBoundingClientRect();u(e),m(t)}else u(void 0),m(void 0)},{width:g,height:v}=(0,a.A)({ref:c,onResize:e=>{null==r||r(e);const{width:t,height:n}=e;(0,o.flushSync)((()=>{u(null!=t?t:0),m(null!=n?n:0)}))}});(0,s.useLayoutEffect)((()=>{u(void 0)}),[g]),(0,s.useLayoutEffect)((()=>{m(void 0)}),[v]);const f=n&&(0,i.A)(g)&&(0,i.A)(v);return{ref:c,width:null!=d?d:f?void 0:null!=g?g:0,height:null!=h?h:f?void 0:null!=v?v:0,refresh:p}}},11542:(e,t,n)=>{n.d(t,{M:()=>s});var i=n(49392),o=n(11855);const s=({defaultValue:e,initialValue:t=e,value:n,onChange:s,isEqual:a=Object.is,allowUndefined:r=!1})=>{const[l,c]=(0,o.useState)(null!=n?n:t),d=(e,t,n)=>(0,i.A)(t)?!(0,i.A)(e)&&(!!n||r):(0,i.A)(e)?(0,i.A)(t):!a(e,t);return(0,o.useEffect)((()=>{d(l,n,!1)&&c(null!=n?n:e)}),[n]),(0,o.useEffect)((()=>{d(l,n,!0)&&(null==s||s(l))}),[l]),[l,c]}},88367:(e,t,n)=>{n.d(t,{G:()=>s});var i=n(49392),o=n(11855);const s=e=>{const t=(0,o.useRef)(),n=()=>{t.current&&(clearTimeout(t.current),t.current=null)};return(0,o.useEffect)((()=>n),[]),{setExpired:o=>{if(n(),(0,i.A)(o))return;const s=Math.max(o-Date.now(),0);t.current=window.setTimeout((()=>{e()}),s)},reset:n}}},65117:(e,t,n)=>{n.d(t,{V8:()=>c,r$:()=>u,zH:()=>l});var i=n(14065),o=n(11855),s=n(22933),a=n(55281),r=n(26007);const l=()=>"undefined"==typeof navigator?"":navigator.language,c=e=>{var t,n,i;return!("undefined"==typeof process||![null===(t=process)||void 0===t||null===(t=t.env)||void 0===t?void 0:t.DEPLOY_CDN_REGION,null===(n=process)||void 0===n||null===(n=n.env)||void 0===n?void 0:"cn"].every((e=>"cn"!==e)))&&(null!==(i=(0,s.isRtlLang)(null!=e?e:l()))&&void 0!==i&&i)},d=function(){var e=(0,i.A)((function*(e,t=!1){try{const o=e.trim();if(!o)return t;const{franc:s}=yield(0,r.ts)((()=>Promise.resolve().then(n.bind(n,6683)))),l=s(o,{minLength:20});return"und"===l?(i=o.charAt(0),new RegExp("^[^A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02b8\u0300-\u0590\u0800-\u1fff\u2c00-\ufb1c\ufdfe-\ufe6f\ufefd-\uffff]*[\u0591-\u07ff\ufb1d-\ufdfd\ufe70-\ufefc]").test(i)):a.T.includes(l)}catch(o){return t}var i}));return function(t){return e.apply(this,arguments)}}(),u=(e,t=!1)=>{const[n,s]=(0,o.useState)("ltr"),a=function(){var n=(0,i.A)((function*(){const n=yield d(e,t);s(n?"rtl":"ltr")}));return function(){return n.apply(this,arguments)}}();return(0,o.useEffect)((()=>{a()}),[e,t]),n}},44644:(e,t,n)=>{n.d(t,{Asr:()=>p.A,BKw:()=>g.BK,BPM:()=>v.BP,Bog:()=>i.Bo,Eop:()=>a.Eo,FTe:()=>u.FT,F_u:()=>c.F_,FrL:()=>c.Fr,G2O:()=>f.G,GOI:()=>v.GO,GgW:()=>u.Gg,HUH:()=>_.HU,ILi:()=>u.IL,IjL:()=>u.Ij,JgS:()=>v.Jg,JxI:()=>m.J,Kld:()=>u.Kl,LsG:()=>u.Ls,MLh:()=>u.ML,Mks:()=>u.Mk,Mx4:()=>c.Mx,Ny:()=>c.Ny,OlY:()=>o.O,P1n:()=>u.P1,QfP:()=>u.Qf,Tw9:()=>a.Tw,UPE:()=>c.UP,V8t:()=>d.V8,V9O:()=>v.V9,VSZ:()=>u.VS,Wpb:()=>u.Wp,XXc:()=>u.XX,Yq5:()=>a.Yq,Z3i:()=>u.Z3,Z57:()=>c.Z5,ZCR:()=>u.ZC,alR:()=>h.al,bPQ:()=>u.bP,e4x:()=>o.e,gml:()=>c.gm,h9L:()=>l.h9,jco:()=>c.jc,k92:()=>u.k9,kU9:()=>u.kU,kf$:()=>i.kf,lBS:()=>u.lB,myZ:()=>u.my,nJq:()=>r.nJ,nrF:()=>c.nr,p_C:()=>x.p,q3w:()=>i.q3,r$W:()=>d.r$,tHD:()=>i.tH,tHN:()=>l.tH,tiF:()=>v.ti,tkF:()=>v.tk,tsJ:()=>l.ts,uQf:()=>_.uQ,v83:()=>u.v8,vAR:()=>s.v,v_R:()=>u.v_,w5E:()=>u.w5,wYm:()=>u.wY,w_h:()=>c.w_,wu0:()=>v.wu,xDQ:()=>u.xD,yK0:()=>v.yK,yy4:()=>i.yy,zH3:()=>d.zH});var i=n(6839),o=n(62396),s=n(24608),a=n(50655),r=n(61306),l=n(26007),c=n(91865),d=n(65117),u=(n(48317),n(47519)),h=n(78449),m=(n(23482),n(51443)),p=n(23241),g=n(38805),v=n(74848),f=(n(55699),n(4133)),_=n(10448),x=n(36352)},10448:(e,t,n)=>{n.d(t,{HU:()=>a,uQ:()=>s});var i=n(33277);const o={_isWideClientScreen:void 0,_mediaQueryList:void 0,get mediaQueryList(){var e,t;return null!==(e=o._mediaQueryList)&&void 0!==e?e:o._mediaQueryList=null===(t=window)||void 0===t?void 0:t.matchMedia("(min-width:880px)")},get isWideClientScreen(){var e;return void 0!==typeof window||(null!==(e=o._isWideClientScreen)&&void 0!==e?e:o._isWideClientScreen=o.mediaQueryList.matches)}},s=()=>o.isWideClientScreen,a=()=>(0,i.Ay)({maxWidth:599})},26368:(e,t,n)=>{n.d(t,{zV:()=>i});const i=(e,t="",n=512)=>{var i;const o=null!==(i=e.split(",")[1])&&void 0!==i?i:e,s=atob(o),a=[];for(let r=0;r<s.length;r+=n){const e=s.slice(r,r+n),t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);const i=new Uint8Array(t);a.push(i)}return new Blob(a,{type:t})}},91865:(e,t,n)=>{n.d(t,{F_:()=>h,Fr:()=>a,Mx:()=>u,Ny:()=>r,UP:()=>p,Z5:()=>f,gm:()=>m,jc:()=>d,nr:()=>g,w_:()=>v});var i=n(7685),o=n.n(i);let s;const a=()=>o().getParser(navigator.userAgent).getPlatformType(!0).includes("mobile"),r=()=>(void 0===s&&(s=a()),s);let l;let c;const d=()=>{if(void 0===c){const{userAgent:e}=navigator,t=/iPad/.test(e),n=e.includes("Macintosh")&&"ontouchstart"in document.documentElement;c=t||n}return c},u=()=>r()||(()=>{if("undefined"==typeof document)return!1;if(void 0===l){const{userAgent:e}=navigator,t=/iPad|iPhone|iPod/.test(e),n=e.includes("Macintosh")&&"ontouchstart"in document.documentElement;l=t||n}return l})(),h=()=>"function"==typeof window.webkitConvertPointFromNodeToPage,m=()=>navigator.userAgent.toLowerCase().includes("firefox"),p=()=>/edge?\//.test(navigator.userAgent.toLowerCase()),g=()=>navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome"),v=()=>h()&&!u();const f=()=>{if("undefined"==typeof navigator)return;const e=navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)\.([0-9]+)\.([0-9]+)\.([0-9]+)/);if(null===e||5!==e.length)return;const[,t,n,i,o]=e.map((e=>parseInt(e,10)));return{major:t,minor:n,build:i,patch:o}}},26007:(e,t,n)=>{n.d(t,{h9:()=>s,tH:()=>r,ts:()=>o});var i=n(14065);n(11855);const o=(e,t=3,n=1e3)=>new Promise(((i,s)=>{e().then(i).catch((a=>{setTimeout((()=>{1!==t?o(e,t-1,n).then(i,s):s(a)}),n)}))})),s=({fn:e,retriesLeft:t=3,interval:n=1e3,fallback:i={default:()=>null},onError:o=(()=>{})})=>new Promise(((a,r)=>{e().then(a).catch((l=>{setTimeout((()=>{if(1===t)return console.error("retryLoadWithFallBack error:",l),null==o||o(l),void a(i);s({fn:e,retriesLeft:t-1,interval:n,fallback:i,onError:o}).then(a,r)}),n)}))})),a=e=>new Promise((t=>{setTimeout(t,e)})),r=function(){var e=(0,i.A)((function*(e,t,n,i){for(let s=0;s<t;s++){const r=s+1;try{return yield e()}catch(o){if(r>=t)throw o;null==i||i(o,s)}const l="number"==typeof n?n:n(r);yield a(l)}throw Error("retry times out of limit")}));return function(t,n,i,o){return e.apply(this,arguments)}}()},78449:(e,t,n)=>{n.d(t,{OM:()=>o,al:()=>i,ax:()=>s});n(80160);const i=e=>{if("undefined"==typeof window)return null;const t=new URL(window.location.href);return new URLSearchParams(t.search).get(e)};function o(){return/youtube/.test(location.hostname)?!!location.pathname.startsWith("/watch"):!!/bilibili/.test(location.hostname)&&!!location.pathname.startsWith("/video/")}function s(){return!!/bilibili/.test(location.hostname)&&location.pathname.startsWith("/festival/")}},54188:(e,t,n)=>{n.d(t,{A:()=>i});const i={"cici-ext-container":"cici-ext-container-ZsL3N4",ciciExtContainer:"cici-ext-container-ZsL3N4","inactivelink-hover-animation":"inactivelink-hover-animation-uqtsZZ",inactivelinkHoverAnimation:"inactivelink-hover-animation-uqtsZZ","notactivelink-hover-animation":"notactivelink-hover-animation-qIF7Pk",notactivelinkHoverAnimation:"notactivelink-hover-animation-qIF7Pk","light-click-animation":"light-click-animation-aP0sBM",lightClickAnimation:"light-click-animation-aP0sBM","click-animation":"click-animation-m_aVOk",clickAnimation:"click-animation-m_aVOk","semi-animation-rotate":"semi-animation-rotate-guIq9p",semiAnimationRotate:"semi-animation-rotate-guIq9p","inactive-btn-hover-animation":"inactive-btn-hover-animation-p55iH4",inactiveBtnHoverAnimation:"inactive-btn-hover-animation-p55iH4","cici-ext-always-dark":"cici-ext-always-dark-cZEcux",ciciExtAlwaysDark:"cici-ext-always-dark-cZEcux","cici-ext-always-light":"cici-ext-always-light-asgCmn",ciciExtAlwaysLight:"cici-ext-always-light-asgCmn",ellipsis:"ellipsis-crsBmL",wrapper:"wrapper-hUZARQ",translateServicePopover:"translateServicePopover-hsdsA4",translatePanel:"translatePanel-zEvg3V",options:"options-Sqt4ba",translatePanelTitle:"translatePanelTitle-aF2p_o",translatePanelText:"translatePanelText-tZn2Vm","translate-panel-checkbox":"translate-panel-checkbox-zBRKCS",translatePanelCheckbox:"translate-panel-checkbox-zBRKCS",translatePanelSelectTitle:"translatePanelSelectTitle-PuACPl",translatePanelSelectList:"translatePanelSelectList-CM7MDK",translatePanelSelectItem:"translatePanelSelectItem-Hjf6Y1",nameWrapper:"nameWrapper-Ie1kv0",locName:"locName-jenbnm",active:"active-yOqMUg",name:"name-b4vXqU",checkbox:"checkbox-yjLP5c","language-notice-wrapper":"language-notice-wrapper-jvVOm3",languageNoticeWrapper:"language-notice-wrapper-jvVOm3","placement-left":"placement-left-rpzGBS",placementLeft:"placement-left-rpzGBS","language-notice":"language-notice-mWw7Vf",languageNotice:"language-notice-mWw7Vf",icon:"icon-C9iS8d",content:"content-TpyY49","activelink-hover-animation":"activelink-hover-animation-pD7DOP",activelinkHoverAnimation:"activelink-hover-animation-pD7DOP"}}},o={};function s(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={id:e,loaded:!1,exports:{}};return i[e].call(n.exports,n,n.exports,s),n.loaded=!0,n.exports}s.m=i,s.amdO={},e=[],s.O=(t,n,i,o)=>{if(!n){var a=1/0;for(d=0;d<e.length;d++){for(var[n,i,o]=e[d],r=!0,l=0;l<n.length;l++)(!1&o||a>=o)&&Object.keys(s.O).every((e=>s.O[e](n[l])))?n.splice(l--,1):(r=!1,o<a&&(a=o));if(r){e.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[n,i,o]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(e,i){if(1&i&&(e=this(e)),8&i)return e;if("object"==typeof e&&e){if(4&i&&e.__esModule)return e;if(16&i&&"function"==typeof e.then)return e}var o=Object.create(null);s.r(o);var a={};t=t||[null,n({}),n([]),n(n)];for(var r=2&i&&e;"object"==typeof r&&!~t.indexOf(r);r=n(r))Object.getOwnPropertyNames(r).forEach((t=>a[t]=()=>e[t]));return a.default=()=>e,s.d(o,a),o},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),s.p="/",(()=>{var e={854:0,389:0};s.O.j=t=>0===e[t];var t=(t,n)=>{var i,o,[a,r,l]=n,c=0;if(a.some((t=>0!==e[t]))){for(i in r)s.o(r,i)&&(s.m[i]=r[i]);if(l)var d=l(s)}for(t&&t(n);c<a.length;c++)o=a[c],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(d)},n=self.webpackChunkflow_web_extension=self.webpackChunkflow_web_extension||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),s.O(void 0,[356,551,295,272,154,256,520,688,223],(()=>s(48704)));var a=s.O(void 0,[356,551,295,272,154,256,520,688,223],(()=>s(76258)));a=s.O(a);